import{j as jsxRuntimeExports}from"./jsx-runtime.mvtouYz0.js";import{r as reactExports}from"./index.DcciWILN.js";import{S as SafeIcon,B as Button}from"./SafeIcon.C08LGL0m.js";import{c as Card,C as CardHeader,a as CardTitle,b as CardContent}from"./card.BWWJCoY0.js";import{B as Badge}from"./badge.BFgaaq5n.js";import{S as Separator}from"./separator.D_t_gK4i.js";import{D as Dialog,a as DialogContent,b as DialogHeader,c as DialogTitle}from"./dialog.Deg6T-G2.js";import{A as Avatar,b as AvatarFallback}from"./avatar.DQITNWzQ.js";import{T as Table,a as TableHeader,b as TableRow,c as TableHead,d as TableBody,e as TableCell}from"./table.Dsw4hYLC.js";import{f as formatCurrency}from"./currency.DQ9ceiwM.js";import{ordersApi,driversApi}from"./api.B5PpFILw.js";import{t as toast}from"./index.fAd_ikgp.js";import"./index.PIAPtHoh.js";import"./index.ubNQCTBn.js";import"./index.DYERl0li.js";import"./index.CmV6gt94.js";import"./index.CLV08RI1.js";import"./index.BB0xO63c.js";import"./Combination.wteLWZ5f.js";import"./index.Ci_bviUJ.js";import"./x.3YBaUzhJ.js";function OrderItemsTable({items}){return jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{children:jsxRuntimeExports.jsx(CardTitle,{children:"Item Pesanan"})}),jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs(Table,{children:[jsxRuntimeExports.jsx(TableHeader,{children:jsxRuntimeExports.jsxs(TableRow,{children:[jsxRuntimeExports.jsx(TableHead,{children:"Jenis LPG"}),jsxRuntimeExports.jsx(TableHead,{className:"text-right",children:"Qty"}),jsxRuntimeExports.jsx(TableHead,{className:"text-right",children:"Harga Satuan"}),jsxRuntimeExports.jsx(TableHead,{className:"text-right",children:"Subtotal"})]})}),jsxRuntimeExports.jsx(TableBody,{children:items.map(item=>jsxRuntimeExports.jsxs(TableRow,{children:[jsxRuntimeExports.jsxs(TableCell,{className:"font-medium",children:["LPG ",item.type]}),jsxRuntimeExports.jsx(TableCell,{className:"text-right",children:item.quantity}),jsxRuntimeExports.jsx(TableCell,{className:"text-right",children:formatCurrency(item.price)}),jsxRuntimeExports.jsx(TableCell,{className:"text-right font-medium",children:formatCurrency(item.subtotal)})]},item.id))})]})})})]})}function OrderSummaryCard({order}){return jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{children:jsxRuntimeExports.jsx(CardTitle,{children:"Ringkasan Pesanan"})}),jsxRuntimeExports.jsxs(CardContent,{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Tanggal Pesanan"}),jsxRuntimeExports.jsxs("p",{className:"font-medium",children:[order.createdDate," ",order.createdTime]})]}),jsxRuntimeExports.jsx(Separator,{}),jsxRuntimeExports.jsx(OrderItemsTable,{items:order.items}),jsxRuntimeExports.jsx(Separator,{}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:formatCurrency(order.subtotal)})]}),order.tax>0&&jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:["PPN 12%",jsxRuntimeExports.jsx(Badge,{variant:"outline",className:"text-[10px] px-1 py-0 bg-orange-50 text-orange-600 border-orange-200",children:"Non-Subsidi"})]}),jsxRuntimeExports.jsxs("span",{className:"font-medium text-orange-600",children:["+ ",formatCurrency(order.tax)]})]})]}),jsxRuntimeExports.jsx(Separator,{}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center bg-primary/5 p-3 rounded-lg",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Total"}),jsxRuntimeExports.jsx("span",{className:"text-lg font-bold text-primary",children:formatCurrency(order.total)})]})]})]})}function OrderTimelineStatus({timeline}){return jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{children:jsxRuntimeExports.jsx(CardTitle,{children:"Timeline Status"})}),jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsx("div",{className:"space-y-4",children:timeline.map((item,index)=>jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center",children:[jsxRuntimeExports.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-full border-2 ${item.completed?"border-primary bg-primary text-primary-foreground":"border-muted bg-muted text-muted-foreground"}`,children:item.completed?jsxRuntimeExports.jsx(SafeIcon,{name:"Check",className:"h-5 w-5"}):jsxRuntimeExports.jsx(SafeIcon,{name:"Clock",className:"h-5 w-5"})}),index<timeline.length-1&&jsxRuntimeExports.jsx("div",{className:`w-0.5 h-12 ${item.completed?"bg-primary":"bg-muted"}`})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 pt-1",children:[jsxRuntimeExports.jsx("p",{className:`font-medium ${item.completed?"text-foreground":"text-muted-foreground"}`,children:item.label}),item.date&&jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:item.date})]})]},item.status))})})]})}function OrderActionsPanel({orderStatus,onPaymentClick,onPaymentConfirmed,onPrintInvoice,onSendWhatsApp,onDriverAssignClick,onCompleteOrder,onEditOrder,onCancelOrder,onConfirmOrder,isPaymentConfirmed=!1,isDriverAssigned=!1}){const isDraft=orderStatus==="created",isPending=orderStatus==="pending_payment",isConfirmed=orderStatus==="payment_confirmed"||orderStatus==="ready_to_ship",isCompleted=orderStatus==="completed",isCancelled=orderStatus==="cancelled",canEdit=orderStatus==="pending_payment"||orderStatus==="created",canCancel=!isCompleted&&!isCancelled;return jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{children:jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Aksi"})}),jsxRuntimeExports.jsxs(CardContent,{className:"space-y-3",children:[isDraft&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Button,{onClick:onConfirmOrder,className:"w-full bg-primary hover:bg-primary/90",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"CheckCircle",className:"mr-2 h-4 w-4"}),"Konfirmasi Pesanan"]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Konfirmasi untuk memproses ke tahap pembayaran"})]}),isPending&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Button,{onClick:onPaymentClick,className:"w-full bg-primary hover:bg-primary/90",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"CreditCard",className:"mr-2 h-4 w-4"}),"Catat Pembayaran"]}),jsxRuntimeExports.jsxs(Button,{onClick:onPaymentConfirmed,variant:"outline",className:"w-full",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"CheckCircle",className:"mr-2 h-4 w-4"}),"Konfirmasi Lunas"]})]}),isConfirmed&&!isDriverAssigned&&jsxRuntimeExports.jsxs(Button,{onClick:onDriverAssignClick,className:"w-full bg-primary hover:bg-primary/90",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"UserPlus",className:"mr-2 h-4 w-4"}),"Tugaskan Driver"]}),isDriverAssigned&&!isCompleted&&jsxRuntimeExports.jsxs(Button,{onClick:onCompleteOrder,className:"w-full bg-green-600 hover:bg-green-700",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"CheckCircle2",className:"mr-2 h-4 w-4"}),"Selesaikan Pesanan"]}),canEdit&&onEditOrder&&jsxRuntimeExports.jsxs(Button,{onClick:onEditOrder,variant:"outline",className:"w-full",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Edit",className:"mr-2 h-4 w-4"}),"Edit Pesanan"]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[jsxRuntimeExports.jsxs(Button,{onClick:onPrintInvoice,variant:"outline",className:"w-full",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Printer",className:"mr-2 h-4 w-4"}),"Cetak Invoice/Nota"]}),jsxRuntimeExports.jsxs(Button,{onClick:onSendWhatsApp,variant:"outline",className:"w-full",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"MessageCircle",className:"mr-2 h-4 w-4"}),"Share via WA"]})]}),canCancel&&onCancelOrder&&jsxRuntimeExports.jsxs(Button,{onClick:onCancelOrder,variant:"outline",className:"w-full text-destructive border-destructive/50 hover:bg-destructive/10",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"X",className:"mr-2 h-4 w-4"}),"Batalkan Pesanan"]}),jsxRuntimeExports.jsxs(Button,{onClick:()=>window.location.href="/daftar-pesanan",variant:"ghost",className:"w-full",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"ArrowLeft",className:"mr-2 h-4 w-4"}),"Kembali ke Daftar"]})]})]})}function CustomerInfoCard({customer}){return jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{children:jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Informasi Pangkalan"})}),jsxRuntimeExports.jsxs(CardContent,{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Nama Pangkalan"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:customer.name})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Alamat"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:customer.address})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Email"}),jsxRuntimeExports.jsxs("a",{href:`mailto:${customer.email}`,className:"text-sm text-primary hover:underline flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Mail",className:"h-4 w-4"}),customer.email]})]}),jsxRuntimeExports.jsxs("div",{className:"border-t pt-4",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Kontak Penanggung Jawab"}),jsxRuntimeExports.jsx("p",{className:"font-medium text-sm",children:customer.contact}),jsxRuntimeExports.jsxs("a",{href:`tel:${customer.contactPhone}`,className:"text-sm text-primary hover:underline flex items-center gap-1 mt-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Phone",className:"h-4 w-4"}),customer.contactPhone]})]})]})]})}function DeliveryInfoCard({delivery}){return jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{children:jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Informasi Pengiriman"})}),jsxRuntimeExports.jsxs(CardContent,{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Status Pengiriman"}),jsxRuntimeExports.jsx(Badge,{variant:"status",className:`mt-1 ${delivery.status==="not_scheduled"||delivery.status==="ready_to_ship"?"bg-gray-100 text-gray-700":delivery.status==="scheduled"?"bg-blue-100 text-blue-700":delivery.status==="in_delivery"?"bg-indigo-100 text-indigo-700":"bg-green-100 text-green-700"}`,children:delivery.statusLabel})]}),delivery.driver?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Driver"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:delivery.driver}),delivery.driverPhone&&jsxRuntimeExports.jsxs("a",{href:`tel:${delivery.driverPhone}`,className:"text-sm text-primary hover:underline flex items-center gap-1 mt-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Phone",className:"h-4 w-4"}),delivery.driverPhone]})]}):jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Driver"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground italic",children:"Belum ditugaskan"})]}),delivery.estimatedDate?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Tanggal Estimasi"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:delivery.estimatedDate})]}):null,jsxRuntimeExports.jsxs("div",{className:"bg-secondary/50 p-3 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground font-medium mb-1",children:"Catatan"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:delivery.notes})]})]})]})}const STATUS_MAP={DRAFT:{status:"created",label:"Draft"},MENUNGGU_PEMBAYARAN:{status:"pending_payment",label:"Menunggu Pembayaran"},DIPROSES:{status:"payment_confirmed",label:"Pembayaran Diterima"},SIAP_KIRIM:{status:"ready_to_ship",label:"Siap Dikirim"},DIKIRIM:{status:"in_delivery",label:"Sedang Dikirim"},SELESAI:{status:"completed",label:"Pesanan Selesai"},BATAL:{status:"cancelled",label:"Dibatalkan"}};function mapApiToUI(apiOrder){const statusInfo=STATUS_MAP[apiOrder.current_status]||{status:"unknown",label:"Unknown"},createdAt=new Date(apiOrder.created_at);return{id:apiOrder.code||`ORD-${apiOrder.id.slice(0,4).toUpperCase()}`,apiId:apiOrder.id,status:statusInfo.status,statusLabel:statusInfo.label,createdDate:createdAt.toLocaleDateString("id-ID"),createdTime:createdAt.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}),customer:{name:apiOrder.pangkalans?.name||"Unknown",address:apiOrder.pangkalans?.address||"-",email:"-",contact:apiOrder.pangkalans?.pic_name||"-",contactPhone:apiOrder.pangkalans?.phone||"-"},items:apiOrder.order_items.map((item,idx)=>({id:idx+1,type:item.label||item.lpg_type,quantity:item.qty,price:item.price_per_unit,subtotal:item.sub_total})),subtotal:apiOrder.subtotal||apiOrder.total_amount,tax:apiOrder.tax_amount||0,total:apiOrder.total_amount,paymentMethod:null,paidAmount:0,delivery:{status:apiOrder.drivers?"assigned":"not_scheduled",statusLabel:apiOrder.drivers?"Sedang Dikirim":"Belum Dijadwalkan",driver:apiOrder.drivers?.name||null,driverPhone:apiOrder.drivers?.phone||null,estimatedDate:null,notes:apiOrder.note||"Tidak ada catatan"},timeline:buildTimeline(apiOrder)}}function buildTimeline(apiOrder){const baseTimeline=[{status:"created",label:"Pesanan Dibuat",date:null,completed:!1},{status:"pending_payment",label:"Menunggu Pembayaran",date:null,completed:!1},{status:"payment_confirmed",label:"Pembayaran Diterima",date:null,completed:!1},{status:"in_delivery",label:"Sedang Dikirim",date:null,completed:!1},{status:"completed",label:"Pesanan Selesai",date:null,completed:!1}];return baseTimeline[0].completed=!0,baseTimeline[0].date=new Date(apiOrder.created_at).toLocaleString("id-ID"),apiOrder.timeline_tracks&&apiOrder.timeline_tracks.forEach(track=>{const mappedStatus=STATUS_MAP[track.status]?.status,idx=baseTimeline.findIndex(t=>t.status===mappedStatus);idx!==-1&&(baseTimeline[idx].completed=!0,baseTimeline[idx].date=new Date(track.created_at).toLocaleString("id-ID"))}),baseTimeline}function OrderDetailContent(){const[order,setOrder]=reactExports.useState(null),[isLoading,setIsLoading]=reactExports.useState(!0),[isUpdating,setIsUpdating]=reactExports.useState(!1),[drivers,setDrivers]=reactExports.useState([]),[isDriverModalOpen,setIsDriverModalOpen]=reactExports.useState(!1),[selectedDriverId,setSelectedDriverId]=reactExports.useState(null),[isCancelModalOpen,setIsCancelModalOpen]=reactExports.useState(!1),getOrderId=()=>typeof window>"u"?null:new URLSearchParams(window.location.search).get("id");reactExports.useEffect(()=>{(async()=>{const orderId=getOrderId();if(!orderId){toast.error("ID pesanan tidak ditemukan"),setIsLoading(!1);return}try{setIsLoading(!0);const[apiOrder,driversRes]=await Promise.all([ordersApi.getById(orderId),driversApi.getAll(1,100,void 0,!0)]);setOrder(mapApiToUI(apiOrder)),setDrivers(driversRes.data)}catch(error){console.error("Failed to fetch order:",error),toast.error("Gagal memuat data pesanan")}finally{setIsLoading(!1)}})()},[]);const updateStatus=async(newStatus,description)=>{if(order)try{setIsUpdating(!0);const updated=await ordersApi.updateStatus(order.apiId,{status:newStatus,description});setOrder(mapApiToUI(updated)),toast.success(`Status diubah ke ${STATUS_MAP[newStatus].label}`)}catch(error){console.error("Failed to update status:",error),toast.error(error.message||"Gagal mengubah status")}finally{setIsUpdating(!1)}},handlePaymentClick=()=>{window.location.href=`/catat-pembayaran?id=${order?.apiId}`},handlePaymentConfirmed=async()=>{await updateStatus("DIPROSES","Pembayaran dikonfirmasi")},handlePrintInvoice=()=>{if(!order)return;const docType=order.status==="payment_confirmed"||order.status==="DIPROSES"||order.status==="SELESAI"?"nota":"invoice";window.location.href=`/nota-pembayaran?id=${order.apiId}&type=${docType}`},handleSendWhatsApp=()=>{if(!order)return;const docType=order.status==="payment_confirmed"||order.status==="DIPROSES"||order.status==="SELESAI"?"nota":"invoice";window.location.href=`/nota-pembayaran?id=${order.apiId}&type=${docType}`},handleSelectDriver=async driverId=>{if(order)try{setIsUpdating(!0),await ordersApi.update(order.apiId,{driver_id:driverId});const updated=await ordersApi.updateStatus(order.apiId,{status:"DIKIRIM",note:"Driver ditugaskan, pesanan sedang dikirim"});setOrder(mapApiToUI(updated)),setIsDriverModalOpen(!1),toast.success("Driver berhasil ditugaskan")}catch(error){console.error("Failed to assign driver:",error),toast.error(error.message||"Gagal menugaskan driver")}finally{setIsUpdating(!1)}},handleCompleteOrder=async()=>{await updateStatus("SELESAI","Pesanan selesai")},handleConfirmOrder=async()=>{await updateStatus("MENUNGGU_PEMBAYARAN","Pesanan dikonfirmasi, menunggu pembayaran")},handleEditOrder=()=>{order&&(window.location.href=`/buat-pesanan?id=${order.apiId}`)},handleCancelOrder=()=>{setIsCancelModalOpen(!0)},confirmCancelOrder=async()=>{await updateStatus("BATAL","Pesanan dibatalkan"),setIsCancelModalOpen(!1),window.location.href="/daftar-pesanan"};return isLoading?jsxRuntimeExports.jsxs("div",{className:"flex-1 flex items-center justify-center p-6",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-8 w-8 animate-spin text-primary"}),jsxRuntimeExports.jsx("span",{className:"ml-2",children:"Memuat detail pesanan..."})]}):order?jsxRuntimeExports.jsxs("div",{className:"flex-1 space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"icon",onClick:()=>window.location.href="/daftar-pesanan",children:jsxRuntimeExports.jsx(SafeIcon,{name:"ArrowLeft",className:"h-5 w-5"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold",children:"Detail Pesanan"}),jsxRuntimeExports.jsxs("p",{className:"text-muted-foreground font-mono",children:["ID: ",order.id]})]})]}),jsxRuntimeExports.jsx(Badge,{variant:"status",className:`text-base px-4 py-2 ${order.status==="pending_payment"?"bg-amber-100 text-amber-800":order.status==="payment_confirmed"?"bg-blue-100 text-blue-800":order.status==="in_delivery"?"bg-indigo-100 text-indigo-800":order.status==="completed"||order.status==="delivered"?"bg-green-100 text-green-800":order.status==="cancelled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:order.statusLabel})]}),jsxRuntimeExports.jsx(Separator,{}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[jsxRuntimeExports.jsx(OrderSummaryCard,{order}),jsxRuntimeExports.jsx(OrderTimelineStatus,{timeline:order.timeline})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsx(CustomerInfoCard,{customer:order.customer}),jsxRuntimeExports.jsx(DeliveryInfoCard,{delivery:order.delivery}),jsxRuntimeExports.jsx(OrderActionsPanel,{orderStatus:order.status,onPaymentClick:handlePaymentClick,onPaymentConfirmed:handlePaymentConfirmed,onPrintInvoice:handlePrintInvoice,onSendWhatsApp:handleSendWhatsApp,onDriverAssignClick:()=>setIsDriverModalOpen(!0),onCompleteOrder:handleCompleteOrder,onEditOrder:handleEditOrder,onCancelOrder:handleCancelOrder,onConfirmOrder:handleConfirmOrder,isPaymentConfirmed:order.status==="payment_confirmed",isDriverAssigned:order.delivery.driver!==null})]})]}),jsxRuntimeExports.jsx(Dialog,{open:isDriverModalOpen,onOpenChange:setIsDriverModalOpen,children:jsxRuntimeExports.jsxs(DialogContent,{className:"max-w-md",children:[jsxRuntimeExports.jsx(DialogHeader,{children:jsxRuntimeExports.jsx(DialogTitle,{children:"Pilih Driver"})}),jsxRuntimeExports.jsx("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:drivers.map(driver=>jsxRuntimeExports.jsxs("button",{onClick:()=>handleSelectDriver(driver.id),disabled:isUpdating,className:"w-full flex items-center gap-3 p-3 rounded-lg border hover:bg-accent transition-colors text-left disabled:opacity-50",children:[jsxRuntimeExports.jsx(Avatar,{className:"h-10 w-10",children:jsxRuntimeExports.jsx(AvatarFallback,{children:driver.name.charAt(0)})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-sm",children:driver.name}),jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground",children:driver.phone||"-"})]}),selectedDriverId===driver.id&&jsxRuntimeExports.jsx(SafeIcon,{name:"Check",className:"h-5 w-5 text-primary"})]},driver.id))})]})}),jsxRuntimeExports.jsx(Dialog,{open:isCancelModalOpen,onOpenChange:setIsCancelModalOpen,children:jsxRuntimeExports.jsxs(DialogContent,{className:"max-w-md",children:[jsxRuntimeExports.jsx(DialogHeader,{children:jsxRuntimeExports.jsxs(DialogTitle,{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-5 w-5 text-destructive"}),"Batalkan Pesanan"]})}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-destructive mb-2",children:"Tindakan ini tidak dapat dibatalkan"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-muted-foreground",children:["Apakah Anda yakin ingin membatalkan pesanan ",jsxRuntimeExports.jsx("span",{className:"font-semibold",children:order.id}),"? Pesanan akan ditandai sebagai dibatalkan dan tidak dapat diproses lebih lanjut."]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3 pt-4",children:[jsxRuntimeExports.jsx(Button,{onClick:()=>setIsCancelModalOpen(!1),variant:"outline",className:"flex-1",children:"Batal"}),jsxRuntimeExports.jsxs(Button,{onClick:confirmCancelOrder,variant:"destructive",className:"flex-1",disabled:isUpdating,children:[isUpdating?jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"mr-2 h-4 w-4 animate-spin"}):jsxRuntimeExports.jsx(SafeIcon,{name:"Trash2",className:"mr-2 h-4 w-4"}),"Batalkan Pesanan"]})]})]})]})})]}):jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6 gap-4",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-16 w-16 text-destructive"}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold",children:"Pesanan Tidak Ditemukan"}),jsxRuntimeExports.jsxs(Button,{onClick:()=>window.location.href="/daftar-pesanan",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"ArrowLeft",className:"mr-2 h-4 w-4"}),"Kembali ke Daftar"]})]})}export{OrderDetailContent as default};
