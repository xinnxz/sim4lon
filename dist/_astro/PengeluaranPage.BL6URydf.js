import{j as jsxRuntimeExports}from"./jsx-runtime.mvtouYz0.js";import{r as reactExports}from"./index.DcciWILN.js";import{C as Card,b as CardHeader,c as CardTitle,a as CardContent,d as CardDescription}from"./card.D0gylVsf.js";import{S as SafeIcon,B as Button}from"./SafeIcon.CAGsavDo.js";import{I as Input}from"./input.C9ryBhC0.js";import{L as Label}from"./label.BFF1cpbq.js";import{T as Textarea}from"./textarea.CmILhP_C.js";import{B as Badge}from"./badge.DZiJ6zSB.js";import{D as Dialog,e as DialogTrigger,a as DialogContent,b as DialogHeader,c as DialogTitle,d as DialogDescription,f as DialogFooter}from"./dialog.CoJQQKDV.js";import{expensesApi}from"./api.Dr7hS9Y8.js";import{t as toast}from"./index.fAd_ikgp.js";import"./index.PIAPtHoh.js";import"./index.ubNQCTBn.js";import"./index.zVS-qTD4.js";import"./index.BpQ989z7.js";import"./index.YpXgcoRz.js";import"./index.Dovp0-D8.js";import"./index.DZiLsHox.js";import"./index.CdmyERTi.js";import"./x.DUlMVzh7.js";const CATEGORIES=[{value:"OPERASIONAL",label:"Operasional",icon:"Settings",color:"bg-slate-500",gradient:"from-slate-500 to-slate-600"},{value:"TRANSPORT",label:"Transport",icon:"Truck",color:"bg-orange-500",gradient:"from-orange-500 to-orange-600"},{value:"SEWA",label:"Sewa",icon:"Home",color:"bg-purple-500",gradient:"from-purple-500 to-purple-600"},{value:"LISTRIK",label:"Listrik/Air",icon:"Zap",color:"bg-yellow-500",gradient:"from-yellow-500 to-amber-600"},{value:"GAJI",label:"Gaji",icon:"Users",color:"bg-blue-500",gradient:"from-blue-500 to-blue-600"},{value:"LAINNYA",label:"Lainnya",icon:"MoreHorizontal",color:"bg-gray-500",gradient:"from-gray-500 to-gray-600"}];function PengeluaranPage(){const[expenses,setExpenses]=reactExports.useState([]),[isLoading,setIsLoading]=reactExports.useState(!0),[isDialogOpen,setIsDialogOpen]=reactExports.useState(!1),[editingExpense,setEditingExpense]=reactExports.useState(null),[formData,setFormData]=reactExports.useState({category:"OPERASIONAL",amount:"",description:"",expense_date:new Date().toISOString().split("T")[0]}),[isSubmitting,setIsSubmitting]=reactExports.useState(!1),[filterMonth,setFilterMonth]=reactExports.useState(()=>{const now=new Date;return`${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,"0")}`}),fetchExpenses=async()=>{try{setIsLoading(!0);const[year,month]=filterMonth.split("-"),startDate=`${year}-${month}-01`,endDate=new Date(parseInt(year),parseInt(month),0).toISOString().split("T")[0],data=await expensesApi.getAll(startDate,endDate);setExpenses(data)}catch(error){console.error("Failed to fetch expenses:",error),toast.error("Gagal memuat data pengeluaran")}finally{setIsLoading(!1)}};reactExports.useEffect(()=>{fetchExpenses()},[filterMonth]);const handleOpenDialog=expense=>{expense?(setEditingExpense(expense),setFormData({category:expense.category,amount:expense.amount.toString(),description:expense.description||"",expense_date:new Date(expense.expense_date).toISOString().split("T")[0]})):(setEditingExpense(null),setFormData({category:"OPERASIONAL",amount:"",description:"",expense_date:new Date().toISOString().split("T")[0]})),setIsDialogOpen(!0)},handleSubmit=async e=>{if(e.preventDefault(),!formData.amount||parseFloat(formData.amount)<=0){toast.error("Jumlah pengeluaran wajib diisi");return}try{setIsSubmitting(!0);const data={category:formData.category,amount:parseFloat(formData.amount),description:formData.description||void 0,expense_date:formData.expense_date};editingExpense?(await expensesApi.update(editingExpense.id,data),toast.success("Pengeluaran berhasil diperbarui")):(await expensesApi.create(data),toast.success("Pengeluaran berhasil ditambahkan")),setIsDialogOpen(!1),fetchExpenses()}catch(error){toast.error(error.message||"Gagal menyimpan pengeluaran")}finally{setIsSubmitting(!1)}},handleDelete=async expense=>{if(confirm(`Hapus pengeluaran "${getCategoryLabel(expense.category)}" ${formatCurrency(expense.amount)}?`))try{await expensesApi.delete(expense.id),toast.success("Pengeluaran berhasil dihapus"),fetchExpenses()}catch(error){toast.error(error.message||"Gagal menghapus pengeluaran")}},formatCurrency=value=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(value),formatDate=dateStr=>new Date(dateStr).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),getCategoryLabel=cat=>CATEGORIES.find(c=>c.value===cat)?.label||cat,getCategoryGradient=cat=>CATEGORIES.find(c=>c.value===cat)?.gradient||"from-gray-500 to-gray-600",getCategoryIcon=cat=>CATEGORIES.find(c=>c.value===cat)?.icon||"Circle",totalExpenses=expenses.reduce((sum,e)=>sum+Number(e.amount),0),expensesByCategory=CATEGORIES.map(cat=>({...cat,total:expenses.filter(e=>e.category===cat.value).reduce((sum,e)=>sum+Number(e.amount),0),count:expenses.filter(e=>e.category===cat.value).length})).filter(cat=>cat.total>0);return isLoading&&expenses.length===0?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center min-h-[500px]",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-red-200 border-t-red-600 mx-auto"}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Wallet",className:"h-6 w-6 text-red-600"})})]}),jsxRuntimeExports.jsx("p",{className:"text-slate-500 mt-4 font-medium",children:"Memuat data pengeluaran..."})]})}):jsxRuntimeExports.jsxs("div",{className:"space-y-8 pb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 animate-fadeInDown",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"h-12 w-1.5 rounded-full bg-gradient-to-b from-red-500 via-red-400 to-orange-500 animate-lineGrow"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-900 dark:text-white tracking-tight",children:"Pengeluaran"}),jsxRuntimeExports.jsxs("p",{className:"text-slate-500 dark:text-slate-400 mt-1 flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Wallet",className:"h-4 w-4 animate-pulse"}),"Catat biaya operasional pangkalan"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(Input,{type:"month",value:filterMonth,onChange:e=>setFilterMonth(e.target.value),className:"w-[160px] rounded-xl"}),jsxRuntimeExports.jsxs(Dialog,{open:isDialogOpen,onOpenChange:setIsDialogOpen,children:[jsxRuntimeExports.jsx(DialogTrigger,{asChild:!0,children:jsxRuntimeExports.jsxs(Button,{onClick:()=>handleOpenDialog(),className:"group bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white rounded-xl shadow-lg shadow-red-500/25 active:scale-95",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Plus",className:"h-4 w-4 mr-2 transition-transform duration-300 group-hover:rotate-90"}),"Tambah Pengeluaran"]})}),jsxRuntimeExports.jsx(DialogContent,{className:"sm:max-w-[500px]",children:jsxRuntimeExports.jsxs("form",{onSubmit:handleSubmit,children:[jsxRuntimeExports.jsxs(DialogHeader,{children:[jsxRuntimeExports.jsxs(DialogTitle,{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"w-10 h-10 rounded-xl bg-red-100 flex items-center justify-center",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Wallet",className:"h-5 w-5 text-red-600"})}),editingExpense?"Edit Pengeluaran":"Tambah Pengeluaran"]}),jsxRuntimeExports.jsx(DialogDescription,{children:editingExpense?"Perbarui data pengeluaran":"Isi data pengeluaran baru"})]}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4 py-4",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{children:"Kategori *"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-3 gap-2",children:CATEGORIES.map(cat=>jsxRuntimeExports.jsxs("button",{type:"button",onClick:()=>setFormData({...formData,category:cat.value}),className:`flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all ${formData.category===cat.value?"border-red-500 bg-red-50":"border-slate-200 hover:border-slate-300"}`,children:[jsxRuntimeExports.jsx("div",{className:`w-10 h-10 rounded-xl bg-gradient-to-br ${cat.gradient} flex items-center justify-center`,children:jsxRuntimeExports.jsx(SafeIcon,{name:cat.icon,className:"h-5 w-5 text-white"})}),jsxRuntimeExports.jsx("span",{className:`text-xs font-medium ${formData.category===cat.value?"text-red-700":"text-slate-600"}`,children:cat.label})]},cat.value))})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"amount",children:"Jumlah (Rp) *"}),jsxRuntimeExports.jsx(Input,{id:"amount",type:"number",value:formData.amount,onChange:e=>setFormData({...formData,amount:e.target.value}),placeholder:"50000",min:"0",required:!0,className:"text-lg font-bold"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"expense_date",children:"Tanggal"}),jsxRuntimeExports.jsx(Input,{id:"expense_date",type:"date",value:formData.expense_date,onChange:e=>setFormData({...formData,expense_date:e.target.value})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"description",children:"Keterangan"}),jsxRuntimeExports.jsx(Textarea,{id:"description",value:formData.description,onChange:e=>setFormData({...formData,description:e.target.value}),placeholder:"BBM motor untuk antar gas...",rows:2})]})]}),jsxRuntimeExports.jsxs(DialogFooter,{children:[jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",onClick:()=>setIsDialogOpen(!1),children:"Batal"}),jsxRuntimeExports.jsxs(Button,{type:"submit",disabled:isSubmitting,className:"bg-red-600 hover:bg-red-700",children:[isSubmitting?jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-4 w-4 mr-2 animate-spin"}):jsxRuntimeExports.jsx(SafeIcon,{name:"Check",className:"h-4 w-4 mr-2"}),"Simpan"]})]})]})})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4",children:[jsxRuntimeExports.jsx("div",{className:"animate-slideInBlur stagger-1",style:{opacity:0},children:jsxRuntimeExports.jsxs(Card,{className:"relative overflow-hidden bg-gradient-to-br from-red-500 to-red-600 text-white shadow-lg shadow-red-500/20 hover:shadow-xl hover:shadow-red-500/30 transition-all duration-300 hover:-translate-y-1 hover:scale-[1.02] group",children:[jsxRuntimeExports.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-white/15 rounded-full -translate-y-1/2 translate-x-1/2 animate-floatOrb"}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-0 left-0 w-12 h-12 bg-white/10 rounded-full translate-y-1/2 -translate-x-1/2 animate-floatOrb-delayed"}),jsxRuntimeExports.jsx(CardHeader,{className:"pb-2 relative",children:jsxRuntimeExports.jsxs(CardTitle,{className:"text-sm font-medium opacity-90 flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"p-1.5 rounded-lg bg-white/20 transition-transform duration-300 group-hover:scale-110 group-hover:rotate-12",children:jsxRuntimeExports.jsx(SafeIcon,{name:"TrendingDown",className:"h-4 w-4"})}),"Total Pengeluaran"]})}),jsxRuntimeExports.jsxs(CardContent,{className:"relative",children:[jsxRuntimeExports.jsx("p",{className:"text-2xl lg:text-3xl font-bold tracking-tight",children:formatCurrency(totalExpenses)}),jsxRuntimeExports.jsxs("p",{className:"text-red-100 text-sm mt-2",children:[expenses.length," transaksi bulan ini"]})]})]})}),expensesByCategory.slice(0,3).map((cat,index)=>jsxRuntimeExports.jsx("div",{className:`animate-slideInBlur stagger-${index+2}`,style:{opacity:0},children:jsxRuntimeExports.jsxs(Card,{className:"relative overflow-hidden bg-white dark:bg-slate-900 shadow-lg border-0 hover:shadow-xl transition-all duration-300 hover:-translate-y-1 hover:scale-[1.02] group",children:[jsxRuntimeExports.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-slate-100 dark:bg-slate-800 rounded-full -translate-y-1/2 translate-x-1/2 animate-floatOrb"}),jsxRuntimeExports.jsx(CardHeader,{className:"pb-2 relative",children:jsxRuntimeExports.jsxs(CardTitle,{className:"text-sm font-medium text-slate-600 dark:text-slate-300 flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:`w-8 h-8 rounded-lg bg-gradient-to-br ${cat.gradient} flex items-center justify-center transition-transform duration-300 group-hover:scale-110 group-hover:rotate-12`,children:jsxRuntimeExports.jsx(SafeIcon,{name:cat.icon,className:"h-4 w-4 text-white"})}),cat.label]})}),jsxRuntimeExports.jsxs(CardContent,{className:"relative",children:[jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:formatCurrency(cat.total)}),jsxRuntimeExports.jsxs("p",{className:"text-slate-500 dark:text-slate-400 text-sm mt-2",children:[cat.count," transaksi"]})]})]})},cat.value))]}),expensesByCategory.length>0&&jsxRuntimeExports.jsxs(Card,{className:"bg-white shadow-lg rounded-2xl border-0 overflow-hidden",children:[jsxRuntimeExports.jsx(CardHeader,{className:"border-b border-slate-100 bg-slate-50/50",children:jsxRuntimeExports.jsxs(CardTitle,{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-100 flex items-center justify-center",children:jsxRuntimeExports.jsx(SafeIcon,{name:"PieChart",className:"h-4 w-4 text-purple-600"})}),"Breakdown Kategori"]})}),jsxRuntimeExports.jsx(CardContent,{className:"p-6",children:jsxRuntimeExports.jsx("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:expensesByCategory.map(cat=>{const percentage=totalExpenses>0?(cat.total/totalExpenses*100).toFixed(1):"0";return jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-slate-50 hover:bg-slate-100 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:`w-10 h-10 rounded-xl bg-gradient-to-br ${cat.gradient} flex items-center justify-center flex-shrink-0`,children:jsxRuntimeExports.jsx(SafeIcon,{name:cat.icon,className:"h-5 w-5 text-white"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-slate-900",children:cat.label}),jsxRuntimeExports.jsxs(Badge,{variant:"secondary",className:"bg-slate-200",children:[percentage,"%"]})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500 font-bold",children:formatCurrency(cat.total)})]})]},cat.value)})})})]}),jsxRuntimeExports.jsxs(Card,{className:"bg-white shadow-lg rounded-2xl border-0 overflow-hidden",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"border-b border-slate-100 bg-slate-50/50",children:[jsxRuntimeExports.jsxs(CardTitle,{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-lg bg-red-100 flex items-center justify-center",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Receipt",className:"h-4 w-4 text-red-600"})}),"Daftar Pengeluaran"]}),jsxRuntimeExports.jsx(CardDescription,{children:"Riwayat pengeluaran bulan ini"})]}),jsxRuntimeExports.jsx(CardContent,{className:"p-0",children:expenses.length===0?jsxRuntimeExports.jsxs("div",{className:"text-center py-16",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Wallet",className:"h-16 w-16 text-slate-300 mx-auto mb-4"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-slate-700 mb-2",children:"Belum Ada Pengeluaran"}),jsxRuntimeExports.jsx("p",{className:"text-slate-400 mb-6",children:"Catat pengeluaran operasional Anda"}),jsxRuntimeExports.jsxs(Button,{onClick:()=>handleOpenDialog(),className:"bg-red-600 hover:bg-red-700",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Plus",className:"h-4 w-4 mr-2"}),"Catat Pengeluaran Pertama"]})]}):jsxRuntimeExports.jsx("div",{className:"divide-y divide-slate-100",children:expenses.map((expense,index)=>jsxRuntimeExports.jsxs("div",{className:`flex items-center justify-between p-4 hover:bg-red-50/30 transition-colors ${index%2===0?"bg-white":"bg-slate-50/30"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${getCategoryGradient(expense.category)} flex items-center justify-center`,children:jsxRuntimeExports.jsx(SafeIcon,{name:getCategoryIcon(expense.category),className:"h-6 w-6 text-white"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("p",{className:"font-semibold text-slate-900",children:getCategoryLabel(expense.category)}),jsxRuntimeExports.jsx(Badge,{variant:"outline",className:"text-xs",children:formatDate(expense.expense_date)})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-slate-500 mt-1",children:expense.description||"Tidak ada keterangan"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("span",{className:"font-bold text-red-600 text-lg",children:["-",formatCurrency(expense.amount)]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:()=>handleOpenDialog(expense),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Pencil",className:"h-4 w-4"})}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:()=>handleDelete(expense),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Trash2",className:"h-4 w-4"})})]})]})]},expense.id))})})]})]})}export{PengeluaranPage as default};
