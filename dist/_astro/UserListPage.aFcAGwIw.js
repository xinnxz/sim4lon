import{S as SafeIcon,B as Button,_ as __vitePreload}from"./SafeIcon.CAGsavDo.js";import{j as jsxRuntimeExports}from"./jsx-runtime.mvtouYz0.js";import{r as reactExports}from"./index.DcciWILN.js";import{I as Input}from"./input.C9ryBhC0.js";import{C as Card,b as CardHeader,c as CardTitle,d as CardDescription,a as CardContent}from"./card.D0gylVsf.js";import{T as Tilt3DCard}from"./Tilt3DCard.A2Rmx9L7.js";import{T as Table,a as TableHeader,b as TableRow,c as TableHead,d as TableBody,e as TableCell}from"./table.DRds5X1g.js";import{D as DropdownMenu,a as DropdownMenuTrigger,b as DropdownMenuContent,c as DropdownMenuItem}from"./dropdown-menu.CyUKnKxT.js";import{S as Select,a as SelectTrigger,b as SelectValue,c as SelectContent,d as SelectItem}from"./select.Dd50uIHU.js";import{B as Badge}from"./badge.DZiJ6zSB.js";import{C as ConfirmationModal}from"./ConfirmationModal.Ck8mepRg.js";import{usersApi}from"./api.Dr7hS9Y8.js";import{t as toast}from"./index.fAd_ikgp.js";import{D as Dialog,a as DialogContent,b as DialogHeader,c as DialogTitle,d as DialogDescription}from"./dialog.CoJQQKDV.js";import AddUserForm from"./AddUserForm.BeJgsljw.js";import{L as Label}from"./label.BFF1cpbq.js";import{A as AnimatedNumber}from"./AnimatedNumber.DkDF6dXY.js";import{P as PageHeader}from"./PageHeader.ChFr_oMu.js";import"./index.BpQ989z7.js";import"./index.PIAPtHoh.js";import"./index.ubNQCTBn.js";import"./index.YpXgcoRz.js";import"./index.Dovp0-D8.js";import"./index.BStXkqMp.js";import"./index.Drh0kMGk.js";import"./index.DZiLsHox.js";import"./index.BFpcrWlj.js";import"./index.9MihlNbL.js";import"./index.CdmyERTi.js";import"./index.DQDOfy24.js";import"./chevron-right.oaN48PMp.js";import"./check.TUgVKQyo.js";import"./index.DGt6JTY0.js";import"./index.BhA3i5Wo.js";import"./index.BaF2FVWY.js";import"./chevron-up.BBBXIirx.js";import"./index.zVS-qTD4.js";import"./x.DUlMVzh7.js";import"./alert.C-aQE-Lx.js";function AddUserModal({open,onOpenChange,onSuccess}){return jsxRuntimeExports.jsx(Dialog,{open,onOpenChange,children:jsxRuntimeExports.jsxs(DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[jsxRuntimeExports.jsxs(DialogHeader,{children:[jsxRuntimeExports.jsx(DialogTitle,{children:"Tambah Pengguna Baru"}),jsxRuntimeExports.jsx(DialogDescription,{children:"Daftarkan pengguna baru ke dalam sistem SIM4LON"})]}),jsxRuntimeExports.jsx("div",{className:"py-4",children:jsxRuntimeExports.jsx(AddUserForm,{onClose:()=>{onOpenChange(!1),onSuccess?.()}})})]})})}const roleOptions=[{value:"ADMIN",label:"Administrator"},{value:"OPERATOR",label:"Operator Lapangan"}];function EditUserForm({onClose,userId}){const[formData,setFormData]=reactExports.useState({nama:"",telepon:"",email:"",role:"OPERATOR",status:"aktif"}),[isLoading,setIsLoading]=reactExports.useState(!1),[isFetching,setIsFetching]=reactExports.useState(!0),[showConfirm,setShowConfirm]=reactExports.useState(!1),[showResetPassword,setShowResetPassword]=reactExports.useState(!1),[errors,setErrors]=reactExports.useState({}),[generatedPassword,setGeneratedPassword]=reactExports.useState(""),[copiedPassword,setCopiedPassword]=reactExports.useState(!1);reactExports.useEffect(()=>{(async()=>{if(!userId){setIsFetching(!1);return}try{const user=await usersApi.getById(userId);setFormData({nama:user.name,telepon:user.phone||"",email:user.email,role:user.role,status:user.is_active?"aktif":"nonaktif"})}catch(error){console.error("Failed to fetch user:",error),toast.error("Gagal memuat data pengguna")}finally{setIsFetching(!1)}})()},[userId]);const validateForm=()=>{const newErrors={};return formData.nama.trim()||(newErrors.nama="Nama pengguna harus diisi"),formData.telepon.trim()?/^(\+62|0)[0-9]{9,12}$/.test(formData.telepon.replace(/\s/g,""))||(newErrors.telepon="Format nomor telepon tidak valid"):newErrors.telepon="Nomor telepon harus diisi",formData.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(formData.email)||(newErrors.email="Format email tidak valid"):newErrors.email="Email harus diisi",formData.role||(newErrors.role="Peran pengguna harus dipilih"),formData.status||(newErrors.status="Status pengguna harus dipilih"),setErrors(newErrors),Object.keys(newErrors).length===0},handleInputChange=e=>{const{name,value}=e.target;setFormData(prev=>({...prev,[name]:value})),errors[name]&&setErrors(prev=>({...prev,[name]:""}))},handleSelectChange=(name,value)=>{setFormData(prev=>({...prev,[name]:value})),errors[name]&&setErrors(prev=>({...prev,[name]:""}))},handleSubmit=async()=>{if(!validateForm()){toast.error("Mohon periksa kembali form Anda");return}if(!userId){toast.error("ID pengguna tidak ditemukan");return}setIsLoading(!0);try{await usersApi.update(userId,{name:formData.nama,phone:formData.telepon,role:formData.role,is_active:formData.status==="aktif"}),toast.success("Data pengguna berhasil diperbarui"),setTimeout(()=>{onClose?onClose():window.location.href="/daftar-pengguna"},500)}catch(error){const message=error?.message||"Gagal memperbarui data pengguna";toast.error(message),setIsLoading(!1)}},handleCancel=()=>{onClose?onClose():window.location.href="/daftar-pengguna"},[isResettingPassword,setIsResettingPassword]=reactExports.useState(!1),generateRandomPassword=async()=>{if(!userId){toast.error("ID pengguna tidak ditemukan");return}setIsResettingPassword(!0);try{const response=await usersApi.resetPassword(userId);setGeneratedPassword(response.newPassword),setCopiedPassword(!1),toast.success("Password berhasil direset dan disimpan ke database")}catch(error){console.error("Failed to reset password:",error),toast.error("Gagal mereset password")}finally{setIsResettingPassword(!1)}},copyPasswordToClipboard=()=>{navigator.clipboard.writeText(generatedPassword),setCopiedPassword(!0),setTimeout(()=>setCopiedPassword(!1),2e3)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Card,{className:"border shadow-card",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"border-b bg-gradient-to-r from-primary/5 to-accent/5",children:[jsxRuntimeExports.jsxs(CardTitle,{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"UserEdit",className:"h-5 w-5 text-primary"}),"Edit Data Pengguna"]}),jsxRuntimeExports.jsxs(CardDescription,{children:["ID Pengguna: ",jsxRuntimeExports.jsx("span",{className:"font-mono font-semibold text-foreground",children:userId||"-"})]})]}),jsxRuntimeExports.jsx(CardContent,{className:"pt-6",children:jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs(Label,{htmlFor:"nama",className:"text-sm font-semibold",children:["Nama Pengguna ",jsxRuntimeExports.jsx("span",{className:"text-destructive",children:"*"})]}),jsxRuntimeExports.jsx(Input,{id:"nama",name:"nama",placeholder:"Masukkan nama pengguna",value:formData.nama,onChange:handleInputChange,className:`h-10 ${errors.nama?"border-destructive focus-visible:ring-destructive":""}`,disabled:isLoading}),errors.nama&&jsxRuntimeExports.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-4 w-4"}),errors.nama]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs(Label,{htmlFor:"telepon",className:"text-sm font-semibold",children:["Nomor Telepon ",jsxRuntimeExports.jsx("span",{className:"text-destructive",children:"*"})]}),jsxRuntimeExports.jsx(Input,{id:"telepon",name:"telepon",placeholder:"Contoh: 081234567890",value:formData.telepon,onChange:handleInputChange,className:`h-10 ${errors.telepon?"border-destructive focus-visible:ring-destructive":""}`,disabled:isLoading}),errors.telepon&&jsxRuntimeExports.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-4 w-4"}),errors.telepon]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs(Label,{htmlFor:"email",className:"text-sm font-semibold flex items-center gap-2",children:["Email",jsxRuntimeExports.jsx("span",{className:"text-xs font-normal bg-gray-200 text-gray-600 px-2 py-0.5 rounded",children:"Read-only"})]}),jsxRuntimeExports.jsx(Input,{id:"email",name:"email",type:"email",value:formData.email,readOnly:!0,disabled:!0,className:"h-10 bg-gray-100 text-gray-600 cursor-not-allowed border-gray-200"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs(Label,{htmlFor:"role",className:"text-sm font-semibold",children:["Peran Pengguna ",jsxRuntimeExports.jsx("span",{className:"text-destructive",children:"*"})]}),jsxRuntimeExports.jsxs(Select,{value:formData.role,onValueChange:value=>handleSelectChange("role",value),disabled:isLoading,children:[jsxRuntimeExports.jsx(SelectTrigger,{className:`h-10 ${errors.role?"border-destructive focus-visible:ring-destructive":""}`,children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Pilih peran pengguna"})}),jsxRuntimeExports.jsx(SelectContent,{children:roleOptions.map(option=>jsxRuntimeExports.jsx(SelectItem,{value:option.value,children:option.label},option.value))})]}),errors.role&&jsxRuntimeExports.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-4 w-4"}),errors.role]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Key",className:"h-5 w-5 text-blue-600"}),jsxRuntimeExports.jsxs("div",{className:"text-sm",children:[jsxRuntimeExports.jsx("p",{className:"font-semibold text-foreground",children:"Reset Password Pengguna"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground text-xs",children:"Generate password baru untuk pengguna yang lupa kata sandi"})]})]}),jsxRuntimeExports.jsxs(Button,{type:"button",variant:"outline",onClick:()=>setShowResetPassword(!0),disabled:isLoading,className:"shrink-0 text-blue-600 border-blue-200 hover:bg-blue-50",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"RotateCw",className:"mr-2 h-4 w-4"}),"Reset Password"]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-primary/5 border border-primary/20 rounded-lg p-4 flex gap-3",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Info",className:"h-5 w-5 text-primary shrink-0 mt-0.5"}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-foreground",children:[jsxRuntimeExports.jsx("p",{className:"font-semibold mb-1",children:"Catatan Penting"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Perubahan peran pengguna akan langsung berlaku. Pastikan pengguna memiliki akses yang sesuai dengan tanggung jawab mereka."})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[jsxRuntimeExports.jsxs(Button,{variant:"outline",onClick:handleCancel,disabled:isLoading,className:"flex-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"X",className:"mr-2 h-4 w-4"}),"Batal"]}),jsxRuntimeExports.jsx(Button,{onClick:()=>setShowConfirm(!0),disabled:isLoading,className:"flex-1 bg-primary hover:bg-primary/90",children:isLoading?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"mr-2 h-4 w-4 animate-spin"}),"Menyimpan..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Save",className:"mr-2 h-4 w-4"}),"Simpan Perubahan"]})})]})]})})]}),jsxRuntimeExports.jsx(ConfirmationModal,{open:showConfirm,onOpenChange:setShowConfirm,title:"Konfirmasi Perubahan",description:`Apakah Anda yakin ingin menyimpan perubahan data pengguna ${formData.nama}?`,confirmText:"Ya, Simpan",cancelText:"Batal",icon:"CheckCircle",iconColor:"text-primary",isLoading,isDangerous:!1,onConfirm:handleSubmit}),showResetPassword&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-50 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-2xl max-w-lg w-full overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[jsxRuntimeExports.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-5",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"bg-white/20 rounded-lg p-2",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Shield",className:"h-6 w-6 text-white"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-white",children:"Reset Password"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-blue-100",children:formData.nama})]})]})}),jsxRuntimeExports.jsx("div",{className:"p-6",children:generatedPassword?jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 rounded-lg border border-green-200",children:[jsxRuntimeExports.jsx("div",{className:"bg-green-500 rounded-full p-1",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Check",className:"h-4 w-4 text-white"})}),jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-green-800",children:"Password berhasil direset!"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Password Baru"}),jsxRuntimeExports.jsx("div",{className:"relative",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 p-4 bg-gray-50 border-2 border-gray-200 rounded-lg font-mono text-lg tracking-wider",children:[jsxRuntimeExports.jsx("span",{className:"flex-1 select-all break-all",children:generatedPassword}),jsxRuntimeExports.jsxs(Button,{type:"button",size:"sm",onClick:copyPasswordToClipboard,className:copiedPassword?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-900 hover:bg-gray-800 text-white",children:[jsxRuntimeExports.jsx(SafeIcon,{name:copiedPassword?"Check":"Copy",className:"h-4 w-4 mr-1"}),copiedPassword?"Copied!":"Copy"]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3 p-3 bg-amber-50 rounded-lg border border-amber-200",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertTriangle",className:"h-5 w-5 text-amber-600 mt-0.5 shrink-0"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-amber-800",children:[jsxRuntimeExports.jsx("strong",{children:"Penting:"})," Salin password ini sekarang. Setelah modal ditutup, password tidak akan ditampilkan lagi."]})]})]}):jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg border border-blue-100",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Info",className:"h-5 w-5 text-blue-600 mt-0.5 shrink-0"}),jsxRuntimeExports.jsxs("div",{className:"text-sm",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-gray-900 mb-1",children:"Password akan direset"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Sistem akan generate password baru dan menyimpannya ke database. Password lama tidak dapat dipulihkan."})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Langkah selanjutnya:"}),jsxRuntimeExports.jsxs("div",{className:"grid gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[jsxRuntimeExports.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-gray-100 text-gray-500 text-xs font-medium",children:"1"}),'Klik "Generate Password"']}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[jsxRuntimeExports.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-gray-100 text-gray-500 text-xs font-medium",children:"2"}),"Copy password yang muncul"]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[jsxRuntimeExports.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-gray-100 text-gray-500 text-xs font-medium",children:"3"}),"Berikan ke pengguna melalui channel aman"]})]})]})]})}),jsxRuntimeExports.jsx("div",{className:"border-t border-gray-100 px-6 py-4 bg-gray-50 flex gap-3 justify-end",children:generatedPassword?jsxRuntimeExports.jsxs(Button,{type:"button",className:"bg-green-600 hover:bg-green-700 text-white px-8",onClick:()=>{setShowResetPassword(!1),setGeneratedPassword("")},children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Check",className:"mr-2 h-4 w-4"}),"Selesai"]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{type:"button",variant:"ghost",onClick:()=>setShowResetPassword(!1),disabled:isResettingPassword,children:"Batal"}),jsxRuntimeExports.jsx(Button,{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:generateRandomPassword,disabled:isResettingPassword,children:isResettingPassword?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"mr-2 h-4 w-4 animate-spin"}),"Generating..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Key",className:"mr-2 h-4 w-4"}),"Generate Password"]})})]})})]})})]})}function EditUserModal({open,onOpenChange,userId,onSuccess}){return jsxRuntimeExports.jsx(Dialog,{open,onOpenChange,children:jsxRuntimeExports.jsxs(DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[jsxRuntimeExports.jsxs(DialogHeader,{children:[jsxRuntimeExports.jsx(DialogTitle,{children:"Edit Pengguna"}),jsxRuntimeExports.jsx(DialogDescription,{children:"Perbarui informasi pengguna sistem"})]}),jsxRuntimeExports.jsx("div",{className:"py-4",children:jsxRuntimeExports.jsx(EditUserForm,{onClose:()=>{onOpenChange(!1),onSuccess?.()},userId})})]})})}const roleLabels={ADMIN:"Administrator",OPERATOR:"Operator Lapangan",PANGKALAN:"Pangkalan"},roleBadgeColors={ADMIN:"bg-purple-500/15 text-purple-600 dark:bg-purple-500/20 dark:text-purple-400",OPERATOR:"bg-blue-500/15 text-blue-600 dark:bg-blue-500/20 dark:text-blue-400",PANGKALAN:"bg-emerald-500/15 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-400"};function UserListPage(){const[userList,setUserList]=reactExports.useState([]),[isLoading,setIsLoading]=reactExports.useState(!0),[totalItems,setTotalItems]=reactExports.useState(0),[currentPage,setCurrentPage]=reactExports.useState(1),[totalPages,setTotalPages]=reactExports.useState(1),[adminCount,setAdminCount]=reactExports.useState(0),[operatorCount,setOperatorCount]=reactExports.useState(0),[currentUserId,setCurrentUserId]=reactExports.useState(null),[searchTerm,setSearchTerm]=reactExports.useState(""),[roleFilter,setRoleFilter]=reactExports.useState("all"),[showAddModal,setShowAddModal]=reactExports.useState(!1),[showEditModal,setShowEditModal]=reactExports.useState(!1),[editingUserId,setEditingUserId]=reactExports.useState(""),[selectedUser,setSelectedUser]=reactExports.useState(null),[showDeleteModal,setShowDeleteModal]=reactExports.useState(!1),[showStatusModal,setShowStatusModal]=reactExports.useState(!1),[sortField,setSortField]=reactExports.useState(null),[sortDirection,setSortDirection]=reactExports.useState("asc"),handleSort=field=>{sortField===field?setSortDirection(prev=>prev==="asc"?"desc":"asc"):(setSortField(field),setSortDirection("asc"))},sortedUserList=reactExports.useMemo(()=>sortField?[...userList].sort((a,b)=>{let aVal=a[sortField],bVal=b[sortField];return aVal==null&&(aVal=""),bVal==null&&(bVal=""),typeof aVal=="string"&&(aVal=aVal.toLowerCase(),bVal=bVal.toLowerCase()),aVal<bVal?sortDirection==="asc"?-1:1:aVal>bVal?sortDirection==="asc"?1:-1:0}):userList,[userList,sortField,sortDirection]),SortableHeader=({field,children,className="",align="left"})=>jsxRuntimeExports.jsx(TableHead,{className:`font-semibold text-muted-foreground cursor-pointer hover:bg-muted/50 transition-colors select-none ${className}`,onClick:()=>handleSort(field),children:jsxRuntimeExports.jsxs("div",{className:`flex items-center gap-1.5 ${align==="center"?"justify-center":"justify-start"}`,children:[children,sortField===field?sortDirection==="asc"?jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronUp",className:"w-4 h-4 text-primary"}):jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronDown",className:"w-4 h-4 text-primary"}):jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronsUpDown",className:"w-4 h-4 text-muted-foreground/50"})]})});reactExports.useEffect(()=>{(async()=>{try{const{authApi}=await __vitePreload(async()=>{const{authApi:authApi2}=await import("./api.Dr7hS9Y8.js");return{authApi:authApi2}},[]),profile=await authApi.getProfile();setCurrentUserId(profile.id)}catch(error){console.error("Failed to get current user:",error)}})()},[]);const fetchUsers=async()=>{try{setIsLoading(!0);const response=await usersApi.getAll(currentPage,10,searchTerm||void 0,["PANGKALAN"]);let filteredData=response.data;roleFilter!=="all"&&(filteredData=response.data.filter(u=>u.role===roleFilter)),setUserList(filteredData),setTotalItems(response.meta.total),setTotalPages(response.meta.totalPages),setAdminCount(response.meta.totalAdmin||0),setOperatorCount(response.meta.totalOperator||0)}catch(error){console.error("Failed to fetch users:",error),toast.error("Gagal memuat data pengguna")}finally{setIsLoading(!1)}};reactExports.useEffect(()=>{fetchUsers()},[currentPage,roleFilter]),reactExports.useEffect(()=>{const timer=setTimeout(()=>{setCurrentPage(1),fetchUsers()},500);return()=>clearTimeout(timer)},[searchTerm]);const handleStatusToggleClick=user=>{setSelectedUser(user),setShowStatusModal(!0)},handleConfirmStatusToggle=async()=>{if(selectedUser)try{const newStatus=!selectedUser.is_active;await usersApi.update(selectedUser.id,{is_active:newStatus}),toast.success(`Pengguna berhasil ${newStatus?"diaktifkan":"dinonaktifkan"}`),fetchUsers()}catch(error){console.error("Failed to update status:",error),toast.error("Gagal mengubah status pengguna")}finally{setShowStatusModal(!1),setSelectedUser(null)}},handleDeleteClick=user=>{setSelectedUser(user),setShowDeleteModal(!0)},handleConfirmDelete=async()=>{if(selectedUser)try{await usersApi.delete(selectedUser.id),toast.success("Pengguna berhasil dihapus"),fetchUsers()}catch(error){console.error("Failed to delete user:",error),toast.error("Gagal menghapus pengguna")}finally{setShowDeleteModal(!1),setSelectedUser(null)}},handleEditClick=user=>{setEditingUserId(user.id),setShowEditModal(!0)},handleSuccess=()=>{setShowAddModal(!1),setShowEditModal(!1),setEditingUserId(""),fetchUsers()};return jsxRuntimeExports.jsxs("div",{className:"flex-1 space-y-6 p-4 sm:p-6 lg:p-8 dashboard-gradient-bg min-h-screen",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[jsxRuntimeExports.jsx(PageHeader,{title:"Daftar Pengguna",subtitle:"Kelola semua pengguna sistem SIM4LON"}),jsxRuntimeExports.jsxs(Button,{onClick:()=>setShowAddModal(!0),className:"w-full sm:w-auto bg-gradient-to-r from-primary to-primary/80 hover:from-primary/90 hover:to-primary/70 text-white shadow-lg hover:shadow-xl transition-all",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Plus",className:"mr-2 h-4 w-4"}),"Tambah Pengguna"]})]}),jsxRuntimeExports.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-border to-transparent"}),jsxRuntimeExports.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:isLoading?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:[0,1,2].map(i=>jsxRuntimeExports.jsx("div",{className:"animate-pulse",style:{animationDelay:`${i*100}ms`},children:jsxRuntimeExports.jsx(Card,{className:"border-0 glass-card h-full",children:jsxRuntimeExports.jsx(CardContent,{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-2.5 rounded-xl bg-muted w-10 h-10 animate-shimmer"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2 flex-1",children:[jsxRuntimeExports.jsx("div",{className:"h-3 w-16 bg-muted rounded animate-shimmer"}),jsxRuntimeExports.jsx("div",{className:"h-7 w-12 bg-muted rounded animate-shimmer"})]})]})})})},i))}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Tilt3DCard,{children:jsxRuntimeExports.jsx(Card,{className:"border-0 glass-card animate-fadeInUp h-full",children:jsxRuntimeExports.jsx(CardContent,{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-2.5 rounded-xl bg-slate-500/10",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Users",className:"w-5 h-5 text-slate-600"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Pengguna"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold",children:jsxRuntimeExports.jsx(AnimatedNumber,{value:totalItems,delay:100})})]})]})})})}),jsxRuntimeExports.jsx(Tilt3DCard,{children:jsxRuntimeExports.jsx(Card,{className:"border-0 glass-card animate-fadeInUp h-full",style:{animationDelay:"0.1s"},children:jsxRuntimeExports.jsx(CardContent,{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-2.5 rounded-xl bg-purple-500/10 dark:bg-purple-500/15",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Shield",className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground",children:"Administrator"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:jsxRuntimeExports.jsx(AnimatedNumber,{value:adminCount,delay:200})})]})]})})})}),jsxRuntimeExports.jsx(Tilt3DCard,{children:jsxRuntimeExports.jsx(Card,{className:"border-0 glass-card animate-fadeInUp h-full",style:{animationDelay:"0.2s"},children:jsxRuntimeExports.jsx(CardContent,{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"p-2.5 rounded-xl bg-blue-500/10 dark:bg-blue-500/15",children:jsxRuntimeExports.jsx(SafeIcon,{name:"UserCog",className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground",children:"Operator"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:jsxRuntimeExports.jsx(AnimatedNumber,{value:operatorCount,delay:300})})]})]})})})})]})}),jsxRuntimeExports.jsx(Card,{className:"glass-card",children:jsxRuntimeExports.jsx(CardContent,{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-stretch sm:items-center",children:[jsxRuntimeExports.jsxs("div",{className:"relative flex-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Search",className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),jsxRuntimeExports.jsx(Input,{placeholder:"Cari nama, email, atau telepon...",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:"pl-10 bg-transparent border-border focus:border-primary focus:ring-primary/20"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 p-1 rounded-lg bg-muted/30",children:[jsxRuntimeExports.jsxs(Button,{size:"sm",onClick:()=>setRoleFilter("all"),className:roleFilter==="all"?"bg-gradient-to-r from-primary to-primary/80 text-white shadow-md":"bg-transparent hover:bg-muted/50 text-muted-foreground",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Users",className:"w-4 h-4 mr-1.5"}),"Semua"]}),jsxRuntimeExports.jsxs(Button,{size:"sm",onClick:()=>setRoleFilter("ADMIN"),className:roleFilter==="ADMIN"?"bg-gradient-to-r from-purple-600/90 to-purple-500/90 text-white shadow-md":"bg-transparent hover:bg-muted/50 text-muted-foreground",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Shield",className:"w-4 h-4 mr-1.5"}),"Admin"]}),jsxRuntimeExports.jsxs(Button,{size:"sm",onClick:()=>setRoleFilter("OPERATOR"),className:roleFilter==="OPERATOR"?"bg-gradient-to-r from-blue-600/90 to-blue-500/90 text-white shadow-md":"bg-transparent hover:bg-muted/50 text-muted-foreground",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"UserCog",className:"w-4 h-4 mr-1.5"}),"Operator"]})]})]})})}),jsxRuntimeExports.jsx(Card,{className:"glass-card overflow-hidden",children:jsxRuntimeExports.jsxs(CardContent,{className:"p-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border/50",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Table",className:"w-5 h-5 text-muted-foreground"}),jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Data Pengguna"}),jsxRuntimeExports.jsxs(Badge,{variant:"secondary",className:"bg-green-500/10 text-green-600",children:[userList.length," data"]})]}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-muted-foreground",children:["Total: ",totalItems," pengguna"]})]}),jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:isLoading?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center py-12",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-3",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-8 w-8 animate-spin text-green-500"}),jsxRuntimeExports.jsx("span",{className:"text-muted-foreground",children:"Memuat data pengguna..."})]})}):jsxRuntimeExports.jsxs(Table,{children:[jsxRuntimeExports.jsx(TableHeader,{children:jsxRuntimeExports.jsxs(TableRow,{className:"bg-transparent border-border focus:border-primary",children:[jsxRuntimeExports.jsx(SortableHeader,{field:"code",className:"w-24",children:"Kode"}),jsxRuntimeExports.jsx(SortableHeader,{field:"name",children:"Nama"}),jsxRuntimeExports.jsx(SortableHeader,{field:"email",children:"Email"}),jsxRuntimeExports.jsx(SortableHeader,{field:"phone",align:"center",children:"Telepon"}),jsxRuntimeExports.jsx(SortableHeader,{field:"role",align:"center",children:"Peran"}),jsxRuntimeExports.jsx(SortableHeader,{field:"is_active",align:"center",children:"Status"}),jsxRuntimeExports.jsx(TableHead,{className:"text-center font-semibold text-slate-700",children:"Aksi"})]})}),jsxRuntimeExports.jsx(TableBody,{children:sortedUserList.length>0?sortedUserList.map(user=>{const isCurrentUser=user.id===currentUserId;return jsxRuntimeExports.jsxs(TableRow,{className:`hover:bg-muted/50 transition-colors ${isCurrentUser?"bg-purple-500/5 border-l-2 border-l-purple-500":""}`,children:[jsxRuntimeExports.jsx(TableCell,{className:"font-mono text-sm text-primary",children:user.code||"-"}),jsxRuntimeExports.jsx(TableCell,{className:"font-medium text-foreground",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[user.name,isCurrentUser&&jsxRuntimeExports.jsx(Badge,{variant:"outline",className:"text-xs bg-purple-500/10 text-purple-600 border-purple-300",children:"Anda"})]})}),jsxRuntimeExports.jsx(TableCell,{className:"text-foreground",children:user.email}),jsxRuntimeExports.jsx(TableCell,{className:"text-center text-foreground",children:user.phone||"-"}),jsxRuntimeExports.jsx(TableCell,{className:"text-center",children:jsxRuntimeExports.jsx(Badge,{className:roleBadgeColors[user.role],children:roleLabels[user.role]})}),jsxRuntimeExports.jsx(TableCell,{className:"text-center",children:jsxRuntimeExports.jsx(Badge,{className:user.is_active?"bg-gradient-to-r from-primary-600/90 to-primary-500/90 text-white shadow-sm":"bg-gradient-to-r from-muted-foreground/60 to-muted-foreground/50 text-white shadow-sm",children:user.is_active?"✓ Aktif":"Nonaktif"})}),jsxRuntimeExports.jsx(TableCell,{className:"text-right",children:jsxRuntimeExports.jsxs(DropdownMenu,{children:[jsxRuntimeExports.jsx(DropdownMenuTrigger,{asChild:!0,children:jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",children:jsxRuntimeExports.jsx(SafeIcon,{name:"MoreVertical",className:"h-4 w-4"})})}),jsxRuntimeExports.jsx(DropdownMenuContent,{align:"end",children:isCurrentUser?jsxRuntimeExports.jsxs(DropdownMenuItem,{disabled:!0,className:"text-muted-foreground cursor-not-allowed",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"ShieldAlert",className:"mr-2 h-4 w-4"}),"Tidak dapat mengubah akun sendiri"]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(DropdownMenuItem,{onClick:()=>handleEditClick(user),children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Edit",className:"mr-2 h-4 w-4"}),"Edit"]}),user.is_active?jsxRuntimeExports.jsxs(DropdownMenuItem,{className:"text-orange-600",onClick:()=>handleStatusToggleClick(user),children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Ban",className:"mr-2 h-4 w-4"}),"Nonaktifkan"]}):jsxRuntimeExports.jsxs(DropdownMenuItem,{className:"text-green-600",onClick:()=>handleStatusToggleClick(user),children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Check",className:"mr-2 h-4 w-4"}),"Aktifkan"]}),jsxRuntimeExports.jsxs(DropdownMenuItem,{className:"text-destructive",onClick:()=>handleDeleteClick(user),children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Trash2",className:"mr-2 h-4 w-4"}),"Hapus"]})]})})]})})]},user.id)}):jsxRuntimeExports.jsx(TableRow,{children:jsxRuntimeExports.jsx(TableCell,{colSpan:6,className:"text-center py-8",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Users",className:"h-8 w-8 text-muted-foreground"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Tidak ada pengguna ditemukan"})]})})})})]})}),totalPages>1&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-border/50",children:[jsxRuntimeExports.jsxs("p",{className:"text-sm text-muted-foreground",children:["Halaman ",currentPage," dari ",totalPages," • Total ",totalItems," pengguna"]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",disabled:currentPage===1,onClick:()=>setCurrentPage(p=>p-1),className:"hover:bg-green-50",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronLeft",className:"h-4 w-4 mr-1"}),"Prev"]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,totalPages)},(_,i)=>{let pageNum;return totalPages<=5||currentPage<=3?pageNum=i+1:currentPage>=totalPages-2?pageNum=totalPages-4+i:pageNum=currentPage-2+i,jsxRuntimeExports.jsx(Button,{variant:currentPage===pageNum?"default":"ghost",size:"sm",onClick:()=>setCurrentPage(pageNum),className:currentPage===pageNum?"bg-green-500 hover:bg-green-600":"",children:pageNum},pageNum)})}),jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",disabled:currentPage===totalPages,onClick:()=>setCurrentPage(p=>p+1),className:"hover:bg-green-50",children:["Next",jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronRight",className:"h-4 w-4 ml-1"})]})]})]})]})}),jsxRuntimeExports.jsx(AddUserModal,{open:showAddModal,onOpenChange:setShowAddModal,onSuccess:handleSuccess}),jsxRuntimeExports.jsx(EditUserModal,{open:showEditModal,onOpenChange:setShowEditModal,userId:editingUserId,onSuccess:handleSuccess}),selectedUser&&showStatusModal&&jsxRuntimeExports.jsx(ConfirmationModal,{open:showStatusModal,onOpenChange:setShowStatusModal,title:selectedUser.is_active?"Nonaktifkan Pengguna":"Aktifkan Pengguna",description:selectedUser.is_active?`Apakah Anda yakin ingin menonaktifkan "${selectedUser.name}"?`:`Apakah Anda yakin ingin mengaktifkan "${selectedUser.name}"?`,confirmText:selectedUser.is_active?"Nonaktifkan":"Aktifkan",cancelText:"Batal",icon:selectedUser.is_active?"AlertTriangle":"CheckCircle",isDangerous:selectedUser.is_active,onConfirm:handleConfirmStatusToggle}),selectedUser&&showDeleteModal&&jsxRuntimeExports.jsx(ConfirmationModal,{open:showDeleteModal,onOpenChange:setShowDeleteModal,title:"Hapus Pengguna",description:`Apakah Anda yakin ingin menghapus "${selectedUser.name}"? Tindakan ini tidak dapat dibatalkan.`,confirmText:"Hapus",cancelText:"Batal",icon:"Trash2",isDangerous:!0,onConfirm:handleConfirmDelete})]})}export{UserListPage as default};
