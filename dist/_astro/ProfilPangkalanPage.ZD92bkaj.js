import{j as jsxRuntimeExports}from"./jsx-runtime.mvtouYz0.js";import{r as reactExports}from"./index.DcciWILN.js";import{C as Card,b as CardHeader,c as CardTitle,d as CardDescription,a as CardContent}from"./card.D0gylVsf.js";import{S as SafeIcon,B as Button}from"./SafeIcon.CAGsavDo.js";import{I as Input}from"./input.C9ryBhC0.js";import{L as Label}from"./label.BFF1cpbq.js";import{A as Avatar,a as AvatarImage,b as AvatarFallback}from"./avatar.LDOJxY28.js";import{S as Separator}from"./separator.bhOikD5L.js";import{authApi,uploadApi}from"./api.Dr7hS9Y8.js";import{t as toast}from"./index.fAd_ikgp.js";import"./index.PIAPtHoh.js";import"./index.ubNQCTBn.js";import"./index.Dovp0-D8.js";function ProfilPangkalanPage(){const[profile,setProfile]=reactExports.useState(null),[isLoading,setIsLoading]=reactExports.useState(!0),[isEditing,setIsEditing]=reactExports.useState(!1),[isSubmitting,setIsSubmitting]=reactExports.useState(!1),[formData,setFormData]=reactExports.useState({name:"",phone:""});reactExports.useEffect(()=>{(async()=>{try{setIsLoading(!0);const data=await authApi.getProfile();setProfile(data),setFormData({name:data.name,phone:data.phone||""})}catch(error){console.error("Failed to fetch profile:",error),toast.error("Gagal memuat profil")}finally{setIsLoading(!1)}})()},[]);const handleSave=async()=>{try{setIsSubmitting(!0);const result=await authApi.updateProfile(formData);setProfile(result.user),setIsEditing(!1),toast.success("Profil berhasil diperbarui")}catch(error){toast.error(error.message||"Gagal memperbarui profil")}finally{setIsSubmitting(!1)}},handleAvatarChange=async e=>{const file=e.target.files?.[0];if(file)try{const uploadResult=await uploadApi.uploadAvatar(file),result=await authApi.updateProfile({avatar_url:uploadResult.url});setProfile(result.user),toast.success("Foto profil berhasil diperbarui")}catch(error){toast.error(error.message||"Gagal upload foto")}},getInitials=name=>name.split(" ").map(word=>word[0]).join("").toUpperCase().slice(0,2);return isLoading?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-64",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-8 w-8 animate-spin text-blue-500"})}):jsxRuntimeExports.jsxs("div",{className:"flex-1 space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Profil"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Kelola informasi akun Anda"})]}),jsxRuntimeExports.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{children:[jsxRuntimeExports.jsx(CardTitle,{children:"Informasi Akun"}),jsxRuntimeExports.jsx(CardDescription,{children:"Data akun login Anda"})]}),jsxRuntimeExports.jsxs(CardContent,{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs(Avatar,{className:"h-20 w-20",children:[jsxRuntimeExports.jsx(AvatarImage,{src:profile?.avatar_url||void 0}),jsxRuntimeExports.jsx(AvatarFallback,{className:"bg-blue-100 text-blue-700 text-xl",children:profile?getInitials(profile.name):"P"})]}),jsxRuntimeExports.jsxs("label",{className:"absolute bottom-0 right-0 h-7 w-7 rounded-full bg-blue-600 flex items-center justify-center cursor-pointer hover:bg-blue-700",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Camera",className:"h-4 w-4 text-white"}),jsxRuntimeExports.jsx("input",{type:"file",accept:"image/*",onChange:handleAvatarChange,className:"hidden"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"font-semibold",children:profile?.name}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:profile?.email})]})]}),jsxRuntimeExports.jsx(Separator,{}),isEditing?jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"name",children:"Nama"}),jsxRuntimeExports.jsx(Input,{id:"name",value:formData.name,onChange:e=>setFormData({...formData,name:e.target.value})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"phone",children:"No. Telepon"}),jsxRuntimeExports.jsx(Input,{id:"phone",value:formData.phone,onChange:e=>setFormData({...formData,phone:e.target.value})})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs(Button,{onClick:handleSave,disabled:isSubmitting,className:"bg-blue-600 hover:bg-blue-700",children:[isSubmitting?jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"mr-2 h-4 w-4 animate-spin"}):null,"Simpan"]}),jsxRuntimeExports.jsx(Button,{variant:"outline",onClick:()=>setIsEditing(!1),children:"Batal"})]})]}):jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Nama"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:profile?.name})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Email"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:profile?.email})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"No. Telepon"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:profile?.phone||"-"})]}),jsxRuntimeExports.jsxs(Button,{variant:"outline",onClick:()=>setIsEditing(!0),children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Pencil",className:"mr-2 h-4 w-4"}),"Edit Profil"]})]})]})]}),jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{children:[jsxRuntimeExports.jsx(CardTitle,{children:"Informasi Pangkalan"}),jsxRuntimeExports.jsx(CardDescription,{children:"Data pangkalan Anda"})]}),jsxRuntimeExports.jsxs(CardContent,{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Kode"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:profile?.pangkalans?.code||"-"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Nama Pangkalan"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:profile?.pangkalans?.name||"-"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Alamat"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:profile?.pangkalans?.address||"-"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Telepon Pangkalan"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:profile?.pangkalans?.phone||"-"})]}),jsxRuntimeExports.jsx(Separator,{}),jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground",children:"Untuk mengubah informasi pangkalan, silakan hubungi administrator."})]})]})]})]})}export{ProfilPangkalanPage as default};
