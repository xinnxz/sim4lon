import{n as isFunction,D as Dot,q as findAllByType,E as ErrorBar,b as Layer,a as filterProps,c as Curve,A as Animate,d as interpolateNumber,j as isEqual,e as isNil,k as hasClipDot,l as LabelList,o as getValueByDataKey,u as uniqueId,G as Global,p as getCateCoordinateOfLine,g as generateCategoricalChart,f as formatAxisMap}from"./generateCategoricalChart.Jvaki1lA.js";import{u,r as reactExports}from"./index.DcciWILN.js";import{e as clsx}from"./SafeIcon.CAGsavDo.js";import{X as XAxis,Y as YAxis}from"./YAxis.DHdzTV6E.js";var _excluded=["type","layout","connectNulls","ref"],_excluded2=["key"];function _typeof(o){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o2){return typeof o2}:function(o2){return o2&&typeof Symbol=="function"&&o2.constructor===Symbol&&o2!==Symbol.prototype?"symbol":typeof o2},_typeof(o)}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded),key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],!(excluded.indexOf(key)>=0)&&Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};for(var key in source)if(Object.prototype.hasOwnProperty.call(source,key)){if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r2){return Object.getOwnPropertyDescriptor(e,r2).enumerable})),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r2){_defineProperty(e,r2,t[r2])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r2){Object.defineProperty(e,r2,Object.getOwnPropertyDescriptor(t,r2))})}return e}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray(o,minLen){if(o){if(typeof o=="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor&&(n=o.constructor.name),n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}}function _iterableToArray(iter){if(typeof Symbol<"u"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){(len==null||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _callSuper(t,o,e){return o=_getPrototypeOf(o),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(o,e||[],_getPrototypeOf(t).constructor):o.apply(t,e))}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call=="function"))return call;if(call!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct=function(){return!!t})()}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o2){return o2.__proto__||Object.getPrototypeOf(o2)},_getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!="function"&&superClass!==null)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o2,p2){return o2.__proto__=p2,o2},_setPrototypeOf(o,p)}function _defineProperty(obj,key,value){return key=_toPropertyKey(key),key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return _typeof(i)=="symbol"?i:i+""}function _toPrimitive(t,r){if(_typeof(t)!="object"||!t)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var i=e.call(t,r);if(_typeof(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Line=(function(_PureComponent){function Line2(){var _this;_classCallCheck(this,Line2);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this=_callSuper(this,Line2,[].concat(args)),_defineProperty(_this,"state",{isAnimationFinished:!0,totalLength:0}),_defineProperty(_this,"generateSimpleStrokeDasharray",function(totalLength,length){return"".concat(length,"px ").concat(totalLength-length,"px")}),_defineProperty(_this,"getStrokeDasharray",function(length,totalLength,lines){var lineLength=lines.reduce(function(pre,next){return pre+next});if(!lineLength)return _this.generateSimpleStrokeDasharray(totalLength,length);for(var count=Math.floor(length/lineLength),remainLength=length%lineLength,restLength=totalLength-length,remainLines=[],i=0,sum=0;i<lines.length;sum+=lines[i],++i)if(sum+lines[i]>remainLength){remainLines=[].concat(_toConsumableArray(lines.slice(0,i)),[remainLength-sum]);break}var emptyLines=remainLines.length%2===0?[0,restLength]:[restLength];return[].concat(_toConsumableArray(Line2.repeat(lines,count)),_toConsumableArray(remainLines),emptyLines).map(function(line){return"".concat(line,"px")}).join(", ")}),_defineProperty(_this,"id",uniqueId("recharts-line-")),_defineProperty(_this,"pathRef",function(node){_this.mainCurve=node}),_defineProperty(_this,"handleAnimationEnd",function(){_this.setState({isAnimationFinished:!0}),_this.props.onAnimationEnd&&_this.props.onAnimationEnd()}),_defineProperty(_this,"handleAnimationStart",function(){_this.setState({isAnimationFinished:!1}),_this.props.onAnimationStart&&_this.props.onAnimationStart()}),_this}return _inherits(Line2,_PureComponent),_createClass(Line2,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var totalLength=this.getTotalLength();this.setState({totalLength})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var totalLength=this.getTotalLength();totalLength!==this.state.totalLength&&this.setState({totalLength})}}},{key:"getTotalLength",value:function(){var curveDom=this.mainCurve;try{return curveDom&&curveDom.getTotalLength&&curveDom.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(needClip,clipPathId){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var _this$props=this.props,points=_this$props.points,xAxis=_this$props.xAxis,yAxis=_this$props.yAxis,layout=_this$props.layout,children=_this$props.children,errorBarItems=findAllByType(children,ErrorBar);if(!errorBarItems)return null;var dataPointFormatter=function(dataPoint,dataKey){return{x:dataPoint.x,y:dataPoint.y,value:dataPoint.value,errorVal:getValueByDataKey(dataPoint.payload,dataKey)}},errorBarProps={clipPath:needClip?"url(#clipPath-".concat(clipPathId,")"):null};return u.createElement(Layer,errorBarProps,errorBarItems.map(function(item){return u.cloneElement(item,{key:"bar-".concat(item.props.dataKey),data:points,xAxis,yAxis,layout,dataPointFormatter})}))}},{key:"renderDots",value:function(needClip,clipDot,clipPathId){var isAnimationActive=this.props.isAnimationActive;if(isAnimationActive&&!this.state.isAnimationFinished)return null;var _this$props2=this.props,dot=_this$props2.dot,points=_this$props2.points,dataKey=_this$props2.dataKey,lineProps=filterProps(this.props,!1),customDotProps=filterProps(dot,!0),dots=points.map(function(entry,i){var dotProps=_objectSpread(_objectSpread(_objectSpread({key:"dot-".concat(i),r:3},lineProps),customDotProps),{},{index:i,cx:entry.x,cy:entry.y,value:entry.value,dataKey,payload:entry.payload,points});return Line2.renderDotItem(dot,dotProps)}),dotsProps={clipPath:needClip?"url(#clipPath-".concat(clipDot?"":"dots-").concat(clipPathId,")"):null};return u.createElement(Layer,_extends({className:"recharts-line-dots",key:"dots"},dotsProps),dots)}},{key:"renderCurveStatically",value:function(points,needClip,clipPathId,props){var _this$props3=this.props,type=_this$props3.type,layout=_this$props3.layout,connectNulls=_this$props3.connectNulls;_this$props3.ref;var others=_objectWithoutProperties(_this$props3,_excluded),curveProps=_objectSpread(_objectSpread(_objectSpread({},filterProps(others,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:needClip?"url(#clipPath-".concat(clipPathId,")"):null,points},props),{},{type,layout,connectNulls});return u.createElement(Curve,_extends({},curveProps,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(needClip,clipPathId){var _this2=this,_this$props4=this.props,points=_this$props4.points,strokeDasharray=_this$props4.strokeDasharray,isAnimationActive=_this$props4.isAnimationActive,animationBegin=_this$props4.animationBegin,animationDuration=_this$props4.animationDuration,animationEasing=_this$props4.animationEasing,animationId=_this$props4.animationId,animateNewValues=_this$props4.animateNewValues,width=_this$props4.width,height=_this$props4.height,_this$state=this.state,prevPoints=_this$state.prevPoints,totalLength=_this$state.totalLength;return u.createElement(Animate,{begin:animationBegin,duration:animationDuration,isActive:isAnimationActive,easing:animationEasing,from:{t:0},to:{t:1},key:"line-".concat(animationId),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(_ref){var t=_ref.t;if(prevPoints){var prevPointsDiffFactor=prevPoints.length/points.length,stepData=points.map(function(entry,index){var prevPointIndex=Math.floor(index*prevPointsDiffFactor);if(prevPoints[prevPointIndex]){var prev=prevPoints[prevPointIndex],interpolatorX=interpolateNumber(prev.x,entry.x),interpolatorY=interpolateNumber(prev.y,entry.y);return _objectSpread(_objectSpread({},entry),{},{x:interpolatorX(t),y:interpolatorY(t)})}if(animateNewValues){var _interpolatorX=interpolateNumber(width*2,entry.x),_interpolatorY=interpolateNumber(height/2,entry.y);return _objectSpread(_objectSpread({},entry),{},{x:_interpolatorX(t),y:_interpolatorY(t)})}return _objectSpread(_objectSpread({},entry),{},{x:entry.x,y:entry.y})});return _this2.renderCurveStatically(stepData,needClip,clipPathId)}var interpolator=interpolateNumber(0,totalLength),curLength=interpolator(t),currentStrokeDasharray;if(strokeDasharray){var lines="".concat(strokeDasharray).split(/[,\s]+/gim).map(function(num){return parseFloat(num)});currentStrokeDasharray=_this2.getStrokeDasharray(curLength,totalLength,lines)}else currentStrokeDasharray=_this2.generateSimpleStrokeDasharray(totalLength,curLength);return _this2.renderCurveStatically(points,needClip,clipPathId,{strokeDasharray:currentStrokeDasharray})})}},{key:"renderCurve",value:function(needClip,clipPathId){var _this$props5=this.props,points=_this$props5.points,isAnimationActive=_this$props5.isAnimationActive,_this$state2=this.state,prevPoints=_this$state2.prevPoints,totalLength=_this$state2.totalLength;return isAnimationActive&&points&&points.length&&(!prevPoints&&totalLength>0||!isEqual(prevPoints,points))?this.renderCurveWithAnimation(needClip,clipPathId):this.renderCurveStatically(points,needClip,clipPathId)}},{key:"render",value:function(){var _filterProps,_this$props6=this.props,hide=_this$props6.hide,dot=_this$props6.dot,points=_this$props6.points,className=_this$props6.className,xAxis=_this$props6.xAxis,yAxis=_this$props6.yAxis,top=_this$props6.top,left=_this$props6.left,width=_this$props6.width,height=_this$props6.height,isAnimationActive=_this$props6.isAnimationActive,id=_this$props6.id;if(hide||!points||!points.length)return null;var isAnimationFinished=this.state.isAnimationFinished,hasSinglePoint=points.length===1,layerClass=clsx("recharts-line",className),needClipX=xAxis&&xAxis.allowDataOverflow,needClipY=yAxis&&yAxis.allowDataOverflow,needClip=needClipX||needClipY,clipPathId=isNil(id)?this.id:id,_ref2=(_filterProps=filterProps(dot,!1))!==null&&_filterProps!==void 0?_filterProps:{r:3,strokeWidth:2},_ref2$r=_ref2.r,r=_ref2$r===void 0?3:_ref2$r,_ref2$strokeWidth=_ref2.strokeWidth,strokeWidth=_ref2$strokeWidth===void 0?2:_ref2$strokeWidth,_ref3=hasClipDot(dot)?dot:{},_ref3$clipDot=_ref3.clipDot,clipDot=_ref3$clipDot===void 0?!0:_ref3$clipDot,dotSize=r*2+strokeWidth;return u.createElement(Layer,{className:layerClass},needClipX||needClipY?u.createElement("defs",null,u.createElement("clipPath",{id:"clipPath-".concat(clipPathId)},u.createElement("rect",{x:needClipX?left:left-width/2,y:needClipY?top:top-height/2,width:needClipX?width:width*2,height:needClipY?height:height*2})),!clipDot&&u.createElement("clipPath",{id:"clipPath-dots-".concat(clipPathId)},u.createElement("rect",{x:left-dotSize/2,y:top-dotSize/2,width:width+dotSize,height:height+dotSize}))):null,!hasSinglePoint&&this.renderCurve(needClip,clipPathId),this.renderErrorBar(needClip,clipPathId),(hasSinglePoint||dot)&&this.renderDots(needClip,clipDot,clipPathId),(!isAnimationActive||isAnimationFinished)&&LabelList.renderCallByParent(this.props,points))}}],[{key:"getDerivedStateFromProps",value:function(nextProps,prevState){return nextProps.animationId!==prevState.prevAnimationId?{prevAnimationId:nextProps.animationId,curPoints:nextProps.points,prevPoints:prevState.curPoints}:nextProps.points!==prevState.curPoints?{curPoints:nextProps.points}:null}},{key:"repeat",value:function(lines,count){for(var linesUnit=lines.length%2!==0?[].concat(_toConsumableArray(lines),[0]):lines,result=[],i=0;i<count;++i)result=[].concat(_toConsumableArray(result),_toConsumableArray(linesUnit));return result}},{key:"renderDotItem",value:function(option,props){var dotItem;if(u.isValidElement(option))dotItem=u.cloneElement(option,props);else if(isFunction(option))dotItem=option(props);else{var key=props.key,dotProps=_objectWithoutProperties(props,_excluded2),className=clsx("recharts-line-dot",typeof option!="boolean"?option.className:"");dotItem=u.createElement(Dot,_extends({key},dotProps,{className}))}return dotItem}}])})(reactExports.PureComponent);_defineProperty(Line,"displayName","Line");_defineProperty(Line,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Global.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});_defineProperty(Line,"getComposedData",function(_ref4){var props=_ref4.props,xAxis=_ref4.xAxis,yAxis=_ref4.yAxis,xAxisTicks=_ref4.xAxisTicks,yAxisTicks=_ref4.yAxisTicks,dataKey=_ref4.dataKey,bandSize=_ref4.bandSize,displayedData=_ref4.displayedData,offset=_ref4.offset,layout=props.layout,points=displayedData.map(function(entry,index){var value=getValueByDataKey(entry,dataKey);return layout==="horizontal"?{x:getCateCoordinateOfLine({axis:xAxis,ticks:xAxisTicks,bandSize,entry,index}),y:isNil(value)?null:yAxis.scale(value),value,payload:entry}:{x:isNil(value)?null:xAxis.scale(value),y:getCateCoordinateOfLine({axis:yAxis,ticks:yAxisTicks,bandSize,entry,index}),value,payload:entry}});return _objectSpread({points,layout},offset)});var LineChart=generateCategoricalChart({chartName:"LineChart",GraphicalChild:Line,axisComponents:[{axisType:"xAxis",AxisComp:XAxis},{axisType:"yAxis",AxisComp:YAxis}],formatAxisMap});export{LineChart as L,Line as a};
