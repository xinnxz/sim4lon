import{j as jsxRuntimeExports}from"./jsx-runtime.mvtouYz0.js";import{r as reactExports}from"./index.DcciWILN.js";import{C as Card,b as CardHeader,c as CardTitle,d as CardDescription,a as CardContent}from"./card.D0gylVsf.js";import{S as SafeIcon,B as Button}from"./SafeIcon.CAGsavDo.js";import{S as Separator}from"./separator.bhOikD5L.js";import{D as Dialog,a as DialogContent,b as DialogHeader,c as DialogTitle,d as DialogDescription}from"./dialog.CoJQQKDV.js";import{I as Input}from"./input.C9ryBhC0.js";import{L as Label}from"./label.BFF1cpbq.js";import{A as Alert,a as AlertDescription}from"./alert.C-aQE-Lx.js";import{t as toast}from"./index.fAd_ikgp.js";import{authApi}from"./api.Dr7hS9Y8.js";import"./index.PIAPtHoh.js";import"./index.ubNQCTBn.js";import"./index.zVS-qTD4.js";import"./index.BpQ989z7.js";import"./index.YpXgcoRz.js";import"./index.Dovp0-D8.js";import"./index.DZiLsHox.js";import"./index.CdmyERTi.js";import"./x.DUlMVzh7.js";function ChangePasswordModal({open,onOpenChange}){const[formData,setFormData]=reactExports.useState({oldPassword:"",newPassword:"",confirmPassword:""}),[errors,setErrors]=reactExports.useState({}),[isLoading,setIsLoading]=reactExports.useState(!1),[showPasswords,setShowPasswords]=reactExports.useState({old:!1,new:!1,confirm:!1}),validateForm=()=>{const newErrors={};return formData.oldPassword.trim()||(newErrors.oldPassword="Kata sandi lama harus diisi"),formData.newPassword.trim()?formData.newPassword.length<8?newErrors.newPassword="Kata sandi baru minimal 8 karakter":/(?=.*[a-z])/.test(formData.newPassword)?/(?=.*[A-Z])/.test(formData.newPassword)?/(?=.*\d)/.test(formData.newPassword)||(newErrors.newPassword="Kata sandi harus mengandung angka"):newErrors.newPassword="Kata sandi harus mengandung huruf besar":newErrors.newPassword="Kata sandi harus mengandung huruf kecil":newErrors.newPassword="Kata sandi baru harus diisi",formData.confirmPassword.trim()?formData.newPassword!==formData.confirmPassword&&(newErrors.confirmPassword="Kata sandi tidak cocok"):newErrors.confirmPassword="Konfirmasi kata sandi harus diisi",formData.oldPassword===formData.newPassword&&(newErrors.newPassword="Kata sandi baru harus berbeda dengan kata sandi lama"),setErrors(newErrors),Object.keys(newErrors).length===0},handleChange=e=>{const{name,value}=e.target;setFormData(prev=>({...prev,[name]:value})),errors[name]&&setErrors(prev=>({...prev,[name]:void 0}))},handleSubmit=async e=>{if(e.preventDefault(),!!validateForm()){setIsLoading(!0);try{await authApi.changePassword({oldPassword:formData.oldPassword,newPassword:formData.newPassword}),toast.success("Kata sandi berhasil diubah"),setTimeout(()=>{onOpenChange(!1),setFormData({oldPassword:"",newPassword:"",confirmPassword:""}),setErrors({}),setShowPasswords({old:!1,new:!1,confirm:!1})},500)}catch(error){const message=error.message||"Terjadi kesalahan saat mengubah kata sandi";setErrors({general:message}),toast.error(message)}finally{setIsLoading(!1)}}},handleCancel=()=>{onOpenChange(!1),setFormData({oldPassword:"",newPassword:"",confirmPassword:""}),setErrors({}),setShowPasswords({old:!1,new:!1,confirm:!1})};return jsxRuntimeExports.jsx(Dialog,{open,onOpenChange,children:jsxRuntimeExports.jsxs(DialogContent,{className:"max-w-md sm:max-w-lg",children:[jsxRuntimeExports.jsxs(DialogHeader,{children:[jsxRuntimeExports.jsxs(DialogTitle,{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Lock",className:"h-5 w-5 text-primary"}),"Ubah Kata Sandi"]}),jsxRuntimeExports.jsx(DialogDescription,{children:"Masukkan kata sandi lama dan baru Anda. Kata sandi harus minimal 8 karakter."})]}),jsxRuntimeExports.jsxs("form",{onSubmit:handleSubmit,className:"space-y-4 max-h-[70vh] overflow-y-auto pr-4",children:[errors.general&&jsxRuntimeExports.jsxs(Alert,{variant:"destructive",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-4 w-4"}),jsxRuntimeExports.jsx(AlertDescription,{children:errors.general})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs(Label,{htmlFor:"oldPassword",className:"text-sm font-medium",children:["Kata Sandi Lama ",jsxRuntimeExports.jsx("span",{className:"text-destructive",children:"*"})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Input,{id:"oldPassword",name:"oldPassword",type:showPasswords.old?"text":"password",placeholder:"Masukkan kata sandi lama Anda",value:formData.oldPassword,onChange:handleChange,disabled:isLoading,className:errors.oldPassword?"border-destructive":"",autoComplete:"current-password"}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>setShowPasswords(prev=>({...prev,old:!prev.old})),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",tabIndex:-1,children:jsxRuntimeExports.jsx(SafeIcon,{name:showPasswords.old?"EyeOff":"Eye",className:"h-4 w-4"})})]}),errors.oldPassword&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-3 w-3"}),errors.oldPassword]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs(Label,{htmlFor:"newPassword",className:"text-sm font-medium",children:["Kata Sandi Baru ",jsxRuntimeExports.jsx("span",{className:"text-destructive",children:"*"})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Input,{id:"newPassword",name:"newPassword",type:showPasswords.new?"text":"password",placeholder:"Masukkan kata sandi baru Anda",value:formData.newPassword,onChange:handleChange,disabled:isLoading,className:errors.newPassword?"border-destructive":"",autoComplete:"new-password"}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>setShowPasswords(prev=>({...prev,new:!prev.new})),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",tabIndex:-1,children:jsxRuntimeExports.jsx(SafeIcon,{name:showPasswords.new?"EyeOff":"Eye",className:"h-4 w-4"})})]}),errors.newPassword&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-3 w-3"}),errors.newPassword]}),formData.newPassword&&jsxRuntimeExports.jsxs("div",{className:"mt-2 p-2 bg-secondary rounded text-xs space-y-1",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-foreground",children:"Persyaratan:"}),jsxRuntimeExports.jsxs("ul",{className:"space-y-0.5",children:[jsxRuntimeExports.jsxs("li",{className:`flex items-center gap-1 ${formData.newPassword.length>=8?"text-primary":"text-muted-foreground"}`,children:[jsxRuntimeExports.jsx(SafeIcon,{name:formData.newPassword.length>=8?"Check":"X",className:"h-3 w-3"}),"Minimal 8 karakter"]}),jsxRuntimeExports.jsxs("li",{className:`flex items-center gap-1 ${/(?=.*[a-z])/.test(formData.newPassword)?"text-primary":"text-muted-foreground"}`,children:[jsxRuntimeExports.jsx(SafeIcon,{name:/(?=.*[a-z])/.test(formData.newPassword)?"Check":"X",className:"h-3 w-3"}),"Huruf kecil"]}),jsxRuntimeExports.jsxs("li",{className:`flex items-center gap-1 ${/(?=.*[A-Z])/.test(formData.newPassword)?"text-primary":"text-muted-foreground"}`,children:[jsxRuntimeExports.jsx(SafeIcon,{name:/(?=.*[A-Z])/.test(formData.newPassword)?"Check":"X",className:"h-3 w-3"}),"Huruf besar"]}),jsxRuntimeExports.jsxs("li",{className:`flex items-center gap-1 ${/(?=.*\d)/.test(formData.newPassword)?"text-primary":"text-muted-foreground"}`,children:[jsxRuntimeExports.jsx(SafeIcon,{name:/(?=.*\d)/.test(formData.newPassword)?"Check":"X",className:"h-3 w-3"}),"Angka"]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs(Label,{htmlFor:"confirmPassword",className:"text-sm font-medium",children:["Konfirmasi Kata Sandi ",jsxRuntimeExports.jsx("span",{className:"text-destructive",children:"*"})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Input,{id:"confirmPassword",name:"confirmPassword",type:showPasswords.confirm?"text":"password",placeholder:"Konfirmasi kata sandi baru Anda",value:formData.confirmPassword,onChange:handleChange,disabled:isLoading,className:errors.confirmPassword?"border-destructive":"",autoComplete:"new-password"}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>setShowPasswords(prev=>({...prev,confirm:!prev.confirm})),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",tabIndex:-1,children:jsxRuntimeExports.jsx(SafeIcon,{name:showPasswords.confirm?"EyeOff":"Eye",className:"h-4 w-4"})})]}),errors.confirmPassword&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-3 w-3"}),errors.confirmPassword]}),formData.newPassword&&formData.confirmPassword&&jsxRuntimeExports.jsxs("div",{className:`text-xs flex items-center gap-1 ${formData.newPassword===formData.confirmPassword?"text-primary":"text-destructive"}`,children:[jsxRuntimeExports.jsx(SafeIcon,{name:formData.newPassword===formData.confirmPassword?"Check":"X",className:"h-3 w-3"}),formData.newPassword===formData.confirmPassword?"Kata sandi cocok":"Kata sandi tidak cocok"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3 pt-4 border-t mt-6",children:[jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",onClick:handleCancel,disabled:isLoading,className:"flex-1",children:"Batal"}),jsxRuntimeExports.jsx(Button,{type:"submit",disabled:isLoading,className:"flex-1 bg-primary hover:bg-primary/90",children:isLoading?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"mr-2 h-4 w-4 animate-spin"}),"Menyimpan..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Save",className:"mr-2 h-4 w-4"}),"Simpan Kata Sandi"]})})]})]})]})})}function ProfileActions(){const[isChangePasswordOpen,setIsChangePasswordOpen]=reactExports.useState(!1),[profile,setProfile]=reactExports.useState(null),[isLoading,setIsLoading]=reactExports.useState(!0);return reactExports.useEffect(()=>{(async()=>{try{setIsLoading(!0);const data=await authApi.getProfile();setProfile(data)}catch(err){console.error("Failed to fetch profile:",err)}finally{setIsLoading(!1)}})()},[]),jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs(Card,{className:"border shadow-card",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"pb-4",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Edit Profil"}),jsxRuntimeExports.jsx(CardDescription,{children:"Perbarui informasi pribadi Anda"})]}),jsxRuntimeExports.jsx(Separator,{}),jsxRuntimeExports.jsxs(CardContent,{className:"pt-6",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Ubah nama, email, nomor telepon, dan informasi profil lainnya."}),jsxRuntimeExports.jsx("a",{href:"/edit-profil-admin",children:jsxRuntimeExports.jsxs(Button,{className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Pencil",className:"h-4 w-4 mr-2"}),"Edit Profil"]})})]})]}),jsxRuntimeExports.jsxs(Card,{className:"border shadow-card",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"pb-4",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Keamanan"}),jsxRuntimeExports.jsx(CardDescription,{children:"Kelola kata sandi akun Anda"})]}),jsxRuntimeExports.jsx(Separator,{}),jsxRuntimeExports.jsxs(CardContent,{className:"pt-6",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Ubah kata sandi untuk menjaga keamanan akun Anda."}),jsxRuntimeExports.jsxs(Button,{onClick:()=>setIsChangePasswordOpen(!0),variant:"outline",className:"w-full border-primary/30 hover:bg-primary/5",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Lock",className:"h-4 w-4 mr-2"}),"Ubah Password"]})]})]}),jsxRuntimeExports.jsxs(Card,{className:"border shadow-card",children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-4",children:jsxRuntimeExports.jsxs(CardTitle,{className:"text-lg flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Shield",className:"h-5 w-5 text-primary"}),"Status Akun"]})}),jsxRuntimeExports.jsx(Separator,{}),jsxRuntimeExports.jsx(CardContent,{className:"pt-6",children:isLoading?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center py-4",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-5 w-5 animate-spin text-muted-foreground"})}):jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-muted-foreground",children:"Status"}),jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center gap-2 text-sm font-medium",children:[jsxRuntimeExports.jsx("span",{className:`h-2 w-2 rounded-full ${profile?.is_active?"bg-primary":"bg-gray-400"}`}),profile?.is_active?"Aktif":"Tidak Aktif"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-muted-foreground",children:"Terakhir Login"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-foreground",children:"Sesi saat ini"})]})]})})]}),jsxRuntimeExports.jsx(ChangePasswordModal,{open:isChangePasswordOpen,onOpenChange:setIsChangePasswordOpen})]})}export{ProfileActions as default};
