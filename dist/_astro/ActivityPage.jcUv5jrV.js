import{j as jsxRuntimeExports}from"./jsx-runtime.mvtouYz0.js";import{r as reactExports}from"./index.DcciWILN.js";import{C as Card,a as CardContent,b as CardHeader,c as CardTitle,d as CardDescription}from"./card.D0gylVsf.js";import{B as Badge}from"./badge.DZiJ6zSB.js";import{c as cn,S as SafeIcon,B as Button}from"./SafeIcon.CAGsavDo.js";import{S as Select,a as SelectTrigger,b as SelectValue,c as SelectContent,d as SelectItem}from"./select.Dd50uIHU.js";import{E as Ellipsis}from"./ellipsis.BH7kGLTy.js";import{A as AnimatedNumber}from"./AnimatedNumber.DkDF6dXY.js";import{activityApi}from"./api.Dr7hS9Y8.js";import"./index.PIAPtHoh.js";import"./index.ubNQCTBn.js";import"./index.DGt6JTY0.js";import"./index.BpQ989z7.js";import"./index.BStXkqMp.js";import"./index.Drh0kMGk.js";import"./index.DZiLsHox.js";import"./index.Dovp0-D8.js";import"./index.YpXgcoRz.js";import"./index.BFpcrWlj.js";import"./index.9MihlNbL.js";import"./index.BhA3i5Wo.js";import"./index.BaF2FVWY.js";import"./chevron-up.BBBXIirx.js";import"./check.TUgVKQyo.js";const Pagination=({className,...props})=>jsxRuntimeExports.jsx("nav",{role:"navigation","aria-label":"pagination",className:cn("mx-auto flex w-full justify-center",className),...props});Pagination.displayName="Pagination";const PaginationContent=reactExports.forwardRef(({className,...props},ref)=>jsxRuntimeExports.jsx("ul",{ref,className:cn("flex flex-row items-center gap-1",className),...props}));PaginationContent.displayName="PaginationContent";const PaginationItem=reactExports.forwardRef(({className,...props},ref)=>jsxRuntimeExports.jsx("li",{ref,className:cn("",className),...props}));PaginationItem.displayName="PaginationItem";const PaginationEllipsis=({className,...props})=>jsxRuntimeExports.jsxs("span",{"aria-hidden":!0,className:cn("flex h-9 w-9 items-center justify-center",className),...props,children:[jsxRuntimeExports.jsx(Ellipsis,{className:"h-4 w-4"}),jsxRuntimeExports.jsx("span",{className:"sr-only",children:"More pages"})]});PaginationEllipsis.displayName="PaginationEllipsis";const formatRelativeTime=timestamp=>{const now=new Date,date=new Date(timestamp),diffMs=now.getTime()-date.getTime(),diffMins=Math.floor(diffMs/6e4),diffHours=Math.floor(diffMs/36e5),diffDays=Math.floor(diffMs/864e5);return diffMins<1?"Baru saja":diffMins<60?`${diffMins} menit lalu`:diffHours<24?`${diffHours} jam lalu`:diffDays===1?"Kemarin":diffDays<7?`${diffDays} hari lalu`:diffDays<30?`${Math.floor(diffDays/7)} minggu lalu`:date.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})},getActivityConfig=(type,iconOverride)=>{const configs={ORDER_NEW:{icon:"ShoppingCart",color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200",label:"Pesanan Baru",gradient:"from-blue-500 to-blue-600"},ORDER_CREATED:{icon:"ShoppingCart",color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200",label:"Pesanan Dibuat",gradient:"from-blue-500 to-blue-600"},ORDER_UPDATED:{icon:"RefreshCw",color:"text-amber-600",bgColor:"bg-amber-50",borderColor:"border-amber-200",label:"Update Pesanan",gradient:"from-amber-500 to-amber-600"},ORDER_STATUS_UPDATED:{icon:"RefreshCw",color:"text-amber-600",bgColor:"bg-amber-50",borderColor:"border-amber-200",label:"Status Diperbarui",gradient:"from-amber-500 to-amber-600"},ORDER_COMPLETED:{icon:"CheckCircle2",color:"text-emerald-600 dark:text-emerald-400",bgColor:"bg-emerald-500/10 dark:bg-emerald-500/15",borderColor:"border-emerald-500/20",label:"Selesai",gradient:"from-emerald-600/90 to-emerald-500/90"},ORDER_DELIVERED:{icon:"Truck",color:"text-cyan-600",bgColor:"bg-cyan-50",borderColor:"border-cyan-200",label:"Dikirim",gradient:"from-cyan-500 to-cyan-600"},ORDER_CANCELLED:{icon:"XCircle",color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",label:"Dibatalkan",gradient:"from-red-500 to-red-600"},STOCK_IN:{icon:"PackagePlus",color:"text-primary",bgColor:"bg-primary/10",borderColor:"border-primary/20",label:"Stok Masuk",gradient:"from-primary to-primary/80"},STOCK_OUT:{icon:"PackageMinus",color:"text-orange-600",bgColor:"bg-orange-50",borderColor:"border-orange-200",label:"Stok Keluar",gradient:"from-orange-500 to-orange-600"},USER_LOGIN:{icon:"User",color:"text-muted-foreground",bgColor:"bg-muted/50",borderColor:"border-border",label:"Login",gradient:"from-muted-foreground/60 to-muted-foreground/50"},SYSTEM_CREATE:{icon:"Plus",color:"text-emerald-600 dark:text-emerald-400",bgColor:"bg-emerald-500/10 dark:bg-emerald-500/15",borderColor:"border-emerald-500/20",label:"Data Dibuat",gradient:"from-emerald-600/90 to-emerald-500/90"},SYSTEM_UPDATE:{icon:"Edit",color:"text-amber-600",bgColor:"bg-amber-50",borderColor:"border-amber-200",label:"Data Diperbarui",gradient:"from-amber-500 to-amber-600"},SYSTEM_DELETE:{icon:"Trash2",color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",label:"Data Dihapus",gradient:"from-red-500 to-red-600"}},normalizedType=type.toUpperCase(),config=configs[normalizedType]||{icon:"Activity",color:"text-gray-600",bgColor:"bg-gray-50",borderColor:"border-gray-200",label:"Aktivitas",gradient:"from-gray-500 to-gray-600"};return{...config,icon:iconOverride||config.icon}},activityFilters=[{value:"all",label:"Semua",icon:"ListFilter",color:"from-slate-500 to-slate-600"},{value:"ORDER",label:"Pesanan",icon:"ShoppingCart",color:"from-cyan-500 to-blue-600"},{value:"STOCK",label:"Stok LPG",icon:"Package",color:"from-primary to-primary/80"},{value:"SYSTEM",label:"Sistem",icon:"Settings",color:"from-slate-600 to-slate-700"}],ITEMS_PER_PAGE_OPTIONS=[10,25,50],TimelineSkeleton=()=>jsxRuntimeExports.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((_,i)=>jsxRuntimeExports.jsxs("div",{className:"flex gap-4 animate-pulse",style:{animationDelay:`${i*100}ms`},children:[jsxRuntimeExports.jsxs("div",{className:"hidden sm:flex flex-col items-center",children:[jsxRuntimeExports.jsx("div",{className:"h-12 w-12 rounded-full bg-slate-200 animate-shimmer"}),jsxRuntimeExports.jsx("div",{className:"w-0.5 h-16 bg-slate-200 mt-2 animate-shimmer"})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 p-4 rounded-xl border border-slate-200 bg-slate-50/50",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx("div",{className:"h-5 w-40 bg-slate-200 rounded animate-shimmer"}),jsxRuntimeExports.jsx("div",{className:"h-5 w-20 bg-slate-200 rounded animate-shimmer"})]}),jsxRuntimeExports.jsx("div",{className:"h-4 w-3/4 bg-slate-200 rounded animate-shimmer mb-3"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsx("div",{className:"h-3 w-24 bg-slate-200 rounded animate-shimmer"}),jsxRuntimeExports.jsx("div",{className:"h-3 w-20 bg-slate-200 rounded animate-shimmer"})]})]})]},i))});function ActivityPage(){const[selectedFilter,setSelectedFilter]=reactExports.useState("all"),[currentPage,setCurrentPage]=reactExports.useState(1),[itemsPerPage,setItemsPerPage]=reactExports.useState(10),[activities,setActivities]=reactExports.useState([]),[meta,setMeta]=reactExports.useState(null),[isLoading,setIsLoading]=reactExports.useState(!0),[error,setError]=reactExports.useState(null);reactExports.useEffect(()=>{(async()=>{try{setIsLoading(!0),setError(null);let typeParam;selectedFilter==="ORDER"?typeParam="ORDER_NEW":selectedFilter==="STOCK"?typeParam="STOCK_IN":selectedFilter==="SYSTEM"?typeParam="USER_LOGIN":selectedFilter!=="all"&&(typeParam=selectedFilter);const response=await activityApi.getAll(currentPage,itemsPerPage,typeParam);setActivities(response.data),setMeta(response.meta)}catch(err){console.error("Failed to fetch activities:",err),setError("Gagal memuat riwayat aktivitas. Silakan coba lagi."),setActivities([]),setMeta(null)}finally{setIsLoading(!1)}})()},[currentPage,itemsPerPage,selectedFilter]);const stats=reactExports.useMemo(()=>({total:meta?.total||0,showing:activities.length,orderCount:activities.filter(a=>a.type.startsWith("ORDER")).length,stockCount:activities.filter(a=>a.type.startsWith("STOCK")).length,systemCount:activities.filter(a=>a.type.startsWith("USER")||a.type.startsWith("SYSTEM")).length}),[meta,activities]),handleFilterChange=filter=>{setSelectedFilter(filter),setCurrentPage(1)},handleRetry=()=>{setError(null),setIsLoading(!0),window.location.reload()},totalPages=meta?.totalPages||1,getPaginationItems=()=>{const items=[];if(totalPages<=5)for(let i=1;i<=totalPages;i++)items.push(i);else currentPage<=3?items.push(1,2,3,4,"ellipsis",totalPages):currentPage>=totalPages-2?items.push(1,"ellipsis",totalPages-3,totalPages-2,totalPages-1,totalPages):items.push(1,"ellipsis",currentPage-1,currentPage,currentPage+1,"ellipsis",totalPages);return items};return jsxRuntimeExports.jsxs("div",{className:"flex-1 space-y-6 p-4 sm:p-6 lg:p-8 dashboard-gradient-bg min-h-screen",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"h-12 w-1.5 rounded-full bg-gradient-to-b from-primary via-primary/70 to-primary/40"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-gradient-primary",children:"Riwayat Aktivitas"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground/80 mt-1",children:"Pantau semua aktivitas sistem secara real-time"})]})]}),jsxRuntimeExports.jsxs(Badge,{variant:"outline",className:"px-4 py-2 text-sm font-medium bg-card/50 backdrop-blur-sm w-fit",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Database",className:"h-4 w-4 mr-2"}),isLoading?"... ":jsxRuntimeExports.jsx(AnimatedNumber,{value:stats.total,delay:0})," Total"]})]}),jsxRuntimeExports.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-border to-transparent"}),jsxRuntimeExports.jsx(Card,{className:"glass-card",children:jsxRuntimeExports.jsx(CardContent,{className:"p-4",children:jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:activityFilters.map(filter=>jsxRuntimeExports.jsxs(Button,{variant:selectedFilter===filter.value?"default":"outline",size:"sm",className:`gap-2 transition-all duration-200 ${selectedFilter===filter.value?`bg-gradient-to-r ${filter.color} text-white shadow-md hover:shadow-lg`:"bg-transparent hover:bg-white/50 text-muted-foreground"}`,onClick:()=>handleFilterChange(filter.value),children:[jsxRuntimeExports.jsx(SafeIcon,{name:filter.icon,className:"h-4 w-4"}),filter.label]},filter.value))})})}),jsxRuntimeExports.jsxs(Card,{className:"glass-card overflow-hidden",children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-4 border-b border-border/50",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Clock",className:"w-5 h-5 text-muted-foreground"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Timeline Aktivitas"}),jsxRuntimeExports.jsx(CardDescription,{children:isLoading?"Memuat...":`Menampilkan ${stats.showing} dari ${stats.total} aktivitas`})]})]}),jsxRuntimeExports.jsxs(Select,{value:itemsPerPage.toString(),onValueChange:v=>{setItemsPerPage(Number(v)),setCurrentPage(1)},children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-36 bg-white/50",children:jsxRuntimeExports.jsx(SelectValue,{})}),jsxRuntimeExports.jsx(SelectContent,{children:ITEMS_PER_PAGE_OPTIONS.map(opt=>jsxRuntimeExports.jsxs(SelectItem,{value:opt.toString(),children:[opt," per halaman"]},opt))})]})]})}),jsxRuntimeExports.jsxs(CardContent,{className:"p-6",children:[isLoading?jsxRuntimeExports.jsx(TimelineSkeleton,{}):error?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[jsxRuntimeExports.jsx("div",{className:"h-20 w-20 rounded-full bg-destructive/10 flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx(SafeIcon,{name:"AlertTriangle",className:"h-10 w-10 text-destructive"})}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-xl mb-2",children:"Terjadi Kesalahan"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground mb-6 max-w-md",children:error}),jsxRuntimeExports.jsxs(Button,{onClick:handleRetry,className:"bg-gradient-to-r from-primary to-primary/80 text-white",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"RefreshCw",className:"h-4 w-4 mr-2"}),"Coba Lagi"]})]}):activities.length===0?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[jsxRuntimeExports.jsx("div",{className:"h-24 w-24 rounded-full bg-gradient-to-br from-primary/10 to-primary/20 flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Inbox",className:"h-12 w-12 text-primary/60"})}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-xl mb-2",children:"Belum Ada Aktivitas"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground max-w-md",children:"Aktivitas sistem akan muncul di sini saat pesanan dibuat, pembayaran diterima, atau stok diperbarui."})]}):jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("div",{className:"absolute left-6 top-0 bottom-0 w-0.5 bg-gradient-to-b from-primary via-primary/50 to-transparent hidden sm:block"}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:activities.map((activity,index)=>{const config=getActivityConfig(activity.type,activity.icon_name);return jsxRuntimeExports.jsxs("div",{className:"relative flex gap-4 group animate-fadeInUp",style:{animationDelay:`${index*50}ms`},children:[jsxRuntimeExports.jsx("div",{className:"hidden sm:flex flex-col items-center z-10",children:jsxRuntimeExports.jsx("div",{className:`h-12 w-12 rounded-full bg-gradient-to-br ${config.gradient} shadow-lg flex items-center justify-center group-hover:scale-110 transition-all duration-300`,children:jsxRuntimeExports.jsx(SafeIcon,{name:config.icon,className:"h-5 w-5 text-white"})})}),jsxRuntimeExports.jsxs("div",{className:`flex-1 p-5 rounded-xl border ${config.borderColor} bg-card/80 dark:bg-card/60 backdrop-blur-sm shadow-sm hover:shadow-lg transition-all duration-300 group-hover:translate-x-1`,children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start justify-between gap-2 mb-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:`sm:hidden h-10 w-10 rounded-xl bg-gradient-to-br ${config.gradient} shadow-sm flex items-center justify-center`,children:jsxRuntimeExports.jsx(SafeIcon,{name:config.icon,className:"h-5 w-5 text-white"})}),jsxRuntimeExports.jsx("h4",{className:"font-semibold text-foreground text-lg",children:activity.title})]}),jsxRuntimeExports.jsx(Badge,{className:`text-xs bg-gradient-to-r ${config.gradient} text-white border-0 shadow-sm w-fit`,children:config.label})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:activity.description||activity.pangkalan_name||"Tidak ada detail"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-2 text-xs text-muted-foreground",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1.5 bg-muted rounded-full px-3 py-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Clock",className:"h-3.5 w-3.5"}),formatRelativeTime(activity.timestamp)]}),activity.users&&jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1.5 bg-muted rounded-full px-3 py-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"User",className:"h-3.5 w-3.5"}),activity.users.name]}),activity.detail_numeric&&jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1.5 bg-primary/10 text-primary rounded-full px-3 py-1 font-medium",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Package",className:"h-3.5 w-3.5"}),activity.detail_numeric.toLocaleString("id-ID")," tabung"]})]})]})]},activity.id)})})]}),meta&&meta.totalPages>1&&!isLoading&&!error&&jsxRuntimeExports.jsx("div",{className:"mt-8 pt-6 border-t border-border/50",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("p",{className:"text-sm text-muted-foreground",children:["Halaman ",currentPage," dari ",totalPages]}),jsxRuntimeExports.jsx(Pagination,{children:jsxRuntimeExports.jsxs(PaginationContent,{children:[jsxRuntimeExports.jsx(PaginationItem,{children:jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",disabled:currentPage===1,onClick:()=>setCurrentPage(p=>p-1),className:"hover:bg-purple-50",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronLeft",className:"h-4 w-4 mr-1"}),"Prev"]})}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1 mx-2",children:getPaginationItems().map((item,i)=>jsxRuntimeExports.jsx(PaginationItem,{children:item==="ellipsis"?jsxRuntimeExports.jsx(PaginationEllipsis,{}):jsxRuntimeExports.jsx(Button,{variant:item===currentPage?"default":"ghost",size:"sm",onClick:()=>setCurrentPage(item),className:item===currentPage?"bg-purple-500 hover:bg-purple-600":"",children:item})},i))}),jsxRuntimeExports.jsx(PaginationItem,{children:jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",disabled:currentPage===totalPages,onClick:()=>setCurrentPage(p=>p+1),className:"hover:bg-purple-50",children:["Next",jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronRight",className:"h-4 w-4 ml-1"})]})})]})})]})})]})]})]})}export{ActivityPage as default};
