import{j as jsxRuntimeExports}from"./jsx-runtime.mvtouYz0.js";import{r as reactExports}from"./index.DcciWILN.js";import{S as SafeIcon,B as Button}from"./SafeIcon.CAGsavDo.js";import{I as Input}from"./input.C9ryBhC0.js";import{L as Label}from"./label.BFF1cpbq.js";import{S as Select,a as SelectTrigger,b as SelectValue,c as SelectContent,d as SelectItem}from"./select.Dd50uIHU.js";import{C as Card,b as CardHeader,c as CardTitle,d as CardDescription,a as CardContent}from"./card.D0gylVsf.js";import{A as Alert,a as AlertDescription}from"./alert.C-aQE-Lx.js";import{t as toast}from"./index.fAd_ikgp.js";import{usersApi}from"./api.Dr7hS9Y8.js";import"./index.PIAPtHoh.js";import"./index.ubNQCTBn.js";import"./index.DGt6JTY0.js";import"./index.BpQ989z7.js";import"./index.BStXkqMp.js";import"./index.Drh0kMGk.js";import"./index.DZiLsHox.js";import"./index.Dovp0-D8.js";import"./index.YpXgcoRz.js";import"./index.BFpcrWlj.js";import"./index.9MihlNbL.js";import"./index.BhA3i5Wo.js";import"./index.BaF2FVWY.js";import"./chevron-up.BBBXIirx.js";import"./check.TUgVKQyo.js";const roleOptions=[{value:"Admin",label:"Administrator"},{value:"Operator",label:"Operator Lapangan"}];function AddUserForm({onClose}){const[formData,setFormData]=reactExports.useState({nama:"",telepon:"",email:"",role:"Operator",password:"",confirmPassword:""}),[errors,setErrors]=reactExports.useState({}),[isLoading,setIsLoading]=reactExports.useState(!1),[showPassword,setShowPassword]=reactExports.useState(!1),validateForm=()=>{const newErrors={};return formData.nama.trim()?formData.nama.trim().length<3&&(newErrors.nama="Nama minimal 3 karakter"):newErrors.nama="Nama harus diisi",formData.telepon.trim()?/^(\+62|0)[0-9]{9,12}$/.test(formData.telepon.replace(/\s/g,""))||(newErrors.telepon="Format nomor telepon tidak valid"):newErrors.telepon="Nomor telepon harus diisi",formData.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(formData.email)||(newErrors.email="Format email tidak valid"):newErrors.email="Email harus diisi",formData.role||(newErrors.role="Peran harus dipilih"),formData.password?formData.password.length<6&&(newErrors.password="Kata sandi minimal 6 karakter"):newErrors.password="Kata sandi harus diisi",formData.confirmPassword?formData.password!==formData.confirmPassword&&(newErrors.confirmPassword="Kata sandi tidak cocok"):newErrors.confirmPassword="Konfirmasi kata sandi harus diisi",setErrors(newErrors),Object.keys(newErrors).length===0},handleChange=e=>{const{name,value}=e.target;setFormData(prev=>({...prev,[name]:value})),errors[name]&&setErrors(prev=>({...prev,[name]:""}))},handleRoleChange=value=>{setFormData(prev=>({...prev,role:value})),errors.role&&setErrors(prev=>({...prev,role:""}))},handleSubmit=async e=>{if(e.preventDefault(),!validateForm()){toast.error("Mohon periksa kembali form Anda");return}setIsLoading(!0);try{const roleMap={Admin:"ADMIN",Operator:"OPERATOR"};await usersApi.create({email:formData.email,password:formData.password,name:formData.nama,phone:formData.telepon,role:roleMap[formData.role]||"OPERATOR"}),toast.success("Pengguna berhasil ditambahkan"),setTimeout(()=>{onClose?onClose():window.location.href="/daftar-pengguna"},500)}catch(error){const message=error?.message||"Gagal menambahkan pengguna. Silakan coba lagi.";toast.error(message),setIsLoading(!1)}},handleCancel=()=>{onClose?onClose():window.location.href="./daftar-pengguna.html"};return jsxRuntimeExports.jsxs(Card,{className:"border shadow-card animate-scaleIn",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"border-b bg-gradient-to-r from-primary/5 to-accent/5",children:[jsxRuntimeExports.jsxs(CardTitle,{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"UserPlus",className:"h-5 w-5 text-primary"}),"Form Pendaftaran Pengguna"]}),jsxRuntimeExports.jsx(CardDescription,{children:"Isi semua field di bawah untuk mendaftarkan pengguna baru"})]}),jsxRuntimeExports.jsx(CardContent,{className:"pt-6",children:jsxRuntimeExports.jsxs("form",{onSubmit:handleSubmit,className:"space-y-6",children:[jsxRuntimeExports.jsxs(Alert,{className:"border-primary/20 bg-primary/5",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Info",className:"h-4 w-4 text-primary"}),jsxRuntimeExports.jsx(AlertDescription,{className:"text-sm text-foreground",children:"Pengguna yang didaftarkan akan langsung aktif dan dapat mengakses sistem sesuai dengan peran yang diberikan."})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs(Label,{htmlFor:"nama",className:"text-sm font-medium",children:["Nama Lengkap ",jsxRuntimeExports.jsx("span",{className:"text-destructive",children:"*"})]}),jsxRuntimeExports.jsx(Input,{id:"nama",name:"nama",type:"text",placeholder:"Masukkan nama lengkap",value:formData.nama,onChange:handleChange,disabled:isLoading,className:errors.nama?"border-destructive":"","aria-invalid":!!errors.nama}),errors.nama&&jsxRuntimeExports.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-4 w-4"}),errors.nama]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs(Label,{htmlFor:"telepon",className:"text-sm font-medium",children:["Nomor Telepon ",jsxRuntimeExports.jsx("span",{className:"text-destructive",children:"*"})]}),jsxRuntimeExports.jsx(Input,{id:"telepon",name:"telepon",type:"tel",placeholder:"Contoh: 08123456789 atau +6281234567890",value:formData.telepon,onChange:handleChange,disabled:isLoading,className:errors.telepon?"border-destructive":"","aria-invalid":!!errors.telepon}),errors.telepon&&jsxRuntimeExports.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-4 w-4"}),errors.telepon]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs(Label,{htmlFor:"email",className:"text-sm font-medium",children:["Email ",jsxRuntimeExports.jsx("span",{className:"text-destructive",children:"*"})]}),jsxRuntimeExports.jsx(Input,{id:"email",name:"email",type:"email",placeholder:"Contoh: user@example.com",value:formData.email,onChange:handleChange,disabled:isLoading,className:errors.email?"border-destructive":"","aria-invalid":!!errors.email}),errors.email&&jsxRuntimeExports.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-4 w-4"}),errors.email]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs(Label,{htmlFor:"role",className:"text-sm font-medium",children:["Peran ",jsxRuntimeExports.jsx("span",{className:"text-destructive",children:"*"})]}),jsxRuntimeExports.jsxs(Select,{value:formData.role,onValueChange:handleRoleChange,disabled:isLoading,children:[jsxRuntimeExports.jsx(SelectTrigger,{id:"role",className:errors.role?"border-destructive":"","aria-invalid":!!errors.role,children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Pilih peran pengguna"})}),jsxRuntimeExports.jsx(SelectContent,{children:roleOptions.map(option=>jsxRuntimeExports.jsx(SelectItem,{value:option.value,children:option.label},option.value))})]}),errors.role&&jsxRuntimeExports.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-4 w-4"}),errors.role]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground",children:"Pilih peran yang sesuai dengan tanggung jawab pengguna"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs(Label,{htmlFor:"password",className:"text-sm font-medium",children:["Kata Sandi ",jsxRuntimeExports.jsx("span",{className:"text-destructive",children:"*"})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Input,{id:"password",name:"password",type:showPassword?"text":"password",placeholder:"Masukkan kata sandi minimal 6 karakter",value:formData.password,onChange:handleChange,disabled:isLoading,className:`pr-10 ${errors.password?"border-destructive":""}`,"aria-invalid":!!errors.password}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>setShowPassword(!showPassword),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",disabled:isLoading,"aria-label":showPassword?"Sembunyikan kata sandi":"Tampilkan kata sandi",children:jsxRuntimeExports.jsx(SafeIcon,{name:showPassword?"EyeOff":"Eye",className:"h-4 w-4"})})]}),errors.password&&jsxRuntimeExports.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-4 w-4"}),errors.password]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs(Label,{htmlFor:"confirmPassword",className:"text-sm font-medium",children:["Konfirmasi Kata Sandi ",jsxRuntimeExports.jsx("span",{className:"text-destructive",children:"*"})]}),jsxRuntimeExports.jsx(Input,{id:"confirmPassword",name:"confirmPassword",type:showPassword?"text":"password",placeholder:"Masukkan ulang kata sandi",value:formData.confirmPassword,onChange:handleChange,disabled:isLoading,className:errors.confirmPassword?"border-destructive":"","aria-invalid":!!errors.confirmPassword}),errors.confirmPassword&&jsxRuntimeExports.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-4 w-4"}),errors.confirmPassword]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[jsxRuntimeExports.jsxs(Button,{type:"button",variant:"outline",onClick:handleCancel,disabled:isLoading,className:"flex-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"X",className:"mr-2 h-4 w-4"}),"Batal"]}),jsxRuntimeExports.jsx(Button,{type:"submit",disabled:isLoading,className:"flex-1 bg-primary hover:bg-primary/90",children:isLoading?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"mr-2 h-4 w-4 animate-spin"}),"Menyimpan..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Save",className:"mr-2 h-4 w-4"}),"Simpan Pengguna"]})})]})]})})]})}export{AddUserForm as default};
