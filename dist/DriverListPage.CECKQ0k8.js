import{j as jsxRuntimeExports}from"./jsx-runtime.mvtouYz0.js";import{r as reactExports}from"./index.DcciWILN.js";import{S as SafeIcon,B as Button}from"./SafeIcon.C08LGL0m.js";import{I as Input}from"./input.B0jSBU-X.js";import{C as Card,a as CardHeader,b as CardTitle,d as CardContent,c as CardDescription}from"./card.SxAweRZB.js";import{T as Tilt3DCard}from"./Tilt3DCard.PsjhSQ2O.js";import{T as Table,a as TableHeader,b as TableRow,c as TableHead,d as TableBody,e as TableCell}from"./table.Dsw4hYLC.js";import{D as DropdownMenu,a as DropdownMenuTrigger,b as DropdownMenuContent,e as DropdownMenuItem}from"./dropdown-menu.COVwx0ux.js";import{B as Badge}from"./badge.BFgaaq5n.js";import{D as Dialog,a as DialogContent,b as DialogHeader,c as DialogTitle,d as DialogDescription}from"./dialog.Deg6T-G2.js";import{C as ConfirmationModal}from"./ConfirmationModal.BnFiX7YW.js";import{driversApi}from"./api.B5PpFILw.js";import{t as toast}from"./index.fAd_ikgp.js";import{L as Label}from"./label.CykMmJMJ.js";import{T as Textarea}from"./textarea.kGDeskSO.js";import"./use3DTilt.Dcq4iilr.js";import"./index.CmV6gt94.js";import"./index.PIAPtHoh.js";import"./index.ubNQCTBn.js";import"./index.CLV08RI1.js";import"./index.BB0xO63c.js";import"./index.CZLqkOjo.js";import"./index.Drh0kMGk.js";import"./Combination.wteLWZ5f.js";import"./index.D7stNVgX.js";import"./index.Bcho8R2B.js";import"./index.Ci_bviUJ.js";import"./index.DNfkKfAg.js";import"./chevron-right.go_z-t67.js";import"./check.bOXrmBHo.js";import"./index.DYERl0li.js";import"./x.3YBaUzhJ.js";function AddDriverModal({open,onOpenChange,driver,onSuccess}){const[isSubmitting,setIsSubmitting]=reactExports.useState(!1),[formData,setFormData]=reactExports.useState({name:"",phone:"",vehicle_id:"",note:""}),[errors,setErrors]=reactExports.useState({});reactExports.useEffect(()=>{open&&(setFormData(driver?{name:driver.name,phone:driver.phone||"",vehicle_id:driver.vehicle_id||"",note:driver.note||""}:{name:"",phone:"",vehicle_id:"",note:""}),setErrors({}))},[driver,open]);const validateForm=()=>{const newErrors={};return formData.name.trim()?formData.name.length<2&&(newErrors.name="Nama minimal 2 karakter"):newErrors.name="Nama supir harus diisi",formData.phone.trim()?/^(\+62|0)[0-9]{9,12}$/.test(formData.phone)||(newErrors.phone="Nomor telepon tidak valid (contoh: 08xx atau +62xx)"):newErrors.phone="Nomor telepon harus diisi",setErrors(newErrors),Object.keys(newErrors).length===0},handleSubmit=async e=>{if(e.preventDefault(),!!validateForm()){setIsSubmitting(!0);try{driver?(await driversApi.update(driver.id,{name:formData.name,phone:formData.phone,vehicle_id:formData.vehicle_id||null,note:formData.note||null}),toast.success("Data supir berhasil diperbarui")):(await driversApi.create({name:formData.name,phone:formData.phone,vehicle_id:formData.vehicle_id||null,note:formData.note||null}),toast.success("Supir baru berhasil ditambahkan")),onOpenChange(!1),onSuccess?.()}catch(error){console.error("Failed to save driver:",error),toast.error("Gagal menyimpan data supir")}finally{setIsSubmitting(!1)}}};return jsxRuntimeExports.jsx(Dialog,{open,onOpenChange,children:jsxRuntimeExports.jsxs(DialogContent,{className:"sm:max-w-md",children:[jsxRuntimeExports.jsxs(DialogHeader,{children:[jsxRuntimeExports.jsx(DialogTitle,{children:driver?"Edit Supir":"Tambah Supir Baru"}),jsxRuntimeExports.jsx(DialogDescription,{children:driver?"Perbarui informasi supir di bawah ini":"Isi formulir untuk menambahkan supir baru ke sistem"})]}),jsxRuntimeExports.jsxs("form",{onSubmit:handleSubmit,className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"name",className:"text-sm font-medium",children:"Nama Supir *"}),jsxRuntimeExports.jsx(Input,{id:"name",placeholder:"Masukkan nama supir",value:formData.name,onChange:e=>setFormData({...formData,name:e.target.value}),disabled:isSubmitting,className:errors.name?"border-destructive":""}),errors.name&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-3 w-3"}),errors.name]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"phone",className:"text-sm font-medium",children:"Nomor Telepon *"}),jsxRuntimeExports.jsx(Input,{id:"phone",placeholder:"08xxxxxxxxxx",value:formData.phone,onChange:e=>setFormData({...formData,phone:e.target.value}),disabled:isSubmitting,className:errors.phone?"border-destructive":""}),errors.phone&&jsxRuntimeExports.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-3 w-3"}),errors.phone]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"vehicle_id",className:"text-sm font-medium",children:"Plat Kendaraan (Opsional)"}),jsxRuntimeExports.jsx(Input,{id:"vehicle_id",placeholder:"Contoh: B 1234 ABC",value:formData.vehicle_id,onChange:e=>setFormData({...formData,vehicle_id:e.target.value}),disabled:isSubmitting})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"note",className:"text-sm font-medium",children:"Catatan (Opsional)"}),jsxRuntimeExports.jsx(Textarea,{id:"note",placeholder:"Tambahkan catatan tentang supir ini...",value:formData.note,onChange:e=>setFormData({...formData,note:e.target.value}),disabled:isSubmitting,className:"resize-none",rows:3})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3 pt-4",children:[jsxRuntimeExports.jsx(Button,{type:"button",variant:"outline",onClick:()=>onOpenChange(!1),disabled:isSubmitting,className:"flex-1",children:"Batal"}),jsxRuntimeExports.jsx(Button,{type:"submit",disabled:isSubmitting,className:"flex-1 bg-primary hover:bg-primary/90 text-primary-foreground gap-2",children:isSubmitting?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-4 w-4 animate-spin"}),"Menyimpan..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Save",className:"h-4 w-4"}),driver?"Simpan Perubahan":"Tambah Supir"]})})]})]})]})})}function DriverListPage(){const[driverList,setDriverList]=reactExports.useState([]),[isLoading,setIsLoading]=reactExports.useState(!0),[totalItems,setTotalItems]=reactExports.useState(0),[currentPage,setCurrentPage]=reactExports.useState(1),[totalPages,setTotalPages]=reactExports.useState(1),[searchTerm,setSearchTerm]=reactExports.useState(""),[statusFilter,setStatusFilter]=reactExports.useState("semua"),[showAddModal,setShowAddModal]=reactExports.useState(!1),[editingDriver,setEditingDriver]=reactExports.useState(null),[selectedDriver,setSelectedDriver]=reactExports.useState(null),[showDeleteModal,setShowDeleteModal]=reactExports.useState(!1),[showStatusModal,setShowStatusModal]=reactExports.useState(!1),fetchDrivers=async()=>{try{setIsLoading(!0);const isActive=statusFilter==="semua"?void 0:statusFilter==="aktif",response=await driversApi.getAll(currentPage,10,searchTerm||void 0,isActive);setDriverList(response.data),setTotalItems(response.meta.total),setTotalPages(response.meta.totalPages)}catch(error){console.error("Failed to fetch drivers:",error),toast.error("Gagal memuat data driver")}finally{setIsLoading(!1)}};reactExports.useEffect(()=>{fetchDrivers()},[currentPage,statusFilter]),reactExports.useEffect(()=>{const timer=setTimeout(()=>{setCurrentPage(1),fetchDrivers()},500);return()=>clearTimeout(timer)},[searchTerm]);const handleStatusToggleClick=driver=>{setSelectedDriver(driver),setShowStatusModal(!0)},handleConfirmStatusToggle=async()=>{if(selectedDriver)try{const newStatus=!selectedDriver.is_active;await driversApi.update(selectedDriver.id,{is_active:newStatus}),toast.success(`Driver berhasil ${newStatus?"diaktifkan":"dinonaktifkan"}`),fetchDrivers()}catch(error){console.error("Failed to update status:",error),toast.error("Gagal mengubah status driver")}finally{setShowStatusModal(!1),setSelectedDriver(null)}},handleDeleteClick=driver=>{setSelectedDriver(driver),setShowDeleteModal(!0)},handleConfirmDelete=async()=>{if(selectedDriver)try{await driversApi.delete(selectedDriver.id),toast.success("Driver berhasil dihapus"),fetchDrivers()}catch(error){console.error("Failed to delete driver:",error),toast.error("Gagal menghapus driver")}finally{setShowDeleteModal(!1),setSelectedDriver(null)}},handleSaveSuccess=()=>{setShowAddModal(!1),setEditingDriver(null),fetchDrivers()},aktivCount=driverList.filter(d=>d.is_active).length,nonaktifCount=driverList.filter(d=>!d.is_active).length;return jsxRuntimeExports.jsxs("div",{className:"flex-1 space-y-6 p-4 sm:p-6 lg:p-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold tracking-tight text-foreground",children:"Daftar Supir"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Kelola data driver dan status ketersediaan mereka"})]}),jsxRuntimeExports.jsxs(Button,{onClick:()=>{setEditingDriver(null),setShowAddModal(!0)},className:"bg-primary hover:bg-primary/90 text-primary-foreground gap-2 w-full sm:w-auto",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Plus",className:"h-4 w-4"}),"Tambah Supir"]})]}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Total Supir"})}),jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold",children:totalItems})})]})}),jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.1s"},children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Supir Aktif"})}),jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-primary",children:aktivCount})})]})}),jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.2s"},children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Supir Nonaktif"})}),jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-destructive",children:nonaktifCount})})]})})]}),jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-3",children:jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Cari Supir"})}),jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Search",className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),jsxRuntimeExports.jsx(Input,{placeholder:"Cari berdasarkan nama atau telepon...",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:"pl-10"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx(Button,{variant:statusFilter==="semua"?"default":"outline",onClick:()=>setStatusFilter("semua"),className:"flex-1 sm:flex-none",children:"Semua"}),jsxRuntimeExports.jsx(Button,{variant:statusFilter==="aktif"?"default":"outline",onClick:()=>setStatusFilter("aktif"),className:"flex-1 sm:flex-none",children:"Aktif"}),jsxRuntimeExports.jsx(Button,{variant:statusFilter==="nonaktif"?"default":"outline",onClick:()=>setStatusFilter("nonaktif"),className:"flex-1 sm:flex-none",children:"Nonaktif"})]})]})})]}),jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{children:[jsxRuntimeExports.jsx(CardTitle,{children:"Daftar Supir"}),jsxRuntimeExports.jsxs(CardDescription,{children:["Menampilkan ",driverList.length," dari ",totalItems," supir"]})]}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:isLoading?jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center py-8",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-8 w-8 animate-spin text-primary"}),jsxRuntimeExports.jsx("span",{className:"ml-2",children:"Memuat data..."})]}):jsxRuntimeExports.jsxs(Table,{children:[jsxRuntimeExports.jsx(TableHeader,{children:jsxRuntimeExports.jsxs(TableRow,{className:"bg-muted/50",children:[jsxRuntimeExports.jsx(TableHead,{className:"font-semibold w-24",children:"Kode"}),jsxRuntimeExports.jsx(TableHead,{className:"font-semibold",children:"Nama"}),jsxRuntimeExports.jsx(TableHead,{className:"font-semibold",children:"Telepon"}),jsxRuntimeExports.jsx(TableHead,{className:"font-semibold",children:"Kendaraan"}),jsxRuntimeExports.jsx(TableHead,{className:"font-semibold",children:"Catatan"}),jsxRuntimeExports.jsx(TableHead,{className:"font-semibold",children:"Status"}),jsxRuntimeExports.jsx(TableHead,{className:"text-right font-semibold",children:"Aksi"})]})}),jsxRuntimeExports.jsx(TableBody,{children:driverList.length>0?driverList.map(driver=>jsxRuntimeExports.jsxs(TableRow,{className:"hover:bg-muted/50",children:[jsxRuntimeExports.jsx(TableCell,{className:"font-mono text-sm text-primary",children:driver.code||"-"}),jsxRuntimeExports.jsx(TableCell,{className:"font-medium",children:driver.name}),jsxRuntimeExports.jsx(TableCell,{children:driver.phone||"-"}),jsxRuntimeExports.jsx(TableCell,{children:driver.vehicle_id||"-"}),jsxRuntimeExports.jsx(TableCell,{className:"max-w-xs truncate",children:driver.note||"-"}),jsxRuntimeExports.jsx(TableCell,{children:jsxRuntimeExports.jsx(Badge,{variant:driver.is_active?"default":"secondary",children:driver.is_active?"Aktif":"Nonaktif"})}),jsxRuntimeExports.jsx(TableCell,{className:"text-right",children:jsxRuntimeExports.jsxs(DropdownMenu,{children:[jsxRuntimeExports.jsx(DropdownMenuTrigger,{asChild:!0,children:jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",children:jsxRuntimeExports.jsx(SafeIcon,{name:"MoreVertical",className:"h-4 w-4"})})}),jsxRuntimeExports.jsxs(DropdownMenuContent,{align:"end",children:[jsxRuntimeExports.jsxs(DropdownMenuItem,{onClick:()=>{setEditingDriver(driver),setShowAddModal(!0)},children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Edit",className:"mr-2 h-4 w-4"}),"Edit"]}),driver.is_active?jsxRuntimeExports.jsxs(DropdownMenuItem,{className:"text-orange-600",onClick:()=>handleStatusToggleClick(driver),children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Ban",className:"mr-2 h-4 w-4"}),"Nonaktifkan"]}):jsxRuntimeExports.jsxs(DropdownMenuItem,{className:"text-green-600",onClick:()=>handleStatusToggleClick(driver),children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Check",className:"mr-2 h-4 w-4"}),"Aktifkan"]}),jsxRuntimeExports.jsxs(DropdownMenuItem,{className:"text-destructive",onClick:()=>handleDeleteClick(driver),children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Trash2",className:"mr-2 h-4 w-4"}),"Hapus"]})]})]})})]},driver.id)):jsxRuntimeExports.jsx(TableRow,{children:jsxRuntimeExports.jsx(TableCell,{colSpan:6,className:"text-center py-8",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Users",className:"h-8 w-8 text-muted-foreground"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Tidak ada supir ditemukan"})]})})})})]})}),totalPages>1&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mt-4",children:[jsxRuntimeExports.jsxs("p",{className:"text-sm text-muted-foreground",children:["Halaman ",currentPage," dari ",totalPages]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",disabled:currentPage===1,onClick:()=>setCurrentPage(p=>p-1),children:[jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronLeft",className:"h-4 w-4"}),"Prev"]}),jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",disabled:currentPage===totalPages,onClick:()=>setCurrentPage(p=>p+1),children:["Next",jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronRight",className:"h-4 w-4"})]})]})]})]})]}),jsxRuntimeExports.jsx(AddDriverModal,{open:showAddModal,onOpenChange:setShowAddModal,driver:editingDriver,onSuccess:handleSaveSuccess}),selectedDriver&&showStatusModal&&jsxRuntimeExports.jsx(ConfirmationModal,{open:showStatusModal,onOpenChange:setShowStatusModal,title:selectedDriver.is_active?"Nonaktifkan Supir":"Aktifkan Supir",description:selectedDriver.is_active?`Apakah Anda yakin ingin menonaktifkan "${selectedDriver.name}"?`:`Apakah Anda yakin ingin mengaktifkan "${selectedDriver.name}"?`,confirmText:selectedDriver.is_active?"Nonaktifkan":"Aktifkan",cancelText:"Batal",icon:selectedDriver.is_active?"AlertTriangle":"CheckCircle",isDangerous:selectedDriver.is_active,onConfirm:handleConfirmStatusToggle}),selectedDriver&&showDeleteModal&&jsxRuntimeExports.jsx(ConfirmationModal,{open:showDeleteModal,onOpenChange:setShowDeleteModal,title:"Hapus Supir",description:`Apakah Anda yakin ingin menghapus "${selectedDriver.name}"? Tindakan ini tidak dapat dibatalkan.`,confirmText:"Hapus",cancelText:"Batal",icon:"Trash2",isDangerous:!0,onConfirm:handleConfirmDelete})]})}export{DriverListPage as default};
