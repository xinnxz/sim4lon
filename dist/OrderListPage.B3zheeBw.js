import{j as jsxRuntimeExports}from"./jsx-runtime.mvtouYz0.js";import{r as reactExports}from"./index.DcciWILN.js";import{B as Button,S as SafeIcon}from"./SafeIcon.C08LGL0m.js";import{I as Input}from"./input.B0jSBU-X.js";import{S as Select,a as SelectTrigger,b as SelectValue,c as SelectContent,d as SelectItem}from"./select.CdiqpKGf.js";import{T as Table,a as TableHeader,b as TableRow,c as TableHead,d as TableBody,e as TableCell}from"./table.Dsw4hYLC.js";import{a as CardHeader,b as CardTitle,d as CardContent,C as Card,c as CardDescription}from"./card.SxAweRZB.js";import{B as Badge}from"./badge.BFgaaq5n.js";import{T as Tilt3DCard}from"./Tilt3DCard.PsjhSQ2O.js";import{t as toast}from"./index.fAd_ikgp.js";import{ordersApi}from"./api.B5PpFILw.js";import"./index.PIAPtHoh.js";import"./index.ubNQCTBn.js";import"./index.DGt6JTY0.js";import"./index.CmV6gt94.js";import"./index.CZLqkOjo.js";import"./index.Drh0kMGk.js";import"./Combination.wteLWZ5f.js";import"./index.BB0xO63c.js";import"./index.CLV08RI1.js";import"./index.D7stNVgX.js";import"./index.Bcho8R2B.js";import"./index.BhA3i5Wo.js";import"./index.DQFEM45L.js";import"./chevron-up.CkJSkLmv.js";import"./check.bOXrmBHo.js";import"./use3DTilt.Dcq4iilr.js";const statusLabels={DRAFT:"Draft",MENUNGGU_PEMBAYARAN:"Menunggu Pembayaran",DIPROSES:"Diproses",SIAP_KIRIM:"Siap Kirim",DIKIRIM:"Sedang Dikirim",SELESAI:"Selesai",BATAL:"Dibatalkan"},statusColors={DRAFT:"bg-gray-100 text-gray-700",MENUNGGU_PEMBAYARAN:"bg-amber-100 text-amber-700",DIPROSES:"bg-blue-100 text-blue-700",SIAP_KIRIM:"bg-purple-100 text-purple-700",DIKIRIM:"bg-indigo-100 text-indigo-700",SELESAI:"bg-green-100 text-green-700",BATAL:"bg-red-100 text-red-700"};function OrderListPage(){const[orders,setOrders]=reactExports.useState([]),[isLoading,setIsLoading]=reactExports.useState(!0),[totalOrders,setTotalOrders]=reactExports.useState(0),[currentPage,setCurrentPage]=reactExports.useState(1),[totalPages,setTotalPages]=reactExports.useState(1),[searchTerm,setSearchTerm]=reactExports.useState(""),[statusFilter,setStatusFilter]=reactExports.useState("all"),[stats,setStats]=reactExports.useState(null),[isLoadingStats,setIsLoadingStats]=reactExports.useState(!0),fetchOrders=async()=>{try{setIsLoading(!0);const status=statusFilter==="all"?void 0:statusFilter,response=await ordersApi.getAll(currentPage,10,status);setOrders(response.data),setTotalOrders(response.meta.total),setTotalPages(response.meta.totalPages)}catch(error){console.error("Failed to fetch orders:",error),toast.error("Gagal memuat data pesanan")}finally{setIsLoading(!1)}},fetchStats=async()=>{try{setIsLoadingStats(!0);const data=await ordersApi.getStats(!0);setStats(data)}catch(error){console.error("Failed to fetch stats:",error)}finally{setIsLoadingStats(!1)}};reactExports.useEffect(()=>{fetchStats()},[]),reactExports.useEffect(()=>{fetchOrders()},[currentPage,statusFilter]),reactExports.useEffect(()=>{const timer=setTimeout(()=>{setCurrentPage(1),fetchOrders()},500);return()=>clearTimeout(timer)},[searchTerm]);const formatCurrency=value=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(value),formatDate=dateString=>new Date(dateString).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),formatOrderCode=order=>order.code||`ORD-${order.id.slice(0,4).toUpperCase()}`,getItemsSummary=order=>{if(!order.order_items||order.order_items.length===0)return"-";const first=order.order_items[0],more=order.order_items.length-1,summary=`${first.label} (${first.qty})`;return more>0?`${summary} +${more} lainnya`:summary},getTotalQty=order=>order.order_items?order.order_items.reduce((sum,item)=>sum+item.qty,0):0,filteredOrders=orders.filter(order=>{if(!searchTerm)return!0;const term=searchTerm.toLowerCase();return order.id.toLowerCase().includes(term)||order.pangkalans?.name.toLowerCase().includes(term)||order.order_items?.some(item=>item.label.toLowerCase().includes(term))});return jsxRuntimeExports.jsxs("div",{className:"flex-1 space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Daftar Pesanan"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground mt-1",children:"Kelola semua pesanan masuk dengan mudah"})]}),jsxRuntimeExports.jsx(Button,{asChild:!0,className:"bg-primary hover:bg-primary/90 w-full sm:w-auto",children:jsxRuntimeExports.jsxs("a",{href:"/buat-pesanan",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Plus",className:"mr-2 h-4 w-4"}),"Buat Pesanan"]})})]}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4 sm:grid-cols-5",children:[jsxRuntimeExports.jsxs(Tilt3DCard,{className:"animate-fadeInUp",children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Total Hari Ini"})}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold",children:isLoadingStats?"-":stats?.total||0}),jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"pesanan"})]})]}),jsxRuntimeExports.jsxs(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.1s"},children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Menunggu Bayar"})}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:isLoadingStats?"-":stats?.menunggu_pembayaran||0}),jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"hari ini"})]})]}),jsxRuntimeExports.jsxs(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.2s"},children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Diproses"})}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-blue-600",children:isLoadingStats?"-":stats?.diproses||0}),jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"hari ini"})]})]}),jsxRuntimeExports.jsxs(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.3s"},children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Dikirim"})}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:isLoadingStats?"-":stats?.dikirim||0}),jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"hari ini"})]})]}),jsxRuntimeExports.jsxs(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.4s"},children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Selesai"})}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-green-600",children:isLoadingStats?"-":stats?.selesai||0}),jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"hari ini"})]})]})]}),jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-4",children:jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Filter & Pencarian"})}),jsxRuntimeExports.jsx(CardContent,{className:"space-y-4",children:jsxRuntimeExports.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-3",children:[jsxRuntimeExports.jsxs("div",{className:"relative sm:col-span-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Search",className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),jsxRuntimeExports.jsx(Input,{placeholder:"Cari ID pesanan, pangkalan, atau jenis LPG...",className:"pl-10",value:searchTerm,onChange:e=>setSearchTerm(e.target.value)})]}),jsxRuntimeExports.jsxs(Select,{value:statusFilter,onValueChange:v=>{setStatusFilter(v),setCurrentPage(1)},children:[jsxRuntimeExports.jsx(SelectTrigger,{children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Filter Status"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:"all",children:"Semua Status"}),jsxRuntimeExports.jsx(SelectItem,{value:"DRAFT",children:"Draft"}),jsxRuntimeExports.jsx(SelectItem,{value:"MENUNGGU_PEMBAYARAN",children:"Menunggu Pembayaran"}),jsxRuntimeExports.jsx(SelectItem,{value:"DIPROSES",children:"Diproses"}),jsxRuntimeExports.jsx(SelectItem,{value:"DIKIRIM",children:"Sedang Dikirim"}),jsxRuntimeExports.jsx(SelectItem,{value:"SELESAI",children:"Selesai"}),jsxRuntimeExports.jsx(SelectItem,{value:"BATAL",children:"Dibatalkan"})]})]})]})})]}),jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{children:[jsxRuntimeExports.jsx(CardTitle,{children:"Daftar Pesanan"}),jsxRuntimeExports.jsxs(CardDescription,{children:["Total ",filteredOrders.length," pesanan ditampilkan"]})]}),jsxRuntimeExports.jsxs(CardContent,{children:[isLoading?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center py-8",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-8 w-8 animate-spin text-primary"})}):jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs(Table,{children:[jsxRuntimeExports.jsx(TableHeader,{children:jsxRuntimeExports.jsxs(TableRow,{className:"hover:bg-transparent",children:[jsxRuntimeExports.jsx(TableHead,{className:"font-semibold",children:"ID Pesanan"}),jsxRuntimeExports.jsx(TableHead,{className:"font-semibold",children:"Pangkalan"}),jsxRuntimeExports.jsx(TableHead,{className:"font-semibold",children:"Item"}),jsxRuntimeExports.jsx(TableHead,{className:"text-right font-semibold",children:"Qty"}),jsxRuntimeExports.jsx(TableHead,{className:"text-right font-semibold",children:"Total"}),jsxRuntimeExports.jsx(TableHead,{className:"font-semibold",children:"Status"}),jsxRuntimeExports.jsx(TableHead,{className:"font-semibold",children:"Tanggal"}),jsxRuntimeExports.jsx(TableHead,{className:"text-right font-semibold",children:"Aksi"})]})}),jsxRuntimeExports.jsx(TableBody,{children:filteredOrders.length>0?filteredOrders.map(order=>jsxRuntimeExports.jsxs(TableRow,{className:"hover:bg-muted/50",children:[jsxRuntimeExports.jsx(TableCell,{className:"font-medium text-primary font-mono",children:formatOrderCode(order)}),jsxRuntimeExports.jsx(TableCell,{className:"text-sm",children:order.pangkalans?.name||"-"}),jsxRuntimeExports.jsx(TableCell,{className:"text-sm",children:getItemsSummary(order)}),jsxRuntimeExports.jsxs(TableCell,{className:"text-right text-sm",children:[getTotalQty(order)," unit"]}),jsxRuntimeExports.jsx(TableCell,{className:"text-right text-sm font-medium",children:formatCurrency(order.total_amount)}),jsxRuntimeExports.jsx(TableCell,{children:jsxRuntimeExports.jsx(Badge,{variant:"status",className:statusColors[order.current_status],children:statusLabels[order.current_status]})}),jsxRuntimeExports.jsx(TableCell,{className:"text-sm text-muted-foreground",children:formatDate(order.created_at)}),jsxRuntimeExports.jsx(TableCell,{className:"text-right",children:jsxRuntimeExports.jsx(Button,{asChild:!0,variant:"outline",size:"sm",className:"hover:bg-primary hover:text-primary-foreground",children:jsxRuntimeExports.jsxs("a",{href:`/detail-pesanan?id=${order.id}`,className:"flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Eye",className:"h-4 w-4"}),"Lihat"]})})})]},order.id)):jsxRuntimeExports.jsx(TableRow,{children:jsxRuntimeExports.jsx(TableCell,{colSpan:8,className:"text-center py-8",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Inbox",className:"h-8 w-8 text-muted-foreground"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Tidak ada pesanan yang ditemukan"})]})})})})]})}),totalPages>1&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:()=>setCurrentPage(p=>Math.max(1,p-1)),disabled:currentPage===1,children:jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronLeft",className:"h-4 w-4"})}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-muted-foreground",children:["Halaman ",currentPage," dari ",totalPages]}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:()=>setCurrentPage(p=>Math.min(totalPages,p+1)),disabled:currentPage===totalPages,children:jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronRight",className:"h-4 w-4"})})]})]})]})]})}export{OrderListPage as default};
