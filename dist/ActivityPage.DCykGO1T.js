import{j as jsxRuntimeExports}from"./jsx-runtime.mvtouYz0.js";import{r as reactExports}from"./index.DcciWILN.js";import{C as Card,a as CardHeader,b as CardTitle,c as CardDescription,d as CardContent}from"./card.SxAweRZB.js";import{B as Badge}from"./badge.BFgaaq5n.js";import{c as cn,e as buttonVariants,S as SafeIcon,B as Button}from"./SafeIcon.C08LGL0m.js";import{S as Select,a as SelectTrigger,b as SelectValue,c as SelectContent,d as SelectItem}from"./select.CdiqpKGf.js";import{C as ChevronLeft,E as Ellipsis}from"./ellipsis.BAGuLDjL.js";import{C as ChevronRight}from"./chevron-right.go_z-t67.js";import{S as Skeleton}from"./skeleton.CiucfBuv.js";import"./input.B0jSBU-X.js";import{activityApi}from"./api.B5PpFILw.js";import"./index.PIAPtHoh.js";import"./index.ubNQCTBn.js";import"./index.DGt6JTY0.js";import"./index.CmV6gt94.js";import"./index.CZLqkOjo.js";import"./index.Drh0kMGk.js";import"./Combination.wteLWZ5f.js";import"./index.BB0xO63c.js";import"./index.CLV08RI1.js";import"./index.D7stNVgX.js";import"./index.Bcho8R2B.js";import"./index.BhA3i5Wo.js";import"./index.DQFEM45L.js";import"./chevron-up.CkJSkLmv.js";import"./check.bOXrmBHo.js";const Pagination=({className,...props})=>jsxRuntimeExports.jsx("nav",{role:"navigation","aria-label":"pagination",className:cn("mx-auto flex w-full justify-center",className),...props});Pagination.displayName="Pagination";const PaginationContent=reactExports.forwardRef(({className,...props},ref)=>jsxRuntimeExports.jsx("ul",{ref,className:cn("flex flex-row items-center gap-1",className),...props}));PaginationContent.displayName="PaginationContent";const PaginationItem=reactExports.forwardRef(({className,...props},ref)=>jsxRuntimeExports.jsx("li",{ref,className:cn("",className),...props}));PaginationItem.displayName="PaginationItem";const PaginationLink=({className,isActive,size="icon",...props})=>jsxRuntimeExports.jsx("a",{"aria-current":isActive?"page":void 0,className:cn(buttonVariants({variant:isActive?"outline":"ghost",size}),className),...props});PaginationLink.displayName="PaginationLink";const PaginationPrevious=({className,...props})=>jsxRuntimeExports.jsxs(PaginationLink,{"aria-label":"Go to previous page",size:"default",className:cn("gap-1 pl-2.5",className),...props,children:[jsxRuntimeExports.jsx(ChevronLeft,{className:"h-4 w-4"}),jsxRuntimeExports.jsx("span",{children:"Previous"})]});PaginationPrevious.displayName="PaginationPrevious";const PaginationNext=({className,...props})=>jsxRuntimeExports.jsxs(PaginationLink,{"aria-label":"Go to next page",size:"default",className:cn("gap-1 pr-2.5",className),...props,children:[jsxRuntimeExports.jsx("span",{children:"Next"}),jsxRuntimeExports.jsx(ChevronRight,{className:"h-4 w-4"})]});PaginationNext.displayName="PaginationNext";const PaginationEllipsis=({className,...props})=>jsxRuntimeExports.jsxs("span",{"aria-hidden":!0,className:cn("flex h-9 w-9 items-center justify-center",className),...props,children:[jsxRuntimeExports.jsx(Ellipsis,{className:"h-4 w-4"}),jsxRuntimeExports.jsx("span",{className:"sr-only",children:"More pages"})]});PaginationEllipsis.displayName="PaginationEllipsis";const formatRelativeTime=timestamp=>{const now=new Date,date=new Date(timestamp),diffMs=now.getTime()-date.getTime(),diffMins=Math.floor(diffMs/6e4),diffHours=Math.floor(diffMs/36e5),diffDays=Math.floor(diffMs/864e5);return diffMins<1?"Baru saja":diffMins<60?`${diffMins} menit lalu`:diffHours<24?`${diffHours} jam lalu`:diffDays===1?"Kemarin":diffDays<7?`${diffDays} hari lalu`:diffDays<30?`${Math.floor(diffDays/7)} minggu lalu`:date.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})},getActivityConfig=(type,iconOverride)=>{const config={ORDER_NEW:{icon:"ShoppingCart",color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200",label:"Pesanan Baru"},ORDER_UPDATED:{icon:"RefreshCw",color:"text-amber-600",bgColor:"bg-amber-50",borderColor:"border-amber-200",label:"Update Pesanan"},ORDER_COMPLETED:{icon:"CheckCircle2",color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",label:"Selesai"},ORDER_CANCELLED:{icon:"XCircle",color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",label:"Dibatalkan"},PAYMENT_RECEIVED:{icon:"Banknote",color:"text-emerald-600",bgColor:"bg-emerald-50",borderColor:"border-emerald-200",label:"Pembayaran"},STOCK_IN:{icon:"PackagePlus",color:"text-indigo-600",bgColor:"bg-indigo-50",borderColor:"border-indigo-200",label:"Stok Masuk"},STOCK_OUT:{icon:"PackageMinus",color:"text-orange-600",bgColor:"bg-orange-50",borderColor:"border-orange-200",label:"Stok Keluar"},USER_LOGIN:{icon:"LogIn",color:"text-purple-600",bgColor:"bg-purple-50",borderColor:"border-purple-200",label:"Login"}}[type]||{icon:"Activity",color:"text-gray-600",bgColor:"bg-gray-50",borderColor:"border-gray-200",label:"Aktivitas"};return{...config,icon:iconOverride||config.icon}},activityFilters=[{value:"all",label:"Semua",icon:"ListFilter"},{value:"ORDER",label:"Pesanan",icon:"ShoppingCart"},{value:"PAYMENT",label:"Pembayaran",icon:"Banknote"},{value:"STOCK",label:"Stok",icon:"Package"}],ITEMS_PER_PAGE_OPTIONS=[10,25,50];function ActivityPage(){const[selectedFilter,setSelectedFilter]=reactExports.useState("all"),[currentPage,setCurrentPage]=reactExports.useState(1),[itemsPerPage,setItemsPerPage]=reactExports.useState(10),[activities,setActivities]=reactExports.useState([]),[meta,setMeta]=reactExports.useState(null),[isLoading,setIsLoading]=reactExports.useState(!0),[error,setError]=reactExports.useState(null);reactExports.useEffect(()=>{(async()=>{try{setIsLoading(!0),setError(null);let typeParam;selectedFilter==="ORDER"?typeParam="ORDER_NEW":selectedFilter==="PAYMENT"?typeParam="PAYMENT_RECEIVED":selectedFilter==="STOCK"?typeParam="STOCK_IN":selectedFilter!=="all"&&(typeParam=selectedFilter);const response=await activityApi.getAll(currentPage,itemsPerPage,typeParam);setActivities(response.data),setMeta(response.meta)}catch(err){console.error("Failed to fetch activities:",err),setError("Gagal memuat riwayat aktivitas")}finally{setIsLoading(!1)}})()},[currentPage,itemsPerPage,selectedFilter]);const stats=reactExports.useMemo(()=>({total:meta?.total||0,showing:activities.length}),[meta,activities]),handleFilterChange=filter=>{setSelectedFilter(filter),setCurrentPage(1)},totalPages=meta?.totalPages||1,getPaginationItems=()=>{const items=[];if(totalPages<=5)for(let i=1;i<=totalPages;i++)items.push(i);else currentPage<=3?items.push(1,2,3,4,"ellipsis",totalPages):currentPage>=totalPages-2?items.push(1,"ellipsis",totalPages-3,totalPages-2,totalPages-1,totalPages):items.push(1,"ellipsis",currentPage-1,currentPage,currentPage+1,"ellipsis",totalPages);return items};return jsxRuntimeExports.jsxs("div",{className:"flex-1 space-y-6 p-4 sm:p-6 lg:p-8 bg-gradient-to-br from-background via-background to-muted/20",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-1",children:[jsxRuntimeExports.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold tracking-tight flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"History",className:"h-7 w-7 text-primary"}),"Riwayat Aktivitas"]}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground text-sm sm:text-base",children:"Pantau semua aktivitas sistem secara real-time"})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:jsxRuntimeExports.jsxs(Badge,{variant:"outline",className:"px-3 py-1.5 text-sm font-medium",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Database",className:"h-4 w-4 mr-1.5"}),stats.total.toLocaleString("id-ID")," Total"]})})]}),jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2",children:activityFilters.map(filter=>jsxRuntimeExports.jsxs(Button,{variant:selectedFilter===filter.value?"default":"outline",size:"sm",className:`gap-2 transition-all duration-200 ${selectedFilter===filter.value?"shadow-md scale-105":"hover:scale-[1.02]"}`,onClick:()=>handleFilterChange(filter.value),children:[jsxRuntimeExports.jsx(SafeIcon,{name:filter.icon,className:"h-4 w-4"}),filter.label]},filter.value))}),jsxRuntimeExports.jsxs(Card,{className:"shadow-lg border-0 bg-card/50 backdrop-blur",children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-4",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Timeline Aktivitas"}),jsxRuntimeExports.jsxs(CardDescription,{children:["Menampilkan ",stats.showing," dari ",stats.total," aktivitas"]})]}),jsxRuntimeExports.jsxs(Select,{value:itemsPerPage.toString(),onValueChange:v=>{setItemsPerPage(Number(v)),setCurrentPage(1)},children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-32",children:jsxRuntimeExports.jsx(SelectValue,{})}),jsxRuntimeExports.jsx(SelectContent,{children:ITEMS_PER_PAGE_OPTIONS.map(opt=>jsxRuntimeExports.jsxs(SelectItem,{value:opt.toString(),children:[opt," per halaman"]},opt))})]})]})}),jsxRuntimeExports.jsxs(CardContent,{children:[isLoading?jsxRuntimeExports.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((_,i)=>jsxRuntimeExports.jsxs("div",{className:"flex gap-4 animate-pulse",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center",children:[jsxRuntimeExports.jsx(Skeleton,{className:"h-10 w-10 rounded-full"}),jsxRuntimeExports.jsx(Skeleton,{className:"w-0.5 h-12 mt-2"})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 space-y-2 pb-4",children:[jsxRuntimeExports.jsx(Skeleton,{className:"h-5 w-1/3"}),jsxRuntimeExports.jsx(Skeleton,{className:"h-4 w-2/3"}),jsxRuntimeExports.jsx(Skeleton,{className:"h-3 w-1/4"})]})]},i))}):error?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[jsxRuntimeExports.jsx("div",{className:"h-16 w-16 rounded-full bg-destructive/10 flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx(SafeIcon,{name:"AlertTriangle",className:"h-8 w-8 text-destructive"})}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Terjadi Kesalahan"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground mb-4",children:error}),jsxRuntimeExports.jsxs(Button,{onClick:()=>window.location.reload(),children:[jsxRuntimeExports.jsx(SafeIcon,{name:"RefreshCw",className:"h-4 w-4 mr-2"}),"Coba Lagi"]})]}):activities.length===0?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[jsxRuntimeExports.jsx("div",{className:"h-20 w-20 rounded-full bg-muted flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Inbox",className:"h-10 w-10 text-muted-foreground"})}),jsxRuntimeExports.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Belum Ada Aktivitas"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground max-w-sm",children:"Aktivitas sistem akan muncul di sini saat pesanan dibuat, pembayaran diterima, atau stok diperbarui."})]}):jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("div",{className:"absolute left-5 top-0 bottom-0 w-0.5 bg-gradient-to-b from-primary/50 via-primary/20 to-transparent hidden sm:block"}),jsxRuntimeExports.jsx("div",{className:"space-y-1",children:activities.map((activity,index)=>{const config=getActivityConfig(activity.type,activity.icon_name);return jsxRuntimeExports.jsxs("div",{className:"relative flex gap-4 group",style:{animationDelay:`${index*50}ms`},children:[jsxRuntimeExports.jsx("div",{className:"hidden sm:flex flex-col items-center z-10",children:jsxRuntimeExports.jsx("div",{className:`h-10 w-10 rounded-full ${config.bgColor} border-2 ${config.borderColor} flex items-center justify-center shadow-sm group-hover:scale-110 transition-transform duration-200`,children:jsxRuntimeExports.jsx(SafeIcon,{name:config.icon,className:`h-5 w-5 ${config.color}`})})}),jsxRuntimeExports.jsxs("div",{className:`flex-1 p-4 rounded-xl border ${config.borderColor} ${config.bgColor} group-hover:shadow-md transition-all duration-200 mb-3`,children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start justify-between gap-2 mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:`sm:hidden h-8 w-8 rounded-full ${config.bgColor} border ${config.borderColor} flex items-center justify-center`,children:jsxRuntimeExports.jsx(SafeIcon,{name:config.icon,className:`h-4 w-4 ${config.color}`})}),jsxRuntimeExports.jsx("h4",{className:"font-semibold text-foreground",children:activity.title})]}),jsxRuntimeExports.jsx(Badge,{variant:"secondary",className:`text-xs ${config.bgColor} ${config.color} border ${config.borderColor} w-fit`,children:config.label})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:activity.description||activity.pangkalan_name||"Tidak ada detail"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-xs text-muted-foreground",children:[jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Clock",className:"h-3.5 w-3.5"}),formatRelativeTime(activity.timestamp)]}),activity.users&&jsxRuntimeExports.jsxs("span",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"User",className:"h-3.5 w-3.5"}),activity.users.name]}),activity.detail_numeric&&jsxRuntimeExports.jsxs("span",{className:"font-semibold text-primary flex items-center gap-1",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Package",className:"h-3.5 w-3.5"}),activity.detail_numeric.toLocaleString("id-ID")," tabung"]})]})]})]},activity.id)})})]}),meta&&meta.totalPages>1&&!isLoading&&!error&&jsxRuntimeExports.jsx("div",{className:"mt-6 pt-6 border-t",children:jsxRuntimeExports.jsx(Pagination,{children:jsxRuntimeExports.jsxs(PaginationContent,{children:[jsxRuntimeExports.jsx(PaginationItem,{children:jsxRuntimeExports.jsx(PaginationPrevious,{href:"#",onClick:e=>{e.preventDefault(),currentPage>1&&setCurrentPage(p=>p-1)},className:currentPage===1?"pointer-events-none opacity-50":"cursor-pointer"})}),getPaginationItems().map((item,i)=>jsxRuntimeExports.jsx(PaginationItem,{children:item==="ellipsis"?jsxRuntimeExports.jsx(PaginationEllipsis,{}):jsxRuntimeExports.jsx(PaginationLink,{href:"#",isActive:item===currentPage,onClick:e=>{e.preventDefault(),setCurrentPage(item)},className:"cursor-pointer",children:item})},i)),jsxRuntimeExports.jsx(PaginationItem,{children:jsxRuntimeExports.jsx(PaginationNext,{href:"#",onClick:e=>{e.preventDefault(),currentPage<totalPages&&setCurrentPage(p=>p+1)},className:currentPage===totalPages?"pointer-events-none opacity-50":"cursor-pointer"})})]})})})]})]})]})}export{ActivityPage as default};
