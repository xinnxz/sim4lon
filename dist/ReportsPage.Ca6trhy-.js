const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index.es.VyUtMH7_.js","./index.DcciWILN.js","./jsx-runtime.mvtouYz0.js","./card.SxAweRZB.js","./SafeIcon.C08LGL0m.js","./tabs.BjBpM8Dk.js","./index.CmV6gt94.js","./index.PIAPtHoh.js","./index.ubNQCTBn.js","./index.DNfkKfAg.js","./index.CZLqkOjo.js","./index.CLV08RI1.js","./index.BB0xO63c.js","./index.Drh0kMGk.js","./index.Ci_bviUJ.js","./select.CdiqpKGf.js","./index.DGt6JTY0.js","./Combination.wteLWZ5f.js","./index.D7stNVgX.js","./index.Bcho8R2B.js","./index.BhA3i5Wo.js","./index.DQFEM45L.js","./chevron-up.CkJSkLmv.js","./check.bOXrmBHo.js","./input.B0jSBU-X.js","./badge.BFgaaq5n.js","./Tilt3DCard.PsjhSQ2O.js","./use3DTilt.Dcq4iilr.js","./api.B5PpFILw.js","./index.fAd_ikgp.js","./generateCategoricalChart.Crqe-OLF.js","./LineChart.DBAKq2J_.js","./PieChart.DJGyav3p.js","./BarChart.ffT2CUX_.js"])))=>i.map(i=>d[i]);
import{j as jsxRuntimeExports}from"./jsx-runtime.mvtouYz0.js";import{r as reactExports}from"./index.DcciWILN.js";import{C as Card,d as CardContent,a as CardHeader,b as CardTitle,c as CardDescription}from"./card.SxAweRZB.js";import{T as Tabs,a as TabsList,b as TabsTrigger,c as TabsContent}from"./tabs.BjBpM8Dk.js";import{_ as __vitePreload,S as SafeIcon,B as Button}from"./SafeIcon.C08LGL0m.js";import{S as Select,a as SelectTrigger,b as SelectValue,c as SelectContent,d as SelectItem}from"./select.CdiqpKGf.js";import{I as Input}from"./input.B0jSBU-X.js";import{B as Badge}from"./badge.BFgaaq5n.js";import{T as Tilt3DCard}from"./Tilt3DCard.PsjhSQ2O.js";import{reportsApi}from"./api.B5PpFILw.js";import{t as toast}from"./index.fAd_ikgp.js";import{R as ResponsiveContainer,T as Tooltip,L as Legend,C as Cell$1,B as Bar}from"./generateCategoricalChart.Crqe-OLF.js";import{L as LineChart,C as CartesianGrid,X as XAxis,Y as YAxis,a as Line}from"./LineChart.DBAKq2J_.js";import{P as PieChart,a as Pie}from"./PieChart.DJGyav3p.js";import{B as BarChart}from"./BarChart.ffT2CUX_.js";function _typeof(o2){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o3){return typeof o3}:function(o3){return o3&&typeof Symbol=="function"&&o3.constructor===Symbol&&o3!==Symbol.prototype?"symbol":typeof o3},_typeof(o2)}var u8=Uint8Array,u16=Uint16Array,i32=Int32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(eb,start){for(var b2=new u16(31),i2=0;i2<31;++i2)b2[i2]=start+=1<<eb[i2-1];for(var r=new i32(b2[30]),i2=1;i2<30;++i2)for(var j2=b2[i2];j2<b2[i2+1];++j2)r[j2]=j2-b2[i2]<<5|i2;return{b:b2,r}},_a$1=freb(fleb,2),fl=_a$1.b,revfl=_a$1.r;fl[28]=258,revfl[258]=28;var _b=freb(fdeb,0),revfd=_b.r,rev=new u16(32768);for(var i$1=0;i$1<32768;++i$1){var x$1=(i$1&43690)>>1|(i$1&21845)<<1;x$1=(x$1&52428)>>2|(x$1&13107)<<2,x$1=(x$1&61680)>>4|(x$1&3855)<<4,rev[i$1]=((x$1&65280)>>8|(x$1&255)<<8)>>1}var hMap=(function(cd,mb,r){for(var s2=cd.length,i2=0,l2=new u16(mb);i2<s2;++i2)cd[i2]&&++l2[cd[i2]-1];var le2=new u16(mb);for(i2=1;i2<mb;++i2)le2[i2]=le2[i2-1]+l2[i2-1]<<1;var co;if(r){co=new u16(1<<mb);var rvb=15-mb;for(i2=0;i2<s2;++i2)if(cd[i2])for(var sv=i2<<4|cd[i2],r_1=mb-cd[i2],v2=le2[cd[i2]-1]++<<r_1,m2=v2|(1<<r_1)-1;v2<=m2;++v2)co[rev[v2]>>rvb]=sv}else for(co=new u16(s2),i2=0;i2<s2;++i2)cd[i2]&&(co[i2]=rev[le2[cd[i2]-1]++]>>15-cd[i2]);return co}),flt=new u8(288);for(var i$1=0;i$1<144;++i$1)flt[i$1]=8;for(var i$1=144;i$1<256;++i$1)flt[i$1]=9;for(var i$1=256;i$1<280;++i$1)flt[i$1]=7;for(var i$1=280;i$1<288;++i$1)flt[i$1]=8;var fdt=new u8(32);for(var i$1=0;i$1<32;++i$1)fdt[i$1]=5;var flm=hMap(flt,9,0),fdm=hMap(fdt,5,0),shft=function(p2){return(p2+7)/8|0},slc=function(v2,s2,e){return(e==null||e>v2.length)&&(e=v2.length),new u8(v2.subarray(s2,e))},wbits=function(d2,p2,v2){v2<<=p2&7;var o2=p2/8|0;d2[o2]|=v2,d2[o2+1]|=v2>>8},wbits16=function(d2,p2,v2){v2<<=p2&7;var o2=p2/8|0;d2[o2]|=v2,d2[o2+1]|=v2>>8,d2[o2+2]|=v2>>16},hTree=function(d2,mb){for(var t2=[],i2=0;i2<d2.length;++i2)d2[i2]&&t2.push({s:i2,f:d2[i2]});var s2=t2.length,t22=t2.slice();if(!s2)return{t:et$1,l:0};if(s2==1){var v2=new u8(t2[0].s+1);return v2[t2[0].s]=1,{t:v2,l:1}}t2.sort(function(a2,b2){return a2.f-b2.f}),t2.push({s:-1,f:25001});var l2=t2[0],r=t2[1],i0=0,i1=1,i22=2;for(t2[0]={s:-1,f:l2.f+r.f,l:l2,r};i1!=s2-1;)l2=t2[t2[i0].f<t2[i22].f?i0++:i22++],r=t2[i0!=i1&&t2[i0].f<t2[i22].f?i0++:i22++],t2[i1++]={s:-1,f:l2.f+r.f,l:l2,r};for(var maxSym=t22[0].s,i2=1;i2<s2;++i2)t22[i2].s>maxSym&&(maxSym=t22[i2].s);var tr=new u16(maxSym+1),mbt=ln(t2[i1-1],tr,0);if(mbt>mb){var i2=0,dt2=0,lft=mbt-mb,cst=1<<lft;for(t22.sort(function(a2,b2){return tr[b2.s]-tr[a2.s]||a2.f-b2.f});i2<s2;++i2){var i2_1=t22[i2].s;if(tr[i2_1]>mb)dt2+=cst-(1<<mbt-tr[i2_1]),tr[i2_1]=mb;else break}for(dt2>>=lft;dt2>0;){var i2_2=t22[i2].s;tr[i2_2]<mb?dt2-=1<<mb-tr[i2_2]++-1:++i2}for(;i2>=0&&dt2;--i2){var i2_3=t22[i2].s;tr[i2_3]==mb&&(--tr[i2_3],++dt2)}mbt=mb}return{t:new u8(tr),l:mbt}},ln=function(n,l2,d2){return n.s==-1?Math.max(ln(n.l,l2,d2+1),ln(n.r,l2,d2+1)):l2[n.s]=d2},lc=function(c2){for(var s2=c2.length;s2&&!c2[--s2];);for(var cl=new u16(++s2),cli=0,cln=c2[0],cls=1,w2=function(v2){cl[cli++]=v2},i2=1;i2<=s2;++i2)if(c2[i2]==cln&&i2!=s2)++cls;else{if(!cln&&cls>2){for(;cls>138;cls-=138)w2(32754);cls>2&&(w2(cls>10?cls-11<<5|28690:cls-3<<5|12305),cls=0)}else if(cls>3){for(w2(cln),--cls;cls>6;cls-=6)w2(8304);cls>2&&(w2(cls-3<<5|8208),cls=0)}for(;cls--;)w2(cln);cls=1,cln=c2[i2]}return{c:cl.subarray(0,cli),n:s2}},clen=function(cf,cl){for(var l2=0,i2=0;i2<cl.length;++i2)l2+=cf[i2]*cl[i2];return l2},wfblk=function(out,pos,dat){var s2=dat.length,o2=shft(pos+2);out[o2]=s2&255,out[o2+1]=s2>>8,out[o2+2]=out[o2]^255,out[o2+3]=out[o2+1]^255;for(var i2=0;i2<s2;++i2)out[o2+i2+4]=dat[i2];return(o2+4+s2)*8},wblk=function(dat,out,final,syms,lf,df,eb,li,bs,bl,p2){wbits(out,p2++,final),++lf[256];for(var _a2=hTree(lf,15),dlt=_a2.t,mlb=_a2.l,_b2=hTree(df,15),ddt=_b2.t,mdb=_b2.l,_c=lc(dlt),lclt=_c.c,nlc=_c.n,_d=lc(ddt),lcdt=_d.c,ndc=_d.n,lcfreq=new u16(19),i2=0;i2<lclt.length;++i2)++lcfreq[lclt[i2]&31];for(var i2=0;i2<lcdt.length;++i2)++lcfreq[lcdt[i2]&31];for(var _e2=hTree(lcfreq,7),lct=_e2.t,mlcb=_e2.l,nlcc=19;nlcc>4&&!lct[clim[nlcc-1]];--nlcc);var flen=bl+5<<3,ftlen=clen(lf,flt)+clen(df,fdt)+eb,dtlen=clen(lf,dlt)+clen(df,ddt)+eb+14+3*nlcc+clen(lcfreq,lct)+2*lcfreq[16]+3*lcfreq[17]+7*lcfreq[18];if(bs>=0&&flen<=ftlen&&flen<=dtlen)return wfblk(out,p2,dat.subarray(bs,bs+bl));var lm,ll,dm,dl;if(wbits(out,p2,1+(dtlen<ftlen)),p2+=2,dtlen<ftlen){lm=hMap(dlt,mlb,0),ll=dlt,dm=hMap(ddt,mdb,0),dl=ddt;var llm=hMap(lct,mlcb,0);wbits(out,p2,nlc-257),wbits(out,p2+5,ndc-1),wbits(out,p2+10,nlcc-4),p2+=14;for(var i2=0;i2<nlcc;++i2)wbits(out,p2+3*i2,lct[clim[i2]]);p2+=3*nlcc;for(var lcts=[lclt,lcdt],it2=0;it2<2;++it2)for(var clct=lcts[it2],i2=0;i2<clct.length;++i2){var len=clct[i2]&31;wbits(out,p2,llm[len]),p2+=lct[len],len>15&&(wbits(out,p2,clct[i2]>>5&127),p2+=clct[i2]>>12)}}else lm=flm,ll=flt,dm=fdm,dl=fdt;for(var i2=0;i2<li;++i2){var sym=syms[i2];if(sym>255){var len=sym>>18&31;wbits16(out,p2,lm[len+257]),p2+=ll[len+257],len>7&&(wbits(out,p2,sym>>23&31),p2+=fleb[len]);var dst=sym&31;wbits16(out,p2,dm[dst]),p2+=dl[dst],dst>3&&(wbits16(out,p2,sym>>5&8191),p2+=fdeb[dst])}else wbits16(out,p2,lm[sym]),p2+=ll[sym]}return wbits16(out,p2,lm[256]),p2+ll[256]},deo=new i32([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),et$1=new u8(0),dflt=function(dat,lvl,plvl,pre,post,st2){var s2=st2.z||dat.length,o2=new u8(pre+s2+5*(1+Math.ceil(s2/7e3))+post),w2=o2.subarray(pre,o2.length-post),lst=st2.l,pos=(st2.r||0)&7;if(lvl){pos&&(w2[0]=st2.r>>3);for(var opt=deo[lvl-1],n=opt>>13,c2=opt&8191,msk_1=(1<<plvl)-1,prev=st2.p||new u16(32768),head=st2.h||new u16(msk_1+1),bs1_1=Math.ceil(plvl/3),bs2_1=2*bs1_1,hsh=function(i3){return(dat[i3]^dat[i3+1]<<bs1_1^dat[i3+2]<<bs2_1)&msk_1},syms=new i32(25e3),lf=new u16(288),df=new u16(32),lc_1=0,eb=0,i2=st2.i||0,li=0,wi=st2.w||0,bs=0;i2+2<s2;++i2){var hv=hsh(i2),imod=i2&32767,pimod=head[hv];if(prev[imod]=pimod,head[hv]=imod,wi<=i2){var rem=s2-i2;if((lc_1>7e3||li>24576)&&(rem>423||!lst)){pos=wblk(dat,w2,0,syms,lf,df,eb,li,bs,i2-bs,pos),li=lc_1=eb=0,bs=i2;for(var j2=0;j2<286;++j2)lf[j2]=0;for(var j2=0;j2<30;++j2)df[j2]=0}var l2=2,d2=0,ch_1=c2,dif=imod-pimod&32767;if(rem>2&&hv==hsh(i2-dif))for(var maxn=Math.min(n,rem)-1,maxd=Math.min(32767,i2),ml=Math.min(258,rem);dif<=maxd&&--ch_1&&imod!=pimod;){if(dat[i2+l2]==dat[i2+l2-dif]){for(var nl=0;nl<ml&&dat[i2+nl]==dat[i2+nl-dif];++nl);if(nl>l2){if(l2=nl,d2=dif,nl>maxn)break;for(var mmd=Math.min(dif,nl-2),md=0,j2=0;j2<mmd;++j2){var ti=i2-dif+j2&32767,pti=prev[ti],cd=ti-pti&32767;cd>md&&(md=cd,pimod=ti)}}}imod=pimod,pimod=prev[imod],dif+=imod-pimod&32767}if(d2){syms[li++]=268435456|revfl[l2]<<18|revfd[d2];var lin=revfl[l2]&31,din=revfd[d2]&31;eb+=fleb[lin]+fdeb[din],++lf[257+lin],++df[din],wi=i2+l2,++lc_1}else syms[li++]=dat[i2],++lf[dat[i2]]}}for(i2=Math.max(i2,wi);i2<s2;++i2)syms[li++]=dat[i2],++lf[dat[i2]];pos=wblk(dat,w2,lst,syms,lf,df,eb,li,bs,i2-bs,pos),lst||(st2.r=pos&7|w2[pos/8|0]<<3,pos-=7,st2.h=head,st2.p=prev,st2.i=i2,st2.w=wi)}else{for(var i2=st2.w||0;i2<s2+lst;i2+=65535){var e=i2+65535;e>=s2&&(w2[pos/8|0]=lst,e=s2),pos=wfblk(w2,pos+1,dat.subarray(i2,e))}st2.i=s2}return slc(o2,0,pre+shft(pos)+post)},adler=function(){var a2=1,b2=0;return{p:function(d2){for(var n=a2,m2=b2,l2=d2.length|0,i2=0;i2!=l2;){for(var e=Math.min(i2+2655,l2);i2<e;++i2)m2+=n+=d2[i2];n=(n&65535)+15*(n>>16),m2=(m2&65535)+15*(m2>>16)}a2=n,b2=m2},d:function(){return a2%=65521,b2%=65521,(a2&255)<<24|(a2&65280)<<8|(b2&255)<<8|b2>>8}}},dopt=function(dat,opt,pre,post,st2){if(!st2&&(st2={l:1},opt.dictionary)){var dict=opt.dictionary.subarray(-32768),newDat=new u8(dict.length+dat.length);newDat.set(dict),newDat.set(dat,dict.length),dat=newDat,st2.w=dict.length}return dflt(dat,opt.level==null?6:opt.level,opt.mem==null?st2.l?Math.ceil(Math.max(8,Math.min(13,Math.log(dat.length)))*1.5):20:12+opt.mem,pre,post,st2)},wbytes=function(d2,b2,v2){for(;v2;++b2)d2[b2]=v2,v2>>>=8},zlh=function(c2,o2){var lv=o2.level,fl2=lv==0?0:lv<6?1:lv==9?3:2;if(c2[0]=120,c2[1]=fl2<<6|(o2.dictionary&&32),c2[1]|=31-(c2[0]<<8|c2[1])%31,o2.dictionary){var h2=adler();h2.p(o2.dictionary),wbytes(c2,2,h2.d())}};function zlibSync(data,opts){opts||(opts={});var a2=adler();a2.p(data);var d2=dopt(data,opts,opts.dictionary?6:2,4);return zlh(d2,opts),wbytes(d2,d2.length-4,a2.d()),d2}var td=typeof TextDecoder<"u"&&new TextDecoder,tds=0;try{td.decode(et$1,{stream:!0}),tds=1}catch{}function _arrayWithHoles(r){if(Array.isArray(r))return r}function _iterableToArrayLimit(r,l2){var t2=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t2!=null){var e,n,i2,u2,a2=[],f2=!0,o2=!1;try{if(i2=(t2=t2.call(r)).next,l2!==0)for(;!(f2=(e=i2.call(t2)).done)&&(a2.push(e.value),a2.length!==l2);f2=!0);}catch(r2){o2=!0,n=r2}finally{try{if(!f2&&t2.return!=null&&(u2=t2.return(),Object(u2)!==u2))return}finally{if(o2)throw n}}return a2}}function _arrayLikeToArray(r,a2){(a2==null||a2>r.length)&&(a2=r.length);for(var e=0,n=Array(a2);e<a2;e++)n[e]=r[e];return n}function _unsupportedIterableToArray(r,a2){if(r){if(typeof r=="string")return _arrayLikeToArray(r,a2);var t2={}.toString.call(r).slice(8,-1);return t2==="Object"&&r.constructor&&(t2=r.constructor.name),t2==="Map"||t2==="Set"?Array.from(r):t2==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t2)?_arrayLikeToArray(r,a2):void 0}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest()}function decode(bytes,encoding="utf8"){return new TextDecoder(encoding).decode(bytes)}const encoder=new TextEncoder;function encode(str){return encoder.encode(str)}const defaultByteLength=1024*8,hostBigEndian=(()=>{const array=new Uint8Array(4),view=new Uint32Array(array.buffer);return!((view[0]=1)&array[0])})(),typedArrays={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class IOBuffer{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(data=defaultByteLength,options={}){let dataIsGiven=!1;typeof data=="number"?data=new ArrayBuffer(data):(dataIsGiven=!0,this.lastWrittenByte=data.byteLength);const offset=options.offset?options.offset>>>0:0,byteLength=data.byteLength-offset;let dvOffset=offset;(ArrayBuffer.isView(data)||data instanceof IOBuffer)&&(data.byteLength!==data.buffer.byteLength&&(dvOffset=data.byteOffset+offset),data=data.buffer),dataIsGiven?this.lastWrittenByte=byteLength:this.lastWrittenByte=0,this.buffer=data,this.length=byteLength,this.byteLength=byteLength,this.byteOffset=dvOffset,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,dvOffset,byteLength),this._mark=0,this._marks=[]}available(byteLength=1){return this.offset+byteLength<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(n=1){return this.offset+=n,this}back(n=1){return this.offset-=n,this}seek(offset){return this.offset=offset,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const offset=this._marks.pop();if(offset===void 0)throw new Error("Mark stack empty");return this.seek(offset),this}rewind(){return this.offset=0,this}ensureAvailable(byteLength=1){if(!this.available(byteLength)){const newLength=(this.offset+byteLength)*2,newArray=new Uint8Array(newLength);newArray.set(new Uint8Array(this.buffer)),this.buffer=newArray.buffer,this.length=newLength,this.byteLength=newLength,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(n=1){return this.readArray(n,"uint8")}readArray(size,type){const bytes=typedArrays[type].BYTES_PER_ELEMENT*size,offset=this.byteOffset+this.offset,slice=this.buffer.slice(offset,offset+bytes);if(this.littleEndian===hostBigEndian&&type!=="uint8"&&type!=="int8"){const slice2=new Uint8Array(this.buffer.slice(offset,offset+bytes));slice2.reverse();const returnArray2=new typedArrays[type](slice2.buffer);return this.offset+=bytes,returnArray2.reverse(),returnArray2}const returnArray=new typedArrays[type](slice);return this.offset+=bytes,returnArray}readInt16(){const value=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,value}readUint16(){const value=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,value}readInt32(){const value=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,value}readUint32(){const value=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,value}readFloat32(){const value=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,value}readFloat64(){const value=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,value}readBigInt64(){const value=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,value}readBigUint64(){const value=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,value}readChar(){return String.fromCharCode(this.readInt8())}readChars(n=1){let result="";for(let i2=0;i2<n;i2++)result+=this.readChar();return result}readUtf8(n=1){return decode(this.readBytes(n))}decodeText(n=1,encoding="utf8"){return decode(this.readBytes(n),encoding)}writeBoolean(value){return this.writeUint8(value?255:0),this}writeInt8(value){return this.ensureAvailable(1),this._data.setInt8(this.offset++,value),this._updateLastWrittenByte(),this}writeUint8(value){return this.ensureAvailable(1),this._data.setUint8(this.offset++,value),this._updateLastWrittenByte(),this}writeByte(value){return this.writeUint8(value)}writeBytes(bytes){this.ensureAvailable(bytes.length);for(let i2=0;i2<bytes.length;i2++)this._data.setUint8(this.offset++,bytes[i2]);return this._updateLastWrittenByte(),this}writeInt16(value){return this.ensureAvailable(2),this._data.setInt16(this.offset,value,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(value){return this.ensureAvailable(2),this._data.setUint16(this.offset,value,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(value){return this.ensureAvailable(4),this._data.setInt32(this.offset,value,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(value){return this.ensureAvailable(4),this._data.setUint32(this.offset,value,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(value){return this.ensureAvailable(4),this._data.setFloat32(this.offset,value,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(value){return this.ensureAvailable(8),this._data.setFloat64(this.offset,value,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(value){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,value,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(value){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,value,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(str){return this.writeUint8(str.charCodeAt(0))}writeChars(str){for(let i2=0;i2<str.length;i2++)this.writeUint8(str.charCodeAt(i2));return this}writeUtf8(str){return this.writeBytes(encode(str))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function zero$1(buf){let len=buf.length;for(;--len>=0;)buf[len]=0}const MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);const static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);const _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);const _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);const base_length=new Array(LENGTH_CODES$1);zero$1(base_length);const base_dist=new Array(D_CODES$1);zero$1(base_dist);const adler32=(adler2,buf,len,pos)=>{let s1=adler2&65535|0,s2=adler2>>>16&65535|0,n=0;for(;len!==0;){n=len>2e3?2e3:len,len-=n;do s1=s1+buf[pos++]|0,s2=s2+s1|0;while(--n);s1%=65521,s2%=65521}return s1|s2<<16|0};var adler32_1=adler32;const makeTable=()=>{let c2,table=[];for(var n=0;n<256;n++){c2=n;for(var k2=0;k2<8;k2++)c2=c2&1?3988292384^c2>>>1:c2>>>1;table[n]=c2}return table},crcTable$1=new Uint32Array(makeTable()),crc32=(crc2,buf,len,pos)=>{const t2=crcTable$1,end=pos+len;crc2^=-1;for(let i2=pos;i2<end;i2++)crc2=crc2>>>8^t2[(crc2^buf[i2])&255];return crc2^-1};var crc32_1=crc32,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const _has=(obj,key)=>Object.prototype.hasOwnProperty.call(obj,key);var assign$1=function(obj){const sources=Array.prototype.slice.call(arguments,1);for(;sources.length;){const source=sources.shift();if(source){if(typeof source!="object")throw new TypeError(source+"must be non-object");for(const p2 in source)_has(source,p2)&&(obj[p2]=source[p2])}}return obj},flattenChunks=chunks=>{let len=0;for(let i2=0,l2=chunks.length;i2<l2;i2++)len+=chunks[i2].length;const result=new Uint8Array(len);for(let i2=0,pos=0,l2=chunks.length;i2<l2;i2++){let chunk=chunks[i2];result.set(chunk,pos),pos+=chunk.length}return result},common={assign:assign$1,flattenChunks};let STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{STR_APPLY_UIA_OK=!1}const _utf8len=new Uint8Array(256);for(let q2=0;q2<256;q2++)_utf8len[q2]=q2>=252?6:q2>=248?5:q2>=240?4:q2>=224?3:q2>=192?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=str=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(str);let buf,c2,c22,m_pos,i2,str_len=str.length,buf_len=0;for(m_pos=0;m_pos<str_len;m_pos++)c2=str.charCodeAt(m_pos),(c2&64512)===55296&&m_pos+1<str_len&&(c22=str.charCodeAt(m_pos+1),(c22&64512)===56320&&(c2=65536+(c2-55296<<10)+(c22-56320),m_pos++)),buf_len+=c2<128?1:c2<2048?2:c2<65536?3:4;for(buf=new Uint8Array(buf_len),i2=0,m_pos=0;i2<buf_len;m_pos++)c2=str.charCodeAt(m_pos),(c2&64512)===55296&&m_pos+1<str_len&&(c22=str.charCodeAt(m_pos+1),(c22&64512)===56320&&(c2=65536+(c2-55296<<10)+(c22-56320),m_pos++)),c2<128?buf[i2++]=c2:c2<2048?(buf[i2++]=192|c2>>>6,buf[i2++]=128|c2&63):c2<65536?(buf[i2++]=224|c2>>>12,buf[i2++]=128|c2>>>6&63,buf[i2++]=128|c2&63):(buf[i2++]=240|c2>>>18,buf[i2++]=128|c2>>>12&63,buf[i2++]=128|c2>>>6&63,buf[i2++]=128|c2&63);return buf};const buf2binstring=(buf,len)=>{if(len<65534&&buf.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,buf.length===len?buf:buf.subarray(0,len));let result="";for(let i2=0;i2<len;i2++)result+=String.fromCharCode(buf[i2]);return result};var buf2string=(buf,max)=>{const len=max||buf.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(buf.subarray(0,max));let i2,out;const utf16buf=new Array(len*2);for(out=0,i2=0;i2<len;){let c2=buf[i2++];if(c2<128){utf16buf[out++]=c2;continue}let c_len=_utf8len[c2];if(c_len>4){utf16buf[out++]=65533,i2+=c_len-1;continue}for(c2&=c_len===2?31:c_len===3?15:7;c_len>1&&i2<len;)c2=c2<<6|buf[i2++]&63,c_len--;if(c_len>1){utf16buf[out++]=65533;continue}c2<65536?utf16buf[out++]=c2:(c2-=65536,utf16buf[out++]=55296|c2>>10&1023,utf16buf[out++]=56320|c2&1023)}return buf2binstring(utf16buf,out)},utf8border=(buf,max)=>{max=max||buf.length,max>buf.length&&(max=buf.length);let pos=max-1;for(;pos>=0&&(buf[pos]&192)===128;)pos--;return pos<0||pos===0?max:pos+_utf8len[buf[pos]]>max?pos:max},strings={string2buf,buf2string,utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream;const BAD$1=16209,TYPE$1=16191;var inffast=function(strm,start){let _in,last,_out,beg,end,dmax,wsize,whave,wnext,s_window,hold,bits,lcode,dcode,lmask,dmask,here,op,len,dist,from,from_source,input,output;const state=strm.state;_in=strm.next_in,input=strm.input,last=_in+(strm.avail_in-5),_out=strm.next_out,output=strm.output,beg=_out-(start-strm.avail_out),end=_out+(strm.avail_out-257),dmax=state.dmax,wsize=state.wsize,whave=state.whave,wnext=state.wnext,s_window=state.window,hold=state.hold,bits=state.bits,lcode=state.lencode,dcode=state.distcode,lmask=(1<<state.lenbits)-1,dmask=(1<<state.distbits)-1;top:do{bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=lcode[hold&lmask];dolen:for(;;){if(op=here>>>24,hold>>>=op,bits-=op,op=here>>>16&255,op===0)output[_out++]=here&65535;else if(op&16){len=here&65535,op&=15,op&&(bits<op&&(hold+=input[_in++]<<bits,bits+=8),len+=hold&(1<<op)-1,hold>>>=op,bits-=op),bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=dcode[hold&dmask];dodist:for(;;){if(op=here>>>24,hold>>>=op,bits-=op,op=here>>>16&255,op&16){if(dist=here&65535,op&=15,bits<op&&(hold+=input[_in++]<<bits,bits+=8,bits<op&&(hold+=input[_in++]<<bits,bits+=8)),dist+=hold&(1<<op)-1,dist>dmax){strm.msg="invalid distance too far back",state.mode=BAD$1;break top}if(hold>>>=op,bits-=op,op=_out-beg,dist>op){if(op=dist-op,op>whave&&state.sane){strm.msg="invalid distance too far back",state.mode=BAD$1;break top}if(from=0,from_source=s_window,wnext===0){if(from+=wsize-op,op<len){len-=op;do output[_out++]=s_window[from++];while(--op);from=_out-dist,from_source=output}}else if(wnext<op){if(from+=wsize+wnext-op,op-=wnext,op<len){len-=op;do output[_out++]=s_window[from++];while(--op);if(from=0,wnext<len){op=wnext,len-=op;do output[_out++]=s_window[from++];while(--op);from=_out-dist,from_source=output}}}else if(from+=wnext-op,op<len){len-=op;do output[_out++]=s_window[from++];while(--op);from=_out-dist,from_source=output}for(;len>2;)output[_out++]=from_source[from++],output[_out++]=from_source[from++],output[_out++]=from_source[from++],len-=3;len&&(output[_out++]=from_source[from++],len>1&&(output[_out++]=from_source[from++]))}else{from=_out-dist;do output[_out++]=output[from++],output[_out++]=output[from++],output[_out++]=output[from++],len-=3;while(len>2);len&&(output[_out++]=output[from++],len>1&&(output[_out++]=output[from++]))}}else if((op&64)===0){here=dcode[(here&65535)+(hold&(1<<op)-1)];continue dodist}else{strm.msg="invalid distance code",state.mode=BAD$1;break top}break}}else if((op&64)===0){here=lcode[(here&65535)+(hold&(1<<op)-1)];continue dolen}else if(op&32){state.mode=TYPE$1;break top}else{strm.msg="invalid literal/length code",state.mode=BAD$1;break top}break}}while(_in<last&&_out<end);len=bits>>3,_in-=len,bits-=len<<3,hold&=(1<<bits)-1,strm.next_in=_in,strm.next_out=_out,strm.avail_in=_in<last?5+(last-_in):5-(_in-last),strm.avail_out=_out<end?257+(end-_out):257-(_out-end),state.hold=hold,state.bits=bits};const MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=(type,lens,lens_index,codes,table,table_index,work,opts)=>{const bits=opts.bits;let len=0,sym=0,min=0,max=0,root=0,curr=0,drop=0,left=0,used=0,huff=0,incr,fill2,low,mask,next,base=null,match;const count=new Uint16Array(MAXBITS+1),offs=new Uint16Array(MAXBITS+1);let extra=null,here_bits,here_op,here_val;for(len=0;len<=MAXBITS;len++)count[len]=0;for(sym=0;sym<codes;sym++)count[lens[lens_index+sym]]++;for(root=bits,max=MAXBITS;max>=1&&count[max]===0;max--);if(root>max&&(root=max),max===0)return table[table_index++]=1<<24|64<<16|0,table[table_index++]=1<<24|64<<16|0,opts.bits=1,0;for(min=1;min<max&&count[min]===0;min++);for(root<min&&(root=min),left=1,len=1;len<=MAXBITS;len++)if(left<<=1,left-=count[len],left<0)return-1;if(left>0&&(type===CODES$1||max!==1))return-1;for(offs[1]=0,len=1;len<MAXBITS;len++)offs[len+1]=offs[len]+count[len];for(sym=0;sym<codes;sym++)lens[lens_index+sym]!==0&&(work[offs[lens[lens_index+sym]]++]=sym);if(type===CODES$1?(base=extra=work,match=20):type===LENS$1?(base=lbase,extra=lext,match=257):(base=dbase,extra=dext,match=0),huff=0,sym=0,len=min,next=table_index,curr=root,drop=0,low=-1,used=1<<root,mask=used-1,type===LENS$1&&used>ENOUGH_LENS$1||type===DISTS$1&&used>ENOUGH_DISTS$1)return 1;for(;;){here_bits=len-drop,work[sym]+1<match?(here_op=0,here_val=work[sym]):work[sym]>=match?(here_op=extra[work[sym]-match],here_val=base[work[sym]-match]):(here_op=96,here_val=0),incr=1<<len-drop,fill2=1<<curr,min=fill2;do fill2-=incr,table[next+(huff>>drop)+fill2]=here_bits<<24|here_op<<16|here_val|0;while(fill2!==0);for(incr=1<<len-1;huff&incr;)incr>>=1;if(incr!==0?(huff&=incr-1,huff+=incr):huff=0,sym++,--count[len]===0){if(len===max)break;len=lens[lens_index+work[sym]]}if(len>root&&(huff&mask)!==low){for(drop===0&&(drop=root),next+=min,curr=len-drop,left=1<<curr;curr+drop<max&&(left-=count[curr+drop],!(left<=0));)curr++,left<<=1;if(used+=1<<curr,type===LENS$1&&used>ENOUGH_LENS$1||type===DISTS$1&&used>ENOUGH_DISTS$1)return 1;low=huff&mask,table[low]=root<<24|curr<<16|next-table_index|0}}return huff!==0&&(table[next+huff]=len-drop<<24|64<<16|0),opts.bits=root,0};var inftrees=inflate_table;const CODES=0,LENS=1,DISTS=2,{Z_FINISH:Z_FINISH$1,Z_BLOCK,Z_TREES,Z_OK:Z_OK$1,Z_STREAM_END:Z_STREAM_END$1,Z_NEED_DICT:Z_NEED_DICT$1,Z_STREAM_ERROR:Z_STREAM_ERROR$1,Z_DATA_ERROR:Z_DATA_ERROR$1,Z_MEM_ERROR:Z_MEM_ERROR$1,Z_BUF_ERROR,Z_DEFLATED}=constants$2,HEAD=16180,FLAGS=16181,TIME=16182,OS=16183,EXLEN=16184,EXTRA=16185,NAME=16186,COMMENT=16187,HCRC=16188,DICTID=16189,DICT=16190,TYPE=16191,TYPEDO=16192,STORED=16193,COPY_=16194,COPY=16195,TABLE=16196,LENLENS=16197,CODELENS=16198,LEN_=16199,LEN=16200,LENEXT=16201,DIST=16202,DISTEXT=16203,MATCH=16204,LIT=16205,CHECK=16206,LENGTH=16207,DONE=16208,BAD=16209,MEM=16210,SYNC=16211,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS,zswap32=q2=>(q2>>>24&255)+(q2>>>8&65280)+((q2&65280)<<8)+((q2&255)<<24);function InflateState(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const inflateStateCheck=strm=>{if(!strm)return 1;const state=strm.state;return!state||state.strm!==strm||state.mode<HEAD||state.mode>SYNC?1:0},inflateResetKeep=strm=>{if(inflateStateCheck(strm))return Z_STREAM_ERROR$1;const state=strm.state;return strm.total_in=strm.total_out=state.total=0,strm.msg="",state.wrap&&(strm.adler=state.wrap&1),state.mode=HEAD,state.last=0,state.havedict=0,state.flags=-1,state.dmax=32768,state.head=null,state.hold=0,state.bits=0,state.lencode=state.lendyn=new Int32Array(ENOUGH_LENS),state.distcode=state.distdyn=new Int32Array(ENOUGH_DISTS),state.sane=1,state.back=-1,Z_OK$1},inflateReset=strm=>{if(inflateStateCheck(strm))return Z_STREAM_ERROR$1;const state=strm.state;return state.wsize=0,state.whave=0,state.wnext=0,inflateResetKeep(strm)},inflateReset2=(strm,windowBits)=>{let wrap;if(inflateStateCheck(strm))return Z_STREAM_ERROR$1;const state=strm.state;return windowBits<0?(wrap=0,windowBits=-windowBits):(wrap=(windowBits>>4)+5,windowBits<48&&(windowBits&=15)),windowBits&&(windowBits<8||windowBits>15)?Z_STREAM_ERROR$1:(state.window!==null&&state.wbits!==windowBits&&(state.window=null),state.wrap=wrap,state.wbits=windowBits,inflateReset(strm))},inflateInit2=(strm,windowBits)=>{if(!strm)return Z_STREAM_ERROR$1;const state=new InflateState;strm.state=state,state.strm=strm,state.window=null,state.mode=HEAD;const ret=inflateReset2(strm,windowBits);return ret!==Z_OK$1&&(strm.state=null),ret},inflateInit=strm=>inflateInit2(strm,DEF_WBITS);let virgin=!0,lenfix,distfix;const fixedtables=state=>{if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);let sym=0;for(;sym<144;)state.lens[sym++]=8;for(;sym<256;)state.lens[sym++]=9;for(;sym<280;)state.lens[sym++]=7;for(;sym<288;)state.lens[sym++]=8;for(inftrees(LENS,state.lens,0,288,lenfix,0,state.work,{bits:9}),sym=0;sym<32;)state.lens[sym++]=5;inftrees(DISTS,state.lens,0,32,distfix,0,state.work,{bits:5}),virgin=!1}state.lencode=lenfix,state.lenbits=9,state.distcode=distfix,state.distbits=5},updatewindow=(strm,src,end,copy)=>{let dist;const state=strm.state;return state.window===null&&(state.wsize=1<<state.wbits,state.wnext=0,state.whave=0,state.window=new Uint8Array(state.wsize)),copy>=state.wsize?(state.window.set(src.subarray(end-state.wsize,end),0),state.wnext=0,state.whave=state.wsize):(dist=state.wsize-state.wnext,dist>copy&&(dist=copy),state.window.set(src.subarray(end-copy,end-copy+dist),state.wnext),copy-=dist,copy?(state.window.set(src.subarray(end-copy,end),0),state.wnext=copy,state.whave=state.wsize):(state.wnext+=dist,state.wnext===state.wsize&&(state.wnext=0),state.whave<state.wsize&&(state.whave+=dist))),0},inflate$2=(strm,flush)=>{let state,input,output,next,put,have,left,hold,bits,_in,_out,copy,from,from_source,here=0,here_bits,here_op,here_val,last_bits,last_op,last_val,len,ret;const hbuf=new Uint8Array(4);let opts,n;const order=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(inflateStateCheck(strm)||!strm.output||!strm.input&&strm.avail_in!==0)return Z_STREAM_ERROR$1;state=strm.state,state.mode===TYPE&&(state.mode=TYPEDO),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,_in=have,_out=left,ret=Z_OK$1;inf_leave:for(;;)switch(state.mode){case HEAD:if(state.wrap===0){state.mode=TYPEDO;break}for(;bits<16;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.wrap&2&&hold===35615){state.wbits===0&&(state.wbits=15),state.check=0,hbuf[0]=hold&255,hbuf[1]=hold>>>8&255,state.check=crc32_1(state.check,hbuf,2,0),hold=0,bits=0,state.mode=FLAGS;break}if(state.head&&(state.head.done=!1),!(state.wrap&1)||(((hold&255)<<8)+(hold>>8))%31){strm.msg="incorrect header check",state.mode=BAD;break}if((hold&15)!==Z_DEFLATED){strm.msg="unknown compression method",state.mode=BAD;break}if(hold>>>=4,bits-=4,len=(hold&15)+8,state.wbits===0&&(state.wbits=len),len>15||len>state.wbits){strm.msg="invalid window size",state.mode=BAD;break}state.dmax=1<<state.wbits,state.flags=0,strm.adler=state.check=1,state.mode=hold&512?DICTID:TYPE,hold=0,bits=0;break;case FLAGS:for(;bits<16;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.flags=hold,(state.flags&255)!==Z_DEFLATED){strm.msg="unknown compression method",state.mode=BAD;break}if(state.flags&57344){strm.msg="unknown header flags set",state.mode=BAD;break}state.head&&(state.head.text=hold>>8&1),state.flags&512&&state.wrap&4&&(hbuf[0]=hold&255,hbuf[1]=hold>>>8&255,state.check=crc32_1(state.check,hbuf,2,0)),hold=0,bits=0,state.mode=TIME;case TIME:for(;bits<32;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.time=hold),state.flags&512&&state.wrap&4&&(hbuf[0]=hold&255,hbuf[1]=hold>>>8&255,hbuf[2]=hold>>>16&255,hbuf[3]=hold>>>24&255,state.check=crc32_1(state.check,hbuf,4,0)),hold=0,bits=0,state.mode=OS;case OS:for(;bits<16;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.xflags=hold&255,state.head.os=hold>>8),state.flags&512&&state.wrap&4&&(hbuf[0]=hold&255,hbuf[1]=hold>>>8&255,state.check=crc32_1(state.check,hbuf,2,0)),hold=0,bits=0,state.mode=EXLEN;case EXLEN:if(state.flags&1024){for(;bits<16;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length=hold,state.head&&(state.head.extra_len=hold),state.flags&512&&state.wrap&4&&(hbuf[0]=hold&255,hbuf[1]=hold>>>8&255,state.check=crc32_1(state.check,hbuf,2,0)),hold=0,bits=0}else state.head&&(state.head.extra=null);state.mode=EXTRA;case EXTRA:if(state.flags&1024&&(copy=state.length,copy>have&&(copy=have),copy&&(state.head&&(len=state.head.extra_len-state.length,state.head.extra||(state.head.extra=new Uint8Array(state.head.extra_len)),state.head.extra.set(input.subarray(next,next+copy),len)),state.flags&512&&state.wrap&4&&(state.check=crc32_1(state.check,input,copy,next)),have-=copy,next+=copy,state.length-=copy),state.length))break inf_leave;state.length=0,state.mode=NAME;case NAME:if(state.flags&2048){if(have===0)break inf_leave;copy=0;do len=input[next+copy++],state.head&&len&&state.length<65536&&(state.head.name+=String.fromCharCode(len));while(len&&copy<have);if(state.flags&512&&state.wrap&4&&(state.check=crc32_1(state.check,input,copy,next)),have-=copy,next+=copy,len)break inf_leave}else state.head&&(state.head.name=null);state.length=0,state.mode=COMMENT;case COMMENT:if(state.flags&4096){if(have===0)break inf_leave;copy=0;do len=input[next+copy++],state.head&&len&&state.length<65536&&(state.head.comment+=String.fromCharCode(len));while(len&&copy<have);if(state.flags&512&&state.wrap&4&&(state.check=crc32_1(state.check,input,copy,next)),have-=copy,next+=copy,len)break inf_leave}else state.head&&(state.head.comment=null);state.mode=HCRC;case HCRC:if(state.flags&512){for(;bits<16;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.wrap&4&&hold!==(state.check&65535)){strm.msg="header crc mismatch",state.mode=BAD;break}hold=0,bits=0}state.head&&(state.head.hcrc=state.flags>>9&1,state.head.done=!0),strm.adler=state.check=0,state.mode=TYPE;break;case DICTID:for(;bits<32;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}strm.adler=state.check=zswap32(hold),hold=0,bits=0,state.mode=DICT;case DICT:if(state.havedict===0)return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,Z_NEED_DICT$1;strm.adler=state.check=1,state.mode=TYPE;case TYPE:if(flush===Z_BLOCK||flush===Z_TREES)break inf_leave;case TYPEDO:if(state.last){hold>>>=bits&7,bits-=bits&7,state.mode=CHECK;break}for(;bits<3;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}switch(state.last=hold&1,hold>>>=1,bits-=1,hold&3){case 0:state.mode=STORED;break;case 1:if(fixedtables(state),state.mode=LEN_,flush===Z_TREES){hold>>>=2,bits-=2;break inf_leave}break;case 2:state.mode=TABLE;break;case 3:strm.msg="invalid block type",state.mode=BAD}hold>>>=2,bits-=2;break;case STORED:for(hold>>>=bits&7,bits-=bits&7;bits<32;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if((hold&65535)!==(hold>>>16^65535)){strm.msg="invalid stored block lengths",state.mode=BAD;break}if(state.length=hold&65535,hold=0,bits=0,state.mode=COPY_,flush===Z_TREES)break inf_leave;case COPY_:state.mode=COPY;case COPY:if(copy=state.length,copy){if(copy>have&&(copy=have),copy>left&&(copy=left),copy===0)break inf_leave;output.set(input.subarray(next,next+copy),put),have-=copy,next+=copy,left-=copy,put+=copy,state.length-=copy;break}state.mode=TYPE;break;case TABLE:for(;bits<14;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.nlen=(hold&31)+257,hold>>>=5,bits-=5,state.ndist=(hold&31)+1,hold>>>=5,bits-=5,state.ncode=(hold&15)+4,hold>>>=4,bits-=4,state.nlen>286||state.ndist>30){strm.msg="too many length or distance symbols",state.mode=BAD;break}state.have=0,state.mode=LENLENS;case LENLENS:for(;state.have<state.ncode;){for(;bits<3;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.lens[order[state.have++]]=hold&7,hold>>>=3,bits-=3}for(;state.have<19;)state.lens[order[state.have++]]=0;if(state.lencode=state.lendyn,state.lenbits=7,opts={bits:state.lenbits},ret=inftrees(CODES,state.lens,0,19,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid code lengths set",state.mode=BAD;break}state.have=0,state.mode=CODELENS;case CODELENS:for(;state.have<state.nlen+state.ndist;){for(;here=state.lencode[hold&(1<<state.lenbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=here&65535,!(here_bits<=bits);){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_val<16)hold>>>=here_bits,bits-=here_bits,state.lens[state.have++]=here_val;else{if(here_val===16){for(n=here_bits+2;bits<n;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold>>>=here_bits,bits-=here_bits,state.have===0){strm.msg="invalid bit length repeat",state.mode=BAD;break}len=state.lens[state.have-1],copy=3+(hold&3),hold>>>=2,bits-=2}else if(here_val===17){for(n=here_bits+3;bits<n;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=here_bits,bits-=here_bits,len=0,copy=3+(hold&7),hold>>>=3,bits-=3}else{for(n=here_bits+7;bits<n;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=here_bits,bits-=here_bits,len=0,copy=11+(hold&127),hold>>>=7,bits-=7}if(state.have+copy>state.nlen+state.ndist){strm.msg="invalid bit length repeat",state.mode=BAD;break}for(;copy--;)state.lens[state.have++]=len}}if(state.mode===BAD)break;if(state.lens[256]===0){strm.msg="invalid code -- missing end-of-block",state.mode=BAD;break}if(state.lenbits=9,opts={bits:state.lenbits},ret=inftrees(LENS,state.lens,0,state.nlen,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid literal/lengths set",state.mode=BAD;break}if(state.distbits=6,state.distcode=state.distdyn,opts={bits:state.distbits},ret=inftrees(DISTS,state.lens,state.nlen,state.ndist,state.distcode,0,state.work,opts),state.distbits=opts.bits,ret){strm.msg="invalid distances set",state.mode=BAD;break}if(state.mode=LEN_,flush===Z_TREES)break inf_leave;case LEN_:state.mode=LEN;case LEN:if(have>=6&&left>=258){strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,inffast(strm,_out),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,state.mode===TYPE&&(state.back=-1);break}for(state.back=0;here=state.lencode[hold&(1<<state.lenbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=here&65535,!(here_bits<=bits);){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_op&&(here_op&240)===0){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here=state.lencode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)],here_bits=here>>>24,here_op=here>>>16&255,here_val=here&65535,!(last_bits+here_bits<=bits);){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,state.length=here_val,here_op===0){state.mode=LIT;break}if(here_op&32){state.back=-1,state.mode=TYPE;break}if(here_op&64){strm.msg="invalid literal/length code",state.mode=BAD;break}state.extra=here_op&15,state.mode=LENEXT;case LENEXT:if(state.extra){for(n=state.extra;bits<n;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}state.was=state.length,state.mode=DIST;case DIST:for(;here=state.distcode[hold&(1<<state.distbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=here&65535,!(here_bits<=bits);){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if((here_op&240)===0){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here=state.distcode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)],here_bits=here>>>24,here_op=here>>>16&255,here_val=here&65535,!(last_bits+here_bits<=bits);){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,here_op&64){strm.msg="invalid distance code",state.mode=BAD;break}state.offset=here_val,state.extra=here_op&15,state.mode=DISTEXT;case DISTEXT:if(state.extra){for(n=state.extra;bits<n;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.offset+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}if(state.offset>state.dmax){strm.msg="invalid distance too far back",state.mode=BAD;break}state.mode=MATCH;case MATCH:if(left===0)break inf_leave;if(copy=_out-left,state.offset>copy){if(copy=state.offset-copy,copy>state.whave&&state.sane){strm.msg="invalid distance too far back",state.mode=BAD;break}copy>state.wnext?(copy-=state.wnext,from=state.wsize-copy):from=state.wnext-copy,copy>state.length&&(copy=state.length),from_source=state.window}else from_source=output,from=put-state.offset,copy=state.length;copy>left&&(copy=left),left-=copy,state.length-=copy;do output[put++]=from_source[from++];while(--copy);state.length===0&&(state.mode=LEN);break;case LIT:if(left===0)break inf_leave;output[put++]=state.length,left--,state.mode=LEN;break;case CHECK:if(state.wrap){for(;bits<32;){if(have===0)break inf_leave;have--,hold|=input[next++]<<bits,bits+=8}if(_out-=left,strm.total_out+=_out,state.total+=_out,state.wrap&4&&_out&&(strm.adler=state.check=state.flags?crc32_1(state.check,output,_out,put-_out):adler32_1(state.check,output,_out,put-_out)),_out=left,state.wrap&4&&(state.flags?hold:zswap32(hold))!==state.check){strm.msg="incorrect data check",state.mode=BAD;break}hold=0,bits=0}state.mode=LENGTH;case LENGTH:if(state.wrap&&state.flags){for(;bits<32;){if(have===0)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.wrap&4&&hold!==(state.total&4294967295)){strm.msg="incorrect length check",state.mode=BAD;break}hold=0,bits=0}state.mode=DONE;case DONE:ret=Z_STREAM_END$1;break inf_leave;case BAD:ret=Z_DATA_ERROR$1;break inf_leave;case MEM:return Z_MEM_ERROR$1;case SYNC:default:return Z_STREAM_ERROR$1}return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,(state.wsize||_out!==strm.avail_out&&state.mode<BAD&&(state.mode<CHECK||flush!==Z_FINISH$1))&&updatewindow(strm,strm.output,strm.next_out,_out-strm.avail_out),_in-=strm.avail_in,_out-=strm.avail_out,strm.total_in+=_in,strm.total_out+=_out,state.total+=_out,state.wrap&4&&_out&&(strm.adler=state.check=state.flags?crc32_1(state.check,output,_out,strm.next_out-_out):adler32_1(state.check,output,_out,strm.next_out-_out)),strm.data_type=state.bits+(state.last?64:0)+(state.mode===TYPE?128:0)+(state.mode===LEN_||state.mode===COPY_?256:0),(_in===0&&_out===0||flush===Z_FINISH$1)&&ret===Z_OK$1&&(ret=Z_BUF_ERROR),ret},inflateEnd=strm=>{if(inflateStateCheck(strm))return Z_STREAM_ERROR$1;let state=strm.state;return state.window&&(state.window=null),strm.state=null,Z_OK$1},inflateGetHeader=(strm,head)=>{if(inflateStateCheck(strm))return Z_STREAM_ERROR$1;const state=strm.state;return(state.wrap&2)===0?Z_STREAM_ERROR$1:(state.head=head,head.done=!1,Z_OK$1)},inflateSetDictionary=(strm,dictionary)=>{const dictLength=dictionary.length;let state,dictid,ret;return inflateStateCheck(strm)||(state=strm.state,state.wrap!==0&&state.mode!==DICT)?Z_STREAM_ERROR$1:state.mode===DICT&&(dictid=1,dictid=adler32_1(dictid,dictionary,dictLength,0),dictid!==state.check)?Z_DATA_ERROR$1:(ret=updatewindow(strm,dictionary,dictLength,dictLength),ret?(state.mode=MEM,Z_MEM_ERROR$1):(state.havedict=1,Z_OK$1))};var inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2$1=inflate$2,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1$2={inflateReset:inflateReset_1,inflateReset2:inflateReset2_1,inflateResetKeep:inflateResetKeep_1,inflateInit:inflateInit_1,inflateInit2:inflateInit2_1,inflate:inflate_2$1,inflateEnd:inflateEnd_1,inflateGetHeader:inflateGetHeader_1,inflateSetDictionary:inflateSetDictionary_1,inflateInfo};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader;const toString=Object.prototype.toString,{Z_NO_FLUSH,Z_FINISH,Z_OK,Z_STREAM_END,Z_NEED_DICT,Z_STREAM_ERROR,Z_DATA_ERROR,Z_MEM_ERROR}=constants$2;function Inflate$1(options){this.options=common.assign({chunkSize:1024*64,windowBits:15,to:""},options||{});const opt=this.options;opt.raw&&opt.windowBits>=0&&opt.windowBits<16&&(opt.windowBits=-opt.windowBits,opt.windowBits===0&&(opt.windowBits=-15)),opt.windowBits>=0&&opt.windowBits<16&&!(options&&options.windowBits)&&(opt.windowBits+=32),opt.windowBits>15&&opt.windowBits<48&&(opt.windowBits&15)===0&&(opt.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;let status=inflate_1$2.inflateInit2(this.strm,opt.windowBits);if(status!==Z_OK)throw new Error(messages[status]);if(this.header=new gzheader,inflate_1$2.inflateGetHeader(this.strm,this.header),opt.dictionary&&(typeof opt.dictionary=="string"?opt.dictionary=strings.string2buf(opt.dictionary):toString.call(opt.dictionary)==="[object ArrayBuffer]"&&(opt.dictionary=new Uint8Array(opt.dictionary)),opt.raw&&(status=inflate_1$2.inflateSetDictionary(this.strm,opt.dictionary),status!==Z_OK)))throw new Error(messages[status])}Inflate$1.prototype.push=function(data,flush_mode){const strm=this.strm,chunkSize=this.options.chunkSize,dictionary=this.options.dictionary;let status,_flush_mode,last_avail_out;if(this.ended)return!1;for(flush_mode===~~flush_mode?_flush_mode=flush_mode:_flush_mode=flush_mode===!0?Z_FINISH:Z_NO_FLUSH,toString.call(data)==="[object ArrayBuffer]"?strm.input=new Uint8Array(data):strm.input=data,strm.next_in=0,strm.avail_in=strm.input.length;;){for(strm.avail_out===0&&(strm.output=new Uint8Array(chunkSize),strm.next_out=0,strm.avail_out=chunkSize),status=inflate_1$2.inflate(strm,_flush_mode),status===Z_NEED_DICT&&dictionary&&(status=inflate_1$2.inflateSetDictionary(strm,dictionary),status===Z_OK?status=inflate_1$2.inflate(strm,_flush_mode):status===Z_DATA_ERROR&&(status=Z_NEED_DICT));strm.avail_in>0&&status===Z_STREAM_END&&strm.state.wrap>0&&data[strm.next_in]!==0;)inflate_1$2.inflateReset(strm),status=inflate_1$2.inflate(strm,_flush_mode);switch(status){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(status),this.ended=!0,!1}if(last_avail_out=strm.avail_out,strm.next_out&&(strm.avail_out===0||status===Z_STREAM_END))if(this.options.to==="string"){let next_out_utf8=strings.utf8border(strm.output,strm.next_out),tail=strm.next_out-next_out_utf8,utf8str=strings.buf2string(strm.output,next_out_utf8);strm.next_out=tail,strm.avail_out=chunkSize-tail,tail&&strm.output.set(strm.output.subarray(next_out_utf8,next_out_utf8+tail),0),this.onData(utf8str)}else this.onData(strm.output.length===strm.next_out?strm.output:strm.output.subarray(0,strm.next_out));if(!(status===Z_OK&&last_avail_out===0)){if(status===Z_STREAM_END)return status=inflate_1$2.inflateEnd(this.strm),this.onEnd(status),this.ended=!0,!0;if(strm.avail_in===0)break}}return!0};Inflate$1.prototype.onData=function(chunk){this.chunks.push(chunk)};Inflate$1.prototype.onEnd=function(status){status===Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=status,this.msg=this.strm.msg};function inflate$1(input,options){const inflator=new Inflate$1(options);if(inflator.push(input),inflator.err)throw inflator.msg||messages[inflator.err];return inflator.result}var Inflate_1$1=Inflate$1,inflate_2=inflate$1,inflate_1$1={Inflate:Inflate_1$1,inflate:inflate_2};const{Inflate,inflate}=inflate_1$1;var Inflate_1=Inflate,inflate_1=inflate;const crcTable=[];for(let n=0;n<256;n++){let c2=n;for(let k2=0;k2<8;k2++)c2&1?c2=3988292384^c2>>>1:c2=c2>>>1;crcTable[n]=c2}const initialCrc=4294967295;function updateCrc(currentCrc,data,length){let c2=currentCrc;for(let n=0;n<length;n++)c2=crcTable[(c2^data[n])&255]^c2>>>8;return c2}function crc(data,length){return(updateCrc(initialCrc,data,length)^initialCrc)>>>0}function checkCrc(buffer,crcLength,chunkName){const expectedCrc=buffer.readUint32(),actualCrc=crc(new Uint8Array(buffer.buffer,buffer.byteOffset+buffer.offset-crcLength-4,crcLength),crcLength);if(actualCrc!==expectedCrc)throw new Error(`CRC mismatch for chunk ${chunkName}. Expected ${expectedCrc}, found ${actualCrc}`)}function unfilterNone(currentLine,newLine,bytesPerLine){for(let i2=0;i2<bytesPerLine;i2++)newLine[i2]=currentLine[i2]}function unfilterSub(currentLine,newLine,bytesPerLine,bytesPerPixel){let i2=0;for(;i2<bytesPerPixel;i2++)newLine[i2]=currentLine[i2];for(;i2<bytesPerLine;i2++)newLine[i2]=currentLine[i2]+newLine[i2-bytesPerPixel]&255}function unfilterUp(currentLine,newLine,prevLine,bytesPerLine){let i2=0;if(prevLine.length===0)for(;i2<bytesPerLine;i2++)newLine[i2]=currentLine[i2];else for(;i2<bytesPerLine;i2++)newLine[i2]=currentLine[i2]+prevLine[i2]&255}function unfilterAverage(currentLine,newLine,prevLine,bytesPerLine,bytesPerPixel){let i2=0;if(prevLine.length===0){for(;i2<bytesPerPixel;i2++)newLine[i2]=currentLine[i2];for(;i2<bytesPerLine;i2++)newLine[i2]=currentLine[i2]+(newLine[i2-bytesPerPixel]>>1)&255}else{for(;i2<bytesPerPixel;i2++)newLine[i2]=currentLine[i2]+(prevLine[i2]>>1)&255;for(;i2<bytesPerLine;i2++)newLine[i2]=currentLine[i2]+(newLine[i2-bytesPerPixel]+prevLine[i2]>>1)&255}}function unfilterPaeth(currentLine,newLine,prevLine,bytesPerLine,bytesPerPixel){let i2=0;if(prevLine.length===0){for(;i2<bytesPerPixel;i2++)newLine[i2]=currentLine[i2];for(;i2<bytesPerLine;i2++)newLine[i2]=currentLine[i2]+newLine[i2-bytesPerPixel]&255}else{for(;i2<bytesPerPixel;i2++)newLine[i2]=currentLine[i2]+prevLine[i2]&255;for(;i2<bytesPerLine;i2++)newLine[i2]=currentLine[i2]+paethPredictor(newLine[i2-bytesPerPixel],prevLine[i2],prevLine[i2-bytesPerPixel])&255}}function paethPredictor(a2,b2,c2){const p2=a2+b2-c2,pa=Math.abs(p2-a2),pb=Math.abs(p2-b2),pc=Math.abs(p2-c2);return pa<=pb&&pa<=pc?a2:pb<=pc?b2:c2}function applyUnfilter(filterType,currentLine,newLine,prevLine,passLineBytes,bytesPerPixel){switch(filterType){case 0:unfilterNone(currentLine,newLine,passLineBytes);break;case 1:unfilterSub(currentLine,newLine,passLineBytes,bytesPerPixel);break;case 2:unfilterUp(currentLine,newLine,prevLine,passLineBytes);break;case 3:unfilterAverage(currentLine,newLine,prevLine,passLineBytes,bytesPerPixel);break;case 4:unfilterPaeth(currentLine,newLine,prevLine,passLineBytes,bytesPerPixel);break;default:throw new Error(`Unsupported filter: ${filterType}`)}}const uint16$1=new Uint16Array([255]),uint8$1=new Uint8Array(uint16$1.buffer),osIsLittleEndian$1=uint8$1[0]===255;function decodeInterlaceAdam7(params){const{data,width,height,channels,depth}=params,passes=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],bytesPerPixel=Math.ceil(depth/8)*channels,resultData=new Uint8Array(height*width*bytesPerPixel);let offset=0;for(let passIndex=0;passIndex<7;passIndex++){const pass=passes[passIndex],passWidth=Math.ceil((width-pass.x)/pass.xStep),passHeight=Math.ceil((height-pass.y)/pass.yStep);if(passWidth<=0||passHeight<=0)continue;const passLineBytes=passWidth*bytesPerPixel,prevLine=new Uint8Array(passLineBytes);for(let y2=0;y2<passHeight;y2++){const filterType=data[offset++],currentLine=data.subarray(offset,offset+passLineBytes);offset+=passLineBytes;const newLine=new Uint8Array(passLineBytes);applyUnfilter(filterType,currentLine,newLine,prevLine,passLineBytes,bytesPerPixel),prevLine.set(newLine);for(let x2=0;x2<passWidth;x2++){const outputX=pass.x+x2*pass.xStep,outputY=pass.y+y2*pass.yStep;if(!(outputX>=width||outputY>=height))for(let i2=0;i2<bytesPerPixel;i2++)resultData[(outputY*width+outputX)*bytesPerPixel+i2]=newLine[x2*bytesPerPixel+i2]}}}if(depth===16){const uint16Data=new Uint16Array(resultData.buffer);if(osIsLittleEndian$1)for(let k2=0;k2<uint16Data.length;k2++)uint16Data[k2]=swap16$1(uint16Data[k2]);return uint16Data}else return resultData}function swap16$1(val){return(val&255)<<8|val>>8&255}const uint16=new Uint16Array([255]),uint8=new Uint8Array(uint16.buffer),osIsLittleEndian=uint8[0]===255,empty=new Uint8Array(0);function decodeInterlaceNull(params){const{data,width,height,channels,depth}=params,bytesPerPixel=Math.ceil(depth/8)*channels,bytesPerLine=Math.ceil(depth/8*channels*width),newData=new Uint8Array(height*bytesPerLine);let prevLine=empty,offset=0,currentLine,newLine;for(let i2=0;i2<height;i2++){switch(currentLine=data.subarray(offset+1,offset+1+bytesPerLine),newLine=newData.subarray(i2*bytesPerLine,(i2+1)*bytesPerLine),data[offset]){case 0:unfilterNone(currentLine,newLine,bytesPerLine);break;case 1:unfilterSub(currentLine,newLine,bytesPerLine,bytesPerPixel);break;case 2:unfilterUp(currentLine,newLine,prevLine,bytesPerLine);break;case 3:unfilterAverage(currentLine,newLine,prevLine,bytesPerLine,bytesPerPixel);break;case 4:unfilterPaeth(currentLine,newLine,prevLine,bytesPerLine,bytesPerPixel);break;default:throw new Error(`Unsupported filter: ${data[offset]}`)}prevLine=newLine,offset+=bytesPerLine+1}if(depth===16){const uint16Data=new Uint16Array(newData.buffer);if(osIsLittleEndian)for(let k2=0;k2<uint16Data.length;k2++)uint16Data[k2]=swap16(uint16Data[k2]);return uint16Data}else return newData}function swap16(val){return(val&255)<<8|val>>8&255}const pngSignature=Uint8Array.of(137,80,78,71,13,10,26,10);function checkSignature(buffer){if(!hasPngSignature(buffer.readBytes(pngSignature.length)))throw new Error("wrong PNG signature")}function hasPngSignature(array){if(array.length<pngSignature.length)return!1;for(let i2=0;i2<pngSignature.length;i2++)if(array[i2]!==pngSignature[i2])return!1;return!0}const textChunkName="tEXt",NULL=0,latin1Decoder=new TextDecoder("latin1");function validateKeyword(keyword){if(validateLatin1(keyword),keyword.length===0||keyword.length>79)throw new Error("keyword length must be between 1 and 79")}const latin1Regex=/^[\u0000-\u00FF]*$/;function validateLatin1(text){if(!latin1Regex.test(text))throw new Error("invalid latin1 text")}function decodetEXt(text,buffer,length){const keyword=readKeyword(buffer);text[keyword]=readLatin1(buffer,length-keyword.length-1)}function readKeyword(buffer){for(buffer.mark();buffer.readByte()!==NULL;);const end=buffer.offset;buffer.reset();const keyword=latin1Decoder.decode(buffer.readBytes(end-buffer.offset-1));return buffer.skip(1),validateKeyword(keyword),keyword}function readLatin1(buffer,length){return latin1Decoder.decode(buffer.readBytes(length))}const ColorType={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},CompressionMethod={UNKNOWN:-1,DEFLATE:0},FilterMethod={UNKNOWN:-1,ADAPTIVE:0},InterlaceMethod={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},DisposeOpType={NONE:0,BACKGROUND:1,PREVIOUS:2},BlendOpType={SOURCE:0,OVER:1};class PngDecoder extends IOBuffer{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(data,options={}){super(data);const{checkCrc:checkCrc2=!1}=options;this._checkCrc=checkCrc2,this._inflator=new Inflate_1,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=CompressionMethod.UNKNOWN,this._filterMethod=FilterMethod.UNKNOWN,this._interlaceMethod=InterlaceMethod.UNKNOWN,this._colorType=ColorType.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(checkSignature(this);!this._end;){const length=this.readUint32(),type=this.readChars(4);this.decodeChunk(length,type)}return this.decodeImage(),this._png}decodeApng(){for(checkSignature(this);!this._end;){const length=this.readUint32(),type=this.readChars(4);this.decodeApngChunk(length,type)}return this.decodeApngImage(),this._apng}decodeChunk(length,type){const offset=this.offset;switch(type){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(length);break;case"IDAT":this.decodeIDAT(length);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(length);break;case"iCCP":this.decodeiCCP(length);break;case textChunkName:decodetEXt(this._png.text,this,length);break;case"pHYs":this.decodepHYs();break;default:this.skip(length);break}if(this.offset-offset!==length)throw new Error(`Length mismatch while decoding chunk ${type}`);this._checkCrc?checkCrc(this,length+4,type):this.skip(4)}decodeApngChunk(length,type){const offset=this.offset;switch(type!=="fdAT"&&type!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),type){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(length);break;default:this.decodeChunk(length,type),this.offset=offset+length;break}if(this.offset-offset!==length)throw new Error(`Length mismatch while decoding chunk ${type}`);this._checkCrc?checkCrc(this,length+4,type):this.skip(4)}decodeIHDR(){const image=this._png;image.width=this.readUint32(),image.height=this.readUint32(),image.depth=checkBitDepth(this.readUint8());const colorType=this.readUint8();this._colorType=colorType;let channels;switch(colorType){case ColorType.GREYSCALE:channels=1;break;case ColorType.TRUECOLOUR:channels=3;break;case ColorType.INDEXED_COLOUR:channels=1;break;case ColorType.GREYSCALE_ALPHA:channels=2;break;case ColorType.TRUECOLOUR_ALPHA:channels=4;break;case ColorType.UNKNOWN:default:throw new Error(`Unknown color type: ${colorType}`)}if(this._png.channels=channels,this._compressionMethod=this.readUint8(),this._compressionMethod!==CompressionMethod.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const image={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(image)}decodePLTE(length){if(length%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${length}`);const l2=length/3;this._hasPalette=!0;const palette=[];this._palette=palette;for(let i2=0;i2<l2;i2++)palette.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(length){this._writingDataChunks=!0;const dataLength=length,dataOffset=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,dataOffset,dataLength)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(length)}decodeFDAT(length){this._writingDataChunks=!0;let dataLength=length,dataOffset=this.offset+this.byteOffset;if(dataOffset+=4,dataLength-=4,this._inflator.push(new Uint8Array(this.buffer,dataOffset,dataLength)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(length)}decodetRNS(length){switch(this._colorType){case ColorType.GREYSCALE:case ColorType.TRUECOLOUR:{if(length%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${length}`);if(length/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${length/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(length/2);for(let i2=0;i2<length/2;i2++)this._transparency[i2]=this.readUint16();break}case ColorType.INDEXED_COLOUR:{if(length>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${length} vs ${this._palette.length})`);let i2=0;for(;i2<length;i2++){const alpha=this.readByte();this._palette[i2].push(alpha)}for(;i2<this._palette.length;i2++)this._palette[i2].push(255);break}case ColorType.UNKNOWN:case ColorType.GREYSCALE_ALPHA:case ColorType.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(length){const name=readKeyword(this),compressionMethod=this.readUint8();if(compressionMethod!==CompressionMethod.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${compressionMethod}`);const compressedProfile=this.readBytes(length-name.length-2);this._png.iccEmbeddedProfile={name,profile:inflate_1(compressedProfile)}}decodepHYs(){const ppuX=this.readUint32(),ppuY=this.readUint32(),unitSpecifier=this.readByte();this._png.resolution={x:ppuX,y:ppuY,unit:unitSpecifier}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let i2=0;i2<this._numberOfFrames;i2++){const newFrame={sequenceNumber:this._frames[i2].sequenceNumber,delayNumber:this._frames[i2].delayNumber,delayDenominator:this._frames[i2].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},frame=this._frames.at(i2);if(frame){if(frame.data=decodeInterlaceNull({data:frame.data,width:frame.width,height:frame.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),i2===0||frame.xOffset===0&&frame.yOffset===0&&frame.width===this._png.width&&frame.height===this._png.height)newFrame.data=frame.data;else{const prevFrame=this._apng.frames.at(i2-1);this.disposeFrame(frame,prevFrame,newFrame),this.addFrameDataToCanvas(newFrame,frame)}this._apng.frames.push(newFrame)}}return this._apng}disposeFrame(frame,prevFrame,imageFrame){switch(frame.disposeOp){case DisposeOpType.NONE:break;case DisposeOpType.BACKGROUND:for(let row=0;row<this._png.height;row++)for(let col=0;col<this._png.width;col++){const index=(row*frame.width+col)*this._png.channels;for(let channel=0;channel<this._png.channels;channel++)imageFrame.data[index+channel]=0}break;case DisposeOpType.PREVIOUS:imageFrame.data.set(prevFrame.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(imageFrame,frame){const maxValue=1<<this._png.depth,calculatePixelIndices=(row,col)=>{const index=((row+frame.yOffset)*this._png.width+frame.xOffset+col)*this._png.channels,frameIndex=(row*frame.width+col)*this._png.channels;return{index,frameIndex}};switch(frame.blendOp){case BlendOpType.SOURCE:for(let row=0;row<frame.height;row++)for(let col=0;col<frame.width;col++){const{index,frameIndex}=calculatePixelIndices(row,col);for(let channel=0;channel<this._png.channels;channel++)imageFrame.data[index+channel]=frame.data[frameIndex+channel]}break;case BlendOpType.OVER:for(let row=0;row<frame.height;row++)for(let col=0;col<frame.width;col++){const{index,frameIndex}=calculatePixelIndices(row,col);for(let channel=0;channel<this._png.channels;channel++){const sourceAlpha=frame.data[frameIndex+this._png.channels-1]/maxValue,foregroundValue=channel%(this._png.channels-1)===0?1:frame.data[frameIndex+channel],value=Math.floor(sourceAlpha*foregroundValue+(1-sourceAlpha)*imageFrame.data[index+channel]);imageFrame.data[index+channel]+=value}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const data=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==FilterMethod.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===InterlaceMethod.NO_INTERLACE)this._png.data=decodeInterlaceNull({data,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===InterlaceMethod.ADAM7)this._png.data=decodeInterlaceAdam7({data,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const result=this._inflator.result,lastFrame=this._frames.at(-1);lastFrame?lastFrame.data=result:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:DisposeOpType.NONE,blendOp:BlendOpType.SOURCE,data:result}),this._inflator=new Inflate_1,this._writingDataChunks=!1}}function checkBitDepth(value){if(value!==1&&value!==2&&value!==4&&value!==8&&value!==16)throw new Error(`invalid bit depth: ${value}`);return value}var ResolutionUnitSpecifier;(function(ResolutionUnitSpecifier2){ResolutionUnitSpecifier2[ResolutionUnitSpecifier2.UNKNOWN=0]="UNKNOWN",ResolutionUnitSpecifier2[ResolutionUnitSpecifier2.METRE=1]="METRE"})(ResolutionUnitSpecifier||(ResolutionUnitSpecifier={}));function decodePng(data,options){return new PngDecoder(data,options).decode()}var i=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function a(){i.console&&typeof i.console.log=="function"&&i.console.log.apply(i.console,arguments)}var o={log:a,warn:function(t2){i.console&&(typeof i.console.warn=="function"?i.console.warn.apply(i.console,arguments):a.call(null,arguments))},error:function(t2){i.console&&(typeof i.console.error=="function"?i.console.error.apply(i.console,arguments):a(t2))}};function s(t2,e,n){var r=new XMLHttpRequest;r.open("GET",t2),r.responseType="blob",r.onload=function(){l(r.response,e,n)},r.onerror=function(){o.error("could not download file")},r.send()}function u(t2){var e=new XMLHttpRequest;e.open("HEAD",t2,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function c(t2){try{t2.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t2.dispatchEvent(e)}}var l=i.saveAs||((typeof window>"u"?"undefined":_typeof(window))!=="object"||window!==i?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t2,e,n){var r=i.URL||i.webkitURL,a2=document.createElement("a");e=e||t2.name||"download",a2.download=e,a2.rel="noopener",typeof t2=="string"?(a2.href=t2,a2.origin!==location.origin?u(a2.href)?s(t2,e,n):c(a2,a2.target="_blank"):c(a2)):(a2.href=r.createObjectURL(t2),setTimeout(function(){r.revokeObjectURL(a2.href)},4e4),setTimeout(function(){c(a2)},0))}:"msSaveOrOpenBlob"in navigator?function(e,n,r){if(n=n||e.name||"download",typeof e=="string")if(u(e))s(e,n,r);else{var i2=document.createElement("a");i2.href=e,i2.target="_blank",setTimeout(function(){c(i2)})}else navigator.msSaveOrOpenBlob((function(e2,n2){return n2===void 0?n2={autoBom:!1}:_typeof(n2)!=="object"&&(o.warn("Deprecated: Expected third argument to be a object"),n2={autoBom:!n2}),n2.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e2.type)?new Blob(["\uFEFF",e2],{type:e2.type}):e2})(e,r),n)}:function(e,n,r,a2){if((a2=a2||open("","_blank"))&&(a2.document.title=a2.document.body.innerText="downloading..."),typeof e=="string")return s(e,n,r);var o2=e.type==="application/octet-stream",u2=/constructor/i.test(i.HTMLElement)||i.safari,c2=/CriOS\/[\d]+/.test(navigator.userAgent);if((c2||o2&&u2)&&(typeof FileReader>"u"?"undefined":_typeof(FileReader))==="object"){var l2=new FileReader;l2.onloadend=function(){var t2=l2.result;t2=c2?t2:t2.replace(/^data:[^;]*;/,"data:attachment/file;"),a2?a2.location.href=t2:location=t2,a2=null},l2.readAsDataURL(e)}else{var h2=i.URL||i.webkitURL,f2=h2.createObjectURL(e);a2?a2.location=f2:location.href=f2,a2=null,setTimeout(function(){h2.revokeObjectURL(f2)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function h(t2){var e;t2=t2||"",this.ok=!1,t2.charAt(0)=="#"&&(t2=t2.substr(1,6)),t2={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t2=(t2=t2.replace(/ /g,"")).toLowerCase()]||t2;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t3){return[parseInt(t3[1]),parseInt(t3[2]),parseInt(t3[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t3){return[parseInt(t3[1],16),parseInt(t3[2],16),parseInt(t3[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t3){return[parseInt(t3[1]+t3[1],16),parseInt(t3[2]+t3[2],16),parseInt(t3[3]+t3[3],16)]}}],r=0;r<n.length;r++){var i2=n[r].re,a2=n[r].process,o2=i2.exec(t2);o2&&(e=a2(o2),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var t3=this.r.toString(16),e2=this.g.toString(16),n2=this.b.toString(16);return t3.length==1&&(t3="0"+t3),e2.length==1&&(e2="0"+e2),n2.length==1&&(n2="0"+n2),"#"+t3+e2+n2}}var f=i.atob.bind(i),d=i.btoa.bind(i);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function p(t2,e){var n=t2[0],r=t2[1],i2=t2[2],a2=t2[3];n=m(n,r,i2,a2,e[0],7,-680876936),a2=m(a2,n,r,i2,e[1],12,-389564586),i2=m(i2,a2,n,r,e[2],17,606105819),r=m(r,i2,a2,n,e[3],22,-1044525330),n=m(n,r,i2,a2,e[4],7,-176418897),a2=m(a2,n,r,i2,e[5],12,1200080426),i2=m(i2,a2,n,r,e[6],17,-1473231341),r=m(r,i2,a2,n,e[7],22,-45705983),n=m(n,r,i2,a2,e[8],7,1770035416),a2=m(a2,n,r,i2,e[9],12,-1958414417),i2=m(i2,a2,n,r,e[10],17,-42063),r=m(r,i2,a2,n,e[11],22,-1990404162),n=m(n,r,i2,a2,e[12],7,1804603682),a2=m(a2,n,r,i2,e[13],12,-40341101),i2=m(i2,a2,n,r,e[14],17,-1502002290),n=v(n,r=m(r,i2,a2,n,e[15],22,1236535329),i2,a2,e[1],5,-165796510),a2=v(a2,n,r,i2,e[6],9,-1069501632),i2=v(i2,a2,n,r,e[11],14,643717713),r=v(r,i2,a2,n,e[0],20,-373897302),n=v(n,r,i2,a2,e[5],5,-701558691),a2=v(a2,n,r,i2,e[10],9,38016083),i2=v(i2,a2,n,r,e[15],14,-660478335),r=v(r,i2,a2,n,e[4],20,-405537848),n=v(n,r,i2,a2,e[9],5,568446438),a2=v(a2,n,r,i2,e[14],9,-1019803690),i2=v(i2,a2,n,r,e[3],14,-187363961),r=v(r,i2,a2,n,e[8],20,1163531501),n=v(n,r,i2,a2,e[13],5,-1444681467),a2=v(a2,n,r,i2,e[2],9,-51403784),i2=v(i2,a2,n,r,e[7],14,1735328473),n=b(n,r=v(r,i2,a2,n,e[12],20,-1926607734),i2,a2,e[5],4,-378558),a2=b(a2,n,r,i2,e[8],11,-2022574463),i2=b(i2,a2,n,r,e[11],16,1839030562),r=b(r,i2,a2,n,e[14],23,-35309556),n=b(n,r,i2,a2,e[1],4,-1530992060),a2=b(a2,n,r,i2,e[4],11,1272893353),i2=b(i2,a2,n,r,e[7],16,-155497632),r=b(r,i2,a2,n,e[10],23,-1094730640),n=b(n,r,i2,a2,e[13],4,681279174),a2=b(a2,n,r,i2,e[0],11,-358537222),i2=b(i2,a2,n,r,e[3],16,-722521979),r=b(r,i2,a2,n,e[6],23,76029189),n=b(n,r,i2,a2,e[9],4,-640364487),a2=b(a2,n,r,i2,e[12],11,-421815835),i2=b(i2,a2,n,r,e[15],16,530742520),n=y(n,r=b(r,i2,a2,n,e[2],23,-995338651),i2,a2,e[0],6,-198630844),a2=y(a2,n,r,i2,e[7],10,1126891415),i2=y(i2,a2,n,r,e[14],15,-1416354905),r=y(r,i2,a2,n,e[5],21,-57434055),n=y(n,r,i2,a2,e[12],6,1700485571),a2=y(a2,n,r,i2,e[3],10,-1894986606),i2=y(i2,a2,n,r,e[10],15,-1051523),r=y(r,i2,a2,n,e[1],21,-2054922799),n=y(n,r,i2,a2,e[8],6,1873313359),a2=y(a2,n,r,i2,e[15],10,-30611744),i2=y(i2,a2,n,r,e[6],15,-1560198380),r=y(r,i2,a2,n,e[13],21,1309151649),n=y(n,r,i2,a2,e[4],6,-145523070),a2=y(a2,n,r,i2,e[11],10,-1120210379),i2=y(i2,a2,n,r,e[2],15,718787259),r=y(r,i2,a2,n,e[9],21,-343485551),t2[0]=P(n,t2[0]),t2[1]=P(r,t2[1]),t2[2]=P(i2,t2[2]),t2[3]=P(a2,t2[3])}function g(t2,e,n,r,i2,a2){return e=P(P(e,t2),P(r,a2)),P(e<<i2|e>>>32-i2,n)}function m(t2,e,n,r,i2,a2,o2){return g(e&n|~e&r,t2,e,i2,a2,o2)}function v(t2,e,n,r,i2,a2,o2){return g(e&r|n&~r,t2,e,i2,a2,o2)}function b(t2,e,n,r,i2,a2,o2){return g(e^n^r,t2,e,i2,a2,o2)}function y(t2,e,n,r,i2,a2,o2){return g(n^(e|~r),t2,e,i2,a2,o2)}function w(t2){var e,n=t2.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t2.length;e+=64)p(r,N(t2.substring(e-64,e)));t2=t2.substring(e-64);var i2=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t2.length;e++)i2[e>>2]|=t2.charCodeAt(e)<<(e%4<<3);if(i2[e>>2]|=128<<(e%4<<3),e>55)for(p(r,i2),e=0;e<16;e++)i2[e]=0;return i2[14]=8*n,p(r,i2),r}function N(t2){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t2.charCodeAt(e)+(t2.charCodeAt(e+1)<<8)+(t2.charCodeAt(e+2)<<16)+(t2.charCodeAt(e+3)<<24);return n}var L="0123456789abcdef".split("");function x(t2){for(var e="",n=0;n<4;n++)e+=L[t2>>8*n+4&15]+L[t2>>8*n&15];return e}function A(t2){return String.fromCharCode(255&t2,(65280&t2)>>8,(16711680&t2)>>16,(4278190080&t2)>>24)}function S(t2){return w(t2).map(A).join("")}var _=(function(t2){for(var e=0;e<t2.length;e++)t2[e]=x(t2[e]);return t2.join("")})(w("hello"))!="5d41402abc4b2a76b9719d911017c592";function P(t2,e){if(_){var n=(65535&t2)+(65535&e);return(t2>>16)+(e>>16)+(n>>16)<<16|65535&n}return t2+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function k(t2,e){var n,r,i2,a2;if(t2!==n){for(var o2=(i2=t2,a2=1+(256/t2.length|0),new Array(a2+1).join(i2)),s2=[],u2=0;u2<256;u2++)s2[u2]=u2;var c2=0;for(u2=0;u2<256;u2++){var l2=s2[u2];c2=(c2+l2+o2.charCodeAt(u2))%256,s2[u2]=s2[c2],s2[c2]=l2}n=t2,r=s2}else s2=r;var h2=e.length,f2=0,d2=0,p2="";for(u2=0;u2<h2;u2++)d2=(d2+(l2=s2[f2=(f2+1)%256]))%256,s2[f2]=s2[d2],s2[d2]=l2,o2=s2[(s2[f2]+s2[d2])%256],p2+=String.fromCharCode(e.charCodeAt(u2)^o2);return p2}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var F={print:4,modify:8,copy:16,"annot-forms":32};function I(t2,e,n,r){this.v=1,this.r=2;var i2=192;t2.forEach(function(t3){if(F.perm!==void 0)throw new Error("Invalid permission: "+t3);i2+=F[t3]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a2=(e+this.padding).substr(0,32),o2=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(a2,o2),this.P=-(1+(255^i2)),this.encryptionKey=S(a2+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=k(this.encryptionKey,this.padding)}function j(t2){if(/[^\u0000-\u00ff]/.test(t2))throw new Error("Invalid PDF Name Object: "+t2+", Only accept ASCII characters.");for(var e="",n=t2.length,r=0;r<n;r++){var i2=t2.charCodeAt(r);e+=i2<33||i2===35||i2===37||i2===40||i2===41||i2===47||i2===60||i2===62||i2===91||i2===93||i2===123||i2===125||i2>126?"#"+("0"+i2.toString(16)).slice(-2):t2[r]}return e}function C(e){if(_typeof(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var n={};this.subscribe=function(t2,e2,r){if(r=r||!1,typeof t2!="string"||typeof e2!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");n.hasOwnProperty(t2)||(n[t2]={});var i2=Math.random().toString(35);return n[t2][i2]=[e2,!!r],i2},this.unsubscribe=function(t2){for(var e2 in n)if(n[e2][t2])return delete n[e2][t2],Object.keys(n[e2]).length===0&&delete n[e2],!0;return!1},this.publish=function(t2){if(n.hasOwnProperty(t2)){var r=Array.prototype.slice.call(arguments,1),a2=[];for(var s2 in n[t2]){var u2=n[t2][s2];try{u2[0].apply(e,r)}catch(c2){i.console&&o.error("jsPDF PubSub Error",c2.message,c2)}u2[1]&&a2.push(s2)}a2.length&&a2.forEach(this.unsubscribe)}},this.getTopics=function(){return n}}function O(t2){if(!(this instanceof O))return new O(t2);var e="opacity,stroke-opacity".split(",");for(var n in t2)t2.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t2[n]);this.id="",this.objectNumber=-1}function B(t2,e){this.gState=t2,this.matrix=e,this.id="",this.objectNumber=-1}function M(t2,e,n,r,i2){if(!(this instanceof M))return new M(t2,e,n,r,i2);this.type=t2==="axial"?2:3,this.coords=e,this.colors=n,B.call(this,r,i2)}function q(t2,e,n,r,i2){if(!(this instanceof q))return new q(t2,e,n,r,i2);this.boundingBox=t2,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,B.call(this,r,i2)}function E(e){var n,r=typeof arguments[0]=="string"?arguments[0]:"p",a2=arguments[1],s2=arguments[2],u2=arguments[3],c2=[],f2=1,p2=16,g2="S",m2=null;_typeof(e=e||{})==="object"&&(r=e.orientation,a2=e.unit||a2,s2=e.format||s2,u2=e.compress||e.compressPdf||u2,(m2=e.encryption||null)!==null&&(m2.userPassword=m2.userPassword||"",m2.ownerPassword=m2.ownerPassword||"",m2.userPermissions=m2.userPermissions||[]),f2=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(n=e.precision),e.floatPrecision!==void 0&&(p2=e.floatPrecision),g2=e.defaultPathOperation||"S"),c2=e.filters||(u2===!0?["FlateEncode"]:c2),a2=a2||"mm",r=(""+(r||"P")).toLowerCase();var v2=e.putOnlyUsedFonts||!1,b2={},y2={internal:{},__private__:{}};y2.__private__.PubSub=C;var w2="1.3",N2=y2.__private__.getPdfVersion=function(){return w2};y2.__private__.setPdfVersion=function(t2){w2=t2};var L2={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};y2.__private__.getPageFormats=function(){return L2};var x2=y2.__private__.getPageFormat=function(t2){return L2[t2]};s2=s2||"a4";var A2="compat",S2="advanced",_2=A2;function P2(){this.saveGraphicsState(),lt2(new Wt2(St,0,0,-St,0,_n()*St).toString()+" cm"),this.setFontSize(this.getFontSize()/St),g2="n",_2=S2}function k2(){this.restoreGraphicsState(),g2="S",_2=A2}var F2=y2.__private__.combineFontStyleAndFontWeight=function(t2,e2){if(t2=="bold"&&e2=="normal"||t2=="bold"&&e2==400||t2=="normal"&&e2=="italic"||t2=="bold"&&e2=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return e2&&(t2=e2==400||e2==="normal"?t2==="italic"?"italic":"normal":e2!=700&&e2!=="bold"||t2!=="normal"?(e2==700?"bold":e2)+""+t2:"bold"),t2};y2.advancedAPI=function(t2){var e2=_2===A2;return e2&&P2.call(this),typeof t2!="function"||(t2(this),e2&&k2.call(this)),this},y2.compatAPI=function(t2){var e2=_2===S2;return e2&&k2.call(this),typeof t2!="function"||(t2(this),e2&&P2.call(this)),this},y2.isAdvancedAPI=function(){return _2===S2};var B2,R2=function(t2){if(_2!==S2)throw new Error(t2+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},D2=y2.roundToPrecision=y2.__private__.roundToPrecision=function(t2,e2){var r2=n||e2;if(isNaN(t2)||isNaN(r2))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return t2.toFixed(r2).replace(/0+$/,"")};B2=y2.hpf=y2.__private__.hpf=typeof p2=="number"?function(t2){if(isNaN(t2))throw new Error("Invalid argument passed to jsPDF.hpf");return D2(t2,p2)}:p2==="smart"?function(t2){if(isNaN(t2))throw new Error("Invalid argument passed to jsPDF.hpf");return D2(t2,t2>-1&&t2<1?16:5)}:function(t2){if(isNaN(t2))throw new Error("Invalid argument passed to jsPDF.hpf");return D2(t2,16)};var T2=y2.f2=y2.__private__.f2=function(t2){if(isNaN(t2))throw new Error("Invalid argument passed to jsPDF.f2");return D2(t2,2)},z2=y2.__private__.f3=function(t2){if(isNaN(t2))throw new Error("Invalid argument passed to jsPDF.f3");return D2(t2,3)},U2=y2.scale=y2.__private__.scale=function(t2){if(isNaN(t2))throw new Error("Invalid argument passed to jsPDF.scale");return _2===A2?t2*St:_2===S2?t2:void 0},H2=function(t2){return U2((function(t3){return _2===A2?_n()-t3:_2===S2?t3:void 0})(t2))};y2.__private__.setPrecision=y2.setPrecision=function(t2){typeof parseInt(t2,10)=="number"&&(n=parseInt(t2,10))};var W2,V2="00000000000000000000000000000000",G2=y2.__private__.getFileId=function(){return V2},Y2=y2.__private__.setFileId=function(t2){return V2=t2!==void 0&&/^[a-fA-F0-9]{32}$/.test(t2)?t2.toUpperCase():V2.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m2!==null&&(je2=new I(m2.userPermissions,m2.userPassword,m2.ownerPassword,V2)),V2};y2.setFileId=function(t2){return Y2(t2),this},y2.getFileId=function(){return G2()};var J2=y2.__private__.convertDateToPDFDate=function(t2){var e2=t2.getTimezoneOffset(),n2=e2<0?"+":"-",r2=Math.floor(Math.abs(e2/60)),i2=Math.abs(e2%60),a3=[n2,Q2(r2),"'",Q2(i2),"'"].join("");return["D:",t2.getFullYear(),Q2(t2.getMonth()+1),Q2(t2.getDate()),Q2(t2.getHours()),Q2(t2.getMinutes()),Q2(t2.getSeconds()),a3].join("")},X2=y2.__private__.convertPDFDateToDate=function(t2){var e2=parseInt(t2.substr(2,4),10),n2=parseInt(t2.substr(6,2),10)-1,r2=parseInt(t2.substr(8,2),10),i2=parseInt(t2.substr(10,2),10),a3=parseInt(t2.substr(12,2),10),o2=parseInt(t2.substr(14,2),10);return new Date(e2,n2,r2,i2,a3,o2,0)},K2=y2.__private__.setCreationDate=function(t2){var e2;if(t2===void 0&&(t2=new Date),t2 instanceof Date)e2=J2(t2);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(t2))throw new Error("Invalid argument passed to jsPDF.setCreationDate");e2=t2}return W2=e2},Z2=y2.__private__.getCreationDate=function(t2){var e2=W2;return t2==="jsDate"&&(e2=X2(W2)),e2};y2.setCreationDate=function(t2){return K2(t2),this},y2.getCreationDate=function(t2){return Z2(t2)};var $2,Q2=y2.__private__.padd2=function(t2){return("0"+parseInt(t2)).slice(-2)},tt2=y2.__private__.padd2Hex=function(t2){return("00"+(t2=t2.toString())).substr(t2.length)},et2=0,nt2=[],rt2=[],it2=0,at2=[],ot2=[],st2=!1,ut2=rt2;y2.__private__.setCustomOutputDestination=function(t2){st2=!0,ut2=t2};var ct2=function(t2){st2||(ut2=t2)};y2.__private__.resetCustomOutputDestination=function(){st2=!1,ut2=rt2};var lt2=y2.__private__.out=function(t2){return t2=t2.toString(),it2+=t2.length+1,ut2.push(t2),ut2},ht2=y2.__private__.write=function(t2){return lt2(arguments.length===1?t2.toString():Array.prototype.join.call(arguments," "))},ft2=y2.__private__.getArrayBuffer=function(t2){for(var e2=t2.length,n2=new ArrayBuffer(e2),r2=new Uint8Array(n2);e2--;)r2[e2]=t2.charCodeAt(e2);return n2},dt2=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];y2.__private__.getStandardFonts=function(){return dt2};var pt2=e.fontSize||16;y2.__private__.setFontSize=y2.setFontSize=function(t2){return pt2=_2===S2?t2/St:t2,this};var gt2,mt2=y2.__private__.getFontSize=y2.getFontSize=function(){return _2===A2?pt2:pt2*St},vt2=e.R2L||!1;y2.__private__.setR2L=y2.setR2L=function(t2){return vt2=t2,this},y2.__private__.getR2L=y2.getR2L=function(){return vt2};var bt2,yt2=y2.__private__.setZoomMode=function(t2){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(t2))gt2=t2;else if(isNaN(t2)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(t2)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+t2+'" is not recognized.');gt2=t2}else gt2=parseInt(t2,10)};y2.__private__.getZoomMode=function(){return gt2};var wt2,Nt2=y2.__private__.setPageMode=function(t2){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(t2)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+t2+'" is not recognized.');bt2=t2};y2.__private__.getPageMode=function(){return bt2};var Lt2=y2.__private__.setLayoutMode=function(t2){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(t2)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+t2+'" is not recognized.');wt2=t2};y2.__private__.getLayoutMode=function(){return wt2},y2.__private__.setDisplayMode=y2.setDisplayMode=function(t2,e2,n2){return yt2(t2),Lt2(e2),Nt2(n2),this};var xt2={title:"",subject:"",author:"",keywords:"",creator:""};y2.__private__.getDocumentProperty=function(t2){if(Object.keys(xt2).indexOf(t2)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return xt2[t2]},y2.__private__.getDocumentProperties=function(){return xt2},y2.__private__.setDocumentProperties=y2.setProperties=y2.setDocumentProperties=function(t2){for(var e2 in xt2)xt2.hasOwnProperty(e2)&&t2[e2]&&(xt2[e2]=t2[e2]);return this},y2.__private__.setDocumentProperty=function(t2,e2){if(Object.keys(xt2).indexOf(t2)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return xt2[t2]=e2};var At2,St,_t2,Pt2,kt2,Ft2={},It2={},jt2=[],Ct2={},Ot2={},Bt2={},Mt2={},qt2=null,Et2=0,Rt2=[],Dt2=new C(y2),Tt2=e.hotfixes||[],zt2={},Ut2={},Ht2=[],Wt2=function t2(e2,n2,r2,i2,a3,o2){if(!(this instanceof t2))return new t2(e2,n2,r2,i2,a3,o2);isNaN(e2)&&(e2=1),isNaN(n2)&&(n2=0),isNaN(r2)&&(r2=0),isNaN(i2)&&(i2=1),isNaN(a3)&&(a3=0),isNaN(o2)&&(o2=0),this._matrix=[e2,n2,r2,i2,a3,o2]};Object.defineProperty(Wt2.prototype,"sx",{get:function(){return this._matrix[0]},set:function(t2){this._matrix[0]=t2}}),Object.defineProperty(Wt2.prototype,"shy",{get:function(){return this._matrix[1]},set:function(t2){this._matrix[1]=t2}}),Object.defineProperty(Wt2.prototype,"shx",{get:function(){return this._matrix[2]},set:function(t2){this._matrix[2]=t2}}),Object.defineProperty(Wt2.prototype,"sy",{get:function(){return this._matrix[3]},set:function(t2){this._matrix[3]=t2}}),Object.defineProperty(Wt2.prototype,"tx",{get:function(){return this._matrix[4]},set:function(t2){this._matrix[4]=t2}}),Object.defineProperty(Wt2.prototype,"ty",{get:function(){return this._matrix[5]},set:function(t2){this._matrix[5]=t2}}),Object.defineProperty(Wt2.prototype,"a",{get:function(){return this._matrix[0]},set:function(t2){this._matrix[0]=t2}}),Object.defineProperty(Wt2.prototype,"b",{get:function(){return this._matrix[1]},set:function(t2){this._matrix[1]=t2}}),Object.defineProperty(Wt2.prototype,"c",{get:function(){return this._matrix[2]},set:function(t2){this._matrix[2]=t2}}),Object.defineProperty(Wt2.prototype,"d",{get:function(){return this._matrix[3]},set:function(t2){this._matrix[3]=t2}}),Object.defineProperty(Wt2.prototype,"e",{get:function(){return this._matrix[4]},set:function(t2){this._matrix[4]=t2}}),Object.defineProperty(Wt2.prototype,"f",{get:function(){return this._matrix[5]},set:function(t2){this._matrix[5]=t2}}),Object.defineProperty(Wt2.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Wt2.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Wt2.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Wt2.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Wt2.prototype.join=function(t2){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(B2).join(t2)},Wt2.prototype.multiply=function(t2){var e2=t2.sx*this.sx+t2.shy*this.shx,n2=t2.sx*this.shy+t2.shy*this.sy,r2=t2.shx*this.sx+t2.sy*this.shx,i2=t2.shx*this.shy+t2.sy*this.sy,a3=t2.tx*this.sx+t2.ty*this.shx+this.tx,o2=t2.tx*this.shy+t2.ty*this.sy+this.ty;return new Wt2(e2,n2,r2,i2,a3,o2)},Wt2.prototype.decompose=function(){var t2=this.sx,e2=this.shy,n2=this.shx,r2=this.sy,i2=this.tx,a3=this.ty,o2=Math.sqrt(t2*t2+e2*e2),s3=(t2/=o2)*n2+(e2/=o2)*r2;n2-=t2*s3,r2-=e2*s3;var u3=Math.sqrt(n2*n2+r2*r2);return s3/=u3,t2*(r2/=u3)<e2*(n2/=u3)&&(t2=-t2,e2=-e2,s3=-s3,o2=-o2),{scale:new Wt2(o2,0,0,u3,0,0),translate:new Wt2(1,0,0,1,i2,a3),rotate:new Wt2(t2,e2,-e2,t2,0,0),skew:new Wt2(1,0,s3,1,0,0)}},Wt2.prototype.toString=function(t2){return this.join(" ")},Wt2.prototype.inversed=function(){var t2=this.sx,e2=this.shy,n2=this.shx,r2=this.sy,i2=this.tx,a3=this.ty,o2=1/(t2*r2-e2*n2),s3=r2*o2,u3=-e2*o2,c3=-n2*o2,l2=t2*o2;return new Wt2(s3,u3,c3,l2,-s3*i2-c3*a3,-u3*i2-l2*a3)},Wt2.prototype.applyToPoint=function(t2){var e2=t2.x*this.sx+t2.y*this.shx+this.tx,n2=t2.x*this.shy+t2.y*this.sy+this.ty;return new gn(e2,n2)},Wt2.prototype.applyToRectangle=function(t2){var e2=this.applyToPoint(t2),n2=this.applyToPoint(new gn(t2.x+t2.w,t2.y+t2.h));return new mn(e2.x,e2.y,n2.x-e2.x,n2.y-e2.y)},Wt2.prototype.clone=function(){var t2=this.sx,e2=this.shy,n2=this.shx,r2=this.sy,i2=this.tx,a3=this.ty;return new Wt2(t2,e2,n2,r2,i2,a3)},y2.Matrix=Wt2;var Vt2=y2.matrixMult=function(t2,e2){return e2.multiply(t2)},Gt2=new Wt2(1,0,0,1,0,0);y2.unitMatrix=y2.identityMatrix=Gt2;var Yt2=function(t2,e2){if(!Ot2[t2]){var n2=(e2 instanceof M?"Sh":"P")+(Object.keys(Ct2).length+1).toString(10);e2.id=n2,Ot2[t2]=n2,Ct2[n2]=e2,Dt2.publish("addPattern",e2)}};y2.ShadingPattern=M,y2.TilingPattern=q,y2.addShadingPattern=function(t2,e2){return R2("addShadingPattern()"),Yt2(t2,e2),this},y2.beginTilingPattern=function(t2){R2("beginTilingPattern()"),bn(t2.boundingBox[0],t2.boundingBox[1],t2.boundingBox[2]-t2.boundingBox[0],t2.boundingBox[3]-t2.boundingBox[1],t2.matrix)},y2.endTilingPattern=function(t2,e2){R2("endTilingPattern()"),e2.stream=ot2[$2].join(`
`),Yt2(t2,e2),Dt2.publish("endTilingPattern",e2),Ht2.pop().restore()};var Jt2,Xt2=y2.__private__.newObject=function(){var t2=Kt2();return Zt2(t2,!0),t2},Kt2=y2.__private__.newObjectDeferred=function(){return et2++,nt2[et2]=function(){return it2},et2},Zt2=function(t2,e2){return e2=typeof e2=="boolean"&&e2,nt2[t2]=it2,e2&&lt2(t2+" 0 obj"),t2},$t2=y2.__private__.newAdditionalObject=function(){var t2={objId:Kt2(),content:""};return at2.push(t2),t2},Qt2=Kt2(),te2=Kt2(),ee2=y2.__private__.decodeColorString=function(t2){var e2=t2.split(" ");if(e2.length!==2||e2[1]!=="g"&&e2[1]!=="G")e2.length!==5||e2[4]!=="k"&&e2[4]!=="K"||(e2=[(1-e2[0])*(1-e2[3]),(1-e2[1])*(1-e2[3]),(1-e2[2])*(1-e2[3]),"r"]);else{var n2=parseFloat(e2[0]);e2=[n2,n2,n2,"r"]}for(var r2="#",i2=0;i2<3;i2++)r2+=("0"+Math.floor(255*parseFloat(e2[i2])).toString(16)).slice(-2);return r2},ne2=y2.__private__.encodeColorString=function(e2){var n2;typeof e2=="string"&&(e2={ch1:e2});var r2=e2.ch1,i2=e2.ch2,a3=e2.ch3,o2=e2.ch4,s3=e2.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof r2=="string"&&r2.charAt(0)!=="#"){var u3=new h(r2);if(u3.ok)r2=u3.toHex();else if(!/^\d*\.?\d*$/.test(r2))throw new Error('Invalid color "'+r2+'" passed to jsPDF.encodeColorString.')}if(typeof r2=="string"&&/^#[0-9A-Fa-f]{3}$/.test(r2)&&(r2="#"+r2[1]+r2[1]+r2[2]+r2[2]+r2[3]+r2[3]),typeof r2=="string"&&/^#[0-9A-Fa-f]{6}$/.test(r2)){var c3=parseInt(r2.substr(1),16);r2=c3>>16&255,i2=c3>>8&255,a3=255&c3}if(i2===void 0||o2===void 0&&r2===i2&&i2===a3)n2=typeof r2=="string"?r2+" "+s3[0]:e2.precision===2?T2(r2/255)+" "+s3[0]:z2(r2/255)+" "+s3[0];else if(o2===void 0||_typeof(o2)==="object"){if(o2&&!isNaN(o2.a)&&o2.a===0)return["1.","1.","1.",s3[1]].join(" ");n2=typeof r2=="string"?[r2,i2,a3,s3[1]].join(" "):e2.precision===2?[T2(r2/255),T2(i2/255),T2(a3/255),s3[1]].join(" "):[z2(r2/255),z2(i2/255),z2(a3/255),s3[1]].join(" ")}else n2=typeof r2=="string"?[r2,i2,a3,o2,s3[2]].join(" "):e2.precision===2?[T2(r2),T2(i2),T2(a3),T2(o2),s3[2]].join(" "):[z2(r2),z2(i2),z2(a3),z2(o2),s3[2]].join(" ");return n2},re2=y2.__private__.getFilters=function(){return c2},ie2=y2.__private__.putStream=function(t2){var e2=(t2=t2||{}).data||"",n2=t2.filters||re2(),r2=t2.alreadyAppliedFilters||[],i2=t2.addLength1||!1,a3=e2.length,o2=t2.objectId,s3=function(t3){return t3};if(m2!==null&&o2===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m2!==null&&(s3=je2.encryptor(o2,0));var u3={};n2===!0&&(n2=["FlateEncode"]);var c3=t2.additionalKeyValues||[],l2=(u3=E.API.processDataByFilters!==void 0?E.API.processDataByFilters(e2,n2):{data:e2,reverseChain:[]}).reverseChain+(Array.isArray(r2)?r2.join(" "):r2.toString());if(u3.data.length!==0&&(c3.push({key:"Length",value:u3.data.length}),i2===!0&&c3.push({key:"Length1",value:a3})),l2.length!=0)if(l2.split("/").length-1==1)c3.push({key:"Filter",value:l2});else{c3.push({key:"Filter",value:"["+l2+"]"});for(var h2=0;h2<c3.length;h2+=1)if(c3[h2].key==="DecodeParms"){for(var f3=[],d2=0;d2<u3.reverseChain.split("/").length-1;d2+=1)f3.push("null");f3.push(c3[h2].value),c3[h2].value="["+f3.join(" ")+"]"}}lt2("<<");for(var p3=0;p3<c3.length;p3++)lt2("/"+c3[p3].key+" "+c3[p3].value);lt2(">>"),u3.data.length!==0&&(lt2("stream"),lt2(s3(u3.data)),lt2("endstream"))},ae2=y2.__private__.putPage=function(t2){var e2=t2.number,n2=t2.data,r2=t2.objId,i2=t2.contentsObjId;Zt2(r2,!0),lt2("<</Type /Page"),lt2("/Parent "+t2.rootDictionaryObjId+" 0 R"),lt2("/Resources "+t2.resourceDictionaryObjId+" 0 R"),lt2("/MediaBox ["+parseFloat(B2(t2.mediaBox.bottomLeftX))+" "+parseFloat(B2(t2.mediaBox.bottomLeftY))+" "+B2(t2.mediaBox.topRightX)+" "+B2(t2.mediaBox.topRightY)+"]"),t2.cropBox!==null&&lt2("/CropBox ["+B2(t2.cropBox.bottomLeftX)+" "+B2(t2.cropBox.bottomLeftY)+" "+B2(t2.cropBox.topRightX)+" "+B2(t2.cropBox.topRightY)+"]"),t2.bleedBox!==null&&lt2("/BleedBox ["+B2(t2.bleedBox.bottomLeftX)+" "+B2(t2.bleedBox.bottomLeftY)+" "+B2(t2.bleedBox.topRightX)+" "+B2(t2.bleedBox.topRightY)+"]"),t2.trimBox!==null&&lt2("/TrimBox ["+B2(t2.trimBox.bottomLeftX)+" "+B2(t2.trimBox.bottomLeftY)+" "+B2(t2.trimBox.topRightX)+" "+B2(t2.trimBox.topRightY)+"]"),t2.artBox!==null&&lt2("/ArtBox ["+B2(t2.artBox.bottomLeftX)+" "+B2(t2.artBox.bottomLeftY)+" "+B2(t2.artBox.topRightX)+" "+B2(t2.artBox.topRightY)+"]"),typeof t2.userUnit=="number"&&t2.userUnit!==1&&lt2("/UserUnit "+t2.userUnit),Dt2.publish("putPage",{objId:r2,pageContext:Rt2[e2],pageNumber:e2,page:n2}),lt2("/Contents "+i2+" 0 R"),lt2(">>"),lt2("endobj");var a3=n2.join(`
`);return _2===S2&&(a3+=`
Q`),Zt2(i2,!0),ie2({data:a3,filters:re2(),objectId:i2}),lt2("endobj"),r2},oe2=y2.__private__.putPages=function(){var t2,e2,n2=[];for(t2=1;t2<=Et2;t2++)Rt2[t2].objId=Kt2(),Rt2[t2].contentsObjId=Kt2();for(t2=1;t2<=Et2;t2++)n2.push(ae2({number:t2,data:ot2[t2],objId:Rt2[t2].objId,contentsObjId:Rt2[t2].contentsObjId,mediaBox:Rt2[t2].mediaBox,cropBox:Rt2[t2].cropBox,bleedBox:Rt2[t2].bleedBox,trimBox:Rt2[t2].trimBox,artBox:Rt2[t2].artBox,userUnit:Rt2[t2].userUnit,rootDictionaryObjId:Qt2,resourceDictionaryObjId:te2}));Zt2(Qt2,!0),lt2("<</Type /Pages");var r2="/Kids [";for(e2=0;e2<Et2;e2++)r2+=n2[e2]+" 0 R ";lt2(r2+"]"),lt2("/Count "+Et2),lt2(">>"),lt2("endobj"),Dt2.publish("postPutPages")},se2=function(t2){Dt2.publish("putFont",{font:t2,out:lt2,newObject:Xt2,putStream:ie2}),t2.isAlreadyPutted!==!0&&(t2.objectNumber=Xt2(),lt2("<<"),lt2("/Type /Font"),lt2("/BaseFont /"+j(t2.postScriptName)),lt2("/Subtype /Type1"),typeof t2.encoding=="string"&&lt2("/Encoding /"+t2.encoding),lt2("/FirstChar 32"),lt2("/LastChar 255"),lt2(">>"),lt2("endobj"))},ue2=function(t2){t2.objectNumber=Xt2();var e2=[];e2.push({key:"Type",value:"/XObject"}),e2.push({key:"Subtype",value:"/Form"}),e2.push({key:"BBox",value:"["+[B2(t2.x),B2(t2.y),B2(t2.x+t2.width),B2(t2.y+t2.height)].join(" ")+"]"}),e2.push({key:"Matrix",value:"["+t2.matrix.toString()+"]"});var n2=t2.pages[1].join(`
`);ie2({data:n2,additionalKeyValues:e2,objectId:t2.objectNumber}),lt2("endobj")},ce2=function(t2,e2){e2||(e2=21);var n2=Xt2(),r2=(function(t3,e3){var n3,r3=[],i3=1/(e3-1);for(n3=0;n3<1;n3+=i3)r3.push(n3);if(r3.push(1),t3[0].offset!=0){var a4={offset:0,color:t3[0].color};t3.unshift(a4)}if(t3[t3.length-1].offset!=1){var o2={offset:1,color:t3[t3.length-1].color};t3.push(o2)}for(var s3="",u3=0,c3=0;c3<r3.length;c3++){for(n3=r3[c3];n3>t3[u3+1].offset;)u3++;var l2=t3[u3].offset,h2=(n3-l2)/(t3[u3+1].offset-l2),f3=t3[u3].color,d2=t3[u3+1].color;s3+=tt2(Math.round((1-h2)*f3[0]+h2*d2[0]).toString(16))+tt2(Math.round((1-h2)*f3[1]+h2*d2[1]).toString(16))+tt2(Math.round((1-h2)*f3[2]+h2*d2[2]).toString(16))}return s3.trim()})(t2.colors,e2),i2=[];i2.push({key:"FunctionType",value:"0"}),i2.push({key:"Domain",value:"[0.0 1.0]"}),i2.push({key:"Size",value:"["+e2+"]"}),i2.push({key:"BitsPerSample",value:"8"}),i2.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),i2.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ie2({data:r2,additionalKeyValues:i2,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:n2}),lt2("endobj"),t2.objectNumber=Xt2(),lt2("<< /ShadingType "+t2.type),lt2("/ColorSpace /DeviceRGB");var a3="/Coords ["+B2(parseFloat(t2.coords[0]))+" "+B2(parseFloat(t2.coords[1]))+" ";t2.type===2?a3+=B2(parseFloat(t2.coords[2]))+" "+B2(parseFloat(t2.coords[3])):a3+=B2(parseFloat(t2.coords[2]))+" "+B2(parseFloat(t2.coords[3]))+" "+B2(parseFloat(t2.coords[4]))+" "+B2(parseFloat(t2.coords[5])),lt2(a3+="]"),t2.matrix&&lt2("/Matrix ["+t2.matrix.toString()+"]"),lt2("/Function "+n2+" 0 R"),lt2("/Extend [true true]"),lt2(">>"),lt2("endobj")},le2=function(t2,e2){var n2=Kt2(),r2=Xt2();e2.push({resourcesOid:n2,objectOid:r2}),t2.objectNumber=r2;var i2=[];i2.push({key:"Type",value:"/Pattern"}),i2.push({key:"PatternType",value:"1"}),i2.push({key:"PaintType",value:"1"}),i2.push({key:"TilingType",value:"1"}),i2.push({key:"BBox",value:"["+t2.boundingBox.map(B2).join(" ")+"]"}),i2.push({key:"XStep",value:B2(t2.xStep)}),i2.push({key:"YStep",value:B2(t2.yStep)}),i2.push({key:"Resources",value:n2+" 0 R"}),t2.matrix&&i2.push({key:"Matrix",value:"["+t2.matrix.toString()+"]"}),ie2({data:t2.stream,additionalKeyValues:i2,objectId:t2.objectNumber}),lt2("endobj")},he2=function(t2){for(var e2 in t2.objectNumber=Xt2(),lt2("<<"),t2)switch(e2){case"opacity":lt2("/ca "+T2(t2[e2]));break;case"stroke-opacity":lt2("/CA "+T2(t2[e2]))}lt2(">>"),lt2("endobj")},fe2=function(t2){Zt2(t2.resourcesOid,!0),lt2("<<"),lt2("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var t3 in lt2("/Font <<"),Ft2)Ft2.hasOwnProperty(t3)&&(v2===!1||v2===!0&&b2.hasOwnProperty(t3))&&lt2("/"+t3+" "+Ft2[t3].objectNumber+" 0 R");lt2(">>")})(),(function(){if(Object.keys(Ct2).length>0){for(var t3 in lt2("/Shading <<"),Ct2)Ct2.hasOwnProperty(t3)&&Ct2[t3]instanceof M&&Ct2[t3].objectNumber>=0&&lt2("/"+t3+" "+Ct2[t3].objectNumber+" 0 R");Dt2.publish("putShadingPatternDict"),lt2(">>")}})(),(function(t3){if(Object.keys(Ct2).length>0){for(var e2 in lt2("/Pattern <<"),Ct2)Ct2.hasOwnProperty(e2)&&Ct2[e2]instanceof y2.TilingPattern&&Ct2[e2].objectNumber>=0&&Ct2[e2].objectNumber<t3&&lt2("/"+e2+" "+Ct2[e2].objectNumber+" 0 R");Dt2.publish("putTilingPatternDict"),lt2(">>")}})(t2.objectOid),(function(){if(Object.keys(Bt2).length>0){var t3;for(t3 in lt2("/ExtGState <<"),Bt2)Bt2.hasOwnProperty(t3)&&Bt2[t3].objectNumber>=0&&lt2("/"+t3+" "+Bt2[t3].objectNumber+" 0 R");Dt2.publish("putGStateDict"),lt2(">>")}})(),(function(){for(var t3 in lt2("/XObject <<"),zt2)zt2.hasOwnProperty(t3)&&zt2[t3].objectNumber>=0&&lt2("/"+t3+" "+zt2[t3].objectNumber+" 0 R");Dt2.publish("putXobjectDict"),lt2(">>")})(),lt2(">>"),lt2("endobj")},de2=function(t2){It2[t2.fontName]=It2[t2.fontName]||{},It2[t2.fontName][t2.fontStyle]=t2.id},pe2=function(t2,e2,n2,r2,i2){var a3={id:"F"+(Object.keys(Ft2).length+1).toString(10),postScriptName:t2,fontName:e2,fontStyle:n2,encoding:r2,isStandardFont:i2||!1,metadata:{}};return Dt2.publish("addFont",{font:a3,instance:this}),Ft2[a3.id]=a3,de2(a3),a3.id},ge2=y2.__private__.pdfEscape=y2.pdfEscape=function(t2,e2){return(function(t3,e3){var n2,r2,i2,a3,o2,s3,u3,c3,l2;if(i2=(e3=e3||{}).sourceEncoding||"Unicode",o2=e3.outputEncoding,(e3.autoencode||o2)&&Ft2[At2].metadata&&Ft2[At2].metadata[i2]&&Ft2[At2].metadata[i2].encoding&&(a3=Ft2[At2].metadata[i2].encoding,!o2&&Ft2[At2].encoding&&(o2=Ft2[At2].encoding),!o2&&a3.codePages&&(o2=a3.codePages[0]),typeof o2=="string"&&(o2=a3[o2]),o2)){for(u3=!1,s3=[],n2=0,r2=t3.length;n2<r2;n2++)(c3=o2[t3.charCodeAt(n2)])?s3.push(String.fromCharCode(c3)):s3.push(t3[n2]),s3[n2].charCodeAt(0)>>8&&(u3=!0);t3=s3.join("")}for(n2=t3.length;u3===void 0&&n2!==0;)t3.charCodeAt(n2-1)>>8&&(u3=!0),n2--;if(!u3)return t3;for(s3=e3.noBOM?[]:[254,255],n2=0,r2=t3.length;n2<r2;n2++){if((l2=(c3=t3.charCodeAt(n2))>>8)>>8)throw new Error("Character at position "+n2+" of string '"+t3+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");s3.push(l2),s3.push(c3-(l2<<8))}return String.fromCharCode.apply(void 0,s3)})(t2,e2).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},me2=y2.__private__.beginPage=function(t2){ot2[++Et2]=[],Rt2[Et2]={objId:0,contentsObjId:0,userUnit:Number(f2),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(t2[0]),topRightY:Number(t2[1])}},ye2(Et2),ct2(ot2[$2])},ve2=function(t2,e2){var n2,i2,a3;switch(r=e2||r,typeof t2=="string"&&(n2=x2(t2.toLowerCase()),Array.isArray(n2)&&(i2=n2[0],a3=n2[1])),Array.isArray(t2)&&(i2=t2[0]*St,a3=t2[1]*St),isNaN(i2)&&(i2=s2[0],a3=s2[1]),(i2>14400||a3>14400)&&(o.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),i2=Math.min(14400,i2),a3=Math.min(14400,a3)),s2=[i2,a3],r.substr(0,1)){case"l":a3>i2&&(s2=[a3,i2]);break;case"p":i2>a3&&(s2=[a3,i2])}me2(s2),Ze(Xe),lt2(on),fn!==0&&lt2(fn+" J"),dn!==0&&lt2(dn+" j"),Dt2.publish("addPage",{pageNumber:Et2})},be2=function(t2){t2>0&&t2<=Et2&&(ot2.splice(t2,1),Rt2.splice(t2,1),Et2--,$2>Et2&&($2=Et2),this.setPage($2))},ye2=function(t2){t2>0&&t2<=Et2&&($2=t2)},we2=y2.__private__.getNumberOfPages=y2.getNumberOfPages=function(){return ot2.length-1},Ne2=function(t2,e2,n2){var r2,i2=void 0;return n2=n2||{},t2=t2!==void 0?t2:Ft2[At2].fontName,e2=e2!==void 0?e2:Ft2[At2].fontStyle,r2=t2.toLowerCase(),It2[r2]!==void 0&&It2[r2][e2]!==void 0?i2=It2[r2][e2]:It2[t2]!==void 0&&It2[t2][e2]!==void 0?i2=It2[t2][e2]:n2.disableWarning===!1&&o.warn("Unable to look up font label for font '"+t2+"', '"+e2+"'. Refer to getFontList() for available fonts."),i2||n2.noFallback||(i2=It2.times[e2])==null&&(i2=It2.times.normal),i2},Le2=y2.__private__.putInfo=function(){var t2=Xt2(),e2=function(t3){return t3};for(var n2 in m2!==null&&(e2=je2.encryptor(t2,0)),lt2("<<"),lt2("/Producer ("+ge2(e2("jsPDF "+E.version))+")"),xt2)xt2.hasOwnProperty(n2)&&xt2[n2]&&lt2("/"+n2.substr(0,1).toUpperCase()+n2.substr(1)+" ("+ge2(e2(xt2[n2]))+")");lt2("/CreationDate ("+ge2(e2(W2))+")"),lt2(">>"),lt2("endobj")},xe2=y2.__private__.putCatalog=function(t2){var e2=(t2=t2||{}).rootDictionaryObjId||Qt2;switch(Xt2(),lt2("<<"),lt2("/Type /Catalog"),lt2("/Pages "+e2+" 0 R"),gt2||(gt2="fullwidth"),gt2){case"fullwidth":lt2("/OpenAction [3 0 R /FitH null]");break;case"fullheight":lt2("/OpenAction [3 0 R /FitV null]");break;case"fullpage":lt2("/OpenAction [3 0 R /Fit]");break;case"original":lt2("/OpenAction [3 0 R /XYZ null null 1]");break;default:var n2=""+gt2;n2.substr(n2.length-1)==="%"&&(gt2=parseInt(gt2)/100),typeof gt2=="number"&&lt2("/OpenAction [3 0 R /XYZ null null "+T2(gt2)+"]")}switch(wt2||(wt2="continuous"),wt2){case"continuous":lt2("/PageLayout /OneColumn");break;case"single":lt2("/PageLayout /SinglePage");break;case"two":case"twoleft":lt2("/PageLayout /TwoColumnLeft");break;case"tworight":lt2("/PageLayout /TwoColumnRight")}bt2&&lt2("/PageMode /"+bt2),Dt2.publish("putCatalog"),lt2(">>"),lt2("endobj")},Ae2=y2.__private__.putTrailer=function(){lt2("trailer"),lt2("<<"),lt2("/Size "+(et2+1)),lt2("/Root "+et2+" 0 R"),lt2("/Info "+(et2-1)+" 0 R"),m2!==null&&lt2("/Encrypt "+je2.oid+" 0 R"),lt2("/ID [ <"+V2+"> <"+V2+"> ]"),lt2(">>")},Se2=y2.__private__.putHeader=function(){lt2("%PDF-"+w2),lt2("%")},_e2=y2.__private__.putXRef=function(){var t2="0000000000";lt2("xref"),lt2("0 "+(et2+1)),lt2("0000000000 65535 f ");for(var e2=1;e2<=et2;e2++)typeof nt2[e2]=="function"?lt2((t2+nt2[e2]()).slice(-10)+" 00000 n "):nt2[e2]!==void 0?lt2((t2+nt2[e2]).slice(-10)+" 00000 n "):lt2("0000000000 00000 n ")},Pe2=y2.__private__.buildDocument=function(){var t2;et2=0,it2=0,rt2=[],nt2=[],at2=[],Qt2=Kt2(),te2=Kt2(),ct2(rt2),Dt2.publish("buildDocument"),Se2(),oe2(),(function(){Dt2.publish("putAdditionalObjects");for(var t3=0;t3<at2.length;t3++){var e3=at2[t3];Zt2(e3.objId,!0),lt2(e3.content),lt2("endobj")}Dt2.publish("postPutAdditionalObjects")})(),t2=[],(function(){for(var t3 in Ft2)Ft2.hasOwnProperty(t3)&&(v2===!1||v2===!0&&b2.hasOwnProperty(t3))&&se2(Ft2[t3])})(),(function(){var t3;for(t3 in Bt2)Bt2.hasOwnProperty(t3)&&he2(Bt2[t3])})(),(function(){for(var t3 in zt2)zt2.hasOwnProperty(t3)&&ue2(zt2[t3])})(),(function(t3){var e3;for(e3 in Ct2)Ct2.hasOwnProperty(e3)&&(Ct2[e3]instanceof M?ce2(Ct2[e3]):Ct2[e3]instanceof q&&le2(Ct2[e3],t3))})(t2),Dt2.publish("putResources"),t2.forEach(fe2),fe2({resourcesOid:te2,objectOid:Number.MAX_SAFE_INTEGER}),Dt2.publish("postPutResources"),m2!==null&&(je2.oid=Xt2(),lt2("<<"),lt2("/Filter /Standard"),lt2("/V "+je2.v),lt2("/R "+je2.r),lt2("/U <"+je2.toHexString(je2.U)+">"),lt2("/O <"+je2.toHexString(je2.O)+">"),lt2("/P "+je2.P),lt2(">>"),lt2("endobj")),Le2(),xe2();var e2=it2;return _e2(),Ae2(),lt2("startxref"),lt2(""+e2),lt2("%%EOF"),ct2(ot2[$2]),rt2.join(`
`)},ke2=y2.__private__.getBlob=function(t2){return new Blob([ft2(t2)],{type:"application/pdf"})},Fe2=y2.output=y2.__private__.output=(Jt2=function(t2,e2){switch(typeof(e2=e2||{})=="string"?e2={filename:e2}:e2.filename=e2.filename||"generated.pdf",t2){case void 0:return Pe2();case"save":y2.save(e2.filename);break;case"arraybuffer":return ft2(Pe2());case"blob":return ke2(Pe2());case"bloburi":case"bloburl":if(i.URL!==void 0&&typeof i.URL.createObjectURL=="function")return i.URL&&i.URL.createObjectURL(ke2(Pe2()))||void 0;o.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var n2="",r2=Pe2();try{n2=d(r2)}catch{n2=d(unescape(encodeURIComponent(r2)))}return"data:application/pdf;filename="+e2.filename+";base64,"+n2;case"pdfobjectnewwindow":if(Object.prototype.toString.call(i)==="[object Window]"){var a3="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",s3=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';e2.pdfObjectUrl&&(a3=e2.pdfObjectUrl,s3="");var u3='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+a3+'"'+s3+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(e2)+");<\/script></body></html>",c3=i.open();return c3!==null&&c3.document.write(u3),c3}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(i)==="[object Window]"){var l2='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(e2.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+e2.filename+'" width="500px" height="400px" /></body></html>',h2=i.open();if(h2!==null){h2.document.write(l2);var f3=this;h2.document.documentElement.querySelector("#pdfViewer").onload=function(){h2.document.title=e2.filename,h2.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(f3.output("bloburl"))}}return h2}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(i)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var p3='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",e2)+'"></iframe></body></html>',g3=i.open();if(g3!==null&&(g3.document.write(p3),g3.document.title=e2.filename),g3||typeof safari>"u")return g3;break;case"datauri":case"dataurl":return i.document.location.href=this.output("datauristring",e2);default:return null}},Jt2.foo=function(){try{return Jt2.apply(this,arguments)}catch(n2){var t2=n2.stack||"";~t2.indexOf(" at ")&&(t2=t2.split(" at ")[1]);var e2="Error in function "+t2.split(`
`)[0].split("<")[0]+": "+n2.message;if(!i.console)throw new Error(e2);i.console.error(e2,n2),i.alert&&alert(e2)}},Jt2.foo.bar=Jt2,Jt2.foo),Ie2=function(t2){return Array.isArray(Tt2)===!0&&Tt2.indexOf(t2)>-1};switch(a2){case"pt":St=1;break;case"mm":St=72/25.4;break;case"cm":St=72/2.54;break;case"in":St=72;break;case"px":St=Ie2("px_scaling")==1?.75:96/72;break;case"pc":case"em":St=12;break;case"ex":St=6;break;default:if(typeof a2!="number")throw new Error("Invalid unit: "+a2);St=a2}var je2=null;K2(),Y2();var Ce=y2.__private__.getPageInfo=y2.getPageInfo=function(t2){if(isNaN(t2)||t2%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Rt2[t2].objId,pageNumber:t2,pageContext:Rt2[t2]}},Oe=y2.__private__.getPageInfoByObjId=function(t2){if(isNaN(t2)||t2%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var e2 in Rt2)if(Rt2[e2].objId===t2)break;return Ce(e2)},Be=y2.__private__.getCurrentPageInfo=y2.getCurrentPageInfo=function(){return{objId:Rt2[$2].objId,pageNumber:$2,pageContext:Rt2[$2]}};y2.addPage=function(){return ve2.apply(this,arguments),this},y2.setPage=function(){return ye2.apply(this,arguments),ct2.call(this,ot2[$2]),this},y2.insertPage=function(t2){return this.addPage(),this.movePage($2,t2),this},y2.movePage=function(t2,e2){var n2,r2;if(t2>e2){n2=ot2[t2],r2=Rt2[t2];for(var i2=t2;i2>e2;i2--)ot2[i2]=ot2[i2-1],Rt2[i2]=Rt2[i2-1];ot2[e2]=n2,Rt2[e2]=r2,this.setPage(e2)}else if(t2<e2){n2=ot2[t2],r2=Rt2[t2];for(var a3=t2;a3<e2;a3++)ot2[a3]=ot2[a3+1],Rt2[a3]=Rt2[a3+1];ot2[e2]=n2,Rt2[e2]=r2,this.setPage(e2)}return this},y2.deletePage=function(){return be2.apply(this,arguments),this},y2.__private__.text=y2.text=function(e2,n2,r2,i2,a3){var o2,s3,u3,c3,l2,h2,f3,d2,p3,g3=(i2=i2||{}).scope||this;if(typeof e2=="number"&&typeof n2=="number"&&(typeof r2=="string"||Array.isArray(r2))){var m3=r2;r2=n2,n2=e2,e2=m3}if(arguments[3]instanceof Wt2==0?(u3=arguments[4],c3=arguments[5],_typeof(f3=arguments[3])==="object"&&f3!==null||(typeof u3=="string"&&(c3=u3,u3=null),typeof f3=="string"&&(c3=f3,f3=null),typeof f3=="number"&&(u3=f3,f3=null),i2={flags:f3,angle:u3,align:c3})):(R2("The transform parameter of text() with a Matrix value"),p3=a3),isNaN(n2)||isNaN(r2)||e2==null)throw new Error("Invalid arguments passed to jsPDF.text");if(e2.length===0)return g3;var v3,y3="",w3=typeof i2.lineHeightFactor=="number"?i2.lineHeightFactor:Je,N3=g3.internal.scaleFactor;function L3(t2){return t2=t2.split("	").join(Array(i2.TabLen||9).join(" ")),ge2(t2,f3)}function x3(t2){for(var e3,n3=t2.concat(),r3=[],i3=n3.length;i3--;)typeof(e3=n3.shift())=="string"?r3.push(e3):Array.isArray(t2)&&(e3.length===1||e3[1]===void 0&&e3[2]===void 0)?r3.push(e3[0]):r3.push([e3[0],e3[1],e3[2]]);return r3}function A3(t2,e3){var n3;if(typeof t2=="string")n3=e3(t2)[0];else if(Array.isArray(t2)){for(var r3,i3,a4=t2.concat(),o3=[],s4=a4.length;s4--;)typeof(r3=a4.shift())=="string"?o3.push(e3(r3)[0]):Array.isArray(r3)&&typeof r3[0]=="string"&&(i3=e3(r3[0],r3[1],r3[2]),o3.push([i3[0],i3[1],i3[2]]));n3=o3}return n3}var P3=!1,k3=!0;if(typeof e2=="string")P3=!0;else if(Array.isArray(e2)){var F3=e2.concat();s3=[];for(var I2,j2=F3.length;j2--;)(typeof(I2=F3.shift())!="string"||Array.isArray(I2)&&typeof I2[0]!="string")&&(k3=!1);P3=k3}if(P3===!1)throw new Error('Type of text must be string or Array. "'+e2+'" is not recognized.');typeof e2=="string"&&(e2=e2.match(/[\r?\n]/)?e2.split(/\r\n|\r|\n/g):[e2]);var C2=pt2/g3.internal.scaleFactor,O2=C2*(w3-1);switch(i2.baseline){case"bottom":r2-=O2;break;case"top":r2+=C2-O2;break;case"hanging":r2+=C2-2*O2;break;case"middle":r2+=C2/2-O2}if((h2=i2.maxWidth||0)>0&&(typeof e2=="string"?e2=g3.splitTextToSize(e2,h2):Object.prototype.toString.call(e2)==="[object Array]"&&(e2=e2.reduce(function(t2,e3){return t2.concat(g3.splitTextToSize(e3,h2))},[]))),o2={text:e2,x:n2,y:r2,options:i2,mutex:{pdfEscape:ge2,activeFontKey:At2,fonts:Ft2,activeFontSize:pt2}},Dt2.publish("preProcessText",o2),e2=o2.text,u3=(i2=o2.options).angle,p3 instanceof Wt2==0&&u3&&typeof u3=="number"){u3*=Math.PI/180,i2.rotationDirection===0&&(u3=-u3),_2===S2&&(u3=-u3);var M2=Math.cos(u3),q2=Math.sin(u3);p3=new Wt2(M2,q2,-q2,M2,0,0)}else u3&&u3 instanceof Wt2&&(p3=u3);_2!==S2||p3||(p3=Gt2),(l2=i2.charSpace||ln2)!==void 0&&(y3+=B2(U2(l2))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(d2=i2.horizontalScale)!==void 0&&(y3+=B2(100*d2)+` Tz
`),i2.lang;var E2=-1,D3=i2.renderingMode!==void 0?i2.renderingMode:i2.stroke,T3=g3.internal.getCurrentPageInfo().pageContext;switch(D3){case 0:case!1:case"fill":E2=0;break;case 1:case!0:case"stroke":E2=1;break;case 2:case"fillThenStroke":E2=2;break;case 3:case"invisible":E2=3;break;case 4:case"fillAndAddForClipping":E2=4;break;case 5:case"strokeAndAddPathForClipping":E2=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":E2=6;break;case 7:case"addToPathForClipping":E2=7}var z3=T3.usedRenderingMode!==void 0?T3.usedRenderingMode:-1;E2!==-1?y3+=E2+` Tr
`:z3!==-1&&(y3+=`0 Tr
`),E2!==-1&&(T3.usedRenderingMode=E2),c3=i2.align||"left";var H3,W3=pt2*w3,V3=g3.internal.pageSize.getWidth(),G3=Ft2[At2];l2=i2.charSpace||ln2,h2=i2.maxWidth||0,f3=Object.assign({autoencode:!0,noBOM:!0},i2.flags);var Y3=[],J3=function(t2){return g3.getStringUnitWidth(t2,{font:G3,charSpace:l2,fontSize:pt2,doKerning:!1})*pt2/N3};if(Object.prototype.toString.call(e2)==="[object Array]"){var X3;s3=x3(e2),c3!=="left"&&(H3=s3.map(J3));var K3,Z3=0;if(c3==="right"){n2-=H3[0],e2=[],j2=s3.length;for(var $3=0;$3<j2;$3++)$3===0?(K3=en(n2),X3=nn(r2)):(K3=U2(Z3-H3[$3]),X3=-W3),e2.push([s3[$3],K3,X3]),Z3=H3[$3]}else if(c3==="center"){n2-=H3[0]/2,e2=[],j2=s3.length;for(var Q3=0;Q3<j2;Q3++)Q3===0?(K3=en(n2),X3=nn(r2)):(K3=U2((Z3-H3[Q3])/2),X3=-W3),e2.push([s3[Q3],K3,X3]),Z3=H3[Q3]}else if(c3==="left"){e2=[],j2=s3.length;for(var tt3=0;tt3<j2;tt3++)e2.push(s3[tt3])}else if(c3==="justify"&&G3.encoding==="Identity-H"){e2=[],j2=s3.length,h2=h2!==0?h2:V3;for(var et3=0,nt3=0;nt3<j2;nt3++)if(X3=nt3===0?nn(r2):-W3,K3=nt3===0?en(n2):et3,nt3<j2-1){var rt3=U2((h2-H3[nt3])/(s3[nt3].split(" ").length-1)),it3=s3[nt3].split(" ");e2.push([it3[0]+" ",K3,X3]),et3=0;for(var at3=1;at3<it3.length;at3++){var ot3=(J3(it3[at3-1]+" "+it3[at3])-J3(it3[at3]))*N3+rt3;at3==it3.length-1?e2.push([it3[at3],ot3,0]):e2.push([it3[at3]+" ",ot3,0]),et3-=ot3}}else e2.push([s3[nt3],K3,X3]);e2.push(["",et3,0])}else{if(c3!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(e2=[],j2=s3.length,h2=h2!==0?h2:V3,nt3=0;nt3<j2;nt3++){X3=nt3===0?nn(r2):-W3,K3=nt3===0?en(n2):0;var st3=s3[nt3].split(" ").length-1,ut3=st3>0?(h2-H3[nt3])/st3:0;nt3<j2-1?Y3.push(B2(U2(ut3))):Y3.push(0),e2.push([s3[nt3],K3,X3])}}}(typeof i2.R2L=="boolean"?i2.R2L:vt2)===!0&&(e2=A3(e2,function(t2,e3,n3){return[t2.split("").reverse().join(""),e3,n3]})),o2={text:e2,x:n2,y:r2,options:i2,mutex:{pdfEscape:ge2,activeFontKey:At2,fonts:Ft2,activeFontSize:pt2}},Dt2.publish("postProcessText",o2),e2=o2.text,v3=o2.mutex.isHex||!1;var ct3=Ft2[At2].encoding;ct3!=="WinAnsiEncoding"&&ct3!=="StandardEncoding"||(e2=A3(e2,function(t2,e3,n3){return[L3(t2),e3,n3]})),s3=x3(e2),e2=[];for(var ht3,ft3,dt3,gt3=Array.isArray(s3[0])?1:0,mt3="",bt3=function(t2,e3,n3){var r3="";return n3 instanceof Wt2?(n3=typeof i2.angle=="number"?Vt2(n3,new Wt2(1,0,0,1,t2,e3)):Vt2(new Wt2(1,0,0,1,t2,e3),n3),_2===S2&&(n3=Vt2(new Wt2(1,0,0,-1,0,0),n3)),r3=n3.join(" ")+` Tm
`):r3=B2(t2)+" "+B2(e3)+` Td
`,r3},yt3=0;yt3<s3.length;yt3++){switch(mt3="",gt3){case 1:dt3=(v3?"<":"(")+s3[yt3][0]+(v3?">":")"),ht3=parseFloat(s3[yt3][1]),ft3=parseFloat(s3[yt3][2]);break;case 0:dt3=(v3?"<":"(")+s3[yt3]+(v3?">":")"),ht3=en(n2),ft3=nn(r2)}Y3!==void 0&&Y3[yt3]!==void 0&&(mt3=Y3[yt3]+` Tw
`),yt3===0?e2.push(mt3+bt3(ht3,ft3,p3)+dt3):gt3===0?e2.push(mt3+dt3):gt3===1&&e2.push(mt3+bt3(ht3,ft3,p3)+dt3)}e2=gt3===0?e2.join(` Tj
T* `):e2.join(` Tj
`),e2+=` Tj
`;var wt3=`BT
/`;return wt3+=At2+" "+pt2+` Tf
`,wt3+=B2(pt2*w3)+` TL
`,wt3+=un+`
`,wt3+=y3,wt3+=e2,lt2(wt3+="ET"),b2[At2]=!0,g3};var Me=y2.__private__.clip=y2.clip=function(t2){return lt2(t2==="evenodd"?"W*":"W"),this};y2.clipEvenOdd=function(){return Me("evenodd")},y2.__private__.discardPath=y2.discardPath=function(){return lt2("n"),this};var qe=y2.__private__.isValidStyle=function(t2){var e2=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(t2)!==-1&&(e2=!0),e2};y2.__private__.setDefaultPathOperation=y2.setDefaultPathOperation=function(t2){return qe(t2)&&(g2=t2),this};var Ee=y2.__private__.getStyle=y2.getStyle=function(t2){var e2=g2;switch(t2){case"D":case"S":e2="S";break;case"F":e2="f";break;case"FD":case"DF":e2="B";break;case"f":case"f*":case"B":case"B*":e2=t2}return e2},Re=y2.close=function(){return lt2("h"),this};y2.stroke=function(){return lt2("S"),this},y2.fill=function(t2){return De("f",t2),this},y2.fillEvenOdd=function(t2){return De("f*",t2),this},y2.fillStroke=function(t2){return De("B",t2),this},y2.fillStrokeEvenOdd=function(t2){return De("B*",t2),this};var De=function(e2,n2){_typeof(n2)==="object"?Ue(n2,e2):lt2(e2)},Te=function(t2){t2===null||_2===S2&&t2===void 0||(t2=Ee(t2),lt2(t2))};function ze(t2,e2,n2,r2,i2){var a3=new q(e2||this.boundingBox,n2||this.xStep,r2||this.yStep,this.gState,i2||this.matrix);a3.stream=this.stream;var o2=t2+"$$"+this.cloneIndex+++"$$";return Yt2(o2,a3),a3}var Ue=function(t2,e2){var n2=Ot2[t2.key],r2=Ct2[n2];if(r2 instanceof M)lt2("q"),lt2(He(e2)),r2.gState&&y2.setGState(r2.gState),lt2(t2.matrix.toString()+" cm"),lt2("/"+n2+" sh"),lt2("Q");else if(r2 instanceof q){var i2=new Wt2(1,0,0,-1,0,_n());t2.matrix&&(i2=i2.multiply(t2.matrix||Gt2),n2=ze.call(r2,t2.key,t2.boundingBox,t2.xStep,t2.yStep,i2).id),lt2("q"),lt2("/Pattern cs"),lt2("/"+n2+" scn"),r2.gState&&y2.setGState(r2.gState),lt2(e2),lt2("Q")}},He=function(t2){switch(t2){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},We=y2.moveTo=function(t2,e2){return lt2(B2(U2(t2))+" "+B2(H2(e2))+" m"),this},Ve=y2.lineTo=function(t2,e2){return lt2(B2(U2(t2))+" "+B2(H2(e2))+" l"),this},Ge=y2.curveTo=function(t2,e2,n2,r2,i2,a3){return lt2([B2(U2(t2)),B2(H2(e2)),B2(U2(n2)),B2(H2(r2)),B2(U2(i2)),B2(H2(a3)),"c"].join(" ")),this};y2.__private__.line=y2.line=function(t2,e2,n2,r2,i2){if(isNaN(t2)||isNaN(e2)||isNaN(n2)||isNaN(r2)||!qe(i2))throw new Error("Invalid arguments passed to jsPDF.line");return _2===A2?this.lines([[n2-t2,r2-e2]],t2,e2,[1,1],i2||"S"):this.lines([[n2-t2,r2-e2]],t2,e2,[1,1]).stroke()},y2.__private__.lines=y2.lines=function(t2,e2,n2,r2,i2,a3){var o2,s3,u3,c3,l2,h2,f3,d2,p3,g3,m3,v3;if(typeof t2=="number"&&(v3=n2,n2=e2,e2=t2,t2=v3),r2=r2||[1,1],a3=a3||!1,isNaN(e2)||isNaN(n2)||!Array.isArray(t2)||!Array.isArray(r2)||!qe(i2)||typeof a3!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(We(e2,n2),o2=r2[0],s3=r2[1],c3=t2.length,g3=e2,m3=n2,u3=0;u3<c3;u3++)(l2=t2[u3]).length===2?(g3=l2[0]*o2+g3,m3=l2[1]*s3+m3,Ve(g3,m3)):(h2=l2[0]*o2+g3,f3=l2[1]*s3+m3,d2=l2[2]*o2+g3,p3=l2[3]*s3+m3,g3=l2[4]*o2+g3,m3=l2[5]*s3+m3,Ge(h2,f3,d2,p3,g3,m3));return a3&&Re(),Te(i2),this},y2.path=function(t2){for(var e2=0;e2<t2.length;e2++){var n2=t2[e2],r2=n2.c;switch(n2.op){case"m":We(r2[0],r2[1]);break;case"l":Ve(r2[0],r2[1]);break;case"c":Ge.apply(this,r2);break;case"h":Re()}}return this},y2.__private__.rect=y2.rect=function(t2,e2,n2,r2,i2){if(isNaN(t2)||isNaN(e2)||isNaN(n2)||isNaN(r2)||!qe(i2))throw new Error("Invalid arguments passed to jsPDF.rect");return _2===A2&&(r2=-r2),lt2([B2(U2(t2)),B2(H2(e2)),B2(U2(n2)),B2(U2(r2)),"re"].join(" ")),Te(i2),this},y2.__private__.triangle=y2.triangle=function(t2,e2,n2,r2,i2,a3,o2){if(isNaN(t2)||isNaN(e2)||isNaN(n2)||isNaN(r2)||isNaN(i2)||isNaN(a3)||!qe(o2))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[n2-t2,r2-e2],[i2-n2,a3-r2],[t2-i2,e2-a3]],t2,e2,[1,1],o2,!0),this},y2.__private__.roundedRect=y2.roundedRect=function(t2,e2,n2,r2,i2,a3,o2){if(isNaN(t2)||isNaN(e2)||isNaN(n2)||isNaN(r2)||isNaN(i2)||isNaN(a3)||!qe(o2))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var s3=4/3*(Math.SQRT2-1);return i2=Math.min(i2,.5*n2),a3=Math.min(a3,.5*r2),this.lines([[n2-2*i2,0],[i2*s3,0,i2,a3-a3*s3,i2,a3],[0,r2-2*a3],[0,a3*s3,-i2*s3,a3,-i2,a3],[2*i2-n2,0],[-i2*s3,0,-i2,-a3*s3,-i2,-a3],[0,2*a3-r2],[0,-a3*s3,i2*s3,-a3,i2,-a3]],t2+i2,e2,[1,1],o2,!0),this},y2.__private__.ellipse=y2.ellipse=function(t2,e2,n2,r2,i2){if(isNaN(t2)||isNaN(e2)||isNaN(n2)||isNaN(r2)||!qe(i2))throw new Error("Invalid arguments passed to jsPDF.ellipse");var a3=4/3*(Math.SQRT2-1)*n2,o2=4/3*(Math.SQRT2-1)*r2;return We(t2+n2,e2),Ge(t2+n2,e2-o2,t2+a3,e2-r2,t2,e2-r2),Ge(t2-a3,e2-r2,t2-n2,e2-o2,t2-n2,e2),Ge(t2-n2,e2+o2,t2-a3,e2+r2,t2,e2+r2),Ge(t2+a3,e2+r2,t2+n2,e2+o2,t2+n2,e2),Te(i2),this},y2.__private__.circle=y2.circle=function(t2,e2,n2,r2){if(isNaN(t2)||isNaN(e2)||isNaN(n2)||!qe(r2))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(t2,e2,n2,n2,r2)},y2.setFont=function(t2,e2,n2){return n2&&(e2=F2(e2,n2)),At2=Ne2(t2,e2,{disableWarning:!1}),this};var Ye=y2.__private__.getFont=y2.getFont=function(){return Ft2[Ne2.apply(y2,arguments)]};y2.__private__.getFontList=y2.getFontList=function(){var t2,e2,n2={};for(t2 in It2)if(It2.hasOwnProperty(t2))for(e2 in n2[t2]=[],It2[t2])It2[t2].hasOwnProperty(e2)&&n2[t2].push(e2);return n2},y2.addFont=function(t2,e2,n2,r2,i2){var a3=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&a3.indexOf(arguments[3])!==-1?i2=arguments[3]:arguments[3]&&a3.indexOf(arguments[3])==-1&&(n2=F2(n2,r2)),pe2.call(this,t2,e2,n2,i2=i2||"Identity-H")};var Je,Xe=e.lineWidth||.200025,Ke=y2.__private__.getLineWidth=y2.getLineWidth=function(){return Xe},Ze=y2.__private__.setLineWidth=y2.setLineWidth=function(t2){return Xe=t2,lt2(B2(U2(t2))+" w"),this};y2.__private__.setLineDash=E.API.setLineDash=E.API.setLineDashPattern=function(t2,e2){if(t2=t2||[],e2=e2||0,isNaN(e2)||!Array.isArray(t2))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return t2=t2.map(function(t3){return B2(U2(t3))}).join(" "),e2=B2(U2(e2)),lt2("["+t2+"] "+e2+" d"),this};var $e=y2.__private__.getLineHeight=y2.getLineHeight=function(){return pt2*Je};y2.__private__.getLineHeight=y2.getLineHeight=function(){return pt2*Je};var Qe=y2.__private__.setLineHeightFactor=y2.setLineHeightFactor=function(t2){return typeof(t2=t2||1.15)=="number"&&(Je=t2),this},tn=y2.__private__.getLineHeightFactor=y2.getLineHeightFactor=function(){return Je};Qe(e.lineHeight);var en=y2.__private__.getHorizontalCoordinate=function(t2){return U2(t2)},nn=y2.__private__.getVerticalCoordinate=function(t2){return _2===S2?t2:Rt2[$2].mediaBox.topRightY-Rt2[$2].mediaBox.bottomLeftY-U2(t2)},rn=y2.__private__.getHorizontalCoordinateString=y2.getHorizontalCoordinateString=function(t2){return B2(en(t2))},an=y2.__private__.getVerticalCoordinateString=y2.getVerticalCoordinateString=function(t2){return B2(nn(t2))},on=e.strokeColor||"0 G";y2.__private__.getStrokeColor=y2.getDrawColor=function(){return ee2(on)},y2.__private__.setStrokeColor=y2.setDrawColor=function(t2,e2,n2,r2){return on=ne2({ch1:t2,ch2:e2,ch3:n2,ch4:r2,pdfColorType:"draw",precision:2}),lt2(on),this};var sn=e.fillColor||"0 g";y2.__private__.getFillColor=y2.getFillColor=function(){return ee2(sn)},y2.__private__.setFillColor=y2.setFillColor=function(t2,e2,n2,r2){return sn=ne2({ch1:t2,ch2:e2,ch3:n2,ch4:r2,pdfColorType:"fill",precision:2}),lt2(sn),this};var un=e.textColor||"0 g",cn=y2.__private__.getTextColor=y2.getTextColor=function(){return ee2(un)};y2.__private__.setTextColor=y2.setTextColor=function(t2,e2,n2,r2){return un=ne2({ch1:t2,ch2:e2,ch3:n2,ch4:r2,pdfColorType:"text",precision:3}),this};var ln2=e.charSpace,hn=y2.__private__.getCharSpace=y2.getCharSpace=function(){return parseFloat(ln2||0)};y2.__private__.setCharSpace=y2.setCharSpace=function(t2){if(isNaN(t2))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ln2=t2,this};var fn=0;y2.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},y2.__private__.setLineCap=y2.setLineCap=function(t2){var e2=y2.CapJoinStyles[t2];if(e2===void 0)throw new Error("Line cap style of '"+t2+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return fn=e2,lt2(e2+" J"),this};var dn=0;y2.__private__.setLineJoin=y2.setLineJoin=function(t2){var e2=y2.CapJoinStyles[t2];if(e2===void 0)throw new Error("Line join style of '"+t2+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return dn=e2,lt2(e2+" j"),this},y2.__private__.setLineMiterLimit=y2.__private__.setMiterLimit=y2.setLineMiterLimit=y2.setMiterLimit=function(t2){if(t2=t2||0,isNaN(t2))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return lt2(B2(U2(t2))+" M"),this},y2.GState=O,y2.setGState=function(t2){(t2=typeof t2=="string"?Bt2[Mt2[t2]]:pn(null,t2)).equals(qt2)||(lt2("/"+t2.id+" gs"),qt2=t2)};var pn=function(t2,e2){if(!t2||!Mt2[t2]){var n2=!1;for(var r2 in Bt2)if(Bt2.hasOwnProperty(r2)&&Bt2[r2].equals(e2)){n2=!0;break}if(n2)e2=Bt2[r2];else{var i2="GS"+(Object.keys(Bt2).length+1).toString(10);Bt2[i2]=e2,e2.id=i2}return t2&&(Mt2[t2]=e2.id),Dt2.publish("addGState",e2),e2}};y2.addGState=function(t2,e2){return pn(t2,e2),this},y2.saveGraphicsState=function(){return lt2("q"),jt2.push({key:At2,size:pt2,color:un}),this},y2.restoreGraphicsState=function(){lt2("Q");var t2=jt2.pop();return At2=t2.key,pt2=t2.size,un=t2.color,qt2=null,this},y2.setCurrentTransformationMatrix=function(t2){return lt2(t2.toString()+" cm"),this},y2.comment=function(t2){return lt2("#"+t2),this};var gn=function(t2,e2){var n2=t2||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return n2},set:function(t3){isNaN(t3)||(n2=parseFloat(t3))}});var r2=e2||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return r2},set:function(t3){isNaN(t3)||(r2=parseFloat(t3))}});var i2="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return i2},set:function(t3){i2=t3.toString()}}),this},mn=function(t2,e2,n2,r2){gn.call(this,t2,e2),this.type="rect";var i2=n2||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return i2},set:function(t3){isNaN(t3)||(i2=parseFloat(t3))}});var a3=r2||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return a3},set:function(t3){isNaN(t3)||(a3=parseFloat(t3))}}),this},vn=function(){this.page=Et2,this.currentPage=$2,this.pages=ot2.slice(0),this.pagesContext=Rt2.slice(0),this.x=_t2,this.y=Pt2,this.matrix=kt2,this.width=wn($2),this.height=Ln($2),this.outputDestination=ut2,this.id="",this.objectNumber=-1};vn.prototype.restore=function(){Et2=this.page,$2=this.currentPage,Rt2=this.pagesContext,ot2=this.pages,_t2=this.x,Pt2=this.y,kt2=this.matrix,Nn($2,this.width),xn($2,this.height),ut2=this.outputDestination};var bn=function(t2,e2,n2,r2,i2){Ht2.push(new vn),Et2=$2=0,ot2=[],_t2=t2,Pt2=e2,kt2=i2,me2([n2,r2])};for(var yn in y2.beginFormObject=function(t2,e2,n2,r2,i2){return bn(t2,e2,n2,r2,i2),this},y2.endFormObject=function(t2){return(function(t3){if(Ut2[t3])Ht2.pop().restore();else{var e2=new vn,n2="Xo"+(Object.keys(zt2).length+1).toString(10);e2.id=n2,Ut2[t3]=n2,zt2[n2]=e2,Dt2.publish("addFormObject",e2),Ht2.pop().restore()}})(t2),this},y2.doFormObject=function(t2,e2){var n2=zt2[Ut2[t2]];return lt2("q"),lt2(e2.toString()+" cm"),lt2("/"+n2.id+" Do"),lt2("Q"),this},y2.getFormObject=function(t2){var e2=zt2[Ut2[t2]];return{x:e2.x,y:e2.y,width:e2.width,height:e2.height,matrix:e2.matrix}},y2.save=function(t2,e2){return t2=t2||"generated.pdf",(e2=e2||{}).returnPromise=e2.returnPromise||!1,e2.returnPromise===!1?(l(ke2(Pe2()),t2),typeof l.unload=="function"&&i.setTimeout&&setTimeout(l.unload,911),this):new Promise(function(e3,n2){try{var r2=l(ke2(Pe2()),t2);typeof l.unload=="function"&&i.setTimeout&&setTimeout(l.unload,911),e3(r2)}catch(a3){n2(a3.message)}})},E.API)E.API.hasOwnProperty(yn)&&(yn==="events"&&E.API.events.length?(function(t2,e2){var n2,r2,i2;for(i2=e2.length-1;i2!==-1;i2--)n2=e2[i2][0],r2=e2[i2][1],t2.subscribe.apply(t2,[n2].concat(typeof r2=="function"?[r2]:r2))})(Dt2,E.API.events):y2[yn]=E.API[yn]);function wn(t2){return Rt2[t2].mediaBox.topRightX-Rt2[t2].mediaBox.bottomLeftX}function Nn(t2,e2){Rt2[t2].mediaBox.topRightX=e2+Rt2[t2].mediaBox.bottomLeftX}function Ln(t2){return Rt2[t2].mediaBox.topRightY-Rt2[t2].mediaBox.bottomLeftY}function xn(t2,e2){Rt2[t2].mediaBox.topRightY=e2+Rt2[t2].mediaBox.bottomLeftY}var An=y2.getPageWidth=function(t2){return wn(t2=t2||$2)/St},Sn=y2.setPageWidth=function(t2,e2){Nn(t2,e2*St)},_n=y2.getPageHeight=function(t2){return Ln(t2=t2||$2)/St},Pn=y2.setPageHeight=function(t2,e2){xn(t2,e2*St)};return y2.internal={pdfEscape:ge2,getStyle:Ee,getFont:Ye,getFontSize:mt2,getCharSpace:hn,getTextColor:cn,getLineHeight:$e,getLineHeightFactor:tn,getLineWidth:Ke,write:ht2,getHorizontalCoordinate:en,getVerticalCoordinate:nn,getCoordinateString:rn,getVerticalCoordinateString:an,collections:{},newObject:Xt2,newAdditionalObject:$t2,newObjectDeferred:Kt2,newObjectDeferredBegin:Zt2,getFilters:re2,putStream:ie2,events:Dt2,scaleFactor:St,pageSize:{getWidth:function(){return An($2)},setWidth:function(t2){Sn($2,t2)},getHeight:function(){return _n($2)},setHeight:function(t2){Pn($2,t2)}},encryptionOptions:m2,encryption:je2,getEncryptor:function(t2){return m2!==null?je2.encryptor(t2,0):function(t3){return t3}},output:Fe2,getNumberOfPages:we2,get pages(){return ot2},out:lt2,f2:T2,f3:z2,getPageInfo:Ce,getPageInfoByObjId:Oe,getCurrentPageInfo:Be,getPDFVersion:N2,Point:gn,Rectangle:mn,Matrix:Wt2,hasHotfix:Ie2},Object.defineProperty(y2.internal.pageSize,"width",{get:function(){return An($2)},set:function(t2){Sn($2,t2)},enumerable:!0,configurable:!0}),Object.defineProperty(y2.internal.pageSize,"height",{get:function(){return _n($2)},set:function(t2){Pn($2,t2)},enumerable:!0,configurable:!0}),function(t2){for(var e2=0,n2=dt2.length;e2<n2;e2++){var r2=pe2.call(this,t2[e2][0],t2[e2][1],t2[e2][2],dt2[e2][3],!0);v2===!1&&(b2[r2]=!0);var i2=t2[e2][0].split("-");de2({id:r2,fontName:i2[0],fontStyle:i2[1]||""})}Dt2.publish("addFonts",{fonts:Ft2,dictionary:It2})}.call(y2,dt2),At2="F1",ve2(s2,r),Dt2.publish("initialized"),y2}I.prototype.lsbFirstWord=function(t2){return String.fromCharCode(255&t2,t2>>8&255,t2>>16&255,t2>>24&255)},I.prototype.toHexString=function(t2){return t2.split("").map(function(t3){return("0"+(255&t3.charCodeAt(0)).toString(16)).slice(-2)}).join("")},I.prototype.hexToBytes=function(t2){for(var e=[],n=0;n<t2.length;n+=2)e.push(String.fromCharCode(parseInt(t2.substr(n,2),16)));return e.join("")},I.prototype.processOwnerPassword=function(t2,e){return k(S(e).substr(0,5),t2)},I.prototype.encryptor=function(t2,e){var n=S(this.encryptionKey+String.fromCharCode(255&t2,t2>>8&255,t2>>16&255,255&e,e>>8&255)).substr(0,10);return function(t3){return k(n,t3)}},O.prototype.equals=function(e){var n,r="id,objectNumber,equals";if(!e||_typeof(e)!==_typeof(this))return!1;var i2=0;for(n in this)if(!(r.indexOf(n)>=0)){if(this.hasOwnProperty(n)&&!e.hasOwnProperty(n)||this[n]!==e[n])return!1;i2++}for(n in e)e.hasOwnProperty(n)&&r.indexOf(n)<0&&i2--;return i2===0},E.API={events:[]},E.version="3.0.4";var R=E.API,D=1,T=function(t2){return t2.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},z=function(t2){return t2.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},U=function(t2){return t2.toFixed(2)},H=function(t2){return t2.toFixed(5)};R.__acroform__={};var W=function(t2,e){t2.prototype=Object.create(e.prototype),t2.prototype.constructor=t2},V=function(t2){return t2*D},G=function(t2){var e=new ct,n=xt.internal.getHeight(t2)||0,r=xt.internal.getWidth(t2)||0;return e.BBox=[0,0,Number(U(r)),Number(U(n))],e},Y=R.__acroform__.setBit=function(t2,e){if(t2=t2||0,e=e||0,isNaN(t2)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t2|1<<e},J=R.__acroform__.clearBit=function(t2,e){if(t2=t2||0,e=e||0,isNaN(t2)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t2&~(1<<e)},X=R.__acroform__.getBit=function(t2,e){if(isNaN(t2)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t2&1<<e?1:0},K=R.__acroform__.getBitForPdf=function(t2,e){if(isNaN(t2)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return X(t2,e-1)},Z=R.__acroform__.setBitForPdf=function(t2,e){if(isNaN(t2)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Y(t2,e-1)},$$1=R.__acroform__.clearBitForPdf=function(t2,e){if(isNaN(t2)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return J(t2,e-1)},Q=R.__acroform__.calculateCoordinates=function(t2,e){var n=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,i2=t2[0],a2=t2[1],o2=t2[2],s2=t2[3],u2={};return u2.lowerLeft_X=n(i2)||0,u2.lowerLeft_Y=r(a2+s2)||0,u2.upperRight_X=n(i2+o2)||0,u2.upperRight_Y=r(a2)||0,[Number(U(u2.lowerLeft_X)),Number(U(u2.lowerLeft_Y)),Number(U(u2.upperRight_X)),Number(U(u2.upperRight_Y))]},tt=function(t2){if(t2.appearanceStreamContent)return t2.appearanceStreamContent;if(t2.V||t2.DV){var e=[],n=t2._V||t2.DV,r=et(t2,n),i2=t2.scope.internal.getFont(t2.fontName,t2.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t2.scope.__private__.encodeColorString(t2.color)),e.push("/"+i2+" "+U(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var a2=G(t2);return a2.scope=t2.scope,a2.stream=e.join(`
`),a2}},et=function(t2,e){var n=t2.fontSize===0?t2.maxFontSize:t2.fontSize,r={text:"",fontSize:""},i2=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i2=t2.multiline?i2.map(function(t3){return t3.split(`
`)}):i2.map(function(t3){return[t3]});var a2=n,o2=xt.internal.getHeight(t2)||0;o2=o2<0?-o2:o2;var s2=xt.internal.getWidth(t2)||0;s2=s2<0?-s2:s2;var u2=function(e2,n2,r2){if(e2+1<i2.length){var a3=n2+" "+i2[e2+1][0];return nt(a3,t2,r2).width<=s2-4}return!1};a2++;t:for(;a2>0;){e="",a2--;var c2,l2,h2=nt("3",t2,a2).height,f2=t2.multiline?o2-a2:(o2-h2)/2,d2=f2+=2,p2=0,g2=0,m2=0;if(a2<=0){e=`(...) Tj
`,e+="% Width of Text: "+nt(e,t2,a2=12).width+", FieldWidth:"+s2+`
`;break}for(var v2="",b2=0,y2=0;y2<i2.length;y2++)if(i2.hasOwnProperty(y2)){var w2=!1;if(i2[y2].length!==1&&m2!==i2[y2].length-1){if((h2+2)*(b2+2)+2>o2)continue t;v2+=i2[y2][m2],w2=!0,g2=y2,y2--}else{v2=(v2+=i2[y2][m2]+" ").substr(v2.length-1)==" "?v2.substr(0,v2.length-1):v2;var N2=parseInt(y2),L2=u2(N2,v2,a2),x2=y2>=i2.length-1;if(L2&&!x2){v2+=" ",m2=0;continue}if(L2||x2){if(x2)g2=N2;else if(t2.multiline&&(h2+2)*(b2+2)+2>o2)continue t}else{if(!t2.multiline||(h2+2)*(b2+2)+2>o2)continue t;g2=N2}}for(var A2="",S2=p2;S2<=g2;S2++){var _2=i2[S2];if(t2.multiline){if(S2===g2){A2+=_2[m2]+" ",m2=(m2+1)%_2.length;continue}if(S2===p2){A2+=_2[_2.length-1]+" ";continue}}A2+=_2[0]+" "}switch(A2=A2.substr(A2.length-1)==" "?A2.substr(0,A2.length-1):A2,l2=nt(A2,t2,a2).width,t2.textAlign){case"right":c2=s2-l2-2;break;case"center":c2=(s2-l2)/2;break;default:c2=2}e+=U(c2)+" "+U(d2)+` Td
`,e+="("+T(A2)+`) Tj
`,e+=-U(c2)+` 0 Td
`,d2=-(a2+2),l2=0,p2=w2?g2:g2+1,b2++,v2=""}break}return r.text=e,r.fontSize=a2,r},nt=function(t2,e,n){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),i2=e.scope.getStringUnitWidth(t2,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i2}},rt={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},it=function(t2,e){var n={type:"reference",object:t2};e.internal.getPageInfo(t2.page).pageContext.annotations.find(function(t3){return t3.type===n.type&&t3.object===n.object})===void 0&&e.internal.getPageInfo(t2.page).pageContext.annotations.push(n)},at=function(e,n){if(n.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(ht.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(rt)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");D=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new lt,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(t2){t2.internal.events.unsubscribe(t2.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t2.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t2.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(t2){t2.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var e2=t2.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n2 in e2)if(e2.hasOwnProperty(n2)){var r=e2[n2];r.objId=void 0,r.hasAnnotation&&it(r,t2)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(t2){if(t2.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t2.internal.write("/AcroForm "+t2.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(n2){(function(e2,n3){var r=!e2;for(var i2 in e2||(n3.internal.newObjectDeferredBegin(n3.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n3.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),e2=e2||n3.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(e2.hasOwnProperty(i2)){var a2=e2[i2],o2=[],s2=a2.Rect;if(a2.Rect&&(a2.Rect=Q(a2.Rect,n3)),n3.internal.newObjectDeferredBegin(a2.objId,!0),a2.DA=xt.createDefaultAppearanceStream(a2),_typeof(a2)==="object"&&typeof a2.getKeyValueListForStream=="function"&&(o2=a2.getKeyValueListForStream()),a2.Rect=s2,a2.hasAppearanceStream&&!a2.appearanceStreamContent){var u2=tt(a2);o2.push({key:"AP",value:"<</N "+u2+">>"}),n3.internal.acroformPlugin.xForms.push(u2)}if(a2.appearanceStreamContent){var c2="";for(var l2 in a2.appearanceStreamContent)if(a2.appearanceStreamContent.hasOwnProperty(l2)){var h2=a2.appearanceStreamContent[l2];if(c2+="/"+l2+" ",c2+="<<",Object.keys(h2).length>=1||Array.isArray(h2)){for(var i2 in h2)if(h2.hasOwnProperty(i2)){var f2=h2[i2];typeof f2=="function"&&(f2=f2.call(n3,a2)),c2+="/"+i2+" "+f2+" ",n3.internal.acroformPlugin.xForms.indexOf(f2)>=0||n3.internal.acroformPlugin.xForms.push(f2)}}else typeof(f2=h2)=="function"&&(f2=f2.call(n3,a2)),c2+="/"+i2+" "+f2,n3.internal.acroformPlugin.xForms.indexOf(f2)>=0||n3.internal.acroformPlugin.xForms.push(f2);c2+=">>"}o2.push({key:"AP",value:`<<
`+c2+">>"})}n3.internal.putStream({additionalKeyValues:o2,objectId:a2.objId}),n3.internal.out("endobj")}r&&(function(e3,n4){for(var r2 in e3)if(e3.hasOwnProperty(r2)){var i3=r2,a3=e3[r2];n4.internal.newObjectDeferredBegin(a3.objId,!0),_typeof(a3)==="object"&&typeof a3.putStream=="function"&&a3.putStream(),delete e3[i3]}})(n3.internal.acroformPlugin.xForms,n3)})(n2,e)}),e.internal.acroformPlugin.isInitialized=!0}},ot=R.__acroform__.arrayToPdfArray=function(e,n,r){var i2=function(t2){return t2};if(Array.isArray(e)){for(var a2="[",o2=0;o2<e.length;o2++)switch(o2!==0&&(a2+=" "),_typeof(e[o2])){case"boolean":case"number":case"object":a2+=e[o2].toString();break;case"string":e[o2].substr(0,1)!=="/"?(n!==void 0&&r&&(i2=r.internal.getEncryptor(n)),a2+="("+T(i2(e[o2].toString()))+")"):a2+=e[o2].toString()}return a2+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},st=function(t2,e,n){var r=function(t3){return t3};return e!==void 0&&n&&(r=n.internal.getEncryptor(e)),(t2=t2||"").toString(),"("+T(r(t2))+")"},ut=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t2){this._objId=t2}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ut.prototype.toString=function(){return this.objId+" 0 R"},ut.prototype.putStream=function(){var t2=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t2,objectId:this.objId}),this.scope.internal.out("endobj")},ut.prototype.getKeyValueListForStream=function(){var t2=[],e=Object.getOwnPropertyNames(this).filter(function(t3){return t3!="content"&&t3!="appearanceStreamContent"&&t3!="scope"&&t3!="objId"&&t3.substring(0,1)!="_"});for(var n in e)if(Object.getOwnPropertyDescriptor(this,e[n]).configurable===!1){var r=e[n],i2=this[r];i2&&(Array.isArray(i2)?t2.push({key:r,value:ot(i2,this.objId,this.scope)}):i2 instanceof ut?(i2.scope=this.scope,t2.push({key:r,value:i2.objId+" 0 R"})):typeof i2!="function"&&t2.push({key:r,value:i2}))}return t2};var ct=function(){ut.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t2,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t3){e=t3}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e2){t2=e2.trim()},get:function(){return t2||null}})};W(ct,ut);var lt=function(){ut.call(this);var t2,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t2){var e2=function(t3){return t3};return this.scope&&(e2=this.scope.internal.getEncryptor(this.objId)),"("+T(e2(t2))+")"}},set:function(e2){t2=e2}})};W(lt,ut);var ht=function t(){ut.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t2){if(isNaN(t2))throw new Error('Invalid value "'+t2+'" for attribute F supplied.');e=t2}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!K(e,3)},set:function(t2){t2?this.F=Z(e,3):this.F=$$1(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t2){if(isNaN(t2))throw new Error('Invalid value "'+t2+'" for attribute Ff supplied.');n=t2}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(t2){r=t2!==void 0?t2:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(t2){r[0]=t2}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(t2){r[1]=t2}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(t2){r[2]=t2}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(t2){r[3]=t2}});var i2="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i2},set:function(t2){switch(t2){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i2=t2;break;default:throw new Error('Invalid value "'+t2+'" for attribute FT supplied.')}}});var a2=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a2||a2.length<1){if(this instanceof yt)return;a2="FieldObject"+t.FieldNum++}var e2=function(t2){return t2};return this.scope&&(e2=this.scope.internal.getEncryptor(this.objId)),"("+T(e2(a2))+")"},set:function(t2){a2=t2.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a2},set:function(t2){a2=t2}});var o2="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o2},set:function(t2){o2=t2}});var s2="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return s2},set:function(t2){s2=t2}});var u2=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u2},set:function(t2){u2=t2}});var c2=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c2===void 0?50/D:c2},set:function(t2){c2=t2}});var l2="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return l2},set:function(t2){l2=t2}});var h2="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h2||this instanceof yt||this instanceof Nt))return st(h2,this.objId,this.scope)},set:function(t2){t2=t2.toString(),h2=t2}});var f2=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(f2)return this instanceof mt==0?st(f2,this.objId,this.scope):f2},set:function(t2){t2=t2.toString(),f2=this instanceof mt==0?t2.substr(0,1)==="("?z(t2.substr(1,t2.length-2)):z(t2):t2}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof mt==1?z(f2.substr(1,f2.length-1)):f2},set:function(t2){t2=t2.toString(),f2=this instanceof mt==1?"/"+t2:t2}});var d2=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d2)return d2},set:function(t2){this.V=t2}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d2)return this instanceof mt==0?st(d2,this.objId,this.scope):d2},set:function(t2){t2=t2.toString(),d2=this instanceof mt==0?t2.substr(0,1)==="("?z(t2.substr(1,t2.length-2)):z(t2):t2}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof mt==1?z(d2.substr(1,d2.length-1)):d2},set:function(t2){t2=t2.toString(),d2=this instanceof mt==1?"/"+t2:t2}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var p2,g2=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g2},set:function(t2){t2=!!t2,g2=t2}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(p2)return p2},set:function(t2){p2=t2}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,1)},set:function(t2){t2?this.Ff=Z(this.Ff,1):this.Ff=$$1(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,2)},set:function(t2){t2?this.Ff=Z(this.Ff,2):this.Ff=$$1(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,3)},set:function(t2){t2?this.Ff=Z(this.Ff,3):this.Ff=$$1(this.Ff,3)}});var m2=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(m2!==null)return m2},set:function(t2){if([0,1,2].indexOf(t2)===-1)throw new Error('Invalid value "'+t2+'" for attribute Q supplied.');m2=t2}}),Object.defineProperty(this,"textAlign",{get:function(){var t2;switch(m2){case 0:default:t2="left";break;case 1:t2="center";break;case 2:t2="right"}return t2},configurable:!0,enumerable:!0,set:function(t2){switch(t2){case"right":case 2:m2=2;break;case"center":case 1:m2=1;break;default:m2=0}}})};W(ht,ut);var ft=function(){ht.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t2=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t2},set:function(e2){t2=e2}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t2},set:function(e2){t2=e2}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return ot(e,this.objId,this.scope)},set:function(t3){var n,r;r=[],typeof(n=t3)=="string"&&(r=(function(t4,e2,n2){n2||(n2=1);for(var r2,i2=[];r2=e2.exec(t4);)i2.push(r2[n2]);return i2})(n,/\((.*?)\)/g)),e=r}}),this.getOptions=function(){return e},this.setOptions=function(t3){e=t3,this.sort&&e.sort()},this.addOption=function(t3){t3=(t3=t3||"").toString(),e.push(t3),this.sort&&e.sort()},this.removeOption=function(t3,n){for(n=n||!1,t3=(t3=t3||"").toString();e.indexOf(t3)!==-1&&(e.splice(e.indexOf(t3),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,18)},set:function(t3){t3?this.Ff=Z(this.Ff,18):this.Ff=$$1(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,19)},set:function(t3){this.combo===!0&&(t3?this.Ff=Z(this.Ff,19):this.Ff=$$1(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,20)},set:function(t3){t3?(this.Ff=Z(this.Ff,20),e.sort()):this.Ff=$$1(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,22)},set:function(t3){t3?this.Ff=Z(this.Ff,22):this.Ff=$$1(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,23)},set:function(t3){t3?this.Ff=Z(this.Ff,23):this.Ff=$$1(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,27)},set:function(t3){t3?this.Ff=Z(this.Ff,27):this.Ff=$$1(this.Ff,27)}}),this.hasAppearanceStream=!1};W(ft,ht);var dt=function(){ft.call(this),this.fontName="helvetica",this.combo=!1};W(dt,ft);var pt=function(){dt.call(this),this.combo=!0};W(pt,dt);var gt=function(){pt.call(this),this.edit=!0};W(gt,pt);var mt=function(){ht.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,15)},set:function(t2){t2?this.Ff=Z(this.Ff,15):this.Ff=$$1(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,16)},set:function(t2){t2?this.Ff=Z(this.Ff,16):this.Ff=$$1(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,17)},set:function(t2){t2?this.Ff=Z(this.Ff,17):this.Ff=$$1(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,26)},set:function(t2){t2?this.Ff=Z(this.Ff,26):this.Ff=$$1(this.Ff,26)}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t2=function(t3){return t3};if(this.scope&&(t2=this.scope.internal.getEncryptor(this.objId)),Object.keys(n).length!==0){var e2,r=[];for(e2 in r.push("<<"),n)r.push("/"+e2+" ("+T(t2(n[e2]))+")");return r.push(">>"),r.join(`
`)}},set:function(e2){_typeof(e2)==="object"&&(n=e2)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(t2){typeof t2=="string"&&(n.CA=t2)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t2){e=t2}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t2){e="/"+t2}})};W(mt,ht);var vt=function(){mt.call(this),this.pushButton=!0};W(vt,mt);var bt=function(){mt.call(this),this.radio=!0,this.pushButton=!1;var t2=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t2},set:function(e){t2=e!==void 0?e:[]}})};W(bt,mt);var yt=function(){var e,n;ht.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t2){e=t2}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return n},set:function(t2){n=t2}});var r,i2={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t2=function(t3){return t3};this.scope&&(t2=this.scope.internal.getEncryptor(this.objId));var e2,n2=[];for(e2 in n2.push("<<"),i2)n2.push("/"+e2+" ("+T(t2(i2[e2]))+")");return n2.push(">>"),n2.join(`
`)},set:function(e2){_typeof(e2)==="object"&&(i2=e2)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i2.CA||""},set:function(t2){typeof t2=="string"&&(i2.CA=t2)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(t2){r=t2}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(t2){r="/"+t2}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=xt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};W(yt,ht),bt.prototype.setAppearance=function(t2){if(!("createAppearanceStream"in t2)||!("getCA"in t2))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t2.createAppearanceStream(n.optionName),n.caption=t2.getCA()}},bt.prototype.createOption=function(t2){var e=new yt;return e.Parent=this,e.optionName=t2,this.Kids.push(e),At.call(this.scope,e),e};var wt=function(){mt.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=xt.CheckBox.createAppearanceStream()};W(wt,mt);var Nt=function(){ht.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,13)},set:function(t3){t3?this.Ff=Z(this.Ff,13):this.Ff=$$1(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,21)},set:function(t3){t3?this.Ff=Z(this.Ff,21):this.Ff=$$1(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,23)},set:function(t3){t3?this.Ff=Z(this.Ff,23):this.Ff=$$1(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,24)},set:function(t3){t3?this.Ff=Z(this.Ff,24):this.Ff=$$1(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,25)},set:function(t3){t3?this.Ff=Z(this.Ff,25):this.Ff=$$1(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,26)},set:function(t3){t3?this.Ff=Z(this.Ff,26):this.Ff=$$1(this.Ff,26)}});var t2=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t2},set:function(e){t2=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t2},set:function(e){Number.isInteger(e)&&(t2=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};W(Nt,ht);var Lt=function(){Nt.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,14)},set:function(t2){t2?this.Ff=Z(this.Ff,14):this.Ff=$$1(this.Ff,14)}}),this.password=!0};W(Lt,Nt);var xt={CheckBox:{createAppearanceStream:function(){return{N:{On:xt.CheckBox.YesNormal},D:{On:xt.CheckBox.YesPushDown,Off:xt.CheckBox.OffPushDown}}},YesPushDown:function(t2){var e=G(t2);e.scope=t2.scope;var n=[],r=t2.scope.internal.getFont(t2.fontName,t2.fontStyle).id,i2=t2.scope.__private__.encodeColorString(t2.color),a2=et(t2,t2.caption);return n.push("0.749023 g"),n.push("0 0 "+U(xt.internal.getWidth(t2))+" "+U(xt.internal.getHeight(t2))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+U(a2.fontSize)+" Tf "+i2),n.push("BT"),n.push(a2.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join(`
`),e},YesNormal:function(t2){var e=G(t2);e.scope=t2.scope;var n=t2.scope.internal.getFont(t2.fontName,t2.fontStyle).id,r=t2.scope.__private__.encodeColorString(t2.color),i2=[],a2=xt.internal.getHeight(t2),o2=xt.internal.getWidth(t2),s2=et(t2,t2.caption);return i2.push("1 g"),i2.push("0 0 "+U(o2)+" "+U(a2)+" re"),i2.push("f"),i2.push("q"),i2.push("0 0 1 rg"),i2.push("0 0 "+U(o2-1)+" "+U(a2-1)+" re"),i2.push("W"),i2.push("n"),i2.push("0 g"),i2.push("BT"),i2.push("/"+n+" "+U(s2.fontSize)+" Tf "+r),i2.push(s2.text),i2.push("ET"),i2.push("Q"),e.stream=i2.join(`
`),e},OffPushDown:function(t2){var e=G(t2);e.scope=t2.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+U(xt.internal.getWidth(t2))+" "+U(xt.internal.getHeight(t2))+" re"),n.push("f"),e.stream=n.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t2){var e={D:{Off:xt.RadioButton.Circle.OffPushDown},N:{}};return e.N[t2]=xt.RadioButton.Circle.YesNormal,e.D[t2]=xt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t2){var e=G(t2);e.scope=t2.scope;var n=[],r=xt.internal.getWidth(t2)<=xt.internal.getHeight(t2)?xt.internal.getWidth(t2)/4:xt.internal.getHeight(t2)/4;r=Number((.9*r).toFixed(5));var i2=xt.internal.Bezier_C,a2=Number((r*i2).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+H(xt.internal.getWidth(t2)/2)+" "+H(xt.internal.getHeight(t2)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+a2+" "+a2+" "+r+" 0 "+r+" c"),n.push("-"+a2+" "+r+" -"+r+" "+a2+" -"+r+" 0 c"),n.push("-"+r+" -"+a2+" -"+a2+" -"+r+" 0 -"+r+" c"),n.push(a2+" -"+r+" "+r+" -"+a2+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t2){var e=G(t2);e.scope=t2.scope;var n=[],r=xt.internal.getWidth(t2)<=xt.internal.getHeight(t2)?xt.internal.getWidth(t2)/4:xt.internal.getHeight(t2)/4;r=Number((.9*r).toFixed(5));var i2=Number((2*r).toFixed(5)),a2=Number((i2*xt.internal.Bezier_C).toFixed(5)),o2=Number((r*xt.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+H(xt.internal.getWidth(t2)/2)+" "+H(xt.internal.getHeight(t2)/2)+" cm"),n.push(i2+" 0 m"),n.push(i2+" "+a2+" "+a2+" "+i2+" 0 "+i2+" c"),n.push("-"+a2+" "+i2+" -"+i2+" "+a2+" -"+i2+" 0 c"),n.push("-"+i2+" -"+a2+" -"+a2+" -"+i2+" 0 -"+i2+" c"),n.push(a2+" -"+i2+" "+i2+" -"+a2+" "+i2+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+H(xt.internal.getWidth(t2)/2)+" "+H(xt.internal.getHeight(t2)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+o2+" "+o2+" "+r+" 0 "+r+" c"),n.push("-"+o2+" "+r+" -"+r+" "+o2+" -"+r+" 0 c"),n.push("-"+r+" -"+o2+" -"+o2+" -"+r+" 0 -"+r+" c"),n.push(o2+" -"+r+" "+r+" -"+o2+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t2){var e=G(t2);e.scope=t2.scope;var n=[],r=xt.internal.getWidth(t2)<=xt.internal.getHeight(t2)?xt.internal.getWidth(t2)/4:xt.internal.getHeight(t2)/4;r=Number((.9*r).toFixed(5));var i2=Number((2*r).toFixed(5)),a2=Number((i2*xt.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+H(xt.internal.getWidth(t2)/2)+" "+H(xt.internal.getHeight(t2)/2)+" cm"),n.push(i2+" 0 m"),n.push(i2+" "+a2+" "+a2+" "+i2+" 0 "+i2+" c"),n.push("-"+a2+" "+i2+" -"+i2+" "+a2+" -"+i2+" 0 c"),n.push("-"+i2+" -"+a2+" -"+a2+" -"+i2+" 0 -"+i2+" c"),n.push(a2+" -"+i2+" "+i2+" -"+a2+" "+i2+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join(`
`),e}},Cross:{createAppearanceStream:function(t2){var e={D:{Off:xt.RadioButton.Cross.OffPushDown},N:{}};return e.N[t2]=xt.RadioButton.Cross.YesNormal,e.D[t2]=xt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t2){var e=G(t2);e.scope=t2.scope;var n=[],r=xt.internal.calculateCross(t2);return n.push("q"),n.push("1 1 "+U(xt.internal.getWidth(t2)-2)+" "+U(xt.internal.getHeight(t2)-2)+" re"),n.push("W"),n.push("n"),n.push(U(r.x1.x)+" "+U(r.x1.y)+" m"),n.push(U(r.x2.x)+" "+U(r.x2.y)+" l"),n.push(U(r.x4.x)+" "+U(r.x4.y)+" m"),n.push(U(r.x3.x)+" "+U(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},YesPushDown:function(t2){var e=G(t2);e.scope=t2.scope;var n=xt.internal.calculateCross(t2),r=[];return r.push("0.749023 g"),r.push("0 0 "+U(xt.internal.getWidth(t2))+" "+U(xt.internal.getHeight(t2))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+U(xt.internal.getWidth(t2)-2)+" "+U(xt.internal.getHeight(t2)-2)+" re"),r.push("W"),r.push("n"),r.push(U(n.x1.x)+" "+U(n.x1.y)+" m"),r.push(U(n.x2.x)+" "+U(n.x2.y)+" l"),r.push(U(n.x4.x)+" "+U(n.x4.y)+" m"),r.push(U(n.x3.x)+" "+U(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t2){var e=G(t2);e.scope=t2.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+U(xt.internal.getWidth(t2))+" "+U(xt.internal.getHeight(t2))+" re"),n.push("f"),e.stream=n.join(`
`),e}}},createDefaultAppearanceStream:function(t2){var e=t2.scope.internal.getFont(t2.fontName,t2.fontStyle).id,n=t2.scope.__private__.encodeColorString(t2.color);return"/"+e+" "+t2.fontSize+" Tf "+n}};xt.internal={Bezier_C:.551915024494,calculateCross:function(t2){var e=xt.internal.getWidth(t2),n=xt.internal.getHeight(t2),r=Math.min(e,n);return{x1:{x:(e-r)/2,y:(n-r)/2+r},x2:{x:(e-r)/2+r,y:(n-r)/2},x3:{x:(e-r)/2,y:(n-r)/2},x4:{x:(e-r)/2+r,y:(n-r)/2+r}}}},xt.internal.getWidth=function(e){var n=0;return _typeof(e)==="object"&&(n=V(e.Rect[2])),n},xt.internal.getHeight=function(e){var n=0;return _typeof(e)==="object"&&(n=V(e.Rect[3])),n};var At=R.addField=function(t2){if(at(this,t2),!(t2 instanceof ht))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t2).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t2.page=t2.scope.internal.getCurrentPageInfo().pageNumber,this};R.AcroFormChoiceField=ft,R.AcroFormListBox=dt,R.AcroFormComboBox=pt,R.AcroFormEditBox=gt,R.AcroFormButton=mt,R.AcroFormPushButton=vt,R.AcroFormRadioButton=bt,R.AcroFormCheckBox=wt,R.AcroFormTextField=Nt,R.AcroFormPasswordField=Lt,R.AcroFormAppearance=xt,R.AcroForm={ChoiceField:ft,ListBox:dt,ComboBox:pt,EditBox:gt,Button:mt,PushButton:vt,RadioButton:bt,CheckBox:wt,TextField:Nt,PasswordField:Lt,Appearance:xt},E.AcroForm={ChoiceField:ft,ListBox:dt,ComboBox:pt,EditBox:gt,Button:mt,PushButton:vt,RadioButton:bt,CheckBox:wt,TextField:Nt,PasswordField:Lt,Appearance:xt};E.AcroForm;function _t(t2){return t2.reduce(function(t3,e,n){return t3[e]=n,t3},{})}(function(e){var n="addImage_";e.__addimage__={};var r="UNKNOWN",i2={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a2=e.__addimage__.getImageFileTypeByImageData=function(t2,e2){var n2,a3,o3,s3,u3,c3=r;if((e2=e2||r)==="RGBA"||t2.data!==void 0&&t2.data instanceof Uint8ClampedArray&&"height"in t2&&"width"in t2)return"RGBA";if(A2(t2))for(u3 in i2)for(o3=i2[u3],n2=0;n2<o3.length;n2+=1){for(s3=!0,a3=0;a3<o3[n2].length;a3+=1)if(o3[n2][a3]!==void 0&&o3[n2][a3]!==t2[a3]){s3=!1;break}if(s3===!0){c3=u3;break}}else for(u3 in i2)for(o3=i2[u3],n2=0;n2<o3.length;n2+=1){for(s3=!0,a3=0;a3<o3[n2].length;a3+=1)if(o3[n2][a3]!==void 0&&o3[n2][a3]!==t2.charCodeAt(a3)){s3=!1;break}if(s3===!0){c3=u3;break}}return c3===r&&e2!==r&&(c3=e2),c3},o2=function t2(e2){for(var n2=this.internal.write,r2=this.internal.putStream,i3=(0,this.internal.getFilters)();i3.indexOf("FlateEncode")!==-1;)i3.splice(i3.indexOf("FlateEncode"),1);e2.objectId=this.internal.newObject();var a3=[];if(a3.push({key:"Type",value:"/XObject"}),a3.push({key:"Subtype",value:"/Image"}),a3.push({key:"Width",value:e2.width}),a3.push({key:"Height",value:e2.height}),e2.colorSpace===y2.INDEXED?a3.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(e2.palette.length/3-1)+" "+("sMask"in e2&&e2.sMask!==void 0?e2.objectId+2:e2.objectId+1)+" 0 R]"}):(a3.push({key:"ColorSpace",value:"/"+e2.colorSpace}),e2.colorSpace===y2.DEVICE_CMYK&&a3.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),a3.push({key:"BitsPerComponent",value:e2.bitsPerComponent}),"decodeParameters"in e2&&e2.decodeParameters!==void 0&&a3.push({key:"DecodeParms",value:"<<"+e2.decodeParameters+">>"}),"transparency"in e2&&Array.isArray(e2.transparency)&&e2.transparency.length>0){for(var o3="",s3=0,u3=e2.transparency.length;s3<u3;s3++)o3+=e2.transparency[s3]+" "+e2.transparency[s3]+" ";a3.push({key:"Mask",value:"["+o3+"]"})}e2.sMask!==void 0&&a3.push({key:"SMask",value:e2.objectId+1+" 0 R"});var c3=e2.filter!==void 0?["/"+e2.filter]:void 0;if(r2({data:e2.data,additionalKeyValues:a3,alreadyAppliedFilters:c3,objectId:e2.objectId}),n2("endobj"),"sMask"in e2&&e2.sMask!==void 0){var l3,h3=(l3=e2.sMaskBitsPerComponent)!==null&&l3!==void 0?l3:e2.bitsPerComponent,f2={width:e2.width,height:e2.height,colorSpace:"DeviceGray",bitsPerComponent:h3,data:e2.sMask};"filter"in e2&&(f2.decodeParameters="/Predictor ".concat(e2.predictor," /Colors 1 /BitsPerComponent ").concat(h3," /Columns ").concat(e2.width),f2.filter=e2.filter),t2.call(this,f2)}if(e2.colorSpace===y2.INDEXED){var d3=this.internal.newObject();r2({data:_2(new Uint8Array(e2.palette)),objectId:d3}),n2("endobj")}},s2=function(){var t2=this.internal.collections[n+"images"];for(var e2 in t2)o2.call(this,t2[e2])},u2=function(){var t2,e2=this.internal.collections[n+"images"],r2=this.internal.write;for(var i3 in e2)r2("/I"+(t2=e2[i3]).index,t2.objectId,"0","R")},c2=function(){this.internal.collections[n+"images"]||(this.internal.collections[n+"images"]={},this.internal.events.subscribe("putResources",s2),this.internal.events.subscribe("putXobjectDict",u2))},l2=function(){var t2=this.internal.collections[n+"images"];return c2.call(this),t2},h2=function(){return Object.keys(this.internal.collections[n+"images"]).length},d2=function(t2){return typeof e["process"+t2.toUpperCase()]=="function"},p2=function(e2){return _typeof(e2)==="object"&&e2.nodeType===1},g2=function(t2,n2){if(t2.nodeName==="IMG"&&t2.hasAttribute("src")){var r2=""+t2.getAttribute("src");if(r2.indexOf("data:image/")===0)return f(unescape(r2).split("base64,").pop());var i3=e.loadFile(r2,!0);if(i3!==void 0)return i3}if(t2.nodeName==="CANVAS"){if(t2.width===0||t2.height===0)throw new Error("Given canvas must have data. Canvas width: "+t2.width+", height: "+t2.height);var a3;switch(n2){case"PNG":a3="image/png";break;case"WEBP":a3="image/webp";break;default:a3="image/jpeg"}return f(t2.toDataURL(a3,1).split("base64,").pop())}},m2=function(t2){var e2=this.internal.collections[n+"images"];if(e2){for(var r2 in e2)if(t2===e2[r2].alias)return e2[r2]}},v2=function(t2,e2,n2){return t2||e2||(t2=-96,e2=-96),t2<0&&(t2=-1*n2.width*72/t2/this.internal.scaleFactor),e2<0&&(e2=-1*n2.height*72/e2/this.internal.scaleFactor),t2===0&&(t2=e2*n2.width/n2.height),e2===0&&(e2=t2*n2.height/n2.width),[t2,e2]},b2=function(t2,e2,n2,r2,i3,a3){var o3=v2.call(this,n2,r2,i3),s3=this.internal.getCoordinateString,u3=this.internal.getVerticalCoordinateString,c3=l2.call(this);if(n2=o3[0],r2=o3[1],c3[i3.index]=i3,a3){a3*=Math.PI/180;var h3=Math.cos(a3),f2=Math.sin(a3),d3=function(t3){return t3.toFixed(4)},p3=[d3(h3),d3(f2),d3(-1*f2),d3(h3),0,0,"cm"]}this.internal.write("q"),a3?(this.internal.write([1,"0","0",1,s3(t2),u3(e2+r2),"cm"].join(" ")),this.internal.write(p3.join(" ")),this.internal.write([s3(n2),"0","0",s3(r2),"0","0","cm"].join(" "))):this.internal.write([s3(n2),"0","0",s3(r2),s3(t2),u3(e2+r2),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+i3.index+" Do"),this.internal.write("Q")},y2=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var w2=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},N2=e.__addimage__.sHashCode=function(t2){var e2,n2,r2=0;if(typeof t2=="string")for(n2=t2.length,e2=0;e2<n2;e2++)r2=(r2<<5)-r2+t2.charCodeAt(e2),r2|=0;else if(A2(t2))for(n2=t2.byteLength/2,e2=0;e2<n2;e2++)r2=(r2<<5)-r2+t2[e2],r2|=0;return r2},L2=e.__addimage__.validateStringAsBase64=function(t2){(t2=t2||"").toString().trim();var e2=!0;return t2.length===0&&(e2=!1),t2.length%4!=0&&(e2=!1),/^[A-Za-z0-9+/]+$/.test(t2.substr(0,t2.length-2))===!1&&(e2=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(t2.substr(-2))===!1&&(e2=!1),e2},x2=e.__addimage__.extractImageFromDataUrl=function(t2){if(t2==null||!(t2=t2.trim()).startsWith("data:"))return null;var e2=t2.indexOf(",");return e2<0?null:t2.substring(0,e2).trim().endsWith("base64")?t2.substring(e2+1):null};e.__addimage__.isArrayBuffer=function(t2){return t2 instanceof ArrayBuffer};var A2=e.__addimage__.isArrayBufferView=function(t2){return t2 instanceof Int8Array||t2 instanceof Uint8Array||t2 instanceof Uint8ClampedArray||t2 instanceof Int16Array||t2 instanceof Uint16Array||t2 instanceof Int32Array||t2 instanceof Uint32Array||t2 instanceof Float32Array||t2 instanceof Float64Array},S2=e.__addimage__.binaryStringToUint8Array=function(t2){for(var e2=t2.length,n2=new Uint8Array(e2),r2=0;r2<e2;r2++)n2[r2]=t2.charCodeAt(r2);return n2},_2=e.__addimage__.arrayBufferToBinaryString=function(t2){for(var e2="",n2=A2(t2)?t2:new Uint8Array(t2),r2=0;r2<n2.length;r2+=8192)e2+=String.fromCharCode.apply(null,n2.subarray(r2,r2+8192));return e2};e.addImage=function(){var e2,n2,i3,a3,o3,s3,u3,l3,h3;if(typeof arguments[1]=="number"?(n2=r,i3=arguments[1],a3=arguments[2],o3=arguments[3],s3=arguments[4],u3=arguments[5],l3=arguments[6],h3=arguments[7]):(n2=arguments[1],i3=arguments[2],a3=arguments[3],o3=arguments[4],s3=arguments[5],u3=arguments[6],l3=arguments[7],h3=arguments[8]),_typeof(e2=arguments[0])==="object"&&!p2(e2)&&"imageData"in e2){var f2=e2;e2=f2.imageData,n2=f2.format||n2||r,i3=f2.x||i3||0,a3=f2.y||a3||0,o3=f2.w||f2.width||o3,s3=f2.h||f2.height||s3,u3=f2.alias||u3,l3=f2.compression||l3,h3=f2.rotation||f2.angle||h3}var d3=this.internal.getFilters();if(l3===void 0&&d3.indexOf("FlateEncode")!==-1&&(l3="SLOW"),isNaN(i3)||isNaN(a3))throw new Error("Invalid coordinates passed to jsPDF.addImage");c2.call(this);var g3=P2.call(this,e2,n2,u3,l3);return b2.call(this,i3,a3,o3,s3,g3,h3),this};var P2=function(t2,n2,i3,o3){var s3,u3,c3;if(typeof t2=="string"&&a2(t2)===r){t2=unescape(t2);var l3=k2(t2,!1);(l3!==""||(l3=e.loadFile(t2,!0))!==void 0)&&(t2=l3)}if(p2(t2)&&(t2=g2(t2,n2)),n2=a2(t2,n2),!d2(n2))throw new Error("addImage does not support files of type '"+n2+"', please ensure that a plugin for '"+n2+"' support is added.");if(((c3=i3)==null||c3.length===0)&&(i3=(function(t3){return typeof t3=="string"||A2(t3)?N2(t3):A2(t3.data)?N2(t3.data):null})(t2)),(s3=m2.call(this,i3))||(t2 instanceof Uint8Array||n2==="RGBA"||(u3=t2,t2=S2(t2)),s3=this["process"+n2.toUpperCase()](t2,h2.call(this),i3,(function(t3){return t3&&typeof t3=="string"&&(t3=t3.toUpperCase()),t3 in e.image_compression?t3:w2.NONE})(o3),u3)),!s3)throw new Error("An unknown error occurred whilst processing the image.");return s3},k2=e.__addimage__.convertBase64ToBinaryString=function(t2,e2){e2=typeof e2!="boolean"||e2;var n2,r2="";if(typeof t2=="string"){var i3;n2=(i3=x2(t2))!==null&&i3!==void 0?i3:t2;try{r2=f(n2)}catch(a3){if(e2)throw L2(n2)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+a3.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return r2};e.getImageProperties=function(t2){var n2,i3,o3="";if(p2(t2)&&(t2=g2(t2)),typeof t2=="string"&&a2(t2)===r&&((o3=k2(t2,!1))===""&&(o3=e.loadFile(t2)||""),t2=o3),i3=a2(t2),!d2(i3))throw new Error("addImage does not support files of type '"+i3+"', please ensure that a plugin for '"+i3+"' support is added.");if(t2 instanceof Uint8Array||(t2=S2(t2)),!(n2=this["process"+i3.toUpperCase()](t2)))throw new Error("An unknown error occurred whilst processing the image");return n2.fileType=i3,n2}})(E.API),(function(t2){var e=function(t3){if(t3!==void 0&&t3!="")return!0};E.API.events.push(["addPage",function(t3){this.internal.getPageInfo(t3.pageNumber).pageContext.annotations=[]}]),t2.events.push(["putPage",function(t3){for(var n,r,i2,a2=this.internal.getCoordinateString,o2=this.internal.getVerticalCoordinateString,s2=this.internal.getPageInfoByObjId(t3.objId),u2=t3.pageContext.annotations,c2=!1,l2=0;l2<u2.length&&!c2;l2++)switch((n=u2[l2]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(c2=!0);break;case"reference":case"text":case"freetext":c2=!0}if(c2!=0){this.internal.write("/Annots [");for(var h2=0;h2<u2.length;h2++){n=u2[h2];var f2=this.internal.pdfEscape,d2=this.internal.getEncryptor(t3.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p2=this.internal.newAdditionalObject(),g2=this.internal.newAdditionalObject(),m2=this.internal.getEncryptor(p2.objId),v2=n.title||"Note";i2="<</Type /Annot /Subtype /Text "+(r="/Rect ["+a2(n.bounds.x)+" "+o2(n.bounds.y+n.bounds.h)+" "+a2(n.bounds.x+n.bounds.w)+" "+o2(n.bounds.y)+"] ")+"/Contents ("+f2(m2(n.contents))+")",i2+=" /Popup "+g2.objId+" 0 R",i2+=" /P "+s2.objId+" 0 R",i2+=" /T ("+f2(m2(v2))+") >>",p2.content=i2;var b2=p2.objId+" 0 R";i2="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+a2(n.bounds.x+30)+" "+o2(n.bounds.y+n.bounds.h)+" "+a2(n.bounds.x+n.bounds.w+30)+" "+o2(n.bounds.y)+"] ")+" /Parent "+b2,n.open&&(i2+=" /Open true"),i2+=" >>",g2.content=i2,this.internal.write(p2.objId,"0 R",g2.objId,"0 R");break;case"freetext":r="/Rect ["+a2(n.bounds.x)+" "+o2(n.bounds.y)+" "+a2(n.bounds.x+n.bounds.w)+" "+o2(n.bounds.y+n.bounds.h)+"] ";var y2=n.color||"#000000";i2="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+f2(d2(n.contents))+")",i2+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+y2+")",i2+=" /Border [0 0 0]",i2+=" >>",this.internal.write(i2);break;case"link":if(n.options.name){var w2=this.annotations._nameMap[n.options.name];n.options.pageNumber=w2.page,n.options.top=w2.y}else n.options.top||(n.options.top=0);if(r="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i2="",n.options.url)i2="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+f2(d2(n.options.url))+") >>";else if(n.options.pageNumber)switch(i2="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i2+=" /Fit]";break;case"FitH":i2+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i2+=" /FitV "+n.options.left+"]";break;default:var N2=o2(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i2+=" /XYZ "+n.options.left+" "+N2+" "+n.options.zoom+"]"}i2!=""&&(i2+=" >>",this.internal.write(i2))}}this.internal.write("]")}}]),t2.createAnnotation=function(t3){var e2=this.internal.getCurrentPageInfo();switch(t3.type){case"link":this.link(t3.bounds.x,t3.bounds.y,t3.bounds.w,t3.bounds.h,t3);break;case"text":case"freetext":e2.pageContext.annotations.push(t3)}},t2.link=function(t3,e2,n,r,i2){var a2=this.internal.getCurrentPageInfo(),o2=this.internal.getCoordinateString,s2=this.internal.getVerticalCoordinateString;a2.pageContext.annotations.push({finalBounds:{x:o2(t3),y:s2(e2),w:o2(t3+n),h:s2(e2+r)},options:i2,type:"link"})},t2.textWithLink=function(t3,e2,n,r){var i2,a2,o2=this.getTextWidth(t3),s2=this.internal.getLineHeight()/this.internal.scaleFactor;if(r.maxWidth!==void 0){a2=r.maxWidth;var u2=this.splitTextToSize(t3,a2).length;i2=Math.ceil(s2*u2)}else a2=o2,i2=s2;return this.text(t3,e2,n,r),n+=.2*s2,r.align==="center"&&(e2-=o2/2),r.align==="right"&&(e2-=o2),this.link(e2,n-s2,a2,i2,r),o2},t2.getTextWidth=function(t3){var e2=this.internal.getFontSize();return this.getStringUnitWidth(t3)*e2/this.internal.scaleFactor}})(E.API),(function(t2){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i2=[1570,1571,1573,1575];t2.__arabicParser__={};var a2=t2.__arabicParser__.isInArabicSubstitutionA=function(t3){return e[t3.charCodeAt(0)]!==void 0},o2=t2.__arabicParser__.isArabicLetter=function(t3){return typeof t3=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(t3)},s2=t2.__arabicParser__.isArabicEndLetter=function(t3){return o2(t3)&&a2(t3)&&e[t3.charCodeAt(0)].length<=2},u2=t2.__arabicParser__.isArabicAlfLetter=function(t3){return o2(t3)&&i2.indexOf(t3.charCodeAt(0))>=0};t2.__arabicParser__.arabicLetterHasIsolatedForm=function(t3){return o2(t3)&&a2(t3)&&e[t3.charCodeAt(0)].length>=1};var c2=t2.__arabicParser__.arabicLetterHasFinalForm=function(t3){return o2(t3)&&a2(t3)&&e[t3.charCodeAt(0)].length>=2};t2.__arabicParser__.arabicLetterHasInitialForm=function(t3){return o2(t3)&&a2(t3)&&e[t3.charCodeAt(0)].length>=3};var l2=t2.__arabicParser__.arabicLetterHasMedialForm=function(t3){return o2(t3)&&a2(t3)&&e[t3.charCodeAt(0)].length==4},h2=t2.__arabicParser__.resolveLigatures=function(t3){var e2=0,r2=n,i3="",a3=0;for(e2=0;e2<t3.length;e2+=1)r2[t3.charCodeAt(e2)]!==void 0?(a3++,typeof(r2=r2[t3.charCodeAt(e2)])=="number"&&(i3+=String.fromCharCode(r2),r2=n,a3=0),e2===t3.length-1&&(r2=n,i3+=t3.charAt(e2-(a3-1)),e2-=a3-1,a3=0)):(r2=n,i3+=t3.charAt(e2-a3),e2-=a3,a3=0);return i3};t2.__arabicParser__.isArabicDiacritic=function(t3){return t3!==void 0&&r[t3.charCodeAt(0)]!==void 0};var f2=t2.__arabicParser__.getCorrectForm=function(t3,e2,n2){return o2(t3)?a2(t3)===!1?-1:!c2(t3)||!o2(e2)&&!o2(n2)||!o2(n2)&&s2(e2)||s2(t3)&&!o2(e2)||s2(t3)&&u2(e2)||s2(t3)&&s2(e2)?0:l2(t3)&&o2(e2)&&!s2(e2)&&o2(n2)&&c2(n2)?3:s2(t3)||!o2(n2)?1:2:-1},d2=function(t3){var n2=0,r2=0,i3=0,a3="",s3="",u3="",c3=(t3=t3||"").split("\\s+"),l3=[];for(n2=0;n2<c3.length;n2+=1){for(l3.push(""),r2=0;r2<c3[n2].length;r2+=1)a3=c3[n2][r2],s3=c3[n2][r2-1],u3=c3[n2][r2+1],o2(a3)?(i3=f2(a3,s3,u3),l3[n2]+=i3!==-1?String.fromCharCode(e[a3.charCodeAt(0)][i3]):a3):l3[n2]+=a3;l3[n2]=h2(l3[n2])}return l3.join(" ")},p2=t2.__arabicParser__.processArabic=t2.processArabic=function(){var t3,e2=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,n2=[];if(Array.isArray(e2)){var r2=0;for(n2=[],r2=0;r2<e2.length;r2+=1)Array.isArray(e2[r2])?n2.push([d2(e2[r2][0]),e2[r2][1],e2[r2][2]]):n2.push([d2(e2[r2])]);t3=n2}else t3=d2(e2);return typeof arguments[0]=="string"?t3:(arguments[0].text=t3,arguments[0])};t2.events.push(["preProcessText",p2])})(E.API),E.API.autoPrint=function(t2){var e;return(t2=t2||{}).variant=t2.variant||"non-conform",t2.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(t2){var e=function(){var t3=void 0;Object.defineProperty(this,"pdf",{get:function(){return t3},set:function(e3){t3=e3}});var e2=150;Object.defineProperty(this,"width",{get:function(){return e2},set:function(t4){e2=isNaN(t4)||Number.isInteger(t4)===!1||t4<0?150:t4,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=e2+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(t4){n=isNaN(t4)||Number.isInteger(t4)===!1||t4<0?300:t4,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var r=[];Object.defineProperty(this,"childNodes",{get:function(){return r},set:function(t4){r=t4}});var i2={};Object.defineProperty(this,"style",{get:function(){return i2},set:function(t4){i2=t4}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t3,e2){var n;if((t3=t3||"2d")!=="2d")return null;for(n in e2)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=e2[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t2.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(E.API),(function(e){var n={left:0,top:0,bottom:0,right:0},r=!1,i2=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},n),this.internal.__cell__.margins.width=this.getPageWidth(),a2.call(this))},a2=function(){this.internal.__cell__.lastCell=new o2,this.internal.__cell__.pages=1},o2=function(){var t2=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return t2},set:function(e3){t2=e3}});var e2=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return e2},set:function(t3){e2=t3}});var n2=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return n2},set:function(t3){n2=t3}});var r2=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return r2},set:function(t3){r2=t3}});var i3=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return i3},set:function(t3){i3=t3}});var a3=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return a3},set:function(t3){a3=t3}});var o3=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return o3},set:function(t3){o3=t3}}),this};o2.prototype.clone=function(){return new o2(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o2.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(t2){return i2.call(this),this.internal.__cell__.headerFunction=typeof t2=="function"?t2:void 0,this},e.getTextDimensions=function(t2,e2){i2.call(this);var n2=(e2=e2||{}).fontSize||this.getFontSize(),r2=e2.font||this.getFont(),a3=e2.scaleFactor||this.internal.scaleFactor,o3=0,s3=0,u3=0,c2=this;if(!Array.isArray(t2)&&typeof t2!="string"){if(typeof t2!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");t2=String(t2)}var l2=e2.maxWidth;l2>0?typeof t2=="string"?t2=this.splitTextToSize(t2,l2):Object.prototype.toString.call(t2)==="[object Array]"&&(t2=t2.reduce(function(t3,e3){return t3.concat(c2.splitTextToSize(e3,l2))},[])):t2=Array.isArray(t2)?t2:[t2];for(var h2=0;h2<t2.length;h2++)o3<(u3=this.getStringUnitWidth(t2[h2],{font:r2})*n2)&&(o3=u3);return o3!==0&&(s3=t2.length),{w:o3/=a3,h:Math.max((s3*n2*this.getLineHeightFactor()-n2*(this.getLineHeightFactor()-1))/a3,0)}},e.cellAddPage=function(){i2.call(this),this.addPage();var t2=this.internal.__cell__.margins||n;return this.internal.__cell__.lastCell=new o2(t2.left,t2.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s2=e.cell=function(){var t2;t2=arguments[0]instanceof o2?arguments[0]:new o2(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),i2.call(this);var e2=this.internal.__cell__.lastCell,a3=this.internal.__cell__.padding,s3=this.internal.__cell__.margins||n,u3=this.internal.__cell__.tableHeaderRow,c2=this.internal.__cell__.printHeaders;return e2.lineNumber!==void 0&&(e2.lineNumber===t2.lineNumber?(t2.x=(e2.x||0)+(e2.width||0),t2.y=e2.y||0):e2.y+e2.height+t2.height+s3.bottom>this.getPageHeight()?(this.cellAddPage(),t2.y=s3.top,c2&&u3&&(this.printHeaderRow(t2.lineNumber,!0),t2.y+=u3[0].height)):t2.y=e2.y+e2.height||t2.y),t2.text[0]!==void 0&&(this.rect(t2.x,t2.y,t2.width,t2.height,r===!0?"FD":void 0),t2.align==="right"?this.text(t2.text,t2.x+t2.width-a3,t2.y+a3,{align:"right",baseline:"top"}):t2.align==="center"?this.text(t2.text,t2.x+t2.width/2,t2.y+a3,{align:"center",baseline:"top",maxWidth:t2.width-a3-a3}):this.text(t2.text,t2.x+a3,t2.y+a3,{align:"left",baseline:"top",maxWidth:t2.width-a3-a3})),this.internal.__cell__.lastCell=t2,this};e.table=function(e2,r2,c2,l2,h2){if(i2.call(this),!c2)throw new Error("No data for PDF table.");var f2,d2,p2,g2,m2=[],v2=[],b2=[],y2={},w2={},N2=[],L2=[],x2=(h2=h2||{}).autoSize||!1,A2=h2.printHeaders!==!1,S2=h2.css&&h2.css["font-size"]!==void 0?16*h2.css["font-size"]:h2.fontSize||12,_2=h2.margins||Object.assign({width:this.getPageWidth()},n),P2=typeof h2.padding=="number"?h2.padding:3,k2=h2.headerBackgroundColor||"#c8c8c8",F2=h2.headerTextColor||"#000";if(a2.call(this),this.internal.__cell__.printHeaders=A2,this.internal.__cell__.margins=_2,this.internal.__cell__.table_font_size=S2,this.internal.__cell__.padding=P2,this.internal.__cell__.headerBackgroundColor=k2,this.internal.__cell__.headerTextColor=F2,this.setFontSize(S2),l2==null)v2=m2=Object.keys(c2[0]),b2=m2.map(function(){return"left"});else if(Array.isArray(l2)&&_typeof(l2[0])==="object")for(m2=l2.map(function(t2){return t2.name}),v2=l2.map(function(t2){return t2.prompt||t2.name||""}),b2=l2.map(function(t2){return t2.align||"left"}),f2=0;f2<l2.length;f2+=1)w2[l2[f2].name]=.7499990551181103*l2[f2].width;else Array.isArray(l2)&&typeof l2[0]=="string"&&(v2=m2=l2,b2=m2.map(function(){return"left"}));if(x2||Array.isArray(l2)&&typeof l2[0]=="string")for(f2=0;f2<m2.length;f2+=1){for(y2[g2=m2[f2]]=c2.map(function(t2){return t2[g2]}),this.setFont(void 0,"bold"),N2.push(this.getTextDimensions(v2[f2],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),d2=y2[g2],this.setFont(void 0,"normal"),p2=0;p2<d2.length;p2+=1)N2.push(this.getTextDimensions(d2[p2],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);w2[g2]=Math.max.apply(null,N2)+P2+P2,N2=[]}if(A2){var I2={};for(f2=0;f2<m2.length;f2+=1)I2[m2[f2]]={},I2[m2[f2]].text=v2[f2],I2[m2[f2]].align=b2[f2];var j2=u2.call(this,I2,w2);L2=m2.map(function(t2){return new o2(e2,r2,w2[t2],j2,I2[t2].text,void 0,I2[t2].align)}),this.setTableHeaderRow(L2),this.printHeaderRow(1,!1)}var C2=l2.reduce(function(t2,e3){return t2[e3.name]=e3.align,t2},{});for(f2=0;f2<c2.length;f2+=1){"rowStart"in h2&&h2.rowStart instanceof Function&&h2.rowStart({row:f2,data:c2[f2]},this);var O2=u2.call(this,c2[f2],w2);for(p2=0;p2<m2.length;p2+=1){var B2=c2[f2][m2[p2]];"cellStart"in h2&&h2.cellStart instanceof Function&&h2.cellStart({row:f2,col:p2,data:B2},this),s2.call(this,new o2(e2,r2,w2[m2[p2]],O2,B2,f2+2,C2[m2[p2]]))}}return this.internal.__cell__.table_x=e2,this.internal.__cell__.table_y=r2,this};var u2=function(t2,e2){var n2=this.internal.__cell__.padding,r2=this.internal.__cell__.table_font_size,i3=this.internal.scaleFactor;return Object.keys(t2).map(function(r3){var i4=t2[r3];return this.splitTextToSize(i4.hasOwnProperty("text")?i4.text:i4,e2[r3]-n2-n2)},this).map(function(t3){return this.getLineHeightFactor()*t3.length*r2/i3+n2+n2},this).reduce(function(t3,e3){return Math.max(t3,e3)},0)};e.setTableHeaderRow=function(t2){i2.call(this),this.internal.__cell__.tableHeaderRow=t2},e.printHeaderRow=function(t2,e2){if(i2.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var n2;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var a3=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o2(a3[0],a3[1],a3[2],a3[3],void 0,-1)}this.setFont(void 0,"bold");for(var u3=[],c2=0;c2<this.internal.__cell__.tableHeaderRow.length;c2+=1){n2=this.internal.__cell__.tableHeaderRow[c2].clone(),e2&&(n2.y=this.internal.__cell__.margins.top||0,u3.push(n2)),n2.lineNumber=t2;var l2=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s2.call(this,n2),this.setTextColor(l2)}u3.length>0&&this.setTableHeaderRow(u3),this.setFont(void 0,"normal"),r=!1}})(E.API);var Pt={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},kt=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Ft=_t(kt),It=[100,200,300,400,500,600,700,800,900],jt=_t(It);function Ct(t2){var e=t2.family.replace(/"|'/g,"").toLowerCase(),n=(function(t3){return Pt[t3=t3||"normal"]?t3:"normal"})(t2.style),r=(function(t3){return t3?typeof t3=="number"?t3>=100&&t3<=900&&t3%100==0?t3:400:/^\d00$/.test(t3)?parseInt(t3):t3==="bold"?700:400:400})(t2.weight),i2=(function(t3){return typeof Ft[t3=t3||"normal"]=="number"?t3:"normal"})(t2.stretch);return{family:e,style:n,weight:r,stretch:i2,src:t2.src||[],ref:t2.ref||{name:e,style:[i2,n,r].join(" ")}}}function Ot(t2,e,n,r){var i2;for(i2=n;i2>=0&&i2<e.length;i2+=r)if(t2[e[i2]])return t2[e[i2]];for(i2=n;i2>=0&&i2<e.length;i2-=r)if(t2[e[i2]])return t2[e[i2]]}var Bt={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Mt={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function qt(t2){return[t2.stretch,t2.style,t2.weight,t2.family].join(" ")}function Et(t2){return t2.trimLeft()}function Rt(t2,e){for(var n=0;n<t2.length;){if(t2.charAt(n)===e)return[t2.substring(0,n),t2.substring(n+1)];n+=1}return null}function Dt(t2){var e=t2.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t2.substring(e[0].length)]}var Tt,zt,Ut,Ht,Wt,Vt,Gt,Yt,Jt=["times"];function Xt(t2,n,r,i2,a2){var o2=4,s2=$t;switch(a2){case E.API.image_compression.FAST:o2=1,s2=Zt;break;case E.API.image_compression.MEDIUM:o2=6,s2=Qt;break;case E.API.image_compression.SLOW:o2=9,s2=te}t2=(function(t3,e,n2,r2){for(var i3,a3=t3.length/e,o3=new Uint8Array(t3.length+a3),s3=[Kt,Zt,$t,Qt,te],u3=0;u3<a3;u3+=1){var c2=u3*e,l2=t3.subarray(c2,c2+e);if(r2)o3.set(r2(l2,n2,i3),c2+u3);else{for(var h2=s3.length,f2=[],d2=0;d2<h2;d2+=1)f2[d2]=s3[d2](l2,n2,i3);var p2=ne(f2.concat());o3.set(f2[p2],c2+u3)}i3=l2}return o3})(t2,n,Math.ceil(r*i2/8),s2);var u2=zlibSync(t2,{level:o2});return E.API.__addimage__.arrayBufferToBinaryString(u2)}function Kt(t2){var e=Array.apply([],t2);return e.unshift(0),e}function Zt(t2,e){var n=t2.length,r=[];r[0]=1;for(var i2=0;i2<n;i2+=1){var a2=t2[i2-e]||0;r[i2+1]=t2[i2]-a2+256&255}return r}function $t(t2,e,n){var r=t2.length,i2=[];i2[0]=2;for(var a2=0;a2<r;a2+=1){var o2=n&&n[a2]||0;i2[a2+1]=t2[a2]-o2+256&255}return i2}function Qt(t2,e,n){var r=t2.length,i2=[];i2[0]=3;for(var a2=0;a2<r;a2+=1){var o2=t2[a2-e]||0,s2=n&&n[a2]||0;i2[a2+1]=t2[a2]+256-(o2+s2>>>1)&255}return i2}function te(t2,e,n){var r=t2.length,i2=[];i2[0]=4;for(var a2=0;a2<r;a2+=1){var o2=ee(t2[a2-e]||0,n&&n[a2]||0,n&&n[a2-e]||0);i2[a2+1]=t2[a2]-o2+256&255}return i2}function ee(t2,e,n){if(t2===e&&e===n)return t2;var r=Math.abs(e-n),i2=Math.abs(t2-n),a2=Math.abs(t2+e-n-n);return r<=i2&&r<=a2?t2:i2<=a2?e:n}function ne(t2){var e=t2.map(function(t3){return t3.reduce(function(t4,e2){return t4+Math.abs(e2)},0)});return e.indexOf(Math.min.apply(null,e))}function re(t2,e,n){var r=e*n,i2=Math.floor(r/8),a2=16-(r-8*i2+n),o2=(1<<n)-1;return ae(t2,i2)>>a2&o2}function ie(t2,e,n,r){var i2=n*r,a2=Math.floor(i2/8),o2=16-(i2-8*a2+r),s2=(1<<r)-1,u2=(e&s2)<<o2;(function(t3,e2,n2){if(e2+1<t3.byteLength)t3.setUint16(e2,n2,!1);else{var r2=n2>>8&255;t3.setUint8(e2,r2)}})(t2,a2,ae(t2,a2)&~(s2<<o2)&65535|u2)}function ae(t2,e){return e+1<t2.byteLength?t2.getUint16(e,!1):t2.getUint8(e)<<8}function oe(t2){var e=0;if(t2[e++]!==71||t2[e++]!==73||t2[e++]!==70||t2[e++]!==56||(t2[e++]+1&253)!=56||t2[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=t2[e++]|t2[e++]<<8,r=t2[e++]|t2[e++]<<8,i2=t2[e++],a2=i2>>7,o2=1<<1+(7&i2);t2[e++],t2[e++];var s2=null,u2=null;a2&&(s2=e,u2=o2,e+=3*o2);var c2=!0,l2=[],h2=0,f2=null,d2=0,p2=null;for(this.width=n,this.height=r;c2&&e<t2.length;)switch(t2[e++]){case 33:switch(t2[e++]){case 255:if(t2[e]!==11||t2[e+1]==78&&t2[e+2]==69&&t2[e+3]==84&&t2[e+4]==83&&t2[e+5]==67&&t2[e+6]==65&&t2[e+7]==80&&t2[e+8]==69&&t2[e+9]==50&&t2[e+10]==46&&t2[e+11]==48&&t2[e+12]==3&&t2[e+13]==1&&t2[e+16]==0)e+=14,p2=t2[e++]|t2[e++]<<8,e++;else for(e+=12;;){if(!((P2=t2[e++])>=0))throw Error("Invalid block size");if(P2===0)break;e+=P2}break;case 249:if(t2[e++]!==4||t2[e+4]!==0)throw new Error("Invalid graphics extension block.");var g2=t2[e++];h2=t2[e++]|t2[e++]<<8,f2=t2[e++],1&g2||(f2=null),d2=g2>>2&7,e++;break;case 254:for(;;){if(!((P2=t2[e++])>=0))throw Error("Invalid block size");if(P2===0)break;e+=P2}break;default:throw new Error("Unknown graphic control label: 0x"+t2[e-1].toString(16))}break;case 44:var m2=t2[e++]|t2[e++]<<8,v2=t2[e++]|t2[e++]<<8,b2=t2[e++]|t2[e++]<<8,y2=t2[e++]|t2[e++]<<8,w2=t2[e++],N2=w2>>6&1,L2=1<<1+(7&w2),x2=s2,A2=u2,S2=!1;w2>>7&&(S2=!0,x2=e,A2=L2,e+=3*L2);var _2=e;for(e++;;){var P2;if(!((P2=t2[e++])>=0))throw Error("Invalid block size");if(P2===0)break;e+=P2}l2.push({x:m2,y:v2,width:b2,height:y2,has_local_palette:S2,palette_offset:x2,palette_size:A2,data_offset:_2,data_length:e-_2,transparent_index:f2,interlaced:!!N2,delay:h2,disposal:d2});break;case 59:c2=!1;break;default:throw new Error("Unknown gif block: 0x"+t2[e-1].toString(16))}this.numFrames=function(){return l2.length},this.loopCount=function(){return p2},this.frameInfo=function(t3){if(t3<0||t3>=l2.length)throw new Error("Frame index out of range.");return l2[t3]},this.decodeAndBlitFrameBGRA=function(e2,r2){var i3=this.frameInfo(e2),a3=i3.width*i3.height,o3=new Uint8Array(a3);se(t2,i3.data_offset,o3,a3);var s3=i3.palette_offset,u3=i3.transparent_index;u3===null&&(u3=256);var c3=i3.width,l3=n-c3,h3=c3,f3=4*(i3.y*n+i3.x),d3=4*((i3.y+i3.height)*n+i3.x),p3=f3,g3=4*l3;i3.interlaced===!0&&(g3+=4*n*7);for(var m3=8,v3=0,b3=o3.length;v3<b3;++v3){var y3=o3[v3];if(h3===0&&(h3=c3,(p3+=g3)>=d3&&(g3=4*l3+4*n*(m3-1),p3=f3+(c3+l3)*(m3<<1),m3>>=1)),y3===u3)p3+=4;else{var w3=t2[s3+3*y3],N3=t2[s3+3*y3+1],L3=t2[s3+3*y3+2];r2[p3++]=L3,r2[p3++]=N3,r2[p3++]=w3,r2[p3++]=255}--h3}},this.decodeAndBlitFrameRGBA=function(e2,r2){var i3=this.frameInfo(e2),a3=i3.width*i3.height,o3=new Uint8Array(a3);se(t2,i3.data_offset,o3,a3);var s3=i3.palette_offset,u3=i3.transparent_index;u3===null&&(u3=256);var c3=i3.width,l3=n-c3,h3=c3,f3=4*(i3.y*n+i3.x),d3=4*((i3.y+i3.height)*n+i3.x),p3=f3,g3=4*l3;i3.interlaced===!0&&(g3+=4*n*7);for(var m3=8,v3=0,b3=o3.length;v3<b3;++v3){var y3=o3[v3];if(h3===0&&(h3=c3,(p3+=g3)>=d3&&(g3=4*l3+4*n*(m3-1),p3=f3+(c3+l3)*(m3<<1),m3>>=1)),y3===u3)p3+=4;else{var w3=t2[s3+3*y3],N3=t2[s3+3*y3+1],L3=t2[s3+3*y3+2];r2[p3++]=w3,r2[p3++]=N3,r2[p3++]=L3,r2[p3++]=255}--h3}}}function se(t2,e,n,r){for(var i2=t2[e++],a2=1<<i2,s2=a2+1,u2=s2+1,c2=i2+1,l2=(1<<c2)-1,h2=0,f2=0,d2=0,p2=t2[e++],g2=new Int32Array(4096),m2=null;;){for(;h2<16&&p2!==0;)f2|=t2[e++]<<h2,h2+=8,p2===1?p2=t2[e++]:--p2;if(h2<c2)break;var v2=f2&l2;if(f2>>=c2,h2-=c2,v2!==a2){if(v2===s2)break;for(var b2=v2<u2?v2:m2,y2=0,w2=b2;w2>a2;)w2=g2[w2]>>8,++y2;var N2=w2;if(d2+y2+(b2!==v2?1:0)>r)return void o.log("Warning, gif stream longer than expected.");n[d2++]=N2;var L2=d2+=y2;for(b2!==v2&&(n[d2++]=N2),w2=b2;y2--;)w2=g2[w2],n[--L2]=255&w2,w2>>=8;m2!==null&&u2<4096&&(g2[u2++]=m2<<8|N2,u2>=l2+1&&c2<12&&(++c2,l2=l2<<1|1)),m2=v2}else u2=s2+1,l2=(1<<(c2=i2+1))-1,m2=null}return d2!==r&&o.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function ue(t2){var e,n,r,i2,a2,o2=Math.floor,s2=new Array(64),u2=new Array(64),c2=new Array(64),l2=new Array(64),h2=new Array(65535),f2=new Array(65535),d2=new Array(64),p2=new Array(64),g2=[],m2=0,v2=7,b2=new Array(64),y2=new Array(64),w2=new Array(64),N2=new Array(256),L2=new Array(2048),x2=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],A2=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],S2=[0,1,2,3,4,5,6,7,8,9,10,11],_2=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],P2=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],k2=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],F2=[0,1,2,3,4,5,6,7,8,9,10,11],I2=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],j2=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function C2(t3,e2){for(var n2=0,r2=0,i3=new Array,a3=1;a3<=16;a3++){for(var o3=1;o3<=t3[a3];o3++)i3[e2[r2]]=[],i3[e2[r2]][0]=n2,i3[e2[r2]][1]=a3,r2++,n2++;n2*=2}return i3}function O2(t3){for(var e2=t3[0],n2=t3[1]-1;n2>=0;)e2&1<<n2&&(m2|=1<<v2),n2--,--v2<0&&(m2==255?(B2(255),B2(0)):B2(m2),v2=7,m2=0)}function B2(t3){g2.push(t3)}function M2(t3){B2(t3>>8&255),B2(255&t3)}function q2(t3,e2,n2,r2,i3){for(var a3,o3=i3[0],s3=i3[240],u3=(function(t4,e3){var n3,r3,i4,a4,o4,s4,u4,c4,l4,h3,f3=0;for(l4=0;l4<8;++l4){n3=t4[f3],r3=t4[f3+1],i4=t4[f3+2],a4=t4[f3+3],o4=t4[f3+4],s4=t4[f3+5],u4=t4[f3+6];var p3=n3+(c4=t4[f3+7]),g4=n3-c4,m4=r3+u4,v4=r3-u4,b4=i4+s4,y4=i4-s4,w4=a4+o4,N3=a4-o4,L3=p3+w4,x3=p3-w4,A3=m4+b4,S3=m4-b4;t4[f3]=L3+A3,t4[f3+4]=L3-A3;var _3=.707106781*(S3+x3);t4[f3+2]=x3+_3,t4[f3+6]=x3-_3;var P3=.382683433*((L3=N3+y4)-(S3=v4+g4)),k3=.5411961*L3+P3,F3=1.306562965*S3+P3,I3=.707106781*(A3=y4+v4),j3=g4+I3,C3=g4-I3;t4[f3+5]=C3+k3,t4[f3+3]=C3-k3,t4[f3+1]=j3+F3,t4[f3+7]=j3-F3,f3+=8}for(f3=0,l4=0;l4<8;++l4){n3=t4[f3],r3=t4[f3+8],i4=t4[f3+16],a4=t4[f3+24],o4=t4[f3+32],s4=t4[f3+40],u4=t4[f3+48];var O3=n3+(c4=t4[f3+56]),B3=n3-c4,M3=r3+u4,q3=r3-u4,E3=i4+s4,R2=i4-s4,D2=a4+o4,T2=a4-o4,z2=O3+D2,U2=O3-D2,H2=M3+E3,W2=M3-E3;t4[f3]=z2+H2,t4[f3+32]=z2-H2;var V2=.707106781*(W2+U2);t4[f3+16]=U2+V2,t4[f3+48]=U2-V2;var G2=.382683433*((z2=T2+R2)-(W2=q3+B3)),Y2=.5411961*z2+G2,J2=1.306562965*W2+G2,X2=.707106781*(H2=R2+q3),K2=B3+X2,Z2=B3-X2;t4[f3+40]=Z2+Y2,t4[f3+24]=Z2-Y2,t4[f3+8]=K2+J2,t4[f3+56]=K2-J2,f3++}for(l4=0;l4<64;++l4)h3=t4[l4]*e3[l4],d2[l4]=h3>0?h3+.5|0:h3-.5|0;return d2})(t3,e2),c3=0;c3<64;++c3)p2[x2[c3]]=u3[c3];var l3=p2[0]-n2;n2=p2[0],l3==0?O2(r2[0]):(O2(r2[f2[a3=32767+l3]]),O2(h2[a3]));for(var g3=63;g3>0&&p2[g3]==0;)g3--;if(g3==0)return O2(o3),n2;for(var m3,v3=1;v3<=g3;){for(var b3=v3;p2[v3]==0&&v3<=g3;)++v3;var y3=v3-b3;if(y3>=16){m3=y3>>4;for(var w3=1;w3<=m3;++w3)O2(s3);y3&=15}a3=32767+p2[v3],O2(i3[(y3<<4)+f2[a3]]),O2(h2[a3]),v3++}return g3!=63&&O2(o3),n2}function E2(t3){t3=Math.min(Math.max(t3,1),100),a2!=t3&&((function(t4){for(var e2=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n2=0;n2<64;n2++){var r2=o2((e2[n2]*t4+50)/100);r2=Math.min(Math.max(r2,1),255),s2[x2[n2]]=r2}for(var i3=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],a3=0;a3<64;a3++){var h3=o2((i3[a3]*t4+50)/100);h3=Math.min(Math.max(h3,1),255),u2[x2[a3]]=h3}for(var f3=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],d3=0,p3=0;p3<8;p3++)for(var g3=0;g3<8;g3++)c2[d3]=1/(s2[x2[d3]]*f3[p3]*f3[g3]*8),l2[d3]=1/(u2[x2[d3]]*f3[p3]*f3[g3]*8),d3++})(t3<50?Math.floor(5e3/t3):Math.floor(200-2*t3)),a2=t3)}this.encode=function(t3,a3){a3&&E2(a3),g2=new Array,m2=0,v2=7,M2(65496),M2(65504),M2(16),B2(74),B2(70),B2(73),B2(70),B2(0),B2(1),B2(1),B2(0),M2(1),M2(1),B2(0),B2(0),(function(){M2(65499),M2(132),B2(0);for(var t4=0;t4<64;t4++)B2(s2[t4]);B2(1);for(var e2=0;e2<64;e2++)B2(u2[e2])})(),(function(t4,e2){M2(65472),M2(17),B2(8),M2(e2),M2(t4),B2(3),B2(1),B2(17),B2(0),B2(2),B2(17),B2(1),B2(3),B2(17),B2(1)})(t3.width,t3.height),(function(){M2(65476),M2(418),B2(0);for(var t4=0;t4<16;t4++)B2(A2[t4+1]);for(var e2=0;e2<=11;e2++)B2(S2[e2]);B2(16);for(var n2=0;n2<16;n2++)B2(_2[n2+1]);for(var r2=0;r2<=161;r2++)B2(P2[r2]);B2(1);for(var i3=0;i3<16;i3++)B2(k2[i3+1]);for(var a4=0;a4<=11;a4++)B2(F2[a4]);B2(17);for(var o4=0;o4<16;o4++)B2(I2[o4+1]);for(var s3=0;s3<=161;s3++)B2(j2[s3])})(),M2(65498),M2(12),B2(3),B2(1),B2(0),B2(2),B2(17),B2(3),B2(17),B2(0),B2(63),B2(0);var o3=0,h3=0,f3=0;m2=0,v2=7,this.encode.displayName="_encode_";for(var d3,p3,N3,x3,C3,R2,D2,T2,z2,U2=t3.data,H2=t3.width,W2=t3.height,V2=4*H2,G2=0;G2<W2;){for(d3=0;d3<V2;){for(C3=V2*G2+d3,D2=-1,T2=0,z2=0;z2<64;z2++)R2=C3+(T2=z2>>3)*V2+(D2=4*(7&z2)),G2+T2>=W2&&(R2-=V2*(G2+1+T2-W2)),d3+D2>=V2&&(R2-=d3+D2-V2+4),p3=U2[R2++],N3=U2[R2++],x3=U2[R2++],b2[z2]=(L2[p3]+L2[N3+256|0]+L2[x3+512|0]>>16)-128,y2[z2]=(L2[p3+768|0]+L2[N3+1024|0]+L2[x3+1280|0]>>16)-128,w2[z2]=(L2[p3+1280|0]+L2[N3+1536|0]+L2[x3+1792|0]>>16)-128;o3=q2(b2,c2,o3,e,r),h3=q2(y2,l2,h3,n,i2),f3=q2(w2,l2,f3,n,i2),d3+=32}G2+=8}if(v2>=0){var Y2=[];Y2[1]=v2+1,Y2[0]=(1<<v2+1)-1,O2(Y2)}return M2(65497),new Uint8Array(g2)},t2=t2||50,(function(){for(var t3=String.fromCharCode,e2=0;e2<256;e2++)N2[e2]=t3(e2)})(),e=C2(A2,S2),n=C2(k2,F2),r=C2(_2,P2),i2=C2(I2,j2),(function(){for(var t3=1,e2=2,n2=1;n2<=15;n2++){for(var r2=t3;r2<e2;r2++)f2[32767+r2]=n2,h2[32767+r2]=[],h2[32767+r2][1]=n2,h2[32767+r2][0]=r2;for(var i3=-(e2-1);i3<=-t3;i3++)f2[32767+i3]=n2,h2[32767+i3]=[],h2[32767+i3][1]=n2,h2[32767+i3][0]=e2-1+i3;t3<<=1,e2<<=1}})(),(function(){for(var t3=0;t3<256;t3++)L2[t3]=19595*t3,L2[t3+256|0]=38470*t3,L2[t3+512|0]=7471*t3+32768,L2[t3+768|0]=-11059*t3,L2[t3+1024|0]=-21709*t3,L2[t3+1280|0]=32768*t3+8421375,L2[t3+1536|0]=-27439*t3,L2[t3+1792|0]=-5329*t3})(),E2(t2)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ce(t2,e){if(this.pos=0,this.buffer=t2,this.datav=new DataView(t2.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function le(t2){function e(t3){if(!t3)throw Error("assert :P")}function n(t3,e2,n2){for(var r2=0;4>r2;r2++)if(t3[e2+r2]!=n2.charCodeAt(r2))return!0;return!1}function r(t3,e2,n2,r2,i3){for(var a3=0;a3<i3;a3++)t3[e2+a3]=n2[r2+a3]}function i2(t3,e2,n2,r2){for(var i3=0;i3<r2;i3++)t3[e2+i3]=n2}function a2(t3){return new Int32Array(t3)}function o2(t3,e2){for(var n2=[],r2=0;r2<t3;r2++)n2.push(new e2);return n2}function s2(t3,e2){var n2=[];return(function t4(n3,r2,i3){for(var a3=i3[r2],o3=0;o3<a3&&(n3.push(i3.length>r2+1?[]:new e2),!(i3.length<r2+1));o3++)t4(n3[o3],r2+1,i3)})(n2,0,t3),n2}var u2=function(){var t3=this;function u3(t4,e2){for(var n2=1<<e2-1>>>0;t4&n2;)n2>>>=1;return n2?(t4&n2-1)+n2:t4}function c3(t4,n2,r2,i3,a3){e(!(i3%r2));do t4[n2+(i3-=r2)]=a3;while(0<i3)}function l3(t4,n2,r2,i3,o3){if(e(2328>=o3),512>=o3)var s3=a2(512);else if((s3=a2(o3))==null)return 0;return(function(t5,n3,r3,i4,o4,s4){var l4,f4,d4=n3,p4=1<<r3,g4=a2(16),m4=a2(16);for(e(o4!=0),e(i4!=null),e(t5!=null),e(0<r3),f4=0;f4<o4;++f4){if(15<i4[f4])return 0;++g4[i4[f4]]}if(g4[0]==o4)return 0;for(m4[1]=0,l4=1;15>l4;++l4){if(g4[l4]>1<<l4)return 0;m4[l4+1]=m4[l4]+g4[l4]}for(f4=0;f4<o4;++f4)l4=i4[f4],0<i4[f4]&&(s4[m4[l4]++]=f4);if(m4[15]==1)return(i4=new h3).g=0,i4.value=s4[0],c3(t5,d4,1,p4,i4),p4;var v4,b4=-1,y4=p4-1,w4=0,N4=1,L4=1,x4=1<<r3;for(f4=0,l4=1,o4=2;l4<=r3;++l4,o4<<=1){if(N4+=L4<<=1,0>(L4-=g4[l4]))return 0;for(;0<g4[l4];--g4[l4])(i4=new h3).g=l4,i4.value=s4[f4++],c3(t5,d4+w4,o4,x4,i4),w4=u3(w4,l4)}for(l4=r3+1,o4=2;15>=l4;++l4,o4<<=1){if(N4+=L4<<=1,0>(L4-=g4[l4]))return 0;for(;0<g4[l4];--g4[l4]){if(i4=new h3,(w4&y4)!=b4){for(d4+=x4,v4=1<<(b4=l4)-r3;15>b4&&!(0>=(v4-=g4[b4]));)++b4,v4<<=1;p4+=x4=1<<(v4=b4-r3),t5[n3+(b4=w4&y4)].g=v4+r3,t5[n3+b4].value=d4-n3-b4}i4.g=l4-r3,i4.value=s4[f4++],c3(t5,d4+(w4>>r3),o4,x4,i4),w4=u3(w4,l4)}}return N4!=2*m4[15]-1?0:p4})(t4,n2,r2,i3,o3,s3)}function h3(){this.value=this.g=0}function f3(){this.value=this.g=0}function d3(){this.G=o2(5,h3),this.H=a2(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o2(Rn,f3)}function p3(t4,n2,r2,i3){e(t4!=null),e(n2!=null),e(2147483648>i3),t4.Ca=254,t4.I=0,t4.b=-8,t4.Ka=0,t4.oa=n2,t4.pa=r2,t4.Jd=n2,t4.Yc=r2+i3,t4.Zc=4<=i3?r2+i3-4+1:r2,_2(t4)}function g3(t4,e2){for(var n2=0;0<e2--;)n2|=k2(t4,128)<<e2;return n2}function m3(t4,e2){var n2=g3(t4,e2);return P2(t4)?-n2:n2}function v3(t4,n2,r2,i3){var a3,o3=0;for(e(t4!=null),e(n2!=null),e(4294967288>i3),t4.Sb=i3,t4.Ra=0,t4.u=0,t4.h=0,4<i3&&(i3=4),a3=0;a3<i3;++a3)o3+=n2[r2+a3]<<8*a3;t4.Ra=o3,t4.bb=i3,t4.oa=n2,t4.pa=r2}function b3(t4){for(;8<=t4.u&&t4.bb<t4.Sb;)t4.Ra>>>=8,t4.Ra+=t4.oa[t4.pa+t4.bb]<<zn-8>>>0,++t4.bb,t4.u-=8;x3(t4)&&(t4.h=1,t4.u=0)}function y3(t4,n2){if(e(0<=n2),!t4.h&&n2<=Tn){var r2=L3(t4)&Dn[n2];return t4.u+=n2,b3(t4),r2}return t4.h=1,t4.u=0}function w3(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function N3(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function L3(t4){return t4.Ra>>>(t4.u&zn-1)>>>0}function x3(t4){return e(t4.bb<=t4.Sb),t4.h||t4.bb==t4.Sb&&t4.u>zn}function A3(t4,e2){t4.u=e2,t4.h=x3(t4)}function S2(t4){t4.u>=Un&&(e(t4.u>=Un),b3(t4))}function _2(t4){e(t4!=null&&t4.oa!=null),t4.pa<t4.Zc?(t4.I=(t4.oa[t4.pa++]|t4.I<<8)>>>0,t4.b+=8):(e(t4!=null&&t4.oa!=null),t4.pa<t4.Yc?(t4.b+=8,t4.I=t4.oa[t4.pa++]|t4.I<<8):t4.Ka?t4.b=0:(t4.I<<=8,t4.b+=8,t4.Ka=1))}function P2(t4){return g3(t4,1)}function k2(t4,e2){var n2=t4.Ca;0>t4.b&&_2(t4);var r2=t4.b,i3=n2*e2>>>8,a3=(t4.I>>>r2>i3)+0;for(a3?(n2-=i3,t4.I-=i3+1<<r2>>>0):n2=i3+1,r2=n2,i3=0;256<=r2;)i3+=8,r2>>=8;return r2=7^i3+Hn[r2],t4.b-=r2,t4.Ca=(n2<<r2)-1,a3}function F2(t4,e2,n2){t4[e2+0]=n2>>24&255,t4[e2+1]=n2>>16&255,t4[e2+2]=n2>>8&255,t4[e2+3]=255&n2}function I2(t4,e2){return t4[e2+0]|t4[e2+1]<<8}function j2(t4,e2){return I2(t4,e2)|t4[e2+2]<<16}function C2(t4,e2){return I2(t4,e2)|I2(t4,e2+2)<<16}function O2(t4,n2){var r2=1<<n2;return e(t4!=null),e(0<n2),t4.X=a2(r2),t4.X==null?0:(t4.Mb=32-n2,t4.Xa=n2,1)}function B2(t4,n2){e(t4!=null),e(n2!=null),e(t4.Xa==n2.Xa),r(n2.X,0,t4.X,0,1<<n2.Xa)}function M2(){this.X=[],this.Xa=this.Mb=0}function q2(t4,n2,r2,i3){e(r2!=null),e(i3!=null);var a3=r2[0],o3=i3[0];return a3==0&&(a3=(t4*o3+n2/2)/n2),o3==0&&(o3=(n2*a3+t4/2)/t4),0>=a3||0>=o3?0:(r2[0]=a3,i3[0]=o3,1)}function E2(t4,e2){return t4+(1<<e2)-1>>>e2}function R2(t4,e2){return((4278255360&t4)+(4278255360&e2)>>>0&4278255360)+((16711935&t4)+(16711935&e2)>>>0&16711935)>>>0}function D2(e2,n2){t3[n2]=function(n3,r2,i3,a3,o3,s3,u4){var c4;for(c4=0;c4<o3;++c4){var l4=t3[e2](s3[u4+c4-1],i3,a3+c4);s3[u4+c4]=R2(n3[r2+c4],l4)}}}function T2(){this.ud=this.hd=this.jd=0}function z2(t4,e2){return((4278124286&(t4^e2))>>>1)+(t4&e2)>>>0}function U2(t4){return 0<=t4&&256>t4?t4:0>t4?0:255<t4?255:void 0}function H2(t4,e2){return U2(t4+(t4-e2+.5>>1))}function W2(t4,e2,n2){return Math.abs(e2-n2)-Math.abs(t4-n2)}function V2(t4,e2,n2,r2,i3,a3,o3){for(r2=a3[o3-1],n2=0;n2<i3;++n2)a3[o3+n2]=r2=R2(t4[e2+n2],r2)}function G2(t4,e2,n2,r2,i3){var a3;for(a3=0;a3<n2;++a3){var o3=t4[e2+a3],s3=o3>>8&255,u4=16711935&(u4=(u4=16711935&o3)+((s3<<16)+s3));r2[i3+a3]=(4278255360&o3)+u4>>>0}}function Y2(t4,e2){e2.jd=255&t4,e2.hd=t4>>8&255,e2.ud=t4>>16&255}function J2(t4,e2,n2,r2,i3,a3){var o3;for(o3=0;o3<r2;++o3){var s3=e2[n2+o3],u4=s3>>>8,c4=s3,l4=255&(l4=(l4=s3>>>16)+((t4.jd<<24>>24)*(u4<<24>>24)>>>5));c4=255&(c4=(c4+=(t4.hd<<24>>24)*(u4<<24>>24)>>>5)+((t4.ud<<24>>24)*(l4<<24>>24)>>>5)),i3[a3+o3]=(4278255360&s3)+(l4<<16)+c4}}function X2(e2,n2,r2,i3,a3){t3[n2]=function(t4,e3,n3,r3,o3,s3,u4,c4,l4){for(r3=u4;r3<c4;++r3)for(u4=0;u4<l4;++u4)o3[s3++]=a3(n3[i3(t4[e3++])])},t3[e2]=function(e3,n3,o3,s3,u4,c4,l4){var h4=8>>e3.b,f4=e3.Ea,d4=e3.K[0],p4=e3.w;if(8>h4)for(e3=(1<<e3.b)-1,p4=(1<<h4)-1;n3<o3;++n3){var g4,m4=0;for(g4=0;g4<f4;++g4)g4&e3||(m4=i3(s3[u4++])),c4[l4++]=a3(d4[m4&p4]),m4>>=h4}else t3["VP8LMapColor"+r2](s3,u4,d4,p4,c4,l4,n3,o3,f4)}}function K2(t4,e2,n2,r2,i3){for(n2=e2+n2;e2<n2;){var a3=t4[e2++];r2[i3++]=a3>>16&255,r2[i3++]=a3>>8&255,r2[i3++]=255&a3}}function Z2(t4,e2,n2,r2,i3){for(n2=e2+n2;e2<n2;){var a3=t4[e2++];r2[i3++]=a3>>16&255,r2[i3++]=a3>>8&255,r2[i3++]=255&a3,r2[i3++]=a3>>24&255}}function $2(t4,e2,n2,r2,i3){for(n2=e2+n2;e2<n2;){var a3=(o3=t4[e2++])>>16&240|o3>>12&15,o3=240&o3|o3>>28&15;r2[i3++]=a3,r2[i3++]=o3}}function Q2(t4,e2,n2,r2,i3){for(n2=e2+n2;e2<n2;){var a3=(o3=t4[e2++])>>16&248|o3>>13&7,o3=o3>>5&224|o3>>3&31;r2[i3++]=a3,r2[i3++]=o3}}function tt2(t4,e2,n2,r2,i3){for(n2=e2+n2;e2<n2;){var a3=t4[e2++];r2[i3++]=255&a3,r2[i3++]=a3>>8&255,r2[i3++]=a3>>16&255}}function et2(t4,e2,n2,i3,a3,o3){if(o3==0)for(n2=e2+n2;e2<n2;)F2(i3,((o3=t4[e2++])[0]>>24|o3[1]>>8&65280|o3[2]<<8&16711680|o3[3]<<24)>>>0),a3+=32;else r(i3,a3,t4,e2,n2)}function nt2(e2,n2){t3[n2][0]=t3[e2+"0"],t3[n2][1]=t3[e2+"1"],t3[n2][2]=t3[e2+"2"],t3[n2][3]=t3[e2+"3"],t3[n2][4]=t3[e2+"4"],t3[n2][5]=t3[e2+"5"],t3[n2][6]=t3[e2+"6"],t3[n2][7]=t3[e2+"7"],t3[n2][8]=t3[e2+"8"],t3[n2][9]=t3[e2+"9"],t3[n2][10]=t3[e2+"10"],t3[n2][11]=t3[e2+"11"],t3[n2][12]=t3[e2+"12"],t3[n2][13]=t3[e2+"13"],t3[n2][14]=t3[e2+"0"],t3[n2][15]=t3[e2+"0"]}function rt2(t4){return t4==Ur||t4==Hr||t4==Wr||t4==Vr}function it2(){this.eb=[],this.size=this.A=this.fb=0}function at2(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ot2(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new it2,this.f.kb=new at2,this.sd=null}function st2(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ut2(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ct2(t4){return alert("todo:WebPSamplerProcessPlane"),t4.T}function lt2(t4,e2){var n2=t4.T,i3=e2.ba.f.RGBA,a3=i3.eb,o3=i3.fb+t4.ka*i3.A,s3=mi[e2.ba.S],u4=t4.y,c4=t4.O,l4=t4.f,h4=t4.N,f4=t4.ea,d4=t4.W,p4=e2.cc,g4=e2.dc,m4=e2.Mc,v4=e2.Nc,b4=t4.ka,y4=t4.ka+t4.T,w4=t4.U,N4=w4+1>>1;for(b4==0?s3(u4,c4,null,null,l4,h4,f4,d4,l4,h4,f4,d4,a3,o3,null,null,w4):(s3(e2.ec,e2.fc,u4,c4,p4,g4,m4,v4,l4,h4,f4,d4,a3,o3-i3.A,a3,o3,w4),++n2);b4+2<y4;b4+=2)p4=l4,g4=h4,m4=f4,v4=d4,h4+=t4.Rc,d4+=t4.Rc,o3+=2*i3.A,s3(u4,(c4+=2*t4.fa)-t4.fa,u4,c4,p4,g4,m4,v4,l4,h4,f4,d4,a3,o3-i3.A,a3,o3,w4);return c4+=t4.fa,t4.j+y4<t4.o?(r(e2.ec,e2.fc,u4,c4,w4),r(e2.cc,e2.dc,l4,h4,N4),r(e2.Mc,e2.Nc,f4,d4,N4),n2--):1&y4||s3(u4,c4,null,null,l4,h4,f4,d4,l4,h4,f4,d4,a3,o3+i3.A,null,null,w4),n2}function ht2(t4,n2,r2){var i3=t4.F,a3=[t4.J];if(i3!=null){var o3=t4.U,s3=n2.ba.S,u4=s3==Dr||s3==Wr;n2=n2.ba.f.RGBA;var c4=[0],l4=t4.ka;c4[0]=t4.T,t4.Kb&&(l4==0?--c4[0]:(--l4,a3[0]-=t4.width),t4.j+t4.ka+t4.T==t4.o&&(c4[0]=t4.o-t4.j-l4));var h4=n2.eb;l4=n2.fb+l4*n2.A,t4=Ar(i3,a3[0],t4.width,o3,c4,h4,l4+(u4?0:3),n2.A),e(r2==c4),t4&&rt2(s3)&&Lr(h4,l4,u4,o3,c4,n2.A)}return 0}function ft2(t4){var e2=t4.ma,n2=e2.ba.S,r2=11>n2,i3=n2==qr||n2==Rr||n2==Dr||n2==Tr||n2==12||rt2(n2);if(e2.memory=null,e2.Ib=null,e2.Jb=null,e2.Nd=null,!Mn(e2.Oa,t4,i3?11:12))return 0;if(i3&&rt2(n2)&&bn(),t4.da)alert("todo:use_scaling");else{if(r2){if(e2.Ib=ct2,t4.Kb){if(n2=t4.U+1>>1,e2.memory=a2(t4.U+2*n2),e2.memory==null)return 0;e2.ec=e2.memory,e2.fc=0,e2.cc=e2.ec,e2.dc=e2.fc+t4.U,e2.Mc=e2.cc,e2.Nc=e2.dc+n2,e2.Ib=lt2,bn()}}else alert("todo:EmitYUV");i3&&(e2.Jb=ht2,r2&&mn())}if(r2&&!Ii){for(t4=0;256>t4;++t4)ji[t4]=89858*(t4-128)+Si>>Ai,Bi[t4]=-22014*(t4-128)+Si,Oi[t4]=-45773*(t4-128),Ci[t4]=113618*(t4-128)+Si>>Ai;for(t4=_i;t4<Pi;++t4)e2=76283*(t4-16)+Si>>Ai,Mi[t4-_i]=Vt2(e2,255),qi[t4-_i]=Vt2(e2+8>>4,15);Ii=1}return 1}function dt2(t4){var n2=t4.ma,r2=t4.U,i3=t4.T;return e(!(1&t4.ka)),0>=r2||0>=i3?0:(r2=n2.Ib(t4,n2),n2.Jb!=null&&n2.Jb(t4,n2,r2),n2.Dc+=r2,1)}function pt2(t4){t4.ma.memory=null}function gt2(t4,e2,n2,r2){return y3(t4,8)!=47?0:(e2[0]=y3(t4,14)+1,n2[0]=y3(t4,14)+1,r2[0]=y3(t4,1),y3(t4,3)!=0?0:!t4.h)}function mt2(t4,e2){if(4>t4)return t4+1;var n2=t4-2>>1;return(2+(1&t4)<<n2)+y3(e2,n2)+1}function vt2(t4,e2){return 120<e2?e2-120:1<=(n2=((n2=Zr[e2-1])>>4)*t4+(8-(15&n2)))?n2:1;var n2}function bt2(t4,e2,n2){var r2=L3(n2),i3=t4[e2+=255&r2].g-8;return 0<i3&&(A3(n2,n2.u+8),r2=L3(n2),e2+=t4[e2].value,e2+=r2&(1<<i3)-1),A3(n2,n2.u+t4[e2].g),t4[e2].value}function yt2(t4,n2,r2){return r2.g+=t4.g,r2.value+=t4.value<<n2>>>0,e(8>=r2.g),t4.g}function wt2(t4,n2,r2){var i3=t4.xc;return e((n2=i3==0?0:t4.vc[t4.md*(r2>>i3)+(n2>>i3)])<t4.Wb),t4.Ya[n2]}function Nt2(t4,n2,i3,a3){var o3=t4.ab,s3=t4.c*n2,u4=t4.C;n2=u4+n2;var c4=i3,l4=a3;for(a3=t4.Ta,i3=t4.Ua;0<o3--;){var h4=t4.gc[o3],f4=u4,d4=n2,p4=c4,g4=l4,m4=(l4=a3,c4=i3,h4.Ea);switch(e(f4<d4),e(d4<=h4.nc),h4.hc){case 2:Gn(p4,g4,(d4-f4)*m4,l4,c4);break;case 0:var v4=f4,b4=d4,y4=l4,w4=c4,N4=(_3=h4).Ea;v4==0&&(Wn(p4,g4,null,null,1,y4,w4),V2(p4,g4+1,0,0,N4-1,y4,w4+1),g4+=N4,w4+=N4,++v4);for(var L4=1<<_3.b,x4=L4-1,A4=E2(N4,_3.b),S3=_3.K,_3=_3.w+(v4>>_3.b)*A4;v4<b4;){var P3=S3,k3=_3,F3=1;for(Vn(p4,g4,y4,w4-N4,1,y4,w4);F3<N4;){var I3=(F3&~x4)+L4;I3>N4&&(I3=N4),(0,Zn[P3[k3++]>>8&15])(p4,g4+ +F3,y4,w4+F3-N4,I3-F3,y4,w4+F3),F3=I3}g4+=N4,w4+=N4,++v4&x4||(_3+=A4)}d4!=h4.nc&&r(l4,c4-m4,l4,c4+(d4-f4-1)*m4,m4);break;case 1:for(m4=p4,b4=g4,N4=(p4=h4.Ea)-(w4=p4&~(y4=(g4=1<<h4.b)-1)),v4=E2(p4,h4.b),L4=h4.K,h4=h4.w+(f4>>h4.b)*v4;f4<d4;){for(x4=L4,A4=h4,S3=new T2,_3=b4+w4,P3=b4+p4;b4<_3;)Y2(x4[A4++],S3),$n(S3,m4,b4,g4,l4,c4),b4+=g4,c4+=g4;b4<P3&&(Y2(x4[A4++],S3),$n(S3,m4,b4,N4,l4,c4),b4+=N4,c4+=N4),++f4&y4||(h4+=v4)}break;case 3:if(p4==l4&&g4==c4&&0<h4.b){for(b4=l4,p4=m4=c4+(d4-f4)*m4-(w4=(d4-f4)*E2(h4.Ea,h4.b)),g4=l4,y4=c4,v4=[],w4=(N4=w4)-1;0<=w4;--w4)v4[w4]=g4[y4+w4];for(w4=N4-1;0<=w4;--w4)b4[p4+w4]=v4[w4];Yn(h4,f4,d4,l4,m4,l4,c4)}else Yn(h4,f4,d4,p4,g4,l4,c4)}c4=a3,l4=i3}l4!=i3&&r(a3,i3,c4,l4,s3)}function Lt2(t4,n2){var r2=t4.V,i3=t4.Ba+t4.c*t4.C,a3=n2-t4.C;if(e(n2<=t4.l.o),e(16>=a3),0<a3){var o3=t4.l,s3=t4.Ta,u4=t4.Ua,c4=o3.width;if(Nt2(t4,a3,r2,i3),a3=u4=[u4],e((r2=t4.C)<(i3=n2)),e(o3.v<o3.va),i3>o3.o&&(i3=o3.o),r2<o3.j){var l4=o3.j-r2;r2=o3.j,a3[0]+=l4*c4}if(r2>=i3?r2=0:(a3[0]+=4*o3.v,o3.ka=r2-o3.j,o3.U=o3.va-o3.v,o3.T=i3-r2,r2=1),r2){if(u4=u4[0],11>(r2=t4.ca).S){var h4=r2.f.RGBA,f4=(i3=r2.S,a3=o3.U,o3=o3.T,l4=h4.eb,h4.A),d4=o3;for(h4=h4.fb+t4.Ma*h4.A;0<d4--;){var p4=s3,g4=u4,m4=a3,v4=l4,b4=h4;switch(i3){case Mr:Qn(p4,g4,m4,v4,b4);break;case qr:tr(p4,g4,m4,v4,b4);break;case Ur:tr(p4,g4,m4,v4,b4),Lr(v4,b4,0,m4,1,0);break;case Er:rr(p4,g4,m4,v4,b4);break;case Rr:et2(p4,g4,m4,v4,b4,1);break;case Hr:et2(p4,g4,m4,v4,b4,1),Lr(v4,b4,0,m4,1,0);break;case Dr:et2(p4,g4,m4,v4,b4,0);break;case Wr:et2(p4,g4,m4,v4,b4,0),Lr(v4,b4,1,m4,1,0);break;case Tr:er(p4,g4,m4,v4,b4);break;case Vr:er(p4,g4,m4,v4,b4),xr(v4,b4,m4,1,0);break;case zr:nr(p4,g4,m4,v4,b4);break;default:e(0)}u4+=c4,h4+=f4}t4.Ma+=o3}else alert("todo:EmitRescaledRowsYUVA");e(t4.Ma<=r2.height)}}t4.C=n2,e(t4.C<=t4.i)}function xt2(t4){var e2;if(0<t4.ua)return 0;for(e2=0;e2<t4.Wb;++e2){var n2=t4.Ya[e2].G,r2=t4.Ya[e2].H;if(0<n2[1][r2[1]+0].g||0<n2[2][r2[2]+0].g||0<n2[3][r2[3]+0].g)return 0}return 1}function At2(t4,n2,r2,i3,a3,o3){if(t4.Z!=0){var s3=t4.qd,u4=t4.rd;for(e(gi[t4.Z]!=null);n2<r2;++n2)gi[t4.Z](s3,u4,i3,a3,i3,a3,o3),s3=i3,u4=a3,a3+=o3;t4.qd=s3,t4.rd=u4}}function St(t4,n2){var r2=t4.l.ma,i3=r2.Z==0||r2.Z==1?t4.l.j:t4.C;if(i3=t4.C<i3?i3:t4.C,e(n2<=t4.l.o),n2>i3){var a3=t4.l.width,o3=r2.ca,s3=r2.tb+a3*i3,u4=t4.V,c4=t4.Ba+t4.c*i3,l4=t4.gc;e(t4.ab==1),e(l4[0].hc==3),Xn(l4[0],i3,n2,u4,c4,o3,s3),At2(r2,i3,n2,o3,s3,a3)}t4.C=t4.Ma=n2}function _t2(t4,n2,r2,i3,a3,o3,s3){var u4=t4.$/i3,c4=t4.$%i3,l4=t4.m,h4=t4.s,f4=r2+t4.$,d4=f4;a3=r2+i3*a3;var p4=r2+i3*o3,g4=280+h4.ua,m4=t4.Pb?u4:16777216,v4=0<h4.ua?h4.Wa:null,b4=h4.wc,y4=f4<p4?wt2(h4,c4,u4):null;e(t4.C<o3),e(p4<=a3);var w4=!1;t:for(;;){for(;w4||f4<p4;){var N4=0;if(u4>=m4){var _3=f4-r2;e((m4=t4).Pb),m4.wd=m4.m,m4.xd=_3,0<m4.s.ua&&B2(m4.s.Wa,m4.s.vb),m4=u4+Qr}if(c4&b4||(y4=wt2(h4,c4,u4)),e(y4!=null),y4.Qb&&(n2[f4]=y4.qb,w4=!0),!w4)if(S2(l4),y4.jc){N4=l4,_3=n2;var P3=f4,k3=y4.pd[L3(N4)&Rn-1];e(y4.jc),256>k3.g?(A3(N4,N4.u+k3.g),_3[P3]=k3.value,N4=0):(A3(N4,N4.u+k3.g-256),e(256<=k3.value),N4=k3.value),N4==0&&(w4=!0)}else N4=bt2(y4.G[0],y4.H[0],l4);if(l4.h)break;if(w4||256>N4){if(!w4)if(y4.nd)n2[f4]=(y4.qb|N4<<8)>>>0;else{if(S2(l4),w4=bt2(y4.G[1],y4.H[1],l4),S2(l4),_3=bt2(y4.G[2],y4.H[2],l4),P3=bt2(y4.G[3],y4.H[3],l4),l4.h)break;n2[f4]=(P3<<24|w4<<16|N4<<8|_3)>>>0}if(w4=!1,++f4,++c4>=i3&&(c4=0,++u4,s3!=null&&u4<=o3&&!(u4%16)&&s3(t4,u4),v4!=null))for(;d4<f4;)N4=n2[d4++],v4.X[(506832829*N4&4294967295)>>>v4.Mb]=N4}else if(280>N4){if(N4=mt2(N4-256,l4),_3=bt2(y4.G[4],y4.H[4],l4),S2(l4),_3=vt2(i3,_3=mt2(_3,l4)),l4.h)break;if(f4-r2<_3||a3-f4<N4)break t;for(P3=0;P3<N4;++P3)n2[f4+P3]=n2[f4+P3-_3];for(f4+=N4,c4+=N4;c4>=i3;)c4-=i3,++u4,s3!=null&&u4<=o3&&!(u4%16)&&s3(t4,u4);if(e(f4<=a3),c4&b4&&(y4=wt2(h4,c4,u4)),v4!=null)for(;d4<f4;)N4=n2[d4++],v4.X[(506832829*N4&4294967295)>>>v4.Mb]=N4}else{if(!(N4<g4))break t;for(w4=N4-280,e(v4!=null);d4<f4;)N4=n2[d4++],v4.X[(506832829*N4&4294967295)>>>v4.Mb]=N4;N4=f4,e(!(w4>>>(_3=v4).Xa)),n2[N4]=_3.X[w4],w4=!0}w4||e(l4.h==x3(l4))}if(t4.Pb&&l4.h&&f4<a3)e(t4.m.h),t4.a=5,t4.m=t4.wd,t4.$=t4.xd,0<t4.s.ua&&B2(t4.s.vb,t4.s.Wa);else{if(l4.h)break t;s3?.(t4,u4>o3?o3:u4),t4.a=0,t4.$=f4-r2}return 1}return t4.a=3,0}function Pt2(t4){e(t4!=null),t4.vc=null,t4.yc=null,t4.Ya=null;var n2=t4.Wa;n2!=null&&(n2.X=null),t4.vb=null,e(t4!=null)}function kt2(){var e2=new on;return e2==null?null:(e2.a=0,e2.xb=pi,nt2("Predictor","VP8LPredictors"),nt2("Predictor","VP8LPredictors_C"),nt2("PredictorAdd","VP8LPredictorsAdd"),nt2("PredictorAdd","VP8LPredictorsAdd_C"),Gn=G2,$n=J2,Qn=K2,tr=Z2,er=$2,nr=Q2,rr=tt2,t3.VP8LMapColor32b=Jn,t3.VP8LMapColor8b=Kn,e2)}function Ft2(t4,n2,r2,s3,u4){var c4=1,f4=[t4],p4=[n2],g4=s3.m,m4=s3.s,v4=null,b4=0;t:for(;;){if(r2)for(;c4&&y3(g4,1);){var w4=f4,N4=p4,x4=s3,_3=1,P3=x4.m,k3=x4.gc[x4.ab],F3=y3(P3,2);if(x4.Oc&1<<F3)c4=0;else{switch(x4.Oc|=1<<F3,k3.hc=F3,k3.Ea=w4[0],k3.nc=N4[0],k3.K=[null],++x4.ab,e(4>=x4.ab),F3){case 0:case 1:k3.b=y3(P3,3)+2,_3=Ft2(E2(k3.Ea,k3.b),E2(k3.nc,k3.b),0,x4,k3.K),k3.K=k3.K[0];break;case 3:var I3,j3=y3(P3,8)+1,C3=16<j3?0:4<j3?1:2<j3?2:3;if(w4[0]=E2(k3.Ea,C3),k3.b=C3,I3=_3=Ft2(j3,1,0,x4,k3.K)){var B3,M3=j3,q3=k3,D3=1<<(8>>q3.b),T3=a2(D3);if(T3==null)I3=0;else{var z3=q3.K[0],U3=q3.w;for(T3[0]=q3.K[0][0],B3=1;B3<1*M3;++B3)T3[B3]=R2(z3[U3+B3],T3[B3-1]);for(;B3<4*D3;++B3)T3[B3]=0;q3.K[0]=null,q3.K[0]=T3,I3=1}}_3=I3;break;case 2:break;default:e(0)}c4=_3}}if(f4=f4[0],p4=p4[0],c4&&y3(g4,1)&&!(c4=1<=(b4=y3(g4,4))&&11>=b4)){s3.a=3;break t}var H3;if(H3=c4)e:{var W3,V3,G3,Y3=s3,J3=f4,X3=p4,K3=b4,Z3=r2,$3=Y3.m,Q3=Y3.s,tt3=[null],et3=1,nt3=0,rt3=$r[K3];n:for(;;){if(Z3&&y3($3,1)){var it3=y3($3,3)+2,at3=E2(J3,it3),ot3=E2(X3,it3),st3=at3*ot3;if(!Ft2(at3,ot3,0,Y3,tt3))break n;for(tt3=tt3[0],Q3.xc=it3,W3=0;W3<st3;++W3){var ut3=tt3[W3]>>8&65535;tt3[W3]=ut3,ut3>=et3&&(et3=ut3+1)}}if($3.h)break n;for(V3=0;5>V3;++V3){var ct3=Jr[V3];!V3&&0<K3&&(ct3+=1<<K3),nt3<ct3&&(nt3=ct3)}var lt3=o2(et3*rt3,h3),ht3=et3,ft3=o2(ht3,d3);if(ft3==null)var dt3=null;else e(65536>=ht3),dt3=ft3;var pt3=a2(nt3);if(dt3==null||pt3==null||lt3==null){Y3.a=1;break n}var gt3=lt3;for(W3=G3=0;W3<et3;++W3){var mt3=dt3[W3],vt3=mt3.G,bt3=mt3.H,wt3=0,Nt3=1,Lt3=0;for(V3=0;5>V3;++V3){ct3=Jr[V3],vt3[V3]=gt3,bt3[V3]=G3,!V3&&0<K3&&(ct3+=1<<K3);r:{var xt3,At3=ct3,St2=Y3,kt3=pt3,It3=gt3,jt3=G3,Ct3=0,Ot3=St2.m,Bt3=y3(Ot3,1);if(i2(kt3,0,0,At3),Bt3){var Mt3=y3(Ot3,1)+1,qt3=y3(Ot3,1),Et3=y3(Ot3,qt3==0?1:8);kt3[Et3]=1,Mt3==2&&(kt3[Et3=y3(Ot3,8)]=1);var Rt3=1}else{var Dt3=a2(19),Tt3=y3(Ot3,4)+4;if(19<Tt3){St2.a=3;var zt3=0;break r}for(xt3=0;xt3<Tt3;++xt3)Dt3[Kr[xt3]]=y3(Ot3,3);var Ut3=void 0,Ht3=void 0,Wt3=St2,Vt3=Dt3,Gt3=At3,Yt3=kt3,Jt3=0,Xt3=Wt3.m,Kt3=8,Zt3=o2(128,h3);i:for(;l3(Zt3,0,7,Vt3,19);){if(y3(Xt3,1)){var $t3=2+2*y3(Xt3,3);if((Ut3=2+y3(Xt3,$t3))>Gt3)break i}else Ut3=Gt3;for(Ht3=0;Ht3<Gt3&&Ut3--;){S2(Xt3);var Qt3=Zt3[0+(127&L3(Xt3))];A3(Xt3,Xt3.u+Qt3.g);var te3=Qt3.value;if(16>te3)Yt3[Ht3++]=te3,te3!=0&&(Kt3=te3);else{var ee3=te3==16,ne3=te3-16,re3=Yr[ne3],ie3=y3(Xt3,Gr[ne3])+re3;if(Ht3+ie3>Gt3)break i;for(var ae3=ee3?Kt3:0;0<ie3--;)Yt3[Ht3++]=ae3}}Jt3=1;break i}Jt3||(Wt3.a=3),Rt3=Jt3}(Rt3=Rt3&&!Ot3.h)&&(Ct3=l3(It3,jt3,8,kt3,At3)),Rt3&&Ct3!=0?zt3=Ct3:(St2.a=3,zt3=0)}if(zt3==0)break n;if(Nt3&&Xr[V3]==1&&(Nt3=gt3[G3].g==0),wt3+=gt3[G3].g,G3+=zt3,3>=V3){var oe3,se3=pt3[0];for(oe3=1;oe3<ct3;++oe3)pt3[oe3]>se3&&(se3=pt3[oe3]);Lt3+=se3}}if(mt3.nd=Nt3,mt3.Qb=0,Nt3&&(mt3.qb=(vt3[3][bt3[3]+0].value<<24|vt3[1][bt3[1]+0].value<<16|vt3[2][bt3[2]+0].value)>>>0,wt3==0&&256>vt3[0][bt3[0]+0].value&&(mt3.Qb=1,mt3.qb+=vt3[0][bt3[0]+0].value<<8)),mt3.jc=!mt3.Qb&&6>Lt3,mt3.jc){var ue3,ce3=mt3;for(ue3=0;ue3<Rn;++ue3){var le3=ue3,he3=ce3.pd[le3],fe3=ce3.G[0][ce3.H[0]+le3];256<=fe3.value?(he3.g=fe3.g+256,he3.value=fe3.value):(he3.g=0,he3.value=0,le3>>=yt2(fe3,8,he3),le3>>=yt2(ce3.G[1][ce3.H[1]+le3],16,he3),le3>>=yt2(ce3.G[2][ce3.H[2]+le3],0,he3),yt2(ce3.G[3][ce3.H[3]+le3],24,he3))}}}Q3.vc=tt3,Q3.Wb=et3,Q3.Ya=dt3,Q3.yc=lt3,H3=1;break e}H3=0}if(!(c4=H3)){s3.a=3;break t}if(0<b4){if(m4.ua=1<<b4,!O2(m4.Wa,b4)){s3.a=1,c4=0;break t}}else m4.ua=0;var de3=s3,pe3=f4,ge3=p4,me3=de3.s,ve3=me3.xc;if(de3.c=pe3,de3.i=ge3,me3.md=E2(pe3,ve3),me3.wc=ve3==0?-1:(1<<ve3)-1,r2){s3.xb=di;break t}if((v4=a2(f4*p4))==null){s3.a=1,c4=0;break t}c4=(c4=_t2(s3,v4,0,f4,p4,p4,null))&&!g4.h;break t}return c4?(u4!=null?u4[0]=v4:(e(v4==null),e(r2)),s3.$=0,r2||Pt2(m4)):Pt2(m4),c4}function It2(t4,n2){var r2=t4.c*t4.i,i3=r2+n2+16*n2;return e(t4.c<=n2),t4.V=a2(i3),t4.V==null?(t4.Ta=null,t4.Ua=0,t4.a=1,0):(t4.Ta=t4.V,t4.Ua=t4.Ba+r2+n2,1)}function jt2(t4,n2){var r2=t4.C,i3=n2-r2,a3=t4.V,o3=t4.Ba+t4.c*r2;for(e(n2<=t4.l.o);0<i3;){var s3=16<i3?16:i3,u4=t4.l.ma,c4=t4.l.width,l4=c4*s3,h4=u4.ca,f4=u4.tb+c4*r2,d4=t4.Ta,p4=t4.Ua;Nt2(t4,s3,a3,o3),Sr(d4,p4,h4,f4,l4),At2(u4,r2,r2+s3,h4,f4,c4),i3-=s3,a3+=s3*t4.c,r2+=s3}e(r2==n2),t4.C=t4.Ma=n2}function Ct2(){this.ub=this.yd=this.td=this.Rb=0}function Ot2(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Bt2(){this.Fb=this.Bb=this.Cb=0,this.Zb=a2(4),this.Lb=a2(4)}function Mt2(){this.Yb=(function(){var t4=[];return(function t5(e2,n2,r2){for(var i3=r2[n2],a3=0;a3<i3&&(e2.push(r2.length>n2+1?[]:0),!(r2.length<n2+1));a3++)t5(e2[a3],n2+1,r2)})(t4,0,[3,11]),t4})()}function qt2(){this.jb=a2(3),this.Wc=s2([4,8],Mt2),this.Xc=s2([4,17],Mt2)}function Et2(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a2(4),this.od=new a2(4)}function Rt2(){this.ld=this.La=this.dd=this.tc=0}function Dt2(){this.Na=this.la=0}function Tt2(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function zt2(){this.ad=a2(384),this.Za=0,this.Ob=a2(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ut2(){this.uc=this.M=this.Nb=0,this.wa=Array(new Rt2),this.Y=0,this.ya=Array(new zt2),this.aa=0,this.l=new Gt2}function Ht2(){this.y=a2(16),this.f=a2(8),this.ea=a2(8)}function Wt2(){this.cb=this.a=0,this.sc="",this.m=new w3,this.Od=new Ct2,this.Kc=new Ot2,this.ed=new Et2,this.Qa=new Bt2,this.Ic=this.$c=this.Aa=0,this.D=new Ut2,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o2(8,w3),this.ia=0,this.pb=o2(4,Tt2),this.Pa=new qt2,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ht2),this.Hd=0,this.rb=Array(new Dt2),this.sb=0,this.wa=Array(new Rt2),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new zt2),this.L=this.aa=0,this.gd=s2([4,2],Rt2),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Vt2(t4,e2){return 0>t4?0:t4>e2?e2:t4}function Gt2(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Yt2(){var t4=new Wt2;return t4!=null&&(t4.a=0,t4.sc="OK",t4.cb=0,t4.Xb=0,ni||(ni=Zt2)),t4}function Jt2(t4,e2,n2){return t4.a==0&&(t4.a=e2,t4.sc=n2,t4.cb=0),0}function Xt2(t4,e2,n2){return 3<=n2&&t4[e2+0]==157&&t4[e2+1]==1&&t4[e2+2]==42}function Kt2(t4,n2){if(t4==null)return 0;if(t4.a=0,t4.sc="OK",n2==null)return Jt2(t4,2,"null VP8Io passed to VP8GetHeaders()");var r2=n2.data,a3=n2.w,o3=n2.ha;if(4>o3)return Jt2(t4,7,"Truncated header.");var s3=r2[a3+0]|r2[a3+1]<<8|r2[a3+2]<<16,u4=t4.Od;if(u4.Rb=!(1&s3),u4.td=s3>>1&7,u4.yd=s3>>4&1,u4.ub=s3>>5,3<u4.td)return Jt2(t4,3,"Incorrect keyframe parameters.");if(!u4.yd)return Jt2(t4,4,"Frame not displayable.");a3+=3,o3-=3;var c4=t4.Kc;if(u4.Rb){if(7>o3)return Jt2(t4,7,"cannot parse picture header");if(!Xt2(r2,a3,o3))return Jt2(t4,3,"Bad code word");c4.c=16383&(r2[a3+4]<<8|r2[a3+3]),c4.Td=r2[a3+4]>>6,c4.i=16383&(r2[a3+6]<<8|r2[a3+5]),c4.Ud=r2[a3+6]>>6,a3+=7,o3-=7,t4.za=c4.c+15>>4,t4.Ub=c4.i+15>>4,n2.width=c4.c,n2.height=c4.i,n2.Da=0,n2.j=0,n2.v=0,n2.va=n2.width,n2.o=n2.height,n2.da=0,n2.ib=n2.width,n2.hb=n2.height,n2.U=n2.width,n2.T=n2.height,i2((s3=t4.Pa).jb,0,255,s3.jb.length),e((s3=t4.Qa)!=null),s3.Cb=0,s3.Bb=0,s3.Fb=1,i2(s3.Zb,0,0,s3.Zb.length),i2(s3.Lb,0,0,s3.Lb)}if(u4.ub>o3)return Jt2(t4,7,"bad partition length");p3(s3=t4.m,r2,a3,u4.ub),a3+=u4.ub,o3-=u4.ub,u4.Rb&&(c4.Ld=P2(s3),c4.Kd=P2(s3)),c4=t4.Qa;var l4,h4=t4.Pa;if(e(s3!=null),e(c4!=null),c4.Cb=P2(s3),c4.Cb){if(c4.Bb=P2(s3),P2(s3)){for(c4.Fb=P2(s3),l4=0;4>l4;++l4)c4.Zb[l4]=P2(s3)?m3(s3,7):0;for(l4=0;4>l4;++l4)c4.Lb[l4]=P2(s3)?m3(s3,6):0}if(c4.Bb)for(l4=0;3>l4;++l4)h4.jb[l4]=P2(s3)?g3(s3,8):255}else c4.Bb=0;if(s3.Ka)return Jt2(t4,3,"cannot parse segment header");if((c4=t4.ed).zd=P2(s3),c4.Tb=g3(s3,6),c4.wb=g3(s3,3),c4.Pc=P2(s3),c4.Pc&&P2(s3)){for(h4=0;4>h4;++h4)P2(s3)&&(c4.vd[h4]=m3(s3,6));for(h4=0;4>h4;++h4)P2(s3)&&(c4.od[h4]=m3(s3,6))}if(t4.L=c4.Tb==0?0:c4.zd?1:2,s3.Ka)return Jt2(t4,3,"cannot parse filter header");var f4=o3;if(o3=l4=a3,a3=l4+f4,c4=f4,t4.Xb=(1<<g3(t4.m,2))-1,f4<3*(h4=t4.Xb))r2=7;else{for(l4+=3*h4,c4-=3*h4,f4=0;f4<h4;++f4){var d4=r2[o3+0]|r2[o3+1]<<8|r2[o3+2]<<16;d4>c4&&(d4=c4),p3(t4.Jc[+f4],r2,l4,d4),l4+=d4,c4-=d4,o3+=3}p3(t4.Jc[+h4],r2,l4,c4),r2=l4<a3?0:5}if(r2!=0)return Jt2(t4,r2,"cannot parse partitions");for(r2=g3(l4=t4.m,7),o3=P2(l4)?m3(l4,4):0,a3=P2(l4)?m3(l4,4):0,c4=P2(l4)?m3(l4,4):0,h4=P2(l4)?m3(l4,4):0,l4=P2(l4)?m3(l4,4):0,f4=t4.Qa,d4=0;4>d4;++d4){if(f4.Cb){var v4=f4.Zb[d4];f4.Fb||(v4+=r2)}else{if(0<d4){t4.pb[d4]=t4.pb[0];continue}v4=r2}var b4=t4.pb[d4];b4.Sc[0]=ti[Vt2(v4+o3,127)],b4.Sc[1]=ei[Vt2(v4+0,127)],b4.Eb[0]=2*ti[Vt2(v4+a3,127)],b4.Eb[1]=101581*ei[Vt2(v4+c4,127)]>>16,8>b4.Eb[1]&&(b4.Eb[1]=8),b4.Qc[0]=ti[Vt2(v4+h4,117)],b4.Qc[1]=ei[Vt2(v4+l4,127)],b4.lc=v4+l4}if(!u4.Rb)return Jt2(t4,4,"Not a key frame.");for(P2(s3),u4=t4.Pa,r2=0;4>r2;++r2){for(o3=0;8>o3;++o3)for(a3=0;3>a3;++a3)for(c4=0;11>c4;++c4)h4=k2(s3,ui[r2][o3][a3][c4])?g3(s3,8):oi[r2][o3][a3][c4],u4.Wc[r2][o3].Yb[a3][c4]=h4;for(o3=0;17>o3;++o3)u4.Xc[r2][o3]=u4.Wc[r2][ci[o3]]}return t4.kc=P2(s3),t4.kc&&(t4.Bd=g3(s3,8)),t4.cb=1}function Zt2(t4,e2,n2,r2,i3,a3,o3){var s3=e2[i3].Yb[n2];for(n2=0;16>i3;++i3){if(!k2(t4,s3[n2+0]))return i3;for(;!k2(t4,s3[n2+1]);)if(s3=e2[++i3].Yb[0],n2=0,i3==16)return 16;var u4=e2[i3+1].Yb;if(k2(t4,s3[n2+2])){var c4=t4,l4=0;if(k2(c4,(f4=s3)[(h4=n2)+3]))if(k2(c4,f4[h4+6])){for(s3=0,h4=2*(l4=k2(c4,f4[h4+8]))+(f4=k2(c4,f4[h4+9+l4])),l4=0,f4=ri[h4];f4[s3];++s3)l4+=l4+k2(c4,f4[s3]);l4+=3+(8<<h4)}else k2(c4,f4[h4+7])?(l4=7+2*k2(c4,165),l4+=k2(c4,145)):l4=5+k2(c4,159);else l4=k2(c4,f4[h4+4])?3+k2(c4,f4[h4+5]):2;s3=u4[2]}else l4=1,s3=u4[1];u4=o3+ii[i3],0>(c4=t4).b&&_2(c4);var h4,f4=c4.b,d4=(h4=c4.Ca>>1)-(c4.I>>f4)>>31;--c4.b,c4.Ca+=d4,c4.Ca|=1,c4.I-=(h4+1&d4)<<f4,a3[u4]=((l4^d4)-d4)*r2[(0<i3)+0]}return 16}function $t2(t4){var e2=t4.rb[t4.sb-1];e2.la=0,e2.Na=0,i2(t4.zc,0,0,t4.zc.length),t4.ja=0}function Qt2(t4,e2,n2,r2,i3){i3=t4[e2+n2+32*r2]+(i3>>3),t4[e2+n2+32*r2]=-256&i3?0>i3?0:255:i3}function te2(t4,e2,n2,r2,i3,a3){Qt2(t4,e2,0,n2,r2+i3),Qt2(t4,e2,1,n2,r2+a3),Qt2(t4,e2,2,n2,r2-a3),Qt2(t4,e2,3,n2,r2-i3)}function ee2(t4){return(20091*t4>>16)+t4}function ne2(t4,e2,n2,r2){var i3,o3=0,s3=a2(16);for(i3=0;4>i3;++i3){var u4=t4[e2+0]+t4[e2+8],c4=t4[e2+0]-t4[e2+8],l4=(35468*t4[e2+4]>>16)-ee2(t4[e2+12]),h4=ee2(t4[e2+4])+(35468*t4[e2+12]>>16);s3[o3+0]=u4+h4,s3[o3+1]=c4+l4,s3[o3+2]=c4-l4,s3[o3+3]=u4-h4,o3+=4,e2++}for(i3=o3=0;4>i3;++i3)u4=(t4=s3[o3+0]+4)+s3[o3+8],c4=t4-s3[o3+8],l4=(35468*s3[o3+4]>>16)-ee2(s3[o3+12]),Qt2(n2,r2,0,0,u4+(h4=ee2(s3[o3+4])+(35468*s3[o3+12]>>16))),Qt2(n2,r2,1,0,c4+l4),Qt2(n2,r2,2,0,c4-l4),Qt2(n2,r2,3,0,u4-h4),o3++,r2+=32}function re2(t4,e2,n2,r2){var i3=t4[e2+0]+4,a3=35468*t4[e2+4]>>16,o3=ee2(t4[e2+4]),s3=35468*t4[e2+1]>>16;te2(n2,r2,0,i3+o3,t4=ee2(t4[e2+1]),s3),te2(n2,r2,1,i3+a3,t4,s3),te2(n2,r2,2,i3-a3,t4,s3),te2(n2,r2,3,i3-o3,t4,s3)}function ie2(t4,e2,n2,r2,i3){ne2(t4,e2,n2,r2),i3&&ne2(t4,e2+16,n2,r2+4)}function ae2(t4,e2,n2,r2){ar(t4,e2+0,n2,r2,1),ar(t4,e2+32,n2,r2+128,1)}function oe2(t4,e2,n2,r2){var i3;for(t4=t4[e2+0]+4,i3=0;4>i3;++i3)for(e2=0;4>e2;++e2)Qt2(n2,r2,e2,i3,t4)}function se2(t4,e2,n2,r2){t4[e2+0]&&ur(t4,e2+0,n2,r2),t4[e2+16]&&ur(t4,e2+16,n2,r2+4),t4[e2+32]&&ur(t4,e2+32,n2,r2+128),t4[e2+48]&&ur(t4,e2+48,n2,r2+128+4)}function ue2(t4,e2,n2,r2){var i3,o3=a2(16);for(i3=0;4>i3;++i3){var s3=t4[e2+0+i3]+t4[e2+12+i3],u4=t4[e2+4+i3]+t4[e2+8+i3],c4=t4[e2+4+i3]-t4[e2+8+i3],l4=t4[e2+0+i3]-t4[e2+12+i3];o3[0+i3]=s3+u4,o3[8+i3]=s3-u4,o3[4+i3]=l4+c4,o3[12+i3]=l4-c4}for(i3=0;4>i3;++i3)s3=(t4=o3[0+4*i3]+3)+o3[3+4*i3],u4=o3[1+4*i3]+o3[2+4*i3],c4=o3[1+4*i3]-o3[2+4*i3],l4=t4-o3[3+4*i3],n2[r2+0]=s3+u4>>3,n2[r2+16]=l4+c4>>3,n2[r2+32]=s3-u4>>3,n2[r2+48]=l4-c4>>3,r2+=64}function ce2(t4,e2,n2){var r2,i3=e2-32,a3=Or,o3=255-t4[i3-1];for(r2=0;r2<n2;++r2){var s3,u4=a3,c4=o3+t4[e2-1];for(s3=0;s3<n2;++s3)t4[e2+s3]=u4[c4+t4[i3+s3]];e2+=32}}function le2(t4,e2){ce2(t4,e2,4)}function he2(t4,e2){ce2(t4,e2,8)}function fe2(t4,e2){ce2(t4,e2,16)}function de2(t4,e2){var n2;for(n2=0;16>n2;++n2)r(t4,e2+32*n2,t4,e2-32,16)}function pe2(t4,e2){var n2;for(n2=16;0<n2;--n2)i2(t4,e2,t4[e2-1],16),e2+=32}function ge2(t4,e2,n2){var r2;for(r2=0;16>r2;++r2)i2(e2,n2+32*r2,t4,16)}function me2(t4,e2){var n2,r2=16;for(n2=0;16>n2;++n2)r2+=t4[e2-1+32*n2]+t4[e2+n2-32];ge2(r2>>5,t4,e2)}function ve2(t4,e2){var n2,r2=8;for(n2=0;16>n2;++n2)r2+=t4[e2-1+32*n2];ge2(r2>>4,t4,e2)}function be2(t4,e2){var n2,r2=8;for(n2=0;16>n2;++n2)r2+=t4[e2+n2-32];ge2(r2>>4,t4,e2)}function ye2(t4,e2){ge2(128,t4,e2)}function we2(t4,e2,n2){return t4+2*e2+n2+2>>2}function Ne2(t4,e2){var n2,i3=e2-32;for(i3=new Uint8Array([we2(t4[i3-1],t4[i3+0],t4[i3+1]),we2(t4[i3+0],t4[i3+1],t4[i3+2]),we2(t4[i3+1],t4[i3+2],t4[i3+3]),we2(t4[i3+2],t4[i3+3],t4[i3+4])]),n2=0;4>n2;++n2)r(t4,e2+32*n2,i3,0,i3.length)}function Le2(t4,e2){var n2=t4[e2-1],r2=t4[e2-1+32],i3=t4[e2-1+64],a3=t4[e2-1+96];F2(t4,e2+0,16843009*we2(t4[e2-1-32],n2,r2)),F2(t4,e2+32,16843009*we2(n2,r2,i3)),F2(t4,e2+64,16843009*we2(r2,i3,a3)),F2(t4,e2+96,16843009*we2(i3,a3,a3))}function xe2(t4,e2){var n2,r2=4;for(n2=0;4>n2;++n2)r2+=t4[e2+n2-32]+t4[e2-1+32*n2];for(r2>>=3,n2=0;4>n2;++n2)i2(t4,e2+32*n2,r2,4)}function Ae2(t4,e2){var n2=t4[e2-1+0],r2=t4[e2-1+32],i3=t4[e2-1+64],a3=t4[e2-1-32],o3=t4[e2+0-32],s3=t4[e2+1-32],u4=t4[e2+2-32],c4=t4[e2+3-32];t4[e2+0+96]=we2(r2,i3,t4[e2-1+96]),t4[e2+1+96]=t4[e2+0+64]=we2(n2,r2,i3),t4[e2+2+96]=t4[e2+1+64]=t4[e2+0+32]=we2(a3,n2,r2),t4[e2+3+96]=t4[e2+2+64]=t4[e2+1+32]=t4[e2+0+0]=we2(o3,a3,n2),t4[e2+3+64]=t4[e2+2+32]=t4[e2+1+0]=we2(s3,o3,a3),t4[e2+3+32]=t4[e2+2+0]=we2(u4,s3,o3),t4[e2+3+0]=we2(c4,u4,s3)}function Se2(t4,e2){var n2=t4[e2+1-32],r2=t4[e2+2-32],i3=t4[e2+3-32],a3=t4[e2+4-32],o3=t4[e2+5-32],s3=t4[e2+6-32],u4=t4[e2+7-32];t4[e2+0+0]=we2(t4[e2+0-32],n2,r2),t4[e2+1+0]=t4[e2+0+32]=we2(n2,r2,i3),t4[e2+2+0]=t4[e2+1+32]=t4[e2+0+64]=we2(r2,i3,a3),t4[e2+3+0]=t4[e2+2+32]=t4[e2+1+64]=t4[e2+0+96]=we2(i3,a3,o3),t4[e2+3+32]=t4[e2+2+64]=t4[e2+1+96]=we2(a3,o3,s3),t4[e2+3+64]=t4[e2+2+96]=we2(o3,s3,u4),t4[e2+3+96]=we2(s3,u4,u4)}function _e2(t4,e2){var n2=t4[e2-1+0],r2=t4[e2-1+32],i3=t4[e2-1+64],a3=t4[e2-1-32],o3=t4[e2+0-32],s3=t4[e2+1-32],u4=t4[e2+2-32],c4=t4[e2+3-32];t4[e2+0+0]=t4[e2+1+64]=a3+o3+1>>1,t4[e2+1+0]=t4[e2+2+64]=o3+s3+1>>1,t4[e2+2+0]=t4[e2+3+64]=s3+u4+1>>1,t4[e2+3+0]=u4+c4+1>>1,t4[e2+0+96]=we2(i3,r2,n2),t4[e2+0+64]=we2(r2,n2,a3),t4[e2+0+32]=t4[e2+1+96]=we2(n2,a3,o3),t4[e2+1+32]=t4[e2+2+96]=we2(a3,o3,s3),t4[e2+2+32]=t4[e2+3+96]=we2(o3,s3,u4),t4[e2+3+32]=we2(s3,u4,c4)}function Pe2(t4,e2){var n2=t4[e2+0-32],r2=t4[e2+1-32],i3=t4[e2+2-32],a3=t4[e2+3-32],o3=t4[e2+4-32],s3=t4[e2+5-32],u4=t4[e2+6-32],c4=t4[e2+7-32];t4[e2+0+0]=n2+r2+1>>1,t4[e2+1+0]=t4[e2+0+64]=r2+i3+1>>1,t4[e2+2+0]=t4[e2+1+64]=i3+a3+1>>1,t4[e2+3+0]=t4[e2+2+64]=a3+o3+1>>1,t4[e2+0+32]=we2(n2,r2,i3),t4[e2+1+32]=t4[e2+0+96]=we2(r2,i3,a3),t4[e2+2+32]=t4[e2+1+96]=we2(i3,a3,o3),t4[e2+3+32]=t4[e2+2+96]=we2(a3,o3,s3),t4[e2+3+64]=we2(o3,s3,u4),t4[e2+3+96]=we2(s3,u4,c4)}function ke2(t4,e2){var n2=t4[e2-1+0],r2=t4[e2-1+32],i3=t4[e2-1+64],a3=t4[e2-1+96];t4[e2+0+0]=n2+r2+1>>1,t4[e2+2+0]=t4[e2+0+32]=r2+i3+1>>1,t4[e2+2+32]=t4[e2+0+64]=i3+a3+1>>1,t4[e2+1+0]=we2(n2,r2,i3),t4[e2+3+0]=t4[e2+1+32]=we2(r2,i3,a3),t4[e2+3+32]=t4[e2+1+64]=we2(i3,a3,a3),t4[e2+3+64]=t4[e2+2+64]=t4[e2+0+96]=t4[e2+1+96]=t4[e2+2+96]=t4[e2+3+96]=a3}function Fe2(t4,e2){var n2=t4[e2-1+0],r2=t4[e2-1+32],i3=t4[e2-1+64],a3=t4[e2-1+96],o3=t4[e2-1-32],s3=t4[e2+0-32],u4=t4[e2+1-32],c4=t4[e2+2-32];t4[e2+0+0]=t4[e2+2+32]=n2+o3+1>>1,t4[e2+0+32]=t4[e2+2+64]=r2+n2+1>>1,t4[e2+0+64]=t4[e2+2+96]=i3+r2+1>>1,t4[e2+0+96]=a3+i3+1>>1,t4[e2+3+0]=we2(s3,u4,c4),t4[e2+2+0]=we2(o3,s3,u4),t4[e2+1+0]=t4[e2+3+32]=we2(n2,o3,s3),t4[e2+1+32]=t4[e2+3+64]=we2(r2,n2,o3),t4[e2+1+64]=t4[e2+3+96]=we2(i3,r2,n2),t4[e2+1+96]=we2(a3,i3,r2)}function Ie2(t4,e2){var n2;for(n2=0;8>n2;++n2)r(t4,e2+32*n2,t4,e2-32,8)}function je2(t4,e2){var n2;for(n2=0;8>n2;++n2)i2(t4,e2,t4[e2-1],8),e2+=32}function Ce(t4,e2,n2){var r2;for(r2=0;8>r2;++r2)i2(e2,n2+32*r2,t4,8)}function Oe(t4,e2){var n2,r2=8;for(n2=0;8>n2;++n2)r2+=t4[e2+n2-32]+t4[e2-1+32*n2];Ce(r2>>4,t4,e2)}function Be(t4,e2){var n2,r2=4;for(n2=0;8>n2;++n2)r2+=t4[e2+n2-32];Ce(r2>>3,t4,e2)}function Me(t4,e2){var n2,r2=4;for(n2=0;8>n2;++n2)r2+=t4[e2-1+32*n2];Ce(r2>>3,t4,e2)}function qe(t4,e2){Ce(128,t4,e2)}function Ee(t4,e2,n2){var r2=t4[e2-n2],i3=t4[e2+0],a3=3*(i3-r2)+jr[1020+t4[e2-2*n2]-t4[e2+n2]],o3=Cr[112+(a3+4>>3)];t4[e2-n2]=Or[255+r2+Cr[112+(a3+3>>3)]],t4[e2+0]=Or[255+i3-o3]}function Re(t4,e2,n2,r2){var i3=t4[e2+0],a3=t4[e2+n2];return Br[255+t4[e2-2*n2]-t4[e2-n2]]>r2||Br[255+a3-i3]>r2}function De(t4,e2,n2,r2){return 4*Br[255+t4[e2-n2]-t4[e2+0]]+Br[255+t4[e2-2*n2]-t4[e2+n2]]<=r2}function Te(t4,e2,n2,r2,i3){var a3=t4[e2-3*n2],o3=t4[e2-2*n2],s3=t4[e2-n2],u4=t4[e2+0],c4=t4[e2+n2],l4=t4[e2+2*n2],h4=t4[e2+3*n2];return 4*Br[255+s3-u4]+Br[255+o3-c4]>r2?0:Br[255+t4[e2-4*n2]-a3]<=i3&&Br[255+a3-o3]<=i3&&Br[255+o3-s3]<=i3&&Br[255+h4-l4]<=i3&&Br[255+l4-c4]<=i3&&Br[255+c4-u4]<=i3}function ze(t4,e2,n2,r2){var i3=2*r2+1;for(r2=0;16>r2;++r2)De(t4,e2+r2,n2,i3)&&Ee(t4,e2+r2,n2)}function Ue(t4,e2,n2,r2){var i3=2*r2+1;for(r2=0;16>r2;++r2)De(t4,e2+r2*n2,1,i3)&&Ee(t4,e2+r2*n2,1)}function He(t4,e2,n2,r2){var i3;for(i3=3;0<i3;--i3)ze(t4,e2+=4*n2,n2,r2)}function We(t4,e2,n2,r2){var i3;for(i3=3;0<i3;--i3)Ue(t4,e2+=4,n2,r2)}function Ve(t4,e2,n2,r2,i3,a3,o3,s3){for(a3=2*a3+1;0<i3--;){if(Te(t4,e2,n2,a3,o3))if(Re(t4,e2,n2,s3))Ee(t4,e2,n2);else{var u4=t4,c4=e2,l4=n2,h4=u4[c4-2*l4],f4=u4[c4-l4],d4=u4[c4+0],p4=u4[c4+l4],g4=u4[c4+2*l4],m4=27*(b4=jr[1020+3*(d4-f4)+jr[1020+h4-p4]])+63>>7,v4=18*b4+63>>7,b4=9*b4+63>>7;u4[c4-3*l4]=Or[255+u4[c4-3*l4]+b4],u4[c4-2*l4]=Or[255+h4+v4],u4[c4-l4]=Or[255+f4+m4],u4[c4+0]=Or[255+d4-m4],u4[c4+l4]=Or[255+p4-v4],u4[c4+2*l4]=Or[255+g4-b4]}e2+=r2}}function Ge(t4,e2,n2,r2,i3,a3,o3,s3){for(a3=2*a3+1;0<i3--;){if(Te(t4,e2,n2,a3,o3))if(Re(t4,e2,n2,s3))Ee(t4,e2,n2);else{var u4=t4,c4=e2,l4=n2,h4=u4[c4-l4],f4=u4[c4+0],d4=u4[c4+l4],p4=Cr[112+(4+(g4=3*(f4-h4))>>3)],g4=Cr[112+(g4+3>>3)],m4=p4+1>>1;u4[c4-2*l4]=Or[255+u4[c4-2*l4]+m4],u4[c4-l4]=Or[255+h4+g4],u4[c4+0]=Or[255+f4-p4],u4[c4+l4]=Or[255+d4-m4]}e2+=r2}}function Ye(t4,e2,n2,r2,i3,a3){Ve(t4,e2,n2,1,16,r2,i3,a3)}function Je(t4,e2,n2,r2,i3,a3){Ve(t4,e2,1,n2,16,r2,i3,a3)}function Xe(t4,e2,n2,r2,i3,a3){var o3;for(o3=3;0<o3;--o3)Ge(t4,e2+=4*n2,n2,1,16,r2,i3,a3)}function Ke(t4,e2,n2,r2,i3,a3){var o3;for(o3=3;0<o3;--o3)Ge(t4,e2+=4,1,n2,16,r2,i3,a3)}function Ze(t4,e2,n2,r2,i3,a3,o3,s3){Ve(t4,e2,i3,1,8,a3,o3,s3),Ve(n2,r2,i3,1,8,a3,o3,s3)}function $e(t4,e2,n2,r2,i3,a3,o3,s3){Ve(t4,e2,1,i3,8,a3,o3,s3),Ve(n2,r2,1,i3,8,a3,o3,s3)}function Qe(t4,e2,n2,r2,i3,a3,o3,s3){Ge(t4,e2+4*i3,i3,1,8,a3,o3,s3),Ge(n2,r2+4*i3,i3,1,8,a3,o3,s3)}function tn(t4,e2,n2,r2,i3,a3,o3,s3){Ge(t4,e2+4,1,i3,8,a3,o3,s3),Ge(n2,r2+4,1,i3,8,a3,o3,s3)}function en(){this.ba=new ot2,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ut2,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function nn(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function rn(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function an(){this.ua=0,this.Wa=new M2,this.vb=new M2,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new d3,this.yc=new h3}function on(){this.xb=this.a=0,this.l=new Gt2,this.ca=new ot2,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new N3,this.Pb=0,this.wd=new N3,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new an,this.ab=0,this.gc=o2(4,rn),this.Oc=0}function sn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Gt2,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function un(t4,e2,n2,r2,i3,a3,o3){for(t4=t4==null?0:t4[e2+0],e2=0;e2<o3;++e2)i3[a3+e2]=t4+n2[r2+e2]&255,t4=i3[a3+e2]}function cn(t4,e2,n2,r2,i3,a3,o3){var s3;if(t4==null)un(null,null,n2,r2,i3,a3,o3);else for(s3=0;s3<o3;++s3)i3[a3+s3]=t4[e2+s3]+n2[r2+s3]&255}function ln2(t4,e2,n2,r2,i3,a3,o3){if(t4==null)un(null,null,n2,r2,i3,a3,o3);else{var s3,u4=t4[e2+0],c4=u4,l4=u4;for(s3=0;s3<o3;++s3)c4=l4+(u4=t4[e2+s3])-c4,l4=n2[r2+s3]+(-256&c4?0>c4?0:255:c4)&255,c4=u4,i3[a3+s3]=l4}}function hn(t4,n2,i3,o3){var s3=n2.width,u4=n2.o;if(e(t4!=null&&n2!=null),0>i3||0>=o3||i3+o3>u4)return null;if(!t4.Cc){if(t4.ga==null){var c4;if(t4.ga=new sn,(c4=t4.ga==null)||(c4=n2.width*n2.o,e(t4.Gb.length==0),t4.Gb=a2(c4),t4.Uc=0,t4.Gb==null?c4=0:(t4.mb=t4.Gb,t4.nb=t4.Uc,t4.rc=null,c4=1),c4=!c4),!c4){c4=t4.ga;var l4=t4.Fa,h4=t4.P,f4=t4.qc,d4=t4.mb,p4=t4.nb,g4=h4+1,m4=f4-1,b4=c4.l;if(e(l4!=null&&d4!=null&&n2!=null),gi[0]=null,gi[1]=un,gi[2]=cn,gi[3]=ln2,c4.ca=d4,c4.tb=p4,c4.c=n2.width,c4.i=n2.height,e(0<c4.c&&0<c4.i),1>=f4)n2=0;else if(c4.$a=3&l4[h4+0],c4.Z=l4[h4+0]>>2&3,c4.Lc=l4[h4+0]>>4&3,h4=l4[h4+0]>>6&3,0>c4.$a||1<c4.$a||4<=c4.Z||1<c4.Lc||h4)n2=0;else if(b4.put=dt2,b4.ac=ft2,b4.bc=pt2,b4.ma=c4,b4.width=n2.width,b4.height=n2.height,b4.Da=n2.Da,b4.v=n2.v,b4.va=n2.va,b4.j=n2.j,b4.o=n2.o,c4.$a)t:{e(c4.$a==1),n2=kt2();e:for(;;){if(n2==null){n2=0;break t}if(e(c4!=null),c4.mc=n2,n2.c=c4.c,n2.i=c4.i,n2.l=c4.l,n2.l.ma=c4,n2.l.width=c4.c,n2.l.height=c4.i,n2.a=0,v3(n2.m,l4,g4,m4),!Ft2(c4.c,c4.i,1,n2,null)||(n2.ab==1&&n2.gc[0].hc==3&&xt2(n2.s)?(c4.ic=1,l4=n2.c*n2.i,n2.Ta=null,n2.Ua=0,n2.V=a2(l4),n2.Ba=0,n2.V==null?(n2.a=1,n2=0):n2=1):(c4.ic=0,n2=It2(n2,c4.c)),!n2))break e;n2=1;break t}c4.mc=null,n2=0}else n2=m4>=c4.c*c4.i;c4=!n2}if(c4)return null;t4.ga.Lc!=1?t4.Ga=0:o3=u4-i3}e(t4.ga!=null),e(i3+o3<=u4);t:{if(n2=(l4=t4.ga).c,u4=l4.l.o,l4.$a==0){if(g4=t4.rc,m4=t4.Vc,b4=t4.Fa,h4=t4.P+1+i3*n2,f4=t4.mb,d4=t4.nb+i3*n2,e(h4<=t4.P+t4.qc),l4.Z!=0)for(e(gi[l4.Z]!=null),c4=0;c4<o3;++c4)gi[l4.Z](g4,m4,b4,h4,f4,d4,n2),g4=f4,m4=d4,d4+=n2,h4+=n2;else for(c4=0;c4<o3;++c4)r(f4,d4,b4,h4,n2),g4=f4,m4=d4,d4+=n2,h4+=n2;t4.rc=g4,t4.Vc=m4}else{if(e(l4.mc!=null),n2=i3+o3,e((c4=l4.mc)!=null),e(n2<=c4.i),c4.C>=n2)n2=1;else if(l4.ic||mn(),l4.ic){l4=c4.V,g4=c4.Ba,m4=c4.c;var y4=c4.i,w4=(b4=1,h4=c4.$/m4,f4=c4.$%m4,d4=c4.m,p4=c4.s,c4.$),N4=m4*y4,L4=m4*n2,A4=p4.wc,_3=w4<L4?wt2(p4,f4,h4):null;e(w4<=N4),e(n2<=y4),e(xt2(p4));e:for(;;){for(;!d4.h&&w4<L4;){if(f4&A4||(_3=wt2(p4,f4,h4)),e(_3!=null),S2(d4),256>(y4=bt2(_3.G[0],_3.H[0],d4)))l4[g4+w4]=y4,++w4,++f4>=m4&&(f4=0,++h4<=n2&&!(h4%16)&&St(c4,h4));else{if(!(280>y4)){b4=0;break e}y4=mt2(y4-256,d4);var P3,k3=bt2(_3.G[4],_3.H[4],d4);if(S2(d4),!(w4>=(k3=vt2(m4,k3=mt2(k3,d4)))&&N4-w4>=y4)){b4=0;break e}for(P3=0;P3<y4;++P3)l4[g4+w4+P3]=l4[g4+w4+P3-k3];for(w4+=y4,f4+=y4;f4>=m4;)f4-=m4,++h4<=n2&&!(h4%16)&&St(c4,h4);w4<L4&&f4&A4&&(_3=wt2(p4,f4,h4))}e(d4.h==x3(d4))}St(c4,h4>n2?n2:h4);break e}!b4||d4.h&&w4<N4?(b4=0,c4.a=d4.h?5:3):c4.$=w4,n2=b4}else n2=_t2(c4,c4.V,c4.Ba,c4.c,c4.i,n2,jt2);if(!n2){o3=0;break t}}i3+o3>=u4&&(t4.Cc=1),o3=1}if(!o3)return null;if(t4.Cc&&((o3=t4.ga)!=null&&(o3.mc=null),t4.ga=null,0<t4.Ga))return alert("todo:WebPDequantizeLevels"),null}return t4.nb+i3*s3}function fn(t4,e2,n2,r2,i3,a3){for(;0<i3--;){var o3,s3=t4,u4=e2+(n2?1:0),c4=t4,l4=e2+(n2?0:3);for(o3=0;o3<r2;++o3){var h4=c4[l4+4*o3];h4!=255&&(h4*=32897,s3[u4+4*o3+0]=s3[u4+4*o3+0]*h4>>23,s3[u4+4*o3+1]=s3[u4+4*o3+1]*h4>>23,s3[u4+4*o3+2]=s3[u4+4*o3+2]*h4>>23)}e2+=a3}}function dn(t4,e2,n2,r2,i3){for(;0<r2--;){var a3;for(a3=0;a3<n2;++a3){var o3=t4[e2+2*a3+0],s3=15&(c4=t4[e2+2*a3+1]),u4=4369*s3,c4=(240&c4|c4>>4)*u4>>16;t4[e2+2*a3+0]=(240&o3|o3>>4)*u4>>16&240|(15&o3|o3<<4)*u4>>16>>4&15,t4[e2+2*a3+1]=240&c4|s3}e2+=i3}}function pn(t4,e2,n2,r2,i3,a3,o3,s3){var u4,c4,l4=255;for(c4=0;c4<i3;++c4){for(u4=0;u4<r2;++u4){var h4=t4[e2+u4];a3[o3+4*u4]=h4,l4&=h4}e2+=n2,o3+=s3}return l4!=255}function gn(t4,e2,n2,r2,i3){var a3;for(a3=0;a3<i3;++a3)n2[r2+a3]=t4[e2+a3]>>8}function mn(){Lr=fn,xr=dn,Ar=pn,Sr=gn}function vn(n2,r2,i3){t3[n2]=function(t4,n3,a3,o3,s3,u4,c4,l4,h4,f4,d4,p4,g4,m4,v4,b4,y4){var w4,N4=y4-1>>1,L4=s3[u4+0]|c4[l4+0]<<16,x4=h4[f4+0]|d4[p4+0]<<16;e(t4!=null);var A4=3*L4+x4+131074>>2;for(r2(t4[n3+0],255&A4,A4>>16,g4,m4),a3!=null&&(A4=3*x4+L4+131074>>2,r2(a3[o3+0],255&A4,A4>>16,v4,b4)),w4=1;w4<=N4;++w4){var S3=s3[u4+w4]|c4[l4+w4]<<16,_3=h4[f4+w4]|d4[p4+w4]<<16,P3=L4+S3+x4+_3+524296,k3=P3+2*(S3+x4)>>3;A4=k3+L4>>1,L4=(P3=P3+2*(L4+_3)>>3)+S3>>1,r2(t4[n3+2*w4-1],255&A4,A4>>16,g4,m4+(2*w4-1)*i3),r2(t4[n3+2*w4-0],255&L4,L4>>16,g4,m4+(2*w4-0)*i3),a3!=null&&(A4=P3+x4>>1,L4=k3+_3>>1,r2(a3[o3+2*w4-1],255&A4,A4>>16,v4,b4+(2*w4-1)*i3),r2(a3[o3+2*w4+0],255&L4,L4>>16,v4,b4+(2*w4+0)*i3)),L4=S3,x4=_3}1&y4||(A4=3*L4+x4+131074>>2,r2(t4[n3+y4-1],255&A4,A4>>16,g4,m4+(y4-1)*i3),a3!=null&&(A4=3*x4+L4+131074>>2,r2(a3[o3+y4-1],255&A4,A4>>16,v4,b4+(y4-1)*i3)))}}function bn(){mi[Mr]=vi,mi[qr]=yi,mi[Er]=bi,mi[Rr]=wi,mi[Dr]=Ni,mi[Tr]=Li,mi[zr]=xi,mi[Ur]=yi,mi[Hr]=wi,mi[Wr]=Ni,mi[Vr]=Li}function yn(t4){return t4&-16384?0>t4?0:255:t4>>ki}function wn(t4,e2){return yn((19077*t4>>8)+(26149*e2>>8)-14234)}function Nn(t4,e2,n2){return yn((19077*t4>>8)-(6419*e2>>8)-(13320*n2>>8)+8708)}function Ln(t4,e2){return yn((19077*t4>>8)+(33050*e2>>8)-17685)}function xn(t4,e2,n2,r2,i3){r2[i3+0]=wn(t4,n2),r2[i3+1]=Nn(t4,e2,n2),r2[i3+2]=Ln(t4,e2)}function An(t4,e2,n2,r2,i3){r2[i3+0]=Ln(t4,e2),r2[i3+1]=Nn(t4,e2,n2),r2[i3+2]=wn(t4,n2)}function Sn(t4,e2,n2,r2,i3){var a3=Nn(t4,e2,n2);e2=a3<<3&224|Ln(t4,e2)>>3,r2[i3+0]=248&wn(t4,n2)|a3>>5,r2[i3+1]=e2}function _n(t4,e2,n2,r2,i3){var a3=240&Ln(t4,e2)|15;r2[i3+0]=240&wn(t4,n2)|Nn(t4,e2,n2)>>4,r2[i3+1]=a3}function Pn(t4,e2,n2,r2,i3){r2[i3+0]=255,xn(t4,e2,n2,r2,i3+1)}function kn(t4,e2,n2,r2,i3){An(t4,e2,n2,r2,i3),r2[i3+3]=255}function Fn(t4,e2,n2,r2,i3){xn(t4,e2,n2,r2,i3),r2[i3+3]=255}function In(e2,n2,r2){t3[e2]=function(t4,e3,i3,a3,o3,s3,u4,c4,l4){for(var h4=c4+(-2&l4)*r2;c4!=h4;)n2(t4[e3+0],i3[a3+0],o3[s3+0],u4,c4),n2(t4[e3+1],i3[a3+0],o3[s3+0],u4,c4+r2),e3+=2,++a3,++s3,c4+=2*r2;1&l4&&n2(t4[e3+0],i3[a3+0],o3[s3+0],u4,c4)}}function jn(t4,e2,n2){return n2==0?t4==0?e2==0?6:5:e2==0?4:0:n2}function Cn(t4,e2,n2,r2,i3){switch(t4>>>30){case 3:ar(e2,n2,r2,i3,0);break;case 2:or(e2,n2,r2,i3);break;case 1:ur(e2,n2,r2,i3)}}function On(t4,e2){var n2,a3,o3=e2.M,s3=e2.Nb,u4=t4.oc,c4=t4.pc+40,l4=t4.oc,h4=t4.pc+584,f4=t4.oc,d4=t4.pc+600;for(n2=0;16>n2;++n2)u4[c4+32*n2-1]=129;for(n2=0;8>n2;++n2)l4[h4+32*n2-1]=129,f4[d4+32*n2-1]=129;for(0<o3?u4[c4-1-32]=l4[h4-1-32]=f4[d4-1-32]=129:(i2(u4,c4-32-1,127,21),i2(l4,h4-32-1,127,9),i2(f4,d4-32-1,127,9)),a3=0;a3<t4.za;++a3){var p4=e2.ya[e2.aa+a3];if(0<a3){for(n2=-1;16>n2;++n2)r(u4,c4+32*n2-4,u4,c4+32*n2+12,4);for(n2=-1;8>n2;++n2)r(l4,h4+32*n2-4,l4,h4+32*n2+4,4),r(f4,d4+32*n2-4,f4,d4+32*n2+4,4)}var g4=t4.Gd,m4=t4.Hd+a3,v4=p4.ad,b4=p4.Hc;if(0<o3&&(r(u4,c4-32,g4[m4].y,0,16),r(l4,h4-32,g4[m4].f,0,8),r(f4,d4-32,g4[m4].ea,0,8)),p4.Za){var y4=u4,w4=c4-32+16;for(0<o3&&(a3>=t4.za-1?i2(y4,w4,g4[m4].y[15],4):r(y4,w4,g4[m4+1].y,0,4)),n2=0;4>n2;n2++)y4[w4+128+n2]=y4[w4+256+n2]=y4[w4+384+n2]=y4[w4+0+n2];for(n2=0;16>n2;++n2,b4<<=2)y4=u4,w4=c4+Ei[n2],hi[p4.Ob[n2]](y4,w4),Cn(b4,v4,16*+n2,y4,w4)}else if(y4=jn(a3,o3,p4.Ob[0]),li[y4](u4,c4),b4!=0)for(n2=0;16>n2;++n2,b4<<=2)Cn(b4,v4,16*+n2,u4,c4+Ei[n2]);for(n2=p4.Gc,y4=jn(a3,o3,p4.Dd),fi[y4](l4,h4),fi[y4](f4,d4),b4=v4,y4=l4,w4=h4,255&(p4=0|n2)&&(170&p4?sr(b4,256,y4,w4):cr(b4,256,y4,w4)),p4=f4,b4=d4,255&(n2>>=8)&&(170&n2?sr(v4,320,p4,b4):cr(v4,320,p4,b4)),o3<t4.Ub-1&&(r(g4[m4].y,0,u4,c4+480,16),r(g4[m4].f,0,l4,h4+224,8),r(g4[m4].ea,0,f4,d4+224,8)),n2=8*s3*t4.B,g4=t4.sa,m4=t4.ta+16*a3+16*s3*t4.R,v4=t4.qa,p4=t4.ra+8*a3+n2,b4=t4.Ha,y4=t4.Ia+8*a3+n2,n2=0;16>n2;++n2)r(g4,m4+n2*t4.R,u4,c4+32*n2,16);for(n2=0;8>n2;++n2)r(v4,p4+n2*t4.B,l4,h4+32*n2,8),r(b4,y4+n2*t4.B,f4,d4+32*n2,8)}}function Bn(t4,r2,i3,a3,o3,s3,u4,c4,l4){var h4=[0],f4=[0],d4=0,p4=l4!=null?l4.kd:0,g4=l4??new nn;if(t4==null||12>i3)return 7;g4.data=t4,g4.w=r2,g4.ha=i3,r2=[r2],i3=[i3],g4.gb=[g4.gb];t:{var m4=r2,b4=i3,y4=g4.gb;if(e(t4!=null),e(b4!=null),e(y4!=null),y4[0]=0,12<=b4[0]&&!n(t4,m4[0],"RIFF")){if(n(t4,m4[0]+8,"WEBP")){y4=3;break t}var w4=C2(t4,m4[0]+4);if(12>w4||4294967286<w4){y4=3;break t}if(p4&&w4>b4[0]-8){y4=7;break t}y4[0]=w4,m4[0]+=12,b4[0]-=12}y4=0}if(y4!=0)return y4;for(w4=0<g4.gb[0],i3=i3[0];;){t:{var L4=t4;b4=r2,y4=i3;var x4=h4,A4=f4,S3=m4=[0];if((k3=d4=[d4])[0]=0,8>y4[0])y4=7;else{if(!n(L4,b4[0],"VP8X")){if(C2(L4,b4[0]+4)!=10){y4=3;break t}if(18>y4[0]){y4=7;break t}var _3=C2(L4,b4[0]+8),P3=1+j2(L4,b4[0]+12);if(2147483648<=P3*(L4=1+j2(L4,b4[0]+15))){y4=3;break t}S3!=null&&(S3[0]=_3),x4!=null&&(x4[0]=P3),A4!=null&&(A4[0]=L4),b4[0]+=18,y4[0]-=18,k3[0]=1}y4=0}}if(d4=d4[0],m4=m4[0],y4!=0)return y4;if(b4=!!(2&m4),!w4&&d4)return 3;if(s3!=null&&(s3[0]=!!(16&m4)),u4!=null&&(u4[0]=b4),c4!=null&&(c4[0]=0),u4=h4[0],m4=f4[0],d4&&b4&&l4==null){y4=0;break}if(4>i3){y4=7;break}if(w4&&d4||!w4&&!d4&&!n(t4,r2[0],"ALPH")){i3=[i3],g4.na=[g4.na],g4.P=[g4.P],g4.Sa=[g4.Sa];t:{_3=t4,y4=r2,w4=i3;var k3=g4.gb;x4=g4.na,A4=g4.P,S3=g4.Sa,P3=22,e(_3!=null),e(w4!=null),L4=y4[0];var F3=w4[0];for(e(x4!=null),e(S3!=null),x4[0]=null,A4[0]=null,S3[0]=0;;){if(y4[0]=L4,w4[0]=F3,8>F3){y4=7;break t}var I3=C2(_3,L4+4);if(4294967286<I3){y4=3;break t}var O3=8+I3+1&-2;if(P3+=O3,0<k3&&P3>k3){y4=3;break t}if(!n(_3,L4,"VP8 ")||!n(_3,L4,"VP8L")){y4=0;break t}if(F3[0]<O3){y4=7;break t}n(_3,L4,"ALPH")||(x4[0]=_3,A4[0]=L4+8,S3[0]=I3),L4+=O3,F3-=O3}}if(i3=i3[0],g4.na=g4.na[0],g4.P=g4.P[0],g4.Sa=g4.Sa[0],y4!=0)break}i3=[i3],g4.Ja=[g4.Ja],g4.xa=[g4.xa];t:if(k3=t4,y4=r2,w4=i3,x4=g4.gb[0],A4=g4.Ja,S3=g4.xa,_3=y4[0],L4=!n(k3,_3,"VP8 "),P3=!n(k3,_3,"VP8L"),e(k3!=null),e(w4!=null),e(A4!=null),e(S3!=null),8>w4[0])y4=7;else{if(L4||P3){if(k3=C2(k3,_3+4),12<=x4&&k3>x4-12){y4=3;break t}if(p4&&k3>w4[0]-8){y4=7;break t}A4[0]=k3,y4[0]+=8,w4[0]-=8,S3[0]=P3}else S3[0]=5<=w4[0]&&k3[_3+0]==47&&!(k3[_3+4]>>5),A4[0]=w4[0];y4=0}if(i3=i3[0],g4.Ja=g4.Ja[0],g4.xa=g4.xa[0],r2=r2[0],y4!=0)break;if(4294967286<g4.Ja)return 3;if(c4==null||b4||(c4[0]=g4.xa?2:1),u4=[u4],m4=[m4],g4.xa){if(5>i3){y4=7;break}c4=u4,p4=m4,b4=s3,t4==null||5>i3?t4=0:5<=i3&&t4[r2+0]==47&&!(t4[r2+4]>>5)?(w4=[0],k3=[0],x4=[0],v3(A4=new N3,t4,r2,i3),gt2(A4,w4,k3,x4)?(c4!=null&&(c4[0]=w4[0]),p4!=null&&(p4[0]=k3[0]),b4!=null&&(b4[0]=x4[0]),t4=1):t4=0):t4=0}else{if(10>i3){y4=7;break}c4=m4,t4==null||10>i3||!Xt2(t4,r2+3,i3-3)?t4=0:(p4=t4[r2+0]|t4[r2+1]<<8|t4[r2+2]<<16,b4=16383&(t4[r2+7]<<8|t4[r2+6]),t4=16383&(t4[r2+9]<<8|t4[r2+8]),1&p4||3<(p4>>1&7)||!(p4>>4&1)||p4>>5>=g4.Ja||!b4||!t4?t4=0:(u4&&(u4[0]=b4),c4&&(c4[0]=t4),t4=1))}if(!t4||(u4=u4[0],m4=m4[0],d4&&(h4[0]!=u4||f4[0]!=m4)))return 3;l4!=null&&(l4[0]=g4,l4.offset=r2-l4.w,e(4294967286>r2-l4.w),e(l4.offset==l4.ha-i3));break}return y4==0||y4==7&&d4&&l4==null?(s3!=null&&(s3[0]|=g4.na!=null&&0<g4.na.length),a3!=null&&(a3[0]=u4),o3!=null&&(o3[0]=m4),0):y4}function Mn(t4,e2,n2){var r2=e2.width,i3=e2.height,a3=0,o3=0,s3=r2,u4=i3;if(e2.Da=t4!=null&&0<t4.Da,e2.Da&&(s3=t4.cd,u4=t4.bd,a3=t4.v,o3=t4.j,11>n2||(a3&=-2,o3&=-2),0>a3||0>o3||0>=s3||0>=u4||a3+s3>r2||o3+u4>i3))return 0;if(e2.v=a3,e2.j=o3,e2.va=a3+s3,e2.o=o3+u4,e2.U=s3,e2.T=u4,e2.da=t4!=null&&0<t4.da,e2.da){if(!q2(s3,u4,n2=[t4.ib],a3=[t4.hb]))return 0;e2.ib=n2[0],e2.hb=a3[0]}return e2.ob=t4!=null&&t4.ob,e2.Kb=t4==null||!t4.Sd,e2.da&&(e2.ob=e2.ib<3*r2/4&&e2.hb<3*i3/4,e2.Kb=0),1}function qn(t4){if(t4==null)return 2;if(11>t4.S){var e2=t4.f.RGBA;e2.fb+=(t4.height-1)*e2.A,e2.A=-e2.A}else e2=t4.f.kb,t4=t4.height,e2.O+=(t4-1)*e2.fa,e2.fa=-e2.fa,e2.N+=(t4-1>>1)*e2.Ab,e2.Ab=-e2.Ab,e2.W+=(t4-1>>1)*e2.Db,e2.Db=-e2.Db,e2.F!=null&&(e2.J+=(t4-1)*e2.lb,e2.lb=-e2.lb);return 0}function En(t4,e2,n2,r2){if(r2==null||0>=t4||0>=e2)return 2;if(n2!=null){if(n2.Da){var i3=n2.cd,o3=n2.bd,s3=-2&n2.v,u4=-2&n2.j;if(0>s3||0>u4||0>=i3||0>=o3||s3+i3>t4||u4+o3>e2)return 2;t4=i3,e2=o3}if(n2.da){if(!q2(t4,e2,i3=[n2.ib],o3=[n2.hb]))return 2;t4=i3[0],e2=o3[0]}}r2.width=t4,r2.height=e2;t:{var c4=r2.width,l4=r2.height;if(t4=r2.S,0>=c4||0>=l4||!(t4>=Mr&&13>t4))t4=2;else{if(0>=r2.Rd&&r2.sd==null){s3=o3=i3=e2=0;var h4=(u4=c4*zi[t4])*l4;if(11>t4||(o3=(l4+1)/2*(e2=(c4+1)/2),t4==12&&(s3=(i3=c4)*l4)),(l4=a2(h4+2*o3+s3))==null){t4=1;break t}r2.sd=l4,11>t4?((c4=r2.f.RGBA).eb=l4,c4.fb=0,c4.A=u4,c4.size=h4):((c4=r2.f.kb).y=l4,c4.O=0,c4.fa=u4,c4.Fd=h4,c4.f=l4,c4.N=0+h4,c4.Ab=e2,c4.Cd=o3,c4.ea=l4,c4.W=0+h4+o3,c4.Db=e2,c4.Ed=o3,t4==12&&(c4.F=l4,c4.J=0+h4+2*o3),c4.Tc=s3,c4.lb=i3)}if(e2=1,i3=r2.S,o3=r2.width,s3=r2.height,i3>=Mr&&13>i3)if(11>i3)t4=r2.f.RGBA,e2&=(u4=Math.abs(t4.A))*(s3-1)+o3<=t4.size,e2&=u4>=o3*zi[i3],e2&=t4.eb!=null;else{t4=r2.f.kb,u4=(o3+1)/2,h4=(s3+1)/2,c4=Math.abs(t4.fa),l4=Math.abs(t4.Ab);var f4=Math.abs(t4.Db),d4=Math.abs(t4.lb),p4=d4*(s3-1)+o3;e2&=c4*(s3-1)+o3<=t4.Fd,e2&=l4*(h4-1)+u4<=t4.Cd,e2=(e2&=f4*(h4-1)+u4<=t4.Ed)&c4>=o3&l4>=u4&f4>=u4,e2&=t4.y!=null,e2&=t4.f!=null,e2&=t4.ea!=null,i3==12&&(e2&=d4>=o3,e2&=p4<=t4.Tc,e2&=t4.F!=null)}else e2=0;t4=e2?0:2}}return t4!=0||n2!=null&&n2.fd&&(t4=qn(r2)),t4}var Rn=64,Dn=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Tn=24,zn=32,Un=8,Hn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];D2("Predictor0","PredictorAdd0"),t3.Predictor0=function(){return 4278190080},t3.Predictor1=function(t4){return t4},t3.Predictor2=function(t4,e2,n2){return e2[n2+0]},t3.Predictor3=function(t4,e2,n2){return e2[n2+1]},t3.Predictor4=function(t4,e2,n2){return e2[n2-1]},t3.Predictor5=function(t4,e2,n2){return z2(z2(t4,e2[n2+1]),e2[n2+0])},t3.Predictor6=function(t4,e2,n2){return z2(t4,e2[n2-1])},t3.Predictor7=function(t4,e2,n2){return z2(t4,e2[n2+0])},t3.Predictor8=function(t4,e2,n2){return z2(e2[n2-1],e2[n2+0])},t3.Predictor9=function(t4,e2,n2){return z2(e2[n2+0],e2[n2+1])},t3.Predictor10=function(t4,e2,n2){return z2(z2(t4,e2[n2-1]),z2(e2[n2+0],e2[n2+1]))},t3.Predictor11=function(t4,e2,n2){var r2=e2[n2+0];return 0>=W2(r2>>24&255,t4>>24&255,(e2=e2[n2-1])>>24&255)+W2(r2>>16&255,t4>>16&255,e2>>16&255)+W2(r2>>8&255,t4>>8&255,e2>>8&255)+W2(255&r2,255&t4,255&e2)?r2:t4},t3.Predictor12=function(t4,e2,n2){var r2=e2[n2+0];return(U2((t4>>24&255)+(r2>>24&255)-((e2=e2[n2-1])>>24&255))<<24|U2((t4>>16&255)+(r2>>16&255)-(e2>>16&255))<<16|U2((t4>>8&255)+(r2>>8&255)-(e2>>8&255))<<8|U2((255&t4)+(255&r2)-(255&e2)))>>>0},t3.Predictor13=function(t4,e2,n2){var r2=e2[n2-1];return(H2((t4=z2(t4,e2[n2+0]))>>24&255,r2>>24&255)<<24|H2(t4>>16&255,r2>>16&255)<<16|H2(t4>>8&255,r2>>8&255)<<8|H2(255&t4,255&r2))>>>0};var Wn=t3.PredictorAdd0;t3.PredictorAdd1=V2,D2("Predictor2","PredictorAdd2"),D2("Predictor3","PredictorAdd3"),D2("Predictor4","PredictorAdd4"),D2("Predictor5","PredictorAdd5"),D2("Predictor6","PredictorAdd6"),D2("Predictor7","PredictorAdd7"),D2("Predictor8","PredictorAdd8"),D2("Predictor9","PredictorAdd9"),D2("Predictor10","PredictorAdd10"),D2("Predictor11","PredictorAdd11"),D2("Predictor12","PredictorAdd12"),D2("Predictor13","PredictorAdd13");var Vn=t3.PredictorAdd2;X2("ColorIndexInverseTransform","MapARGB","32b",function(t4){return t4>>8&255},function(t4){return t4}),X2("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(t4){return t4},function(t4){return t4>>8&255});var Gn,Yn=t3.ColorIndexInverseTransform,Jn=t3.MapARGB,Xn=t3.VP8LColorIndexInverseTransformAlpha,Kn=t3.MapAlpha,Zn=t3.VP8LPredictorsAdd=[];Zn.length=16,(t3.VP8LPredictors=[]).length=16,(t3.VP8LPredictorsAdd_C=[]).length=16,(t3.VP8LPredictors_C=[]).length=16;var $n,Qn,tr,er,nr,rr,ir,ar,or,sr,ur,cr,lr,hr,fr,dr,pr,gr,mr,vr,br,yr,wr,Nr,Lr,xr,Ar,Sr,_r=a2(511),Pr=a2(2041),kr=a2(225),Fr=a2(767),Ir=0,jr=Pr,Cr=kr,Or=Fr,Br=_r,Mr=0,qr=1,Er=2,Rr=3,Dr=4,Tr=5,zr=6,Ur=7,Hr=8,Wr=9,Vr=10,Gr=[2,3,7],Yr=[3,3,11],Jr=[280,256,256,256,40],Xr=[0,1,1,1,0],Kr=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Zr=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],$r=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Qr=8,ti=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ei=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ni=null,ri=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],ii=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ai=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],oi=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],si=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ui=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ci=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],li=[],hi=[],fi=[],di=1,pi=2,gi=[],mi=[];vn("UpsampleRgbLinePair",xn,3),vn("UpsampleBgrLinePair",An,3),vn("UpsampleRgbaLinePair",Fn,4),vn("UpsampleBgraLinePair",kn,4),vn("UpsampleArgbLinePair",Pn,4),vn("UpsampleRgba4444LinePair",_n,2),vn("UpsampleRgb565LinePair",Sn,2);var vi=t3.UpsampleRgbLinePair,bi=t3.UpsampleBgrLinePair,yi=t3.UpsampleRgbaLinePair,wi=t3.UpsampleBgraLinePair,Ni=t3.UpsampleArgbLinePair,Li=t3.UpsampleRgba4444LinePair,xi=t3.UpsampleRgb565LinePair,Ai=16,Si=1<<Ai-1,_i=-227,Pi=482,ki=6,Ii=0,ji=a2(256),Ci=a2(256),Oi=a2(256),Bi=a2(256),Mi=a2(Pi-_i),qi=a2(Pi-_i);In("YuvToRgbRow",xn,3),In("YuvToBgrRow",An,3),In("YuvToRgbaRow",Fn,4),In("YuvToBgraRow",kn,4),In("YuvToArgbRow",Pn,4),In("YuvToRgba4444Row",_n,2),In("YuvToRgb565Row",Sn,2);var Ei=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ri=[0,2,8],Di=[8,7,6,4,4,2,2,2,1,1,1,1],Ti=1;this.WebPDecodeRGBA=function(t4,n2,s3,u4,c4){var l4=qr,h4=new en,f4=new ot2;h4.ba=f4,f4.S=l4,f4.width=[f4.width],f4.height=[f4.height];var d4=f4.width,p4=f4.height,g4=new st2;if(g4==null||t4==null)var m4=2;else e(g4!=null),m4=Bn(t4,n2,s3,g4.width,g4.height,g4.Pd,g4.Qd,g4.format,null);if(m4!=0?d4=0:(d4!=null&&(d4[0]=g4.width[0]),p4!=null&&(p4[0]=g4.height[0]),d4=1),d4){f4.width=f4.width[0],f4.height=f4.height[0],u4!=null&&(u4[0]=f4.width),c4!=null&&(c4[0]=f4.height);t:{if(u4=new Gt2,(c4=new nn).data=t4,c4.w=n2,c4.ha=s3,c4.kd=1,n2=[0],e(c4!=null),((t4=Bn(c4.data,c4.w,c4.ha,null,null,null,n2,null,c4))==0||t4==7)&&n2[0]&&(t4=4),(n2=t4)==0){if(e(h4!=null),u4.data=c4.data,u4.w=c4.w+c4.offset,u4.ha=c4.ha-c4.offset,u4.put=dt2,u4.ac=ft2,u4.bc=pt2,u4.ma=h4,c4.xa){if((t4=kt2())==null){h4=1;break t}if((function(t5,n3){var r2=[0],i3=[0],a3=[0];e:for(;;){if(t5==null)return 0;if(n3==null)return t5.a=2,0;if(t5.l=n3,t5.a=0,v3(t5.m,n3.data,n3.w,n3.ha),!gt2(t5.m,r2,i3,a3)){t5.a=3;break e}if(t5.xb=pi,n3.width=r2[0],n3.height=i3[0],!Ft2(r2[0],i3[0],1,t5,null))break e;return 1}return e(t5.a!=0),0})(t4,u4)){if(u4=(n2=En(u4.width,u4.height,h4.Oa,h4.ba))==0){e:{u4=t4;n:for(;;){if(u4==null){u4=0;break e}if(e(u4.s.yc!=null),e(u4.s.Ya!=null),e(0<u4.s.Wb),e((s3=u4.l)!=null),e((c4=s3.ma)!=null),u4.xb!=0){if(u4.ca=c4.ba,u4.tb=c4.tb,e(u4.ca!=null),!Mn(c4.Oa,s3,Rr)){u4.a=2;break n}if(!It2(u4,s3.width)||s3.da)break n;if((s3.da||rt2(u4.ca.S))&&mn(),11>u4.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),u4.ca.f.kb.F!=null&&mn()),u4.Pb&&0<u4.s.ua&&u4.s.vb.X==null&&!O2(u4.s.vb,u4.s.Wa.Xa)){u4.a=1;break n}u4.xb=0}if(!_t2(u4,u4.V,u4.Ba,u4.c,u4.i,s3.o,Lt2))break n;c4.Dc=u4.Ma,u4=1;break e}e(u4.a!=0),u4=0}u4=!u4}u4&&(n2=t4.a)}else n2=t4.a}else{if((t4=new Yt2)==null){h4=1;break t}if(t4.Fa=c4.na,t4.P=c4.P,t4.qc=c4.Sa,Kt2(t4,u4)){if((n2=En(u4.width,u4.height,h4.Oa,h4.ba))==0){if(t4.Aa=0,s3=h4.Oa,e((c4=t4)!=null),s3!=null){if(0<(d4=0>(d4=s3.Md)?0:100<d4?255:255*d4/100)){for(p4=g4=0;4>p4;++p4)12>(m4=c4.pb[p4]).lc&&(m4.ia=d4*Di[0>m4.lc?0:m4.lc]>>3),g4|=m4.ia;g4&&(alert("todo:VP8InitRandom"),c4.ia=1)}c4.Ga=s3.Id,100<c4.Ga?c4.Ga=100:0>c4.Ga&&(c4.Ga=0)}(function(t5,n3){if(t5==null)return 0;if(n3==null)return Jt2(t5,2,"NULL VP8Io parameter in VP8Decode().");if(!t5.cb&&!Kt2(t5,n3))return 0;if(e(t5.cb),n3.ac==null||n3.ac(n3)){n3.ob&&(t5.L=0);var s4=Ri[t5.L];if(t5.L==2?(t5.yb=0,t5.zb=0):(t5.yb=n3.v-s4>>4,t5.zb=n3.j-s4>>4,0>t5.yb&&(t5.yb=0),0>t5.zb&&(t5.zb=0)),t5.Va=n3.o+15+s4>>4,t5.Hb=n3.va+15+s4>>4,t5.Hb>t5.za&&(t5.Hb=t5.za),t5.Va>t5.Ub&&(t5.Va=t5.Ub),0<t5.L){var u5=t5.ed;for(s4=0;4>s4;++s4){var c5;if(t5.Qa.Cb){var l5=t5.Qa.Lb[s4];t5.Qa.Fb||(l5+=u5.Tb)}else l5=u5.Tb;for(c5=0;1>=c5;++c5){var h5=t5.gd[s4][c5],f5=l5;if(u5.Pc&&(f5+=u5.vd[0],c5&&(f5+=u5.od[0])),0<(f5=0>f5?0:63<f5?63:f5)){var d5=f5;0<u5.wb&&(d5=4<u5.wb?d5>>2:d5>>1)>9-u5.wb&&(d5=9-u5.wb),1>d5&&(d5=1),h5.dd=d5,h5.tc=2*f5+d5,h5.ld=40<=f5?2:15<=f5?1:0}else h5.tc=0;h5.La=c5}}}s4=0}else Jt2(t5,6,"Frame setup failed"),s4=t5.a;if(s4=s4==0){if(s4){t5.$c=0,0<t5.Aa||(t5.Ic=Ti);e:{s4=t5.Ic,u5=4*(d5=t5.za);var p5=32*d5,g5=d5+1,m5=0<t5.L?d5*(0<t5.Aa?2:1):0,v4=(t5.Aa==2?2:1)*d5;if((h5=u5+832+(c5=3*(16*s4+Ri[t5.L])/2*p5)+(l5=t5.Fa!=null&&0<t5.Fa.length?t5.Kc.c*t5.Kc.i:0))!=h5)s4=0;else{if(h5>t5.Vb){if(t5.Vb=0,t5.Ec=a2(h5),t5.Fc=0,t5.Ec==null){s4=Jt2(t5,1,"no memory during frame initialization.");break e}t5.Vb=h5}h5=t5.Ec,f5=t5.Fc,t5.Ac=h5,t5.Bc=f5,f5+=u5,t5.Gd=o2(p5,Ht2),t5.Hd=0,t5.rb=o2(g5+1,Dt2),t5.sb=1,t5.wa=m5?o2(m5,Rt2):null,t5.Y=0,t5.D.Nb=0,t5.D.wa=t5.wa,t5.D.Y=t5.Y,0<t5.Aa&&(t5.D.Y+=d5),e(!0),t5.oc=h5,t5.pc=f5,f5+=832,t5.ya=o2(v4,zt2),t5.aa=0,t5.D.ya=t5.ya,t5.D.aa=t5.aa,t5.Aa==2&&(t5.D.aa+=d5),t5.R=16*d5,t5.B=8*d5,d5=(p5=Ri[t5.L])*t5.R,p5=p5/2*t5.B,t5.sa=h5,t5.ta=f5+d5,t5.qa=t5.sa,t5.ra=t5.ta+16*s4*t5.R+p5,t5.Ha=t5.qa,t5.Ia=t5.ra+8*s4*t5.B+p5,t5.$c=0,f5+=c5,t5.mb=l5?h5:null,t5.nb=l5?f5:null,e(f5+l5<=t5.Fc+t5.Vb),$t2(t5),i2(t5.Ac,t5.Bc,0,u5),s4=1}}if(s4){if(n3.ka=0,n3.y=t5.sa,n3.O=t5.ta,n3.f=t5.qa,n3.N=t5.ra,n3.ea=t5.Ha,n3.Vd=t5.Ia,n3.fa=t5.R,n3.Rc=t5.B,n3.F=null,n3.J=0,!Ir){for(s4=-255;255>=s4;++s4)_r[255+s4]=0>s4?-s4:s4;for(s4=-1020;1020>=s4;++s4)Pr[1020+s4]=-128>s4?-128:127<s4?127:s4;for(s4=-112;112>=s4;++s4)kr[112+s4]=-16>s4?-16:15<s4?15:s4;for(s4=-255;510>=s4;++s4)Fr[255+s4]=0>s4?0:255<s4?255:s4;Ir=1}ir=ue2,ar=ie2,sr=ae2,ur=oe2,cr=se2,or=re2,lr=Ye,hr=Je,fr=Ze,dr=$e,pr=Xe,gr=Ke,mr=Qe,vr=tn,br=ze,yr=Ue,wr=He,Nr=We,hi[0]=xe2,hi[1]=le2,hi[2]=Ne2,hi[3]=Le2,hi[4]=Ae2,hi[5]=_e2,hi[6]=Se2,hi[7]=Pe2,hi[8]=Fe2,hi[9]=ke2,li[0]=me2,li[1]=fe2,li[2]=de2,li[3]=pe2,li[4]=ve2,li[5]=be2,li[6]=ye2,fi[0]=Oe,fi[1]=he2,fi[2]=Ie2,fi[3]=je2,fi[4]=Me,fi[5]=Be,fi[6]=qe,s4=1}else s4=0}s4&&(s4=(function(t6,n4){for(t6.M=0;t6.M<t6.Va;++t6.M){var o3,s5=t6.Jc[t6.M&t6.Xb],u6=t6.m,c6=t6;for(o3=0;o3<c6.za;++o3){var l6=u6,h6=c6,f6=h6.Ac,d6=h6.Bc+4*o3,p6=h6.zc,g6=h6.ya[h6.aa+o3];if(h6.Qa.Bb?g6.$b=k2(l6,h6.Pa.jb[0])?2+k2(l6,h6.Pa.jb[2]):k2(l6,h6.Pa.jb[1]):g6.$b=0,h6.kc&&(g6.Ad=k2(l6,h6.Bd)),g6.Za=!k2(l6,145)+0,g6.Za){var m6=g6.Ob,v5=0;for(h6=0;4>h6;++h6){var b4,y4=p6[0+h6];for(b4=0;4>b4;++b4){y4=si[f6[d6+b4]][y4];for(var w4=ai[k2(l6,y4[0])];0<w4;)w4=ai[2*w4+k2(l6,y4[w4])];y4=-w4,f6[d6+b4]=y4}r(m6,v5,f6,d6,4),v5+=4,p6[0+h6]=y4}}else y4=k2(l6,156)?k2(l6,128)?1:3:k2(l6,163)?2:0,g6.Ob[0]=y4,i2(f6,d6,y4,4),i2(p6,0,y4,4);g6.Dd=k2(l6,142)?k2(l6,114)?k2(l6,183)?1:3:2:0}if(c6.m.Ka)return Jt2(t6,7,"Premature end-of-partition0 encountered.");for(;t6.ja<t6.za;++t6.ja){if(c6=s5,l6=(u6=t6).rb[u6.sb-1],f6=u6.rb[u6.sb+u6.ja],o3=u6.ya[u6.aa+u6.ja],d6=u6.kc?o3.Ad:0)l6.la=f6.la=0,o3.Za||(l6.Na=f6.Na=0),o3.Hc=0,o3.Gc=0,o3.ia=0;else{var N4,L4;if(l6=f6,f6=c6,d6=u6.Pa.Xc,p6=u6.ya[u6.aa+u6.ja],g6=u6.pb[p6.$b],h6=p6.ad,m6=0,v5=u6.rb[u6.sb-1],y4=b4=0,i2(h6,m6,0,384),p6.Za)var x4=0,A4=d6[3];else{w4=a2(16);var S3=l6.Na+v5.Na;if(S3=ni(f6,d6[1],S3,g6.Eb,0,w4,0),l6.Na=v5.Na=(0<S3)+0,1<S3)ir(w4,0,h6,m6);else{var _3=w4[0]+3>>3;for(w4=0;256>w4;w4+=16)h6[m6+w4]=_3}x4=1,A4=d6[0]}var P3=15&l6.la,F3=15&v5.la;for(w4=0;4>w4;++w4){var I3=1&F3;for(_3=L4=0;4>_3;++_3)P3=P3>>1|(I3=(S3=ni(f6,A4,S3=I3+(1&P3),g6.Sc,x4,h6,m6))>x4)<<7,L4=L4<<2|(3<S3?3:1<S3?2:h6[m6+0]!=0),m6+=16;P3>>=4,F3=F3>>1|I3<<7,b4=(b4<<8|L4)>>>0}for(A4=P3,x4=F3>>4,N4=0;4>N4;N4+=2){for(L4=0,P3=l6.la>>4+N4,F3=v5.la>>4+N4,w4=0;2>w4;++w4){for(I3=1&F3,_3=0;2>_3;++_3)S3=I3+(1&P3),P3=P3>>1|(I3=0<(S3=ni(f6,d6[2],S3,g6.Qc,0,h6,m6)))<<3,L4=L4<<2|(3<S3?3:1<S3?2:h6[m6+0]!=0),m6+=16;P3>>=2,F3=F3>>1|I3<<5}y4|=L4<<4*N4,A4|=P3<<4<<N4,x4|=(240&F3)<<N4}l6.la=A4,v5.la=x4,p6.Hc=b4,p6.Gc=y4,p6.ia=43690&y4?0:g6.ia,d6=!(b4|y4)}if(0<u6.L&&(u6.wa[u6.Y+u6.ja]=u6.gd[o3.$b][o3.Za],u6.wa[u6.Y+u6.ja].La|=!d6),c6.Ka)return Jt2(t6,7,"Premature end-of-file encountered.")}if($t2(t6),u6=n4,c6=1,o3=(s5=t6).D,l6=0<s5.L&&s5.M>=s5.zb&&s5.M<=s5.Va,s5.Aa==0)e:{if(o3.M=s5.M,o3.uc=l6,On(s5,o3),c6=1,o3=(L4=s5.D).Nb,l6=(y4=Ri[s5.L])*s5.R,f6=y4/2*s5.B,w4=16*o3*s5.R,_3=8*o3*s5.B,d6=s5.sa,p6=s5.ta-l6+w4,g6=s5.qa,h6=s5.ra-f6+_3,m6=s5.Ha,v5=s5.Ia-f6+_3,F3=(P3=L4.M)==0,b4=P3>=s5.Va-1,s5.Aa==2&&On(s5,L4),L4.uc)for(I3=(S3=s5).D.M,e(S3.D.uc),L4=S3.yb;L4<S3.Hb;++L4){x4=L4,A4=I3;var j3=(C3=(z3=S3).D).Nb;N4=z3.R;var C3=C3.wa[C3.Y+x4],O3=z3.sa,B3=z3.ta+16*j3*N4+16*x4,M3=C3.dd,q3=C3.tc;if(q3!=0)if(e(3<=q3),z3.L==1)0<x4&&yr(O3,B3,N4,q3+4),C3.La&&Nr(O3,B3,N4,q3),0<A4&&br(O3,B3,N4,q3+4),C3.La&&wr(O3,B3,N4,q3);else{var E3=z3.B,R3=z3.qa,D3=z3.ra+8*j3*E3+8*x4,T3=z3.Ha,z3=z3.Ia+8*j3*E3+8*x4;j3=C3.ld,0<x4&&(hr(O3,B3,N4,q3+4,M3,j3),dr(R3,D3,T3,z3,E3,q3+4,M3,j3)),C3.La&&(gr(O3,B3,N4,q3,M3,j3),vr(R3,D3,T3,z3,E3,q3,M3,j3)),0<A4&&(lr(O3,B3,N4,q3+4,M3,j3),fr(R3,D3,T3,z3,E3,q3+4,M3,j3)),C3.La&&(pr(O3,B3,N4,q3,M3,j3),mr(R3,D3,T3,z3,E3,q3,M3,j3))}}if(s5.ia&&alert("todo:DitherRow"),u6.put!=null){if(L4=16*P3,P3=16*(P3+1),F3?(u6.y=s5.sa,u6.O=s5.ta+w4,u6.f=s5.qa,u6.N=s5.ra+_3,u6.ea=s5.Ha,u6.W=s5.Ia+_3):(L4-=y4,u6.y=d6,u6.O=p6,u6.f=g6,u6.N=h6,u6.ea=m6,u6.W=v5),b4||(P3-=y4),P3>u6.o&&(P3=u6.o),u6.F=null,u6.J=null,s5.Fa!=null&&0<s5.Fa.length&&L4<P3&&(u6.J=hn(s5,u6,L4,P3-L4),u6.F=s5.mb,u6.F==null&&u6.F.length==0)){c6=Jt2(s5,3,"Could not decode alpha data.");break e}L4<u6.j&&(y4=u6.j-L4,L4=u6.j,e(!(1&y4)),u6.O+=s5.R*y4,u6.N+=s5.B*(y4>>1),u6.W+=s5.B*(y4>>1),u6.F!=null&&(u6.J+=u6.width*y4)),L4<P3&&(u6.O+=u6.v,u6.N+=u6.v>>1,u6.W+=u6.v>>1,u6.F!=null&&(u6.J+=u6.v),u6.ka=L4-u6.j,u6.U=u6.va-u6.v,u6.T=P3-L4,c6=u6.put(u6))}o3+1!=s5.Ic||b4||(r(s5.sa,s5.ta-l6,d6,p6+16*s5.R,l6),r(s5.qa,s5.ra-f6,g6,h6+8*s5.B,f6),r(s5.Ha,s5.Ia-f6,m6,v5+8*s5.B,f6))}if(!c6)return Jt2(t6,6,"Output aborted.")}return 1})(t5,n3)),n3.bc!=null&&n3.bc(n3),s4&=1}return s4?(t5.cb=0,s4):0})(t4,u4)||(n2=t4.a)}}else n2=t4.a}n2==0&&h4.Oa!=null&&h4.Oa.fd&&(n2=qn(h4.ba))}h4=n2}l4=h4!=0?null:11>l4?f4.f.RGBA.eb:f4.f.kb.y}else l4=null;return l4};var zi=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c2(t3,e2){for(var n2="",r2=0;r2<4;r2++)n2+=String.fromCharCode(t3[e2++]);return n2}function l2(t3,e2){return t3[e2+0]|t3[e2+1]<<8}function h2(t3,e2){return(t3[e2+0]|t3[e2+1]<<8|t3[e2+2]<<16)>>>0}function f2(t3,e2){return(t3[e2+0]|t3[e2+1]<<8|t3[e2+2]<<16|t3[e2+3]<<24)>>>0}new u2;var d2=[0],p2=[0],g2=[],m2=new u2,v2=t2,b2=(function(t3,e2){var n2={},r2=0,i3=!1,a3=0,o3=0;if(n2.frames=[],!(function(t4,e3){for(var n3=0;n3<4;n3++)if(t4[e3+n3]!="RIFF".charCodeAt(n3))return!0;return!1})(t3,e2)){for(f2(t3,e2+=4),e2+=8;e2<t3.length;){var s3=c2(t3,e2),u3=f2(t3,e2+=4);e2+=4;var d3=u3+(1&u3);switch(s3){case"VP8 ":case"VP8L":n2.frames[r2]===void 0&&(n2.frames[r2]={}),(m3=n2.frames[r2]).src_off=i3?o3:e2-8,m3.src_size=a3+u3+8,r2++,i3&&(i3=!1,a3=0,o3=0);break;case"VP8X":(m3=n2.header={}).feature_flags=t3[e2];var p3=e2+4;m3.canvas_width=1+h2(t3,p3),p3+=3,m3.canvas_height=1+h2(t3,p3),p3+=3;break;case"ALPH":i3=!0,a3=d3+8,o3=e2-8;break;case"ANIM":(m3=n2.header).bgcolor=f2(t3,e2),p3=e2+4,m3.loop_count=l2(t3,p3),p3+=2;break;case"ANMF":var g3,m3;(m3=n2.frames[r2]={}).offset_x=2*h2(t3,e2),e2+=3,m3.offset_y=2*h2(t3,e2),e2+=3,m3.width=1+h2(t3,e2),e2+=3,m3.height=1+h2(t3,e2),e2+=3,m3.duration=h2(t3,e2),e2+=3,g3=t3[e2++],m3.dispose=1&g3,m3.blend=g3>>1&1}s3!="ANMF"&&(e2+=d3)}return n2}})(v2,0);b2.response=v2,b2.rgbaoutput=!0,b2.dataurl=!1;var y2=b2.header?b2.header:null,w2=b2.frames?b2.frames:null;if(y2){y2.loop_counter=y2.loop_count,d2=[y2.canvas_height],p2=[y2.canvas_width];for(var N2=0;N2<w2.length&&w2[N2].blend!=0;N2++);}var L2=w2[0],x2=m2.WebPDecodeRGBA(v2,L2.src_off,L2.src_size,p2,d2);L2.rgba=x2,L2.imgwidth=p2[0],L2.imgheight=d2[0];for(var A2=0;A2<p2[0]*d2[0]*4;A2++)g2[A2]=x2[A2];return this.width=p2,this.height=d2,this.data=g2,this}(function(e){var n,r,i2,a2,s2,u2,c2,l2,f2,d2=function(t2){return t2=t2||{},this.isStrokeTransparent=t2.isStrokeTransparent||!1,this.strokeOpacity=t2.strokeOpacity||1,this.strokeStyle=t2.strokeStyle||"#000000",this.fillStyle=t2.fillStyle||"#000000",this.isFillTransparent=t2.isFillTransparent||!1,this.fillOpacity=t2.fillOpacity||1,this.font=t2.font||"10px sans-serif",this.textBaseline=t2.textBaseline||"alphabetic",this.textAlign=t2.textAlign||"left",this.lineWidth=t2.lineWidth||1,this.lineJoin=t2.lineJoin||"miter",this.lineCap=t2.lineCap||"butt",this.path=t2.path||[],this.transform=t2.transform!==void 0?t2.transform.clone():new l2,this.globalCompositeOperation=t2.globalCompositeOperation||"normal",this.globalAlpha=t2.globalAlpha||1,this.clip_path=t2.clip_path||[],this.currentPoint=t2.currentPoint||new u2,this.miterLimit=t2.miterLimit||10,this.lastPoint=t2.lastPoint||new u2,this.lineDashOffset=t2.lineDashOffset||0,this.lineDash=t2.lineDash||[],this.margin=t2.margin||[0,0,0,0],this.prevPageLastElemOffset=t2.prevPageLastElemOffset||0,this.ignoreClearRect=typeof t2.ignoreClearRect!="boolean"||t2.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new p2(this),n=this.internal.f2,r=this.internal.getCoordinateString,i2=this.internal.getVerticalCoordinateString,a2=this.internal.getHorizontalCoordinate,s2=this.internal.getVerticalCoordinate,u2=this.internal.Point,c2=this.internal.Rectangle,l2=this.internal.Matrix,f2=new d2}]);var p2=function(t2){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var e2=t2;Object.defineProperty(this,"pdf",{get:function(){return e2}});var n2=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return n2},set:function(t3){n2=!!t3}});var r2=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return r2},set:function(t3){r2=!!t3}});var i3=0;Object.defineProperty(this,"posX",{get:function(){return i3},set:function(t3){isNaN(t3)||(i3=t3)}});var a3=0;Object.defineProperty(this,"posY",{get:function(){return a3},set:function(t3){isNaN(t3)||(a3=t3)}}),Object.defineProperty(this,"margin",{get:function(){return f2.margin},set:function(t3){var e3;typeof t3=="number"?e3=[t3,t3,t3,t3]:((e3=new Array(4))[0]=t3[0],e3[1]=t3.length>=2?t3[1]:e3[0],e3[2]=t3.length>=3?t3[2]:e3[0],e3[3]=t3.length>=4?t3[3]:e3[1]),f2.margin=e3}});var o2=!1;Object.defineProperty(this,"autoPaging",{get:function(){return o2},set:function(t3){o2=t3}});var s3=0;Object.defineProperty(this,"lastBreak",{get:function(){return s3},set:function(t3){s3=t3}});var u3=[];Object.defineProperty(this,"pageBreaks",{get:function(){return u3},set:function(t3){u3=t3}}),Object.defineProperty(this,"ctx",{get:function(){return f2},set:function(t3){t3 instanceof d2&&(f2=t3)}}),Object.defineProperty(this,"path",{get:function(){return f2.path},set:function(t3){f2.path=t3}});var c3=[];Object.defineProperty(this,"ctxStack",{get:function(){return c3},set:function(t3){c3=t3}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(t3){var e3;e3=g2(t3),this.ctx.fillStyle=e3.style,this.ctx.isFillTransparent=e3.a===0,this.ctx.fillOpacity=e3.a,this.pdf.setFillColor(e3.r,e3.g,e3.b,{a:e3.a}),this.pdf.setTextColor(e3.r,e3.g,e3.b,{a:e3.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(t3){var e3=g2(t3);this.ctx.strokeStyle=e3.style,this.ctx.isStrokeTransparent=e3.a===0,this.ctx.strokeOpacity=e3.a,e3.a===0?this.pdf.setDrawColor(255,255,255):(e3.a,this.pdf.setDrawColor(e3.r,e3.g,e3.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(t3){["butt","round","square"].indexOf(t3)!==-1&&(this.ctx.lineCap=t3,this.pdf.setLineCap(t3))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(t3){isNaN(t3)||(this.ctx.lineWidth=t3,this.pdf.setLineWidth(t3))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(t3){["bevel","round","miter"].indexOf(t3)!==-1&&(this.ctx.lineJoin=t3,this.pdf.setLineJoin(t3))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(t3){isNaN(t3)||(this.ctx.miterLimit=t3,this.pdf.setMiterLimit(t3))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(t3){this.ctx.textBaseline=t3}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(t3){["right","end","center","left","start"].indexOf(t3)!==-1&&(this.ctx.textAlign=t3)}});var l3=null,h2=null,p3=null;Object.defineProperty(this,"fontFaces",{get:function(){return p3},set:function(t3){l3=null,h2=null,p3=t3}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(t3){var e3;if(this.ctx.font=t3,(e3=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(t3))!==null){var n3=e3[1];e3[2];var r3=e3[3],i4=e3[4];e3[5];var a4=e3[6],o3=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(i4)[2];i4=Math.floor(o3==="px"?parseFloat(i4)*this.pdf.internal.scaleFactor:o3==="em"?parseFloat(i4)*this.pdf.getFontSize():parseFloat(i4)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(i4);var s4=(function(t4){var e4,n4,r4=[],i5=t4.trim();if(i5==="")return Jt;if(i5 in Mt)return[Mt[i5]];for(;i5!=="";){switch(n4=null,e4=(i5=Et(i5)).charAt(0)){case'"':case"'":n4=Rt(i5.substring(1),e4);break;default:n4=Dt(i5)}if(n4===null||(r4.push(n4[0]),(i5=Et(n4[1]))!==""&&i5.charAt(0)!==","))return Jt;i5=i5.replace(/^,/,"")}return r4})(a4);if(this.fontFaces){var u4=(function(t4,e4){var n4=t4.getFontList(),r4=JSON.stringify(n4);if(l3===null||h2!==r4){var i5=(function(t5){var e5=[];return Object.keys(t5).forEach(function(n5){t5[n5].forEach(function(t6){var r5=null;switch(t6){case"bold":r5={family:n5,weight:"bold"};break;case"italic":r5={family:n5,style:"italic"};break;case"bolditalic":r5={family:n5,weight:"bold",style:"italic"};break;case"":case"normal":r5={family:n5}}r5!==null&&(r5.ref={name:n5,style:t6},e5.push(r5))})}),e5})(n4);l3=(function(t5){for(var e5={},n5=0;n5<t5.length;++n5){var r5=Ct(t5[n5]),i6=r5.family,a5=r5.stretch,o4=r5.style,s5=r5.weight;e5[i6]=e5[i6]||{},e5[i6][a5]=e5[i6][a5]||{},e5[i6][a5][o4]=e5[i6][a5][o4]||{},e5[i6][a5][o4][s5]=r5}return e5})(i5.concat(e4)),h2=r4}return l3})(this.pdf,this.fontFaces),c4=s4.map(function(t4){return{family:t4,stretch:"normal",weight:r3,style:n3}}),f3=(function(t4,e4,n4){for(var r4=(n4=n4||{}).defaultFontFamily||"times",i5=Object.assign({},Bt,n4.genericFontFamilies||{}),a5=null,o4=null,s5=0;s5<e4.length;++s5)if(i5[(a5=Ct(e4[s5])).family]&&(a5.family=i5[a5.family]),t4.hasOwnProperty(a5.family)){o4=t4[a5.family];break}if(!(o4=o4||t4[r4]))throw new Error("Could not find a font-family for the rule '"+qt(a5)+"' and default family '"+r4+"'.");if(o4=(function(t5,e5){if(e5[t5])return e5[t5];var n5=Ft[t5],r5=n5<=Ft.normal?-1:1,i6=Ot(e5,kt,n5,r5);if(!i6)throw new Error("Could not find a matching font-stretch value for "+t5);return i6})(a5.stretch,o4),o4=(function(t5,e5){if(e5[t5])return e5[t5];for(var n5=Pt[t5],r5=0;r5<n5.length;++r5)if(e5[n5[r5]])return e5[n5[r5]];throw new Error("Could not find a matching font-style for "+t5)})(a5.style,o4),!(o4=(function(t5,e5){if(e5[t5])return e5[t5];if(t5===400&&e5[500])return e5[500];if(t5===500&&e5[400])return e5[400];var n5=jt[t5],r5=Ot(e5,It,n5,t5<400?-1:1);if(!r5)throw new Error("Could not find a matching font-weight for value "+t5);return r5})(a5.weight,o4)))throw new Error("Failed to resolve a font for the rule '"+qt(a5)+"'.");return o4})(u4,c4);this.pdf.setFont(f3.ref.name,f3.ref.style)}else{var d3="";(r3==="bold"||parseInt(r3,10)>=700||n3==="bold")&&(d3="bold"),n3==="italic"&&(d3+="italic"),d3.length===0&&(d3="normal");for(var p4="",g3={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},m3=0;m3<s4.length;m3++){if(this.pdf.internal.getFont(s4[m3],d3,{noFallback:!0,disableWarning:!0})!==void 0){p4=s4[m3];break}if(d3==="bolditalic"&&this.pdf.internal.getFont(s4[m3],"bold",{noFallback:!0,disableWarning:!0})!==void 0)p4=s4[m3],d3="bold";else if(this.pdf.internal.getFont(s4[m3],"normal",{noFallback:!0,disableWarning:!0})!==void 0){p4=s4[m3],d3="normal";break}}if(p4===""){for(var v3=0;v3<s4.length;v3++)if(g3[s4[v3]]){p4=g3[s4[v3]];break}}p4=p4===""?"Times":p4,this.pdf.setFont(p4,d3)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(t3){this.ctx.globalCompositeOperation=t3}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(t3){this.ctx.globalAlpha=t3}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(t3){this.ctx.lineDashOffset=t3,T2.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(t3){this.ctx.lineDash=t3,T2.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(t3){this.ctx.ignoreClearRect=!!t3}})};p2.prototype.setLineDash=function(t2){this.lineDash=t2},p2.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p2.prototype.fill=function(){x2.call(this,"fill",!1)},p2.prototype.stroke=function(){x2.call(this,"stroke",!1)},p2.prototype.beginPath=function(){this.path=[{type:"begin"}]},p2.prototype.moveTo=function(t2,e2){if(isNaN(t2)||isNaN(e2))throw o.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var n2=this.ctx.transform.applyToPoint(new u2(t2,e2));this.path.push({type:"mt",x:n2.x,y:n2.y}),this.ctx.lastPoint=new u2(t2,e2)},p2.prototype.closePath=function(){var e2=new u2(0,0),n2=0;for(n2=this.path.length-1;n2!==-1;n2--)if(this.path[n2].type==="begin"&&_typeof(this.path[n2+1])==="object"&&typeof this.path[n2+1].x=="number"){e2=new u2(this.path[n2+1].x,this.path[n2+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new u2(e2.x,e2.y)},p2.prototype.lineTo=function(t2,e2){if(isNaN(t2)||isNaN(e2))throw o.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var n2=this.ctx.transform.applyToPoint(new u2(t2,e2));this.path.push({type:"lt",x:n2.x,y:n2.y}),this.ctx.lastPoint=new u2(n2.x,n2.y)},p2.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),x2.call(this,null,!0)},p2.prototype.quadraticCurveTo=function(t2,e2,n2,r2){if(isNaN(n2)||isNaN(r2)||isNaN(t2)||isNaN(e2))throw o.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var i3=this.ctx.transform.applyToPoint(new u2(n2,r2)),a3=this.ctx.transform.applyToPoint(new u2(t2,e2));this.path.push({type:"qct",x1:a3.x,y1:a3.y,x:i3.x,y:i3.y}),this.ctx.lastPoint=new u2(i3.x,i3.y)},p2.prototype.bezierCurveTo=function(t2,e2,n2,r2,i3,a3){if(isNaN(i3)||isNaN(a3)||isNaN(t2)||isNaN(e2)||isNaN(n2)||isNaN(r2))throw o.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var s3=this.ctx.transform.applyToPoint(new u2(i3,a3)),c3=this.ctx.transform.applyToPoint(new u2(t2,e2)),l3=this.ctx.transform.applyToPoint(new u2(n2,r2));this.path.push({type:"bct",x1:c3.x,y1:c3.y,x2:l3.x,y2:l3.y,x:s3.x,y:s3.y}),this.ctx.lastPoint=new u2(s3.x,s3.y)},p2.prototype.arc=function(t2,e2,n2,r2,i3,a3){if(isNaN(t2)||isNaN(e2)||isNaN(n2)||isNaN(r2)||isNaN(i3))throw o.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(a3=!!a3,!this.ctx.transform.isIdentity){var s3=this.ctx.transform.applyToPoint(new u2(t2,e2));t2=s3.x,e2=s3.y;var c3=this.ctx.transform.applyToPoint(new u2(0,n2)),l3=this.ctx.transform.applyToPoint(new u2(0,0));n2=Math.sqrt(Math.pow(c3.x-l3.x,2)+Math.pow(c3.y-l3.y,2))}Math.abs(i3-r2)>=2*Math.PI&&(r2=0,i3=2*Math.PI),this.path.push({type:"arc",x:t2,y:e2,radius:n2,startAngle:r2,endAngle:i3,counterclockwise:a3})},p2.prototype.arcTo=function(t2,e2,n2,r2,i3){throw new Error("arcTo not implemented.")},p2.prototype.rect=function(t2,e2,n2,r2){if(isNaN(t2)||isNaN(e2)||isNaN(n2)||isNaN(r2))throw o.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(t2,e2),this.lineTo(t2+n2,e2),this.lineTo(t2+n2,e2+r2),this.lineTo(t2,e2+r2),this.lineTo(t2,e2),this.lineTo(t2+n2,e2),this.lineTo(t2,e2)},p2.prototype.fillRect=function(t2,e2,n2,r2){if(isNaN(t2)||isNaN(e2)||isNaN(n2)||isNaN(r2))throw o.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m2.call(this)){var i3={};this.lineCap!=="butt"&&(i3.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(i3.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(t2,e2,n2,r2),this.fill(),i3.hasOwnProperty("lineCap")&&(this.lineCap=i3.lineCap),i3.hasOwnProperty("lineJoin")&&(this.lineJoin=i3.lineJoin)}},p2.prototype.strokeRect=function(t2,e2,n2,r2){if(isNaN(t2)||isNaN(e2)||isNaN(n2)||isNaN(r2))throw o.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v2.call(this)||(this.beginPath(),this.rect(t2,e2,n2,r2),this.stroke())},p2.prototype.clearRect=function(t2,e2,n2,r2){if(isNaN(t2)||isNaN(e2)||isNaN(n2)||isNaN(r2))throw o.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(t2,e2,n2,r2))},p2.prototype.save=function(t2){t2=typeof t2!="boolean"||t2;for(var e2=this.pdf.internal.getCurrentPageInfo().pageNumber,n2=0;n2<this.pdf.internal.getNumberOfPages();n2++)this.pdf.setPage(n2+1),this.pdf.internal.out("q");if(this.pdf.setPage(e2),t2){this.ctx.fontSize=this.pdf.internal.getFontSize();var r2=new d2(this.ctx);this.ctxStack.push(this.ctx),this.ctx=r2}},p2.prototype.restore=function(t2){t2=typeof t2!="boolean"||t2;for(var e2=this.pdf.internal.getCurrentPageInfo().pageNumber,n2=0;n2<this.pdf.internal.getNumberOfPages();n2++)this.pdf.setPage(n2+1),this.pdf.internal.out("Q");this.pdf.setPage(e2),t2&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p2.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g2=function(t2){var e2,n2,r2,i3;if(t2.isCanvasGradient===!0&&(t2=t2.getColor()),!t2)return{r:0,g:0,b:0,a:0,style:t2};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(t2))e2=0,n2=0,r2=0,i3=0;else{var a3=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(t2);if(a3!==null)e2=parseInt(a3[1]),n2=parseInt(a3[2]),r2=parseInt(a3[3]),i3=1;else if((a3=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(t2))!==null)e2=parseInt(a3[1]),n2=parseInt(a3[2]),r2=parseInt(a3[3]),i3=parseFloat(a3[4]);else{if(i3=1,typeof t2=="string"&&t2.charAt(0)!=="#"){var o2=new h(t2);t2=o2.ok?o2.toHex():"#000000"}t2.length===4?(e2=t2.substring(1,2),e2+=e2,n2=t2.substring(2,3),n2+=n2,r2=t2.substring(3,4),r2+=r2):(e2=t2.substring(1,3),n2=t2.substring(3,5),r2=t2.substring(5,7)),e2=parseInt(e2,16),n2=parseInt(n2,16),r2=parseInt(r2,16)}}return{r:e2,g:n2,b:r2,a:i3,style:t2}},m2=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v2=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p2.prototype.fillText=function(t2,e2,n2,r2){if(isNaN(e2)||isNaN(n2)||typeof t2!="string")throw o.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(r2=isNaN(r2)?void 0:r2,!m2.call(this)){var i3=E2(this.ctx.transform.rotation),a3=this.ctx.transform.scaleX;j2.call(this,{text:t2,x:e2,y:n2,scale:a3,angle:i3,align:this.textAlign,maxWidth:r2})}},p2.prototype.strokeText=function(t2,e2,n2,r2){if(isNaN(e2)||isNaN(n2)||typeof t2!="string")throw o.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v2.call(this)){r2=isNaN(r2)?void 0:r2;var i3=E2(this.ctx.transform.rotation),a3=this.ctx.transform.scaleX;j2.call(this,{text:t2,x:e2,y:n2,scale:a3,renderingMode:"stroke",angle:i3,align:this.textAlign,maxWidth:r2})}},p2.prototype.measureText=function(t2){if(typeof t2!="string")throw o.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var e2=this.pdf,n2=this.pdf.internal.scaleFactor,r2=e2.internal.getFontSize(),i3=e2.getStringUnitWidth(t2)*r2/e2.internal.scaleFactor;return new function(t3){var e3=(t3=t3||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return e3}}),this}({width:i3*=Math.round(96*n2/72*1e4)/1e4})},p2.prototype.scale=function(t2,e2){if(isNaN(t2)||isNaN(e2))throw o.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var n2=new l2(t2,0,0,e2,0,0);this.ctx.transform=this.ctx.transform.multiply(n2)},p2.prototype.rotate=function(t2){if(isNaN(t2))throw o.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var e2=new l2(Math.cos(t2),Math.sin(t2),-Math.sin(t2),Math.cos(t2),0,0);this.ctx.transform=this.ctx.transform.multiply(e2)},p2.prototype.translate=function(t2,e2){if(isNaN(t2)||isNaN(e2))throw o.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var n2=new l2(1,0,0,1,t2,e2);this.ctx.transform=this.ctx.transform.multiply(n2)},p2.prototype.transform=function(t2,e2,n2,r2,i3,a3){if(isNaN(t2)||isNaN(e2)||isNaN(n2)||isNaN(r2)||isNaN(i3)||isNaN(a3))throw o.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var s3=new l2(t2,e2,n2,r2,i3,a3);this.ctx.transform=this.ctx.transform.multiply(s3)},p2.prototype.setTransform=function(t2,e2,n2,r2,i3,a3){t2=isNaN(t2)?1:t2,e2=isNaN(e2)?0:e2,n2=isNaN(n2)?0:n2,r2=isNaN(r2)?1:r2,i3=isNaN(i3)?0:i3,a3=isNaN(a3)?0:a3,this.ctx.transform=new l2(t2,e2,n2,r2,i3,a3)};var b2=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p2.prototype.drawImage=function(t2,e2,n2,r2,i3,a3,o2,s3,u3){var h2=this.pdf.getImageProperties(t2),f3=1,d3=1,p3=1,g3=1;r2!==void 0&&s3!==void 0&&(p3=s3/r2,g3=u3/i3,f3=h2.width/r2*s3/r2,d3=h2.height/i3*u3/i3),a3===void 0&&(a3=e2,o2=n2,e2=0,n2=0),r2!==void 0&&s3===void 0&&(s3=r2,u3=i3),r2===void 0&&s3===void 0&&(s3=h2.width,u3=h2.height);var m3=this.ctx.transform.decompose(),v3=E2(m3.rotate.shx),w3=new l2,x3=(w3=(w3=(w3=w3.multiply(m3.translate)).multiply(m3.skew)).multiply(m3.scale)).applyToRectangle(new c2(a3-e2*p3,o2-n2*g3,r2*f3,i3*d3));if(this.autoPaging){for(var S3,_3=y2.call(this,x3),P3=[],k3=0;k3<_3.length;k3+=1)P3.indexOf(_3[k3])===-1&&P3.push(_3[k3]);L2(P3);for(var F3=P3[0],I3=P3[P3.length-1],j3=F3;j3<I3+1;j3++){this.pdf.setPage(j3);var C3=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],O3=j3===1?this.posY+this.margin[0]:this.margin[0],B3=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],M3=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],q3=j3===1?0:B3+(j3-2)*M3;if(this.ctx.clip_path.length!==0){var R3=this.path;S3=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N2(S3,this.posX+this.margin[3],-q3+O3+this.ctx.prevPageLastElemOffset),A2.call(this,"fill",!0),this.path=R3}var D3=JSON.parse(JSON.stringify(x3));D3=N2([D3],this.posX+this.margin[3],-q3+O3+this.ctx.prevPageLastElemOffset)[0];var T3=(j3>F3||j3<I3)&&b2.call(this);T3&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],C3,M3,null).clip().discardPath()),this.pdf.addImage(t2,"JPEG",D3.x,D3.y,D3.w,D3.h,null,null,v3),T3&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(t2,"JPEG",x3.x,x3.y,x3.w,x3.h,null,null,v3)};var y2=function(t2,e2,n2){var r2=[];e2=e2||this.pdf.internal.pageSize.width,n2=n2||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var i3=this.posY+this.ctx.prevPageLastElemOffset;switch(t2.type){default:case"mt":case"lt":r2.push(Math.floor((t2.y+i3)/n2)+1);break;case"arc":r2.push(Math.floor((t2.y+i3-t2.radius)/n2)+1),r2.push(Math.floor((t2.y+i3+t2.radius)/n2)+1);break;case"qct":var a3=R2(this.ctx.lastPoint.x,this.ctx.lastPoint.y,t2.x1,t2.y1,t2.x,t2.y);r2.push(Math.floor((a3.y+i3)/n2)+1),r2.push(Math.floor((a3.y+a3.h+i3)/n2)+1);break;case"bct":var o2=D2(this.ctx.lastPoint.x,this.ctx.lastPoint.y,t2.x1,t2.y1,t2.x2,t2.y2,t2.x,t2.y);r2.push(Math.floor((o2.y+i3)/n2)+1),r2.push(Math.floor((o2.y+o2.h+i3)/n2)+1);break;case"rect":r2.push(Math.floor((t2.y+i3)/n2)+1),r2.push(Math.floor((t2.y+t2.h+i3)/n2)+1)}for(var s3=0;s3<r2.length;s3+=1)for(;this.pdf.internal.getNumberOfPages()<r2[s3];)w2.call(this);return r2},w2=function(){var t2=this.fillStyle,e2=this.strokeStyle,n2=this.font,r2=this.lineCap,i3=this.lineWidth,a3=this.lineJoin;this.pdf.addPage(),this.fillStyle=t2,this.strokeStyle=e2,this.font=n2,this.lineCap=r2,this.lineWidth=i3,this.lineJoin=a3},N2=function(t2,e2,n2){for(var r2=0;r2<t2.length;r2++)switch(t2[r2].type){case"bct":t2[r2].x2+=e2,t2[r2].y2+=n2;case"qct":t2[r2].x1+=e2,t2[r2].y1+=n2;default:t2[r2].x+=e2,t2[r2].y+=n2}return t2},L2=function(t2){return t2.sort(function(t3,e2){return t3-e2})},x2=function(t2,e2){var n2=this.fillStyle,r2=this.strokeStyle,i3=this.lineCap,a3=this.lineWidth,o2=Math.abs(a3*this.ctx.transform.scaleX),s3=this.lineJoin;if(this.autoPaging){for(var u3,c3,l3=JSON.parse(JSON.stringify(this.path)),h2=JSON.parse(JSON.stringify(this.path)),f3=[],d3=0;d3<h2.length;d3++)if(h2[d3].x!==void 0)for(var p3=y2.call(this,h2[d3]),g3=0;g3<p3.length;g3+=1)f3.indexOf(p3[g3])===-1&&f3.push(p3[g3]);for(var m3=0;m3<f3.length;m3++)for(;this.pdf.internal.getNumberOfPages()<f3[m3];)w2.call(this);L2(f3);for(var v3=f3[0],x3=f3[f3.length-1],S3=v3;S3<x3+1;S3++){this.pdf.setPage(S3),this.fillStyle=n2,this.strokeStyle=r2,this.lineCap=i3,this.lineWidth=o2,this.lineJoin=s3;var _3=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],P3=S3===1?this.posY+this.margin[0]:this.margin[0],k3=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],F3=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],I3=S3===1?0:k3+(S3-2)*F3;if(this.ctx.clip_path.length!==0){var j3=this.path;u3=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N2(u3,this.posX+this.margin[3],-I3+P3+this.ctx.prevPageLastElemOffset),A2.call(this,t2,!0),this.path=j3}if(c3=JSON.parse(JSON.stringify(l3)),this.path=N2(c3,this.posX+this.margin[3],-I3+P3+this.ctx.prevPageLastElemOffset),e2===!1||S3===0){var C3=(S3>v3||S3<x3)&&b2.call(this);C3&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],_3,F3,null).clip().discardPath()),A2.call(this,t2,e2),C3&&this.pdf.restoreGraphicsState()}this.lineWidth=a3}this.path=l3}else this.lineWidth=o2,A2.call(this,t2,e2),this.lineWidth=a3},A2=function(t2,e2){if((t2!=="stroke"||e2||!v2.call(this))&&(t2==="stroke"||e2||!m2.call(this))){for(var n2,r2,i3=[],a3=this.path,o2=0;o2<a3.length;o2++){var s3=a3[o2];switch(s3.type){case"begin":i3.push({begin:!0});break;case"close":i3.push({close:!0});break;case"mt":i3.push({start:s3,deltas:[],abs:[]});break;case"lt":var u3=i3.length;if(a3[o2-1]&&!isNaN(a3[o2-1].x)&&(n2=[s3.x-a3[o2-1].x,s3.y-a3[o2-1].y],u3>0)){for(;u3>=0;u3--)if(i3[u3-1].close!==!0&&i3[u3-1].begin!==!0){i3[u3-1].deltas.push(n2),i3[u3-1].abs.push(s3);break}}break;case"bct":n2=[s3.x1-a3[o2-1].x,s3.y1-a3[o2-1].y,s3.x2-a3[o2-1].x,s3.y2-a3[o2-1].y,s3.x-a3[o2-1].x,s3.y-a3[o2-1].y],i3[i3.length-1].deltas.push(n2);break;case"qct":var c3=a3[o2-1].x+2/3*(s3.x1-a3[o2-1].x),l3=a3[o2-1].y+2/3*(s3.y1-a3[o2-1].y),h2=s3.x+2/3*(s3.x1-s3.x),f3=s3.y+2/3*(s3.y1-s3.y),d3=s3.x,p3=s3.y;n2=[c3-a3[o2-1].x,l3-a3[o2-1].y,h2-a3[o2-1].x,f3-a3[o2-1].y,d3-a3[o2-1].x,p3-a3[o2-1].y],i3[i3.length-1].deltas.push(n2);break;case"arc":i3.push({deltas:[],abs:[],arc:!0}),Array.isArray(i3[i3.length-1].abs)&&i3[i3.length-1].abs.push(s3)}}r2=e2?null:t2==="stroke"?"stroke":"fill";for(var g3=!1,b3=0;b3<i3.length;b3++)if(i3[b3].arc)for(var y3=i3[b3].abs,w3=0;w3<y3.length;w3++){var N3=y3[w3];N3.type==="arc"?P2.call(this,N3.x,N3.y,N3.radius,N3.startAngle,N3.endAngle,N3.counterclockwise,void 0,e2,!g3):C2.call(this,N3.x,N3.y),g3=!0}else if(i3[b3].close===!0)this.pdf.internal.out("h"),g3=!1;else if(i3[b3].begin!==!0){var L3=i3[b3].start.x,x3=i3[b3].start.y;O2.call(this,i3[b3].deltas,L3,x3),g3=!0}r2&&k2.call(this,r2),e2&&F2.call(this)}},S2=function(t2){var e2=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,n2=e2*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return t2-n2;case"top":return t2+e2-n2;case"hanging":return t2+e2-2*n2;case"middle":return t2+e2/2-n2;default:return t2}},_2=function(t2){return t2+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p2.prototype.createLinearGradient=function(){var t2=function(){};return t2.colorStops=[],t2.addColorStop=function(t3,e2){this.colorStops.push([t3,e2])},t2.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},t2.isCanvasGradient=!0,t2},p2.prototype.createPattern=function(){return this.createLinearGradient()},p2.prototype.createRadialGradient=function(){return this.createLinearGradient()};var P2=function(t2,e2,n2,r2,i3,a3,o2,s3,u3){for(var c3=M2.call(this,n2,r2,i3,a3),l3=0;l3<c3.length;l3++){var h2=c3[l3];l3===0&&(u3?I2.call(this,h2.x1+t2,h2.y1+e2):C2.call(this,h2.x1+t2,h2.y1+e2)),B2.call(this,t2,e2,h2.x2,h2.y2,h2.x3,h2.y3,h2.x4,h2.y4)}s3?F2.call(this):k2.call(this,o2)},k2=function(t2){switch(t2){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},F2=function(){this.pdf.clip(),this.pdf.discardPath()},I2=function(t2,e2){this.pdf.internal.out(r(t2)+" "+i2(e2)+" m")},j2=function(t2){var e2;switch(t2.align){case"right":case"end":e2="right";break;case"center":e2="center";break;default:e2="left"}var n2,r2,i3,a3=this.pdf.getTextDimensions(t2.text),o2=S2.call(this,t2.y),s3=_2.call(this,o2)-a3.h,h2=this.ctx.transform.applyToPoint(new u2(t2.x,o2));if(this.autoPaging){var f3=this.ctx.transform.decompose(),d3=new l2;d3=(d3=(d3=d3.multiply(f3.translate)).multiply(f3.skew)).multiply(f3.scale);for(var p3=this.ctx.transform.applyToRectangle(new c2(t2.x,o2,a3.w,a3.h)),g3=d3.applyToRectangle(new c2(t2.x,s3,a3.w,a3.h)),m3=y2.call(this,g3),v3=[],w3=0;w3<m3.length;w3+=1)v3.indexOf(m3[w3])===-1&&v3.push(m3[w3]);L2(v3);for(var x3=v3[0],P3=v3[v3.length-1],k3=x3;k3<P3+1;k3++){this.pdf.setPage(k3);var F3=k3===1?this.posY+this.margin[0]:this.margin[0],I3=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],j3=this.pdf.internal.pageSize.height-this.margin[2],C3=j3-this.margin[0],O3=this.pdf.internal.pageSize.width-this.margin[1],B3=O3-this.margin[3],M3=k3===1?0:I3+(k3-2)*C3;if(this.ctx.clip_path.length!==0){var q3=this.path;n2=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N2(n2,this.posX+this.margin[3],-1*M3+F3),A2.call(this,"fill",!0),this.path=q3}var E3=N2([JSON.parse(JSON.stringify(g3))],this.posX+this.margin[3],-M3+F3+this.ctx.prevPageLastElemOffset)[0];t2.scale>=.01&&(r2=this.pdf.internal.getFontSize(),this.pdf.setFontSize(r2*t2.scale),i3=this.lineWidth,this.lineWidth=i3*t2.scale);var R3=this.autoPaging!=="text";if(R3||E3.y+E3.h<=j3){if(R3||E3.y>=F3&&E3.x<=O3){var D3=R3?t2.text:this.pdf.splitTextToSize(t2.text,t2.maxWidth||O3-E3.x)[0],T3=N2([JSON.parse(JSON.stringify(p3))],this.posX+this.margin[3],-M3+F3+this.ctx.prevPageLastElemOffset)[0],z2=R3&&(k3>x3||k3<P3)&&b2.call(this);z2&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],B3,C3,null).clip().discardPath()),this.pdf.text(D3,T3.x,T3.y,{angle:t2.angle,align:e2,renderingMode:t2.renderingMode}),z2&&this.pdf.restoreGraphicsState()}}else E3.y<j3&&(this.ctx.prevPageLastElemOffset+=j3-E3.y);t2.scale>=.01&&(this.pdf.setFontSize(r2),this.lineWidth=i3)}}else t2.scale>=.01&&(r2=this.pdf.internal.getFontSize(),this.pdf.setFontSize(r2*t2.scale),i3=this.lineWidth,this.lineWidth=i3*t2.scale),this.pdf.text(t2.text,h2.x+this.posX,h2.y+this.posY,{angle:t2.angle,align:e2,renderingMode:t2.renderingMode,maxWidth:t2.maxWidth}),t2.scale>=.01&&(this.pdf.setFontSize(r2),this.lineWidth=i3)},C2=function(t2,e2,n2,a3){n2=n2||0,a3=a3||0,this.pdf.internal.out(r(t2+n2)+" "+i2(e2+a3)+" l")},O2=function(t2,e2,n2){return this.pdf.lines(t2,e2,n2,null,null)},B2=function(t2,e2,r2,i3,o2,u3,c3,l3){this.pdf.internal.out([n(a2(r2+t2)),n(s2(i3+e2)),n(a2(o2+t2)),n(s2(u3+e2)),n(a2(c3+t2)),n(s2(l3+e2)),"c"].join(" "))},M2=function(t2,e2,n2,r2){for(var i3=2*Math.PI,a3=Math.PI/2;e2>n2;)e2-=i3;var o2=Math.abs(n2-e2);o2<i3&&r2&&(o2=i3-o2);for(var s3=[],u3=r2?-1:1,c3=e2;o2>1e-5;){var l3=c3+u3*Math.min(o2,a3);s3.push(q2.call(this,t2,c3,l3)),o2-=Math.abs(l3-c3),c3=l3}return s3},q2=function(t2,e2,n2){var r2=(n2-e2)/2,i3=t2*Math.cos(r2),a3=t2*Math.sin(r2),o2=i3,s3=-a3,u3=o2*o2+s3*s3,c3=u3+o2*i3+s3*a3,l3=4/3*(Math.sqrt(2*u3*c3)-c3)/(o2*a3-s3*i3),h2=o2-l3*s3,f3=s3+l3*o2,d3=h2,p3=-f3,g3=r2+e2,m3=Math.cos(g3),v3=Math.sin(g3);return{x1:t2*Math.cos(e2),y1:t2*Math.sin(e2),x2:h2*m3-f3*v3,y2:h2*v3+f3*m3,x3:d3*m3-p3*v3,y3:d3*v3+p3*m3,x4:t2*Math.cos(n2),y4:t2*Math.sin(n2)}},E2=function(t2){return 180*t2/Math.PI},R2=function(t2,e2,n2,r2,i3,a3){var o2=t2+.5*(n2-t2),s3=e2+.5*(r2-e2),u3=i3+.5*(n2-i3),l3=a3+.5*(r2-a3),h2=Math.min(t2,i3,o2,u3),f3=Math.max(t2,i3,o2,u3),d3=Math.min(e2,a3,s3,l3),p3=Math.max(e2,a3,s3,l3);return new c2(h2,d3,f3-h2,p3-d3)},D2=function(t2,e2,n2,r2,i3,a3,o2,s3){var u3,l3,h2,f3,d3,p3,g3,m3,v3,b3,y3,w3,N3,L3,x3=n2-t2,A3=r2-e2,S3=i3-n2,_3=a3-r2,P3=o2-i3,k3=s3-a3;for(l3=0;l3<41;l3++)v3=(g3=(h2=t2+(u3=l3/40)*x3)+u3*((d3=n2+u3*S3)-h2))+u3*(d3+u3*(i3+u3*P3-d3)-g3),b3=(m3=(f3=e2+u3*A3)+u3*((p3=r2+u3*_3)-f3))+u3*(p3+u3*(a3+u3*k3-p3)-m3),l3==0?(y3=v3,w3=b3,N3=v3,L3=b3):(y3=Math.min(y3,v3),w3=Math.min(w3,b3),N3=Math.max(N3,v3),L3=Math.max(L3,b3));return new c2(Math.round(y3),Math.round(w3),Math.round(N3-y3),Math.round(L3-w3))},T2=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var t2,e2,n2=(t2=this.ctx.lineDash,e2=this.ctx.lineDashOffset,JSON.stringify({lineDash:t2,lineDashOffset:e2}));this.prevLineDash!==n2&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=n2)}}})(E.API),(function(t2){var n=function(t3){var e,n2,r2,i3,a3,o3,s2,u2,c2,l2;for(n2=[],r2=0,i3=(t3+=e="\0\0\0\0".slice(t3.length%4||4)).length;i3>r2;r2+=4)(a3=(t3.charCodeAt(r2)<<24)+(t3.charCodeAt(r2+1)<<16)+(t3.charCodeAt(r2+2)<<8)+t3.charCodeAt(r2+3))!==0?(o3=(a3=((a3=((a3=((a3=(a3-(l2=a3%85))/85)-(c2=a3%85))/85)-(u2=a3%85))/85)-(s2=a3%85))/85)%85,n2.push(o3+33,s2+33,u2+33,c2+33,l2+33)):n2.push(122);return(function(t4,e2){for(var n3=e2;n3>0;n3--)t4.pop()})(n2,e.length),String.fromCharCode.apply(String,n2)+"~>"},r=function(t3){var e,n2,r2,i3,a3,o3=String,s2="length",u2=255,c2="charCodeAt",l2="slice",h2="replace";for(t3[l2](-2),t3=t3[l2](0,-2)[h2](/\s/g,"")[h2]("z","!!!!!"),r2=[],i3=0,a3=(t3+=e="uuuuu"[l2](t3[s2]%5||5))[s2];a3>i3;i3+=5)n2=52200625*(t3[c2](i3)-33)+614125*(t3[c2](i3+1)-33)+7225*(t3[c2](i3+2)-33)+85*(t3[c2](i3+3)-33)+(t3[c2](i3+4)-33),r2.push(u2&n2>>24,u2&n2>>16,u2&n2>>8,u2&n2);return(function(t4,e2){for(var n3=e2;n3>0;n3--)t4.pop()})(r2,e[s2]),o3.fromCharCode.apply(o3,r2)},i2=function(t3){return t3.split("").map(function(t4){return("0"+t4.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a2=function(t3){var e=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((t3=t3.replace(/\s/g,"")).indexOf(">")!==-1&&(t3=t3.substr(0,t3.indexOf(">"))),t3.length%2&&(t3+="0"),e.test(t3)===!1)return"";for(var n2="",r2=0;r2<t3.length;r2+=2)n2+=String.fromCharCode("0x"+(t3[r2]+t3[r2+1]));return n2},o2=function(t3){for(var n2=new Uint8Array(t3.length),r2=t3.length;r2--;)n2[r2]=t3.charCodeAt(r2);return(n2=zlibSync(n2)).reduce(function(t4,e){return t4+String.fromCharCode(e)},"")};t2.processDataByFilters=function(t3,e){var s2=0,u2=t3||"",c2=[];for(typeof(e=e||[])=="string"&&(e=[e]),s2=0;s2<e.length;s2+=1)switch(e[s2]){case"ASCII85Decode":case"/ASCII85Decode":u2=r(u2),c2.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u2=n(u2),c2.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u2=a2(u2),c2.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u2=i2(u2),c2.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u2=o2(u2),c2.push("/FlateDecode");break;default:throw new Error('The filter: "'+e[s2]+'" is not implemented')}return{data:u2,reverseChain:c2.reverse().join(" ")}}})(E.API),(function(t2){t2.loadFile=function(t3,e,n){return(function(t4,e2,n2){e2=e2!==!1,n2=typeof n2=="function"?n2:function(){};var r=void 0;try{r=(function(t5,e3,n3){var r2=new XMLHttpRequest,i2=0,a2=function(t6){var e4=t6.length,n4=[],r3=String.fromCharCode;for(i2=0;i2<e4;i2+=1)n4.push(r3(255&t6.charCodeAt(i2)));return n4.join("")};if(r2.open("GET",t5,!e3),r2.overrideMimeType("text/plain; charset=x-user-defined"),e3===!1&&(r2.onload=function(){r2.status===200?n3(a2(this.responseText)):n3(void 0)}),r2.send(null),e3&&r2.status===200)return a2(r2.responseText)})(t4,e2,n2)}catch{}return r})(t3,e,n)},t2.loadImageFile=t2.loadFile})(E.API),(function(e){function n(){return(i.html2canvas?Promise.resolve(i.html2canvas):__vitePreload(()=>import("./html2canvas.esm.DkCHeoCc.js"),[],import.meta.url)).catch(function(t2){return Promise.reject(new Error("Could not load html2canvas: "+t2))}).then(function(t2){return t2.default?t2.default:t2})}function r(){return(i.DOMPurify?Promise.resolve(i.DOMPurify):__vitePreload(()=>import("./purify.es.DT9SruXx.js"),[],import.meta.url)).catch(function(t2){return Promise.reject(new Error("Could not load dompurify: "+t2))}).then(function(t2){return t2.default?t2.default:t2})}var a2=function(e2){var n2=_typeof(e2);return n2==="undefined"?"undefined":n2==="string"||e2 instanceof String?"string":n2==="number"||e2 instanceof Number?"number":n2==="function"||e2 instanceof Function?"function":e2&&e2.constructor===Array?"array":e2&&e2.nodeType===1?"element":n2==="object"?"object":"unknown"},o2=function(t2,e2){var n2=document.createElement(t2);for(var r2 in e2.className&&(n2.className=e2.className),e2.innerHTML&&e2.dompurify&&(n2.innerHTML=e2.dompurify.sanitize(e2.innerHTML)),e2.style)n2.style[r2]=e2.style[r2];return n2},s2=function t2(e2,n2){for(var r2=e2.nodeType===3?document.createTextNode(e2.nodeValue):e2.cloneNode(!1),i2=e2.firstChild;i2;i2=i2.nextSibling)n2!==!0&&i2.nodeType===1&&i2.nodeName==="SCRIPT"||r2.appendChild(t2(i2,n2));return e2.nodeType===1&&(e2.nodeName==="CANVAS"?(r2.width=e2.width,r2.height=e2.height,r2.getContext("2d").drawImage(e2,0,0)):e2.nodeName!=="TEXTAREA"&&e2.nodeName!=="SELECT"||(r2.value=e2.value),r2.addEventListener("load",function(){r2.scrollTop=e2.scrollTop,r2.scrollLeft=e2.scrollLeft},!0)),r2},u2=function t2(e2){var n2=Object.assign(t2.convert(Promise.resolve()),JSON.parse(JSON.stringify(t2.template))),r2=t2.convert(Promise.resolve(),n2);return(r2=r2.setProgress(1,t2,1,[t2])).set(e2)};(u2.prototype=Object.create(Promise.prototype)).constructor=u2,u2.convert=function(t2,e2){return t2.__proto__=e2||u2.prototype,t2},u2.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},u2.prototype.from=function(t2,e2){return this.then(function(){switch(e2=e2||(function(t3){switch(a2(t3)){case"string":return"string";case"element":return t3.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(t2),e2){case"string":return this.then(r).then(function(e3){return this.set({src:o2("div",{innerHTML:t2,dompurify:e3})})});case"element":return this.set({src:t2});case"canvas":return this.set({canvas:t2});case"img":return this.set({img:t2});default:return this.error("Unknown source type.")}})},u2.prototype.to=function(t2){switch(t2){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},u2.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var t2={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},e2=s2(this.prop.src,this.opt.html2canvas.javascriptEnabled);e2.tagName==="BODY"&&(t2.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=o2("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=o2("div",{className:"html2pdf__container",style:t2}),this.prop.container.appendChild(e2),this.prop.container.firstChild.appendChild(o2("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},u2.prototype.toCanvas=function(){var t2=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(t2).then(n).then(function(t3){var e2=Object.assign({},this.opt.html2canvas);return delete e2.onrendered,t3(this.prop.container,e2)}).then(function(t3){(this.opt.html2canvas.onrendered||function(){})(t3),this.prop.canvas=t3,document.body.removeChild(this.prop.overlay)})},u2.prototype.toContext2d=function(){var t2=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(t2).then(n).then(function(t3){var e2=this.opt.jsPDF,n2=this.opt.fontFaces,r2=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,i2=Object.assign({async:!0,allowTaint:!0,scale:r2,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete i2.onrendered,e2.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,e2.context2d.posX=this.opt.x,e2.context2d.posY=this.opt.y,e2.context2d.margin=this.opt.margin,e2.context2d.fontFaces=n2,n2)for(var a3=0;a3<n2.length;++a3){var o3=n2[a3],s3=o3.src.find(function(t4){return t4.format==="truetype"});s3&&e2.addFont(s3.url,o3.ref.name,o3.ref.style)}return i2.windowHeight=i2.windowHeight||0,i2.windowHeight=i2.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):i2.windowHeight,e2.context2d.save(!0),t3(this.prop.container,i2)}).then(function(t3){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(t3),this.prop.canvas=t3,document.body.removeChild(this.prop.overlay)})},u2.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var t2=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=t2})},u2.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},u2.prototype.output=function(t2,e2,n2){return(n2=n2||"pdf").toLowerCase()==="img"||n2.toLowerCase()==="image"?this.outputImg(t2,e2):this.outputPdf(t2,e2)},u2.prototype.outputPdf=function(t2,e2){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(t2,e2)})},u2.prototype.outputImg=function(t2){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(t2){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+t2+'" is not supported.'}})},u2.prototype.save=function(t2){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(t2?{filename:t2}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},u2.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},u2.prototype.set=function(t2){if(a2(t2)!=="object")return this;var e2=Object.keys(t2||{}).map(function(e3){if(e3 in u2.template.prop)return function(){this.prop[e3]=t2[e3]};switch(e3){case"margin":return this.setMargin.bind(this,t2.margin);case"jsPDF":return function(){return this.opt.jsPDF=t2.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,t2.pageSize);default:return function(){this.opt[e3]=t2[e3]}}},this);return this.then(function(){return this.thenList(e2)})},u2.prototype.get=function(t2,e2){return this.then(function(){var n2=t2 in u2.template.prop?this.prop[t2]:this.opt[t2];return e2?e2(n2):n2})},u2.prototype.setMargin=function(t2){return this.then(function(){switch(a2(t2)){case"number":t2=[t2,t2,t2,t2];case"array":if(t2.length===2&&(t2=[t2[0],t2[1],t2[0],t2[1]]),t2.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=t2}).then(this.setPageSize)},u2.prototype.setPageSize=function(t2){function e2(t3,e3){return Math.floor(t3*e3/72*96)}return this.then(function(){(t2=t2||E.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(t2.inner={width:t2.width-this.opt.margin[1]-this.opt.margin[3],height:t2.height-this.opt.margin[0]-this.opt.margin[2]},t2.inner.px={width:e2(t2.inner.width,t2.k),height:e2(t2.inner.height,t2.k)},t2.inner.ratio=t2.inner.height/t2.inner.width),this.prop.pageSize=t2})},u2.prototype.setProgress=function(t2,e2,n2,r2){return t2!=null&&(this.progress.val=t2),e2!=null&&(this.progress.state=e2),n2!=null&&(this.progress.n=n2),r2!=null&&(this.progress.stack=r2),this.progress.ratio=this.progress.val/this.progress.state,this},u2.prototype.updateProgress=function(t2,e2,n2,r2){return this.setProgress(t2?this.progress.val+t2:null,e2||null,n2?this.progress.n+n2:null,r2?this.progress.stack.concat(r2):null)},u2.prototype.then=function(t2,e2){var n2=this;return this.thenCore(t2,e2,function(t3,e3){return n2.updateProgress(null,null,1,[t3]),Promise.prototype.then.call(this,function(e4){return n2.updateProgress(null,t3),e4}).then(t3,e3).then(function(t4){return n2.updateProgress(1),t4})})},u2.prototype.thenCore=function(t2,e2,n2){n2=n2||Promise.prototype.then;var r2=this;t2&&(t2=t2.bind(r2)),e2&&(e2=e2.bind(r2));var i2=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?r2:u2.convert(Object.assign({},r2),Promise.prototype),a3=n2.call(i2,t2,e2);return u2.convert(a3,r2.__proto__)},u2.prototype.thenExternal=function(t2,e2){return Promise.prototype.then.call(this,t2,e2)},u2.prototype.thenList=function(t2){var e2=this;return t2.forEach(function(t3){e2=e2.thenCore(t3)}),e2},u2.prototype.catch=function(t2){t2&&(t2=t2.bind(this));var e2=Promise.prototype.catch.call(this,t2);return u2.convert(e2,this)},u2.prototype.catchExternal=function(t2){return Promise.prototype.catch.call(this,t2)},u2.prototype.error=function(t2){return this.then(function(){throw new Error(t2)})},u2.prototype.using=u2.prototype.set,u2.prototype.saveAs=u2.prototype.save,u2.prototype.export=u2.prototype.output,u2.prototype.run=u2.prototype.then,E.getPageSize=function(e2,n2,r2){if(_typeof(e2)==="object"){var i2=e2;e2=i2.orientation,n2=i2.unit||n2,r2=i2.format||r2}n2=n2||"mm",r2=r2||"a4",e2=(""+(e2||"P")).toLowerCase();var a3,o3=(""+r2).toLowerCase(),s3={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(n2){case"pt":a3=1;break;case"mm":a3=72/25.4;break;case"cm":a3=72/2.54;break;case"in":a3=72;break;case"px":a3=.75;break;case"pc":case"em":a3=12;break;case"ex":a3=6;break;default:throw"Invalid unit: "+n2}var u3,c2=0,l2=0;if(s3.hasOwnProperty(o3))c2=s3[o3][1]/a3,l2=s3[o3][0]/a3;else try{c2=r2[1],l2=r2[0]}catch{throw new Error("Invalid format: "+r2)}if(e2==="p"||e2==="portrait")e2="p",l2>c2&&(u3=l2,l2=c2,c2=u3);else{if(e2!=="l"&&e2!=="landscape")throw"Invalid orientation: "+e2;e2="l",c2>l2&&(u3=l2,l2=c2,c2=u3)}return{width:l2,height:c2,unit:n2,k:a3,orientation:e2}},e.html=function(t2,e2){(e2=e2||{}).callback=e2.callback||function(){},e2.html2canvas=e2.html2canvas||{},e2.html2canvas.canvas=e2.html2canvas.canvas||this.canvas,e2.jsPDF=e2.jsPDF||this,e2.fontFaces=e2.fontFaces?e2.fontFaces.map(Ct):null;var n2=new u2(e2);return e2.worker?n2:n2.from(t2).doCallback()}})(E.API),E.API.addJS=function(t2){return Ut=t2,this.internal.events.subscribe("postPutResources",function(){Tt=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Tt+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),zt=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Ut+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Tt!==void 0&&zt!==void 0&&this.internal.out("/Names <</JavaScript "+Tt+" 0 R>>")}),this},(function(t2){var e;t2.events.push(["postPutResources",function(){var t3=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=t3.outline.render().split(/\r\n/),i2=0;i2<r.length;i2++){var a2=r[i2],o2=n.exec(a2);if(o2!=null){var s2=o2[1];t3.internal.newObjectDeferredBegin(s2,!1)}t3.internal.write(a2)}if(this.outline.createNamedDestinations){var u2=this.internal.pages.length,c2=[];for(i2=0;i2<u2;i2++){var l2=t3.internal.newObject();c2.push(l2);var h2=t3.internal.getPageInfo(i2+1);t3.internal.write("<< /D["+h2.objId+" 0 R /XYZ null null null]>> endobj")}var f2=t3.internal.newObject();for(t3.internal.write("<< /Names [ "),i2=0;i2<c2.length;i2++)t3.internal.write("(page_"+(i2+1)+")"+c2[i2]+" 0 R");t3.internal.write(" ] >>","endobj"),e=t3.internal.newObject(),t3.internal.write("<< /Dests "+f2+" 0 R"),t3.internal.write(">>","endobj")}}]),t2.events.push(["putCatalog",function(){var t3=this;t3.outline.root.children.length>0&&(t3.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t3.internal.write("/Names "+e+" 0 R"))}]),t2.events.push(["initialized",function(){var t3=this;t3.outline={createNamedDestinations:!1,root:{children:[]}},t3.outline.add=function(t4,e2,n){var r={title:e2,options:n,children:[]};return t4==null&&(t4=this.root),t4.children.push(r),r},t3.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t3,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t3.outline.genIds_r=function(e2){e2.id=t3.internal.newObjectDeferred();for(var n=0;n<e2.children.length;n++)this.genIds_r(e2.children[n])},t3.outline.renderRoot=function(t4){this.objStart(t4),this.line("/Type /Outlines"),t4.children.length>0&&(this.line("/First "+this.makeRef(t4.children[0])),this.line("/Last "+this.makeRef(t4.children[t4.children.length-1]))),this.line("/Count "+this.count_r({count:0},t4)),this.objEnd()},t3.outline.renderItems=function(e2){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,r=0;r<e2.children.length;r++){var i2=e2.children[r];this.objStart(i2),this.line("/Title "+this.makeString(i2.title)),this.line("/Parent "+this.makeRef(e2)),r>0&&this.line("/Prev "+this.makeRef(e2.children[r-1])),r<e2.children.length-1&&this.line("/Next "+this.makeRef(e2.children[r+1])),i2.children.length>0&&(this.line("/First "+this.makeRef(i2.children[0])),this.line("/Last "+this.makeRef(i2.children[i2.children.length-1])));var a2=this.count=this.count_r({count:0},i2);if(a2>0&&this.line("/Count "+a2),i2.options&&i2.options.pageNumber){var o2=t3.internal.getPageInfo(i2.options.pageNumber);this.line("/Dest ["+o2.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var s2=0;s2<e2.children.length;s2++)this.renderItems(e2.children[s2])},t3.outline.line=function(t4){this.ctx.val+=t4+`\r
`},t3.outline.makeRef=function(t4){return t4.id+" 0 R"},t3.outline.makeString=function(e2){return"("+t3.internal.pdfEscape(e2)+")"},t3.outline.objStart=function(t4){this.ctx.val+=`\r
`+t4.id+` 0 obj\r
<<\r
`},t3.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t3.outline.count_r=function(t4,e2){for(var n=0;n<e2.children.length;n++)t4.count++,this.count_r(t4,e2.children[n]);return t4.count}}])})(E.API),(function(t2){var e=[192,193,194,195,196,197,198,199];t2.processJPEG=function(t3,n,r,i2,a2,o2){var s2,u2=this.decode.DCT_DECODE,c2=null;if(typeof t3=="string"||this.__addimage__.isArrayBuffer(t3)||this.__addimage__.isArrayBufferView(t3)){switch(t3=a2||t3,t3=this.__addimage__.isArrayBuffer(t3)?new Uint8Array(t3):t3,s2=(function(t4){for(var n2,r2=256*t4.charCodeAt(4)+t4.charCodeAt(5),i3=t4.length,a3={width:0,height:0,numcomponents:1},o3=4;o3<i3;o3+=2){if(o3+=r2,e.indexOf(t4.charCodeAt(o3+1))!==-1){n2=256*t4.charCodeAt(o3+5)+t4.charCodeAt(o3+6),a3={width:256*t4.charCodeAt(o3+7)+t4.charCodeAt(o3+8),height:n2,numcomponents:t4.charCodeAt(o3+9)};break}r2=256*t4.charCodeAt(o3+2)+t4.charCodeAt(o3+3)}return a3})(t3=this.__addimage__.isArrayBufferView(t3)?this.__addimage__.arrayBufferToBinaryString(t3):t3),s2.numcomponents){case 1:o2=this.color_spaces.DEVICE_GRAY;break;case 4:o2=this.color_spaces.DEVICE_CMYK;break;case 3:o2=this.color_spaces.DEVICE_RGB}c2={data:t3,width:s2.width,height:s2.height,colorSpace:o2,bitsPerComponent:8,filter:u2,index:n,alias:r}}return c2}})(E.API),E.API.processPNG=function(t2,i2,a2,o2){if(this.__addimage__.isArrayBuffer(t2)&&(t2=new Uint8Array(t2)),this.__addimage__.isArrayBufferView(t2)){var s2,u2=decodePng(t2,{checkCrc:!0}),c2=u2.width,l2=u2.height,h2=u2.channels,f2=u2.palette,d2=u2.depth;s2=f2&&h2===1?(function(t3){for(var e=t3.width,r=t3.height,i3=t3.data,a3=t3.palette,o3=t3.depth,s3=!1,u3=[],c3=[],l3=void 0,h3=!1,f3=0,d3=0;d3<a3.length;d3++){var p3=_slicedToArray(a3[d3],4),g3=p3[0],m3=p3[1],v3=p3[2],b3=p3[3];u3.push(g3,m3,v3),b3!=null&&(b3===0?(f3++,c3.length<1&&c3.push(d3)):b3<255&&(h3=!0))}if(h3||f3>1){s3=!0,c3=void 0;var y3=e*r;l3=new Uint8Array(y3);for(var w3=new DataView(i3.buffer),N3=0;N3<y3;N3++){var L3=re(w3,N3,o3),x3=_slicedToArray(a3[L3],4)[3];l3[N3]=x3}}else f3===0&&(c3=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:s3?8:void 0,colorBytes:i3,alphaBytes:l3,needSMask:s3,palette:u3,mask:c3}})(u2):h2===2||h2===4?(function(t3){for(var e=t3.data,n=t3.width,r=t3.height,i3=t3.channels,a3=t3.depth,o3=i3===2?"DeviceGray":"DeviceRGB",s3=i3-1,u3=n*r,c3=s3,l3=u3*c3,h3=1*u3,f3=Math.ceil(l3*a3/8),d3=Math.ceil(h3*a3/8),p3=new Uint8Array(f3),g3=new Uint8Array(d3),m3=new DataView(e.buffer),v3=new DataView(p3.buffer),b3=new DataView(g3.buffer),y3=!1,w3=0;w3<u3;w3++){for(var N3=w3*i3,L3=0;L3<c3;L3++)ie(v3,re(m3,N3+L3,a3),w3*c3+L3,a3);var x3=re(m3,N3+c3,a3);x3<(1<<a3)-1&&(y3=!0),ie(b3,x3,1*w3,a3)}return{colorSpace:o3,colorsPerPixel:s3,sMaskBitsPerComponent:y3?a3:void 0,colorBytes:p3,alphaBytes:g3,needSMask:y3}})(u2):(function(t3){var e=t3.data,n=t3.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:n,colorsPerPixel:n==="DeviceGray"?1:3,colorBytes:e instanceof Uint16Array?(function(t4){for(var e2=t4.length,n2=new Uint8Array(2*e2),r=new DataView(n2.buffer,n2.byteOffset,n2.byteLength),i3=0;i3<e2;i3++)r.setUint16(2*i3,t4[i3],!1);return n2})(e):e,needSMask:!1}})(u2);var p2,g2,m2,v2=s2,b2=v2.colorSpace,y2=v2.colorsPerPixel,w2=v2.sMaskBitsPerComponent,N2=v2.colorBytes,L2=v2.alphaBytes,x2=v2.needSMask,A2=v2.palette,S2=v2.mask,_2=null;return o2!==E.API.image_compression.NONE&&typeof zlibSync=="function"?(_2=(function(t3){var e;switch(t3){case E.API.image_compression.FAST:e=11;break;case E.API.image_compression.MEDIUM:e=13;break;case E.API.image_compression.SLOW:e=14;break;default:e=12}return e})(o2),p2=this.decode.FLATE_DECODE,g2="/Predictor ".concat(_2," /Colors ").concat(y2," /BitsPerComponent ").concat(d2," /Columns ").concat(c2),t2=Xt(N2,Math.ceil(c2*y2*d2/8),y2,d2,o2),x2&&(m2=Xt(L2,Math.ceil(c2*w2/8),1,w2,o2))):(p2=void 0,g2=void 0,t2=N2,x2&&(m2=L2)),(this.__addimage__.isArrayBuffer(t2)||this.__addimage__.isArrayBufferView(t2))&&(t2=this.__addimage__.arrayBufferToBinaryString(t2)),(m2&&this.__addimage__.isArrayBuffer(m2)||this.__addimage__.isArrayBufferView(m2))&&(m2=this.__addimage__.arrayBufferToBinaryString(m2)),{alias:a2,data:t2,index:i2,filter:p2,decodeParameters:g2,transparency:S2,palette:A2,sMask:m2,predictor:_2,width:c2,height:l2,bitsPerComponent:d2,sMaskBitsPerComponent:w2,colorSpace:b2}}},(function(t2){t2.processGIF89A=function(e,n,r,i2){var a2=new oe(e),o2=a2.width,s2=a2.height,u2=[];a2.decodeAndBlitFrameRGBA(0,u2);var c2={data:u2,width:o2,height:s2},l2=new ue(100).encode(c2,100);return t2.processJPEG.call(this,l2,n,r,i2)},t2.processGIF87A=t2.processGIF89A})(E.API),ce.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t2=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t2);for(var e=0;e<t2;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i2=this.datav.getUint8(this.pos++,!0),a2=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i2,green:r,blue:n,quad:a2}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ce.prototype.parseBGR=function(){this.pos=this.offset;try{var t2="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t2]()}catch(n){o.log("bit decode error:"+n)}},ce.prototype.bit1=function(){var t2,e=Math.ceil(this.width/8),n=e%4;for(t2=this.height-1;t2>=0;t2--){for(var r=this.bottom_up?t2:this.height-1-t2,i2=0;i2<e;i2++)for(var a2=this.datav.getUint8(this.pos++,!0),o2=r*this.width*4+8*i2*4,s2=0;s2<8&&8*i2+s2<this.width;s2++){var u2=this.palette[a2>>7-s2&1];this.data[o2+4*s2]=u2.blue,this.data[o2+4*s2+1]=u2.green,this.data[o2+4*s2+2]=u2.red,this.data[o2+4*s2+3]=255}n!==0&&(this.pos+=4-n)}},ce.prototype.bit4=function(){for(var t2=Math.ceil(this.width/2),e=t2%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i2=0;i2<t2;i2++){var a2=this.datav.getUint8(this.pos++,!0),o2=r*this.width*4+2*i2*4,s2=a2>>4,u2=15&a2,c2=this.palette[s2];if(this.data[o2]=c2.blue,this.data[o2+1]=c2.green,this.data[o2+2]=c2.red,this.data[o2+3]=255,2*i2+1>=this.width)break;c2=this.palette[u2],this.data[o2+4]=c2.blue,this.data[o2+4+1]=c2.green,this.data[o2+4+2]=c2.red,this.data[o2+4+3]=255}e!==0&&(this.pos+=4-e)}},ce.prototype.bit8=function(){for(var t2=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var i2=this.datav.getUint8(this.pos++,!0),a2=n*this.width*4+4*r;if(i2<this.palette.length){var o2=this.palette[i2];this.data[a2]=o2.red,this.data[a2+1]=o2.green,this.data[a2+2]=o2.blue,this.data[a2+3]=255}else this.data[a2]=255,this.data[a2+1]=255,this.data[a2+2]=255,this.data[a2+3]=255}t2!==0&&(this.pos+=4-t2)}},ce.prototype.bit15=function(){for(var t2=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i2=0;i2<this.width;i2++){var a2=this.datav.getUint16(this.pos,!0);this.pos+=2;var o2=(a2&e)/e*255|0,s2=(a2>>5&e)/e*255|0,u2=(a2>>10&e)/e*255|0,c2=a2>>15?255:0,l2=r*this.width*4+4*i2;this.data[l2]=u2,this.data[l2+1]=s2,this.data[l2+2]=o2,this.data[l2+3]=c2}this.pos+=t2}},ce.prototype.bit16=function(){for(var t2=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i2=this.bottom_up?r:this.height-1-r,a2=0;a2<this.width;a2++){var o2=this.datav.getUint16(this.pos,!0);this.pos+=2;var s2=(o2&e)/e*255|0,u2=(o2>>5&n)/n*255|0,c2=(o2>>11)/e*255|0,l2=i2*this.width*4+4*a2;this.data[l2]=c2,this.data[l2+1]=u2,this.data[l2+2]=s2,this.data[l2+3]=255}this.pos+=t2}},ce.prototype.bit24=function(){for(var t2=this.height-1;t2>=0;t2--){for(var e=this.bottom_up?t2:this.height-1-t2,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i2=this.datav.getUint8(this.pos++,!0),a2=this.datav.getUint8(this.pos++,!0),o2=e*this.width*4+4*n;this.data[o2]=a2,this.data[o2+1]=i2,this.data[o2+2]=r,this.data[o2+3]=255}this.pos+=this.width%4}},ce.prototype.bit32=function(){for(var t2=this.height-1;t2>=0;t2--)for(var e=this.bottom_up?t2:this.height-1-t2,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i2=this.datav.getUint8(this.pos++,!0),a2=this.datav.getUint8(this.pos++,!0),o2=this.datav.getUint8(this.pos++,!0),s2=e*this.width*4+4*n;this.data[s2]=a2,this.data[s2+1]=i2,this.data[s2+2]=r,this.data[s2+3]=o2}},ce.prototype.getData=function(){return this.data},(function(t2){t2.processBMP=function(e,n,r,i2){var a2=new ce(e,!1),o2=a2.width,s2=a2.height,u2={data:a2.getData(),width:o2,height:s2},c2=new ue(100).encode(u2,100);return t2.processJPEG.call(this,c2,n,r,i2)}})(E.API),le.prototype.getData=function(){return this.data},(function(t2){t2.processWEBP=function(e,n,r,i2){var a2=new le(e),o2=a2.width,s2=a2.height,u2={data:a2.getData(),width:o2,height:s2},c2=new ue(100).encode(u2,100);return t2.processJPEG.call(this,c2,n,r,i2)}})(E.API),E.API.processRGBA=function(t2,e,n){for(var r=t2.data,i2=r.length,a2=new Uint8Array(i2/4*3),o2=new Uint8Array(i2/4),s2=0,u2=0,c2=0;c2<i2;c2+=4){var l2=r[c2],h2=r[c2+1],f2=r[c2+2],d2=r[c2+3];a2[s2++]=l2,a2[s2++]=h2,a2[s2++]=f2,o2[u2++]=d2}var p2=this.__addimage__.arrayBufferToBinaryString(a2);return{alpha:this.__addimage__.arrayBufferToBinaryString(o2),data:p2,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t2.width,height:t2.height}},E.API.setLanguage=function(t2){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t2]!==void 0&&(this.internal.languageSettings.languageCode=t2,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Ht=E.API,Wt=Ht.getCharWidthsArray=function(e,n){var r,i2,a2=(n=n||{}).font||this.internal.getFont(),o2=n.fontSize||this.internal.getFontSize(),s2=n.charSpace||this.internal.getCharSpace(),u2=n.widths?n.widths:a2.metadata.Unicode.widths,c2=u2.fof?u2.fof:1,l2=n.kerning?n.kerning:a2.metadata.Unicode.kerning,h2=l2.fof?l2.fof:1,f2=n.doKerning!==!1,d2=0,p2=e.length,g2=0,m2=u2[0]||c2,v2=[];for(r=0;r<p2;r++)i2=e.charCodeAt(r),typeof a2.metadata.widthOfString=="function"?v2.push((a2.metadata.widthOfGlyph(a2.metadata.characterToGlyph(i2))+s2*(1e3/o2)||0)/1e3):(d2=f2&&_typeof(l2[i2])==="object"&&!isNaN(parseInt(l2[i2][g2],10))?l2[i2][g2]/h2:0,v2.push((u2[i2]||m2)/c2+d2)),g2=i2;return v2},Vt=Ht.getStringUnitWidth=function(t2,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),i2=e.charSpace||this.internal.getCharSpace();return Ht.processArabic&&(t2=Ht.processArabic(t2)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(t2,n,i2)/n:Wt.apply(this,arguments).reduce(function(t3,e2){return t3+e2},0)},Gt=function(t2,e,n,r){for(var i2=[],a2=0,o2=t2.length,s2=0;a2!==o2&&s2+e[a2]<n;)s2+=e[a2],a2++;i2.push(t2.slice(0,a2));var u2=a2;for(s2=0;a2!==o2;)s2+e[a2]>r&&(i2.push(t2.slice(u2,a2)),s2=0,u2=a2),s2+=e[a2],a2++;return u2!==a2&&i2.push(t2.slice(u2,a2)),i2},Yt=function(t2,e,n){n||(n={});var r,i2,a2,o2,s2,u2,c2,l2=[],h2=[l2],f2=n.textIndent||0,d2=0,p2=0,g2=t2.split(" "),m2=Wt.apply(this,[" ",n])[0];if(u2=n.lineIndent===-1?g2[0].length+2:n.lineIndent||0){var v2=Array(u2).join(" "),b2=[];g2.map(function(t3){(t3=t3.split(/\s*\n/)).length>1?b2=b2.concat(t3.map(function(t4,e2){return(e2&&t4.length?`
`:"")+t4})):b2.push(t3[0])}),g2=b2,u2=Vt.apply(this,[v2,n])}for(a2=0,o2=g2.length;a2<o2;a2++){var y2=0;if(r=g2[a2],u2&&r[0]==`
`&&(r=r.substr(1),y2=1),f2+d2+(p2=(i2=Wt.apply(this,[r,n])).reduce(function(t3,e2){return t3+e2},0))>e||y2){if(p2>e){for(s2=Gt.apply(this,[r,i2,e-(f2+d2),e]),l2.push(s2.shift()),l2=[s2.pop()];s2.length;)h2.push([s2.shift()]);p2=i2.slice(r.length-(l2[0]?l2[0].length:0)).reduce(function(t3,e2){return t3+e2},0)}else l2=[r];h2.push(l2),f2=p2+u2,d2=m2}else l2.push(r),f2+=d2+p2,d2=m2}return c2=u2?function(t3,e2){return(e2?v2:"")+t3.join(" ")}:function(t3){return t3.join(" ")},h2.map(c2)},Ht.splitTextToSize=function(t2,e,n){var r,i2=(n=n||{}).fontSize||this.internal.getFontSize(),a2=function(t3){if(t3.widths&&t3.kerning)return{widths:t3.widths,kerning:t3.kerning};var e2=this.internal.getFont(t3.fontName,t3.fontStyle),n2="Unicode";return e2.metadata[n2]?{widths:e2.metadata[n2].widths||{0:1},kerning:e2.metadata[n2].kerning||{}}:{font:e2.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,n);r=Array.isArray(t2)?t2:String(t2).split(/\r?\n/);var o2=1*this.internal.scaleFactor*e/i2;a2.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i2:0,a2.lineIndent=n.lineIndent;var s2,u2,c2=[];for(s2=0,u2=r.length;s2<u2;s2++)c2=c2.concat(Yt.apply(this,[r[s2],o2,a2]));return c2},(function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var n="0123456789abcdef",r="klmnopqrstuvwxyz",i2={},a2={},o2=0;o2<16;o2++)i2[r[o2]]=n[o2],a2[n[o2]]=r[o2];var s2=function(t2){return"0x"+parseInt(t2,10).toString(16)},u2=e.__fontmetrics__.compress=function(e2){var n2,r2,i3,o3,c3=["{"];for(var l3 in e2){if(n2=e2[l3],isNaN(parseInt(l3,10))?r2="'"+l3+"'":(l3=parseInt(l3,10),r2=(r2=s2(l3).slice(2)).slice(0,-1)+a2[r2.slice(-1)]),typeof n2=="number")n2<0?(i3=s2(n2).slice(3),o3="-"):(i3=s2(n2).slice(2),o3=""),i3=o3+i3.slice(0,-1)+a2[i3.slice(-1)];else{if(_typeof(n2)!=="object")throw new Error("Don't know what to do with value type "+_typeof(n2)+".");i3=u2(n2)}c3.push(r2+i3)}return c3.push("}"),c3.join("")},c2=e.__fontmetrics__.uncompress=function(t2){if(typeof t2!="string")throw new Error("Invalid argument passed to uncompress.");for(var e2,n2,r2,a3,o3={},s3=1,u3=o3,c3=[],l3="",h3="",f3=t2.length-1,d2=1;d2<f3;d2+=1)(a3=t2[d2])=="'"?e2?(r2=e2.join(""),e2=void 0):e2=[]:e2?e2.push(a3):a3=="{"?(c3.push([u3,r2]),u3={},r2=void 0):a3=="}"?((n2=c3.pop())[0][n2[1]]=u3,r2=void 0,u3=n2[0]):a3=="-"?s3=-1:r2===void 0?i2.hasOwnProperty(a3)?(l3+=i2[a3],r2=parseInt(l3,16)*s3,s3=1,l3=""):l3+=a3:i2.hasOwnProperty(a3)?(h3+=i2[a3],u3[r2]=parseInt(h3,16)*s3,s3=1,r2=void 0,h3=""):h3+=a3;return o3},l2={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c2("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h2={Unicode:{Courier:l2,"Courier-Bold":l2,"Courier-BoldOblique":l2,"Courier-Oblique":l2,Helvetica:l2,"Helvetica-Bold":l2,"Helvetica-BoldOblique":l2,"Helvetica-Oblique":l2,"Times-Roman":l2,"Times-Bold":l2,"Times-BoldItalic":l2,"Times-Italic":l2}},f2={Unicode:{"Courier-Oblique":c2("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c2("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c2("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c2("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c2("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c2("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c2("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c2("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c2("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c2("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c2("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c2("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c2("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c2("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(t2){var e2=t2.font,n2=f2.Unicode[e2.postScriptName];n2&&(e2.metadata.Unicode={},e2.metadata.Unicode.widths=n2.widths,e2.metadata.Unicode.kerning=n2.kerning);var r2=h2.Unicode[e2.postScriptName];r2&&(e2.metadata.Unicode.encoding=r2,e2.encoding=r2.codePages[0])}])})(E.API),(function(t2){var e=function(t3){for(var e2=t3.length,n=new Uint8Array(e2),r=0;r<e2;r++)n[r]=t3.charCodeAt(r);return n};t2.API.events.push(["addFont",function(n){var r=void 0,i2=n.font,a2=n.instance;if(!i2.isStandardFont){if(a2===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i2.postScriptName+"').");if(typeof(r=a2.existsFileInVFS(i2.postScriptName)===!1?a2.loadFile(i2.postScriptName):a2.getFileFromVFS(i2.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i2.postScriptName+"').");(function(n2,r2){r2=/^\x00\x01\x00\x00/.test(r2)?e(r2):e(f(r2)),n2.metadata=t2.API.TTFFont.open(r2),n2.metadata.Unicode=n2.metadata.Unicode||{encoding:{},kerning:{},widths:[]},n2.metadata.glyIdsUsed=[0]})(i2,r)}}])})(E),E.API.addSvgAsImage=function(t2,e,n,r,a2,s2,u2,c2){if(isNaN(e)||isNaN(n))throw o.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(a2))throw o.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var l2=document.createElement("canvas");l2.width=r,l2.height=a2;var h2=l2.getContext("2d");h2.fillStyle="#fff",h2.fillRect(0,0,l2.width,l2.height);var f2={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d2=this;return(i.canvg?Promise.resolve(i.canvg):__vitePreload(()=>import("./index.es.VyUtMH7_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33]),import.meta.url)).catch(function(t3){return Promise.reject(new Error("Could not load canvg: "+t3))}).then(function(t3){return t3.default?t3.default:t3}).then(function(e2){return e2.fromString(h2,t2,f2)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(t3){return t3.render(f2)}).then(function(){d2.addImage(l2.toDataURL("image/jpeg",1),e,n,r,a2,u2,c2)})},E.API.putTotalPages=function(t2){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t2,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t2,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i2=0;i2<this.internal.pages[r].length;i2++)this.internal.pages[r][i2]=this.internal.pages[r][i2].replace(e,n);return this},E.API.viewerPreferences=function(e,n){var r;e=e||{},n=n||!1;var i2,a2,o2,s2={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},u2=Object.keys(s2),c2=[],l2=0,h2=0,f2=0;function d2(t2,e2){var n2,r2=!1;for(n2=0;n2<t2.length;n2+=1)t2[n2]===e2&&(r2=!0);return r2}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s2)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||n===!0){var p2=u2.length;for(f2=0;f2<p2;f2+=1)r[u2[f2]].value=r[u2[f2]].defaultValue,r[u2[f2]].explicitSet=!1}if(_typeof(e)==="object"){for(a2 in e)if(o2=e[a2],d2(u2,a2)&&o2!==void 0){if(r[a2].type==="boolean"&&typeof o2=="boolean")r[a2].value=o2;else if(r[a2].type==="name"&&d2(r[a2].valueSet,o2))r[a2].value=o2;else if(r[a2].type==="integer"&&Number.isInteger(o2))r[a2].value=o2;else if(r[a2].type==="array"){for(l2=0;l2<o2.length;l2+=1)if(i2=!0,o2[l2].length===1&&typeof o2[l2][0]=="number")c2.push(String(o2[l2]-1));else if(o2[l2].length>1){for(h2=0;h2<o2[l2].length;h2+=1)typeof o2[l2][h2]!="number"&&(i2=!1);i2===!0&&c2.push([o2[l2][0]-1,o2[l2][1]-1].join(" "))}r[a2].value="["+c2.join(" ")+"]"}else r[a2].value=r[a2].defaultValue;r[a2].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var t2,e2=[];for(t2 in r)r[t2].explicitSet===!0&&(r[t2].type==="name"?e2.push("/"+t2+" /"+r[t2].value):e2.push("/"+t2+" "+r[t2].value));e2.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+e2.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t2){var e=function(){var t3='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',e2=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),n2=unescape(encodeURIComponent(t3)),r=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),i2=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),a2=unescape(encodeURIComponent("</x:xmpmeta>")),o2=n2.length+r.length+i2.length+e2.length+a2.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+o2+" >>"),this.internal.write("stream"),this.internal.write(e2+n2+r+i2+a2),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t2.addMetadata=function(t3,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:t3,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",e)),this}})(E.API),(function(t2){var e=t2.API,n=e.pdfEscape16=function(t3,e2){for(var n2,r2=e2.metadata.Unicode.widths,i3=["","0","00","000","0000"],a2=[""],o2=0,s2=t3.length;o2<s2;++o2){if(n2=e2.metadata.characterToGlyph(t3.charCodeAt(o2)),e2.metadata.glyIdsUsed.push(n2),e2.metadata.toUnicode[n2]=t3.charCodeAt(o2),r2.indexOf(n2)==-1&&(r2.push(n2),r2.push([parseInt(e2.metadata.widthOfGlyph(n2),10)])),n2=="0")return a2.join("");n2=n2.toString(16),a2.push(i3[4-n2.length],n2)}return a2.join("")},r=function(t3){var e2,n2,r2,i3,a2,o2,s2;for(a2=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,r2=[],o2=0,s2=(n2=Object.keys(t3).sort(function(t4,e3){return t4-e3})).length;o2<s2;o2++)e2=n2[o2],r2.length>=100&&(a2+=`
`+r2.length+` beginbfchar
`+r2.join(`
`)+`
endbfchar`,r2=[]),t3[e2]!==void 0&&t3[e2]!==null&&typeof t3[e2].toString=="function"&&(i3=("0000"+t3[e2].toString(16)).slice(-4),e2=("0000"+(+e2).toString(16)).slice(-4),r2.push("<"+e2+"><"+i3+">"));return r2.length&&(a2+=`
`+r2.length+` beginbfchar
`+r2.join(`
`)+`
endbfchar
`),a2+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(e2){(function(e3){var n2=e3.font,i3=e3.out,a2=e3.newObject,o2=e3.putStream;if(n2.metadata instanceof t2.API.TTFFont&&n2.encoding==="Identity-H"){for(var s2=n2.metadata.Unicode.widths,u2=n2.metadata.subset.encode(n2.metadata.glyIdsUsed,1),c2="",l2=0;l2<u2.length;l2++)c2+=String.fromCharCode(u2[l2]);var h2=a2();o2({data:c2,addLength1:!0,objectId:h2}),i3("endobj");var f2=a2();o2({data:r(n2.metadata.toUnicode),addLength1:!0,objectId:f2}),i3("endobj");var d2=a2();i3("<<"),i3("/Type /FontDescriptor"),i3("/FontName /"+j(n2.fontName)),i3("/FontFile2 "+h2+" 0 R"),i3("/FontBBox "+t2.API.PDFObject.convert(n2.metadata.bbox)),i3("/Flags "+n2.metadata.flags),i3("/StemV "+n2.metadata.stemV),i3("/ItalicAngle "+n2.metadata.italicAngle),i3("/Ascent "+n2.metadata.ascender),i3("/Descent "+n2.metadata.decender),i3("/CapHeight "+n2.metadata.capHeight),i3(">>"),i3("endobj");var p2=a2();i3("<<"),i3("/Type /Font"),i3("/BaseFont /"+j(n2.fontName)),i3("/FontDescriptor "+d2+" 0 R"),i3("/W "+t2.API.PDFObject.convert(s2)),i3("/CIDToGIDMap /Identity"),i3("/DW 1000"),i3("/Subtype /CIDFontType2"),i3("/CIDSystemInfo"),i3("<<"),i3("/Supplement 0"),i3("/Registry (Adobe)"),i3("/Ordering ("+n2.encoding+")"),i3(">>"),i3(">>"),i3("endobj"),n2.objectNumber=a2(),i3("<<"),i3("/Type /Font"),i3("/Subtype /Type0"),i3("/ToUnicode "+f2+" 0 R"),i3("/BaseFont /"+j(n2.fontName)),i3("/Encoding /"+n2.encoding),i3("/DescendantFonts ["+p2+" 0 R]"),i3(">>"),i3("endobj"),n2.isAlreadyPutted=!0}})(e2)}]),e.events.push(["putFont",function(e2){(function(e3){var n2=e3.font,i3=e3.out,a2=e3.newObject,o2=e3.putStream;if(n2.metadata instanceof t2.API.TTFFont&&n2.encoding==="WinAnsiEncoding"){for(var s2=n2.metadata.rawData,u2="",c2=0;c2<s2.length;c2++)u2+=String.fromCharCode(s2[c2]);var l2=a2();o2({data:u2,addLength1:!0,objectId:l2}),i3("endobj");var h2=a2();o2({data:r(n2.metadata.toUnicode),addLength1:!0,objectId:h2}),i3("endobj");var f2=a2();i3("<<"),i3("/Descent "+n2.metadata.decender),i3("/CapHeight "+n2.metadata.capHeight),i3("/StemV "+n2.metadata.stemV),i3("/Type /FontDescriptor"),i3("/FontFile2 "+l2+" 0 R"),i3("/Flags 96"),i3("/FontBBox "+t2.API.PDFObject.convert(n2.metadata.bbox)),i3("/FontName /"+j(n2.fontName)),i3("/ItalicAngle "+n2.metadata.italicAngle),i3("/Ascent "+n2.metadata.ascender),i3(">>"),i3("endobj"),n2.objectNumber=a2();for(var d2=0;d2<n2.metadata.hmtx.widths.length;d2++)n2.metadata.hmtx.widths[d2]=parseInt(n2.metadata.hmtx.widths[d2]*(1e3/n2.metadata.head.unitsPerEm));i3("<</Subtype/TrueType/Type/Font/ToUnicode "+h2+" 0 R/BaseFont/"+j(n2.fontName)+"/FontDescriptor "+f2+" 0 R/Encoding/"+n2.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t2.API.PDFObject.convert(n2.metadata.hmtx.widths)+">>"),i3("endobj"),n2.isAlreadyPutted=!0}})(e2)}]);var i2=function(t3){var e2,r2=t3.text||"",i3=t3.x,a2=t3.y,o2=t3.options||{},s2=t3.mutex||{},u2=s2.pdfEscape,c2=s2.activeFontKey,l2=s2.fonts,h2=c2,f2="",d2=0,p2="",g2=l2[h2].encoding;if(l2[h2].encoding!=="Identity-H")return{text:r2,x:i3,y:a2,options:o2,mutex:s2};for(p2=r2,h2=c2,Array.isArray(r2)&&(p2=r2[0]),d2=0;d2<p2.length;d2+=1)l2[h2].metadata.hasOwnProperty("cmap")&&(e2=l2[h2].metadata.cmap.unicode.codeMap[p2[d2].charCodeAt(0)]),e2||p2[d2].charCodeAt(0)<256&&l2[h2].metadata.hasOwnProperty("Unicode")?f2+=p2[d2]:f2+="";var m2="";return parseInt(h2.slice(1))<14||g2==="WinAnsiEncoding"?m2=u2(f2,h2).split("").map(function(t4){return t4.charCodeAt(0).toString(16)}).join(""):g2==="Identity-H"&&(m2=n(f2,l2[h2])),s2.isHex=!0,{text:m2,x:i3,y:a2,options:o2,mutex:s2}};e.events.push(["postProcessText",function(t3){var e2=t3.text||"",n2=[],r2={text:e2,x:t3.x,y:t3.y,options:t3.options,mutex:t3.mutex};if(Array.isArray(e2)){var a2=0;for(a2=0;a2<e2.length;a2+=1)Array.isArray(e2[a2])&&e2[a2].length===3?n2.push([i2(Object.assign({},r2,{text:e2[a2][0]})).text,e2[a2][1],e2[a2][2]]):n2.push(i2(Object.assign({},r2,{text:e2[a2]})).text);t3.text=n2}else t3.text=i2(Object.assign({},r2,{text:e2})).text}])})(E),(function(t2){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t2.existsFileInVFS=function(t3){return e.call(this),this.internal.vFS[t3]!==void 0},t2.addFileToVFS=function(t3,n){return e.call(this),this.internal.vFS[t3]=n,this},t2.getFileFromVFS=function(t3){return e.call(this),this.internal.vFS[t3]!==void 0?this.internal.vFS[t3]:null}})(E.API),(function(t2){t2.__bidiEngine__=t2.prototype.__bidiEngine__=function(t3){var n2,r,i2,a2,o2,s2,u2,c2=e,l2=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h2=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],f2={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},d2={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},p2=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],g2=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),m2=!1,v2=0;this.__bidiEngine__={};var b2=function(t4){var e2=t4.charCodeAt(),n3=e2>>8,r2=d2[n3];return r2!==void 0?c2[256*r2+(255&e2)]:n3===252||n3===253?"AL":g2.test(n3)?"L":n3===8?"R":"N"},y2=function(t4){for(var e2,n3=0;n3<t4.length;n3++){if((e2=b2(t4.charAt(n3)))==="L")return!1;if(e2==="R")return!0}return!1},w2=function(t4,e2,o3,s3){var u3,c3,l3,h3,f3=e2[s3];switch(f3){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":m2=!1;break;case"N":case"AN":break;case"EN":m2&&(f3="AN");break;case"AL":m2=!0,f3="R";break;case"WS":case"BN":f3="N";break;case"CS":s3<1||s3+1>=e2.length||(u3=o3[s3-1])!=="EN"&&u3!=="AN"||(c3=e2[s3+1])!=="EN"&&c3!=="AN"?f3="N":m2&&(c3="AN"),f3=c3===u3?c3:"N";break;case"ES":f3=(u3=s3>0?o3[s3-1]:"B")==="EN"&&s3+1<e2.length&&e2[s3+1]==="EN"?"EN":"N";break;case"ET":if(s3>0&&o3[s3-1]==="EN"){f3="EN";break}if(m2){f3="N";break}for(l3=s3+1,h3=e2.length;l3<h3&&e2[l3]==="ET";)l3++;f3=l3<h3&&e2[l3]==="EN"?"EN":"N";break;case"NSM":if(i2&&!a2){for(h3=e2.length,l3=s3+1;l3<h3&&e2[l3]==="NSM";)l3++;if(l3<h3){var d3=t4[s3],p3=d3>=1425&&d3<=2303||d3===64286;if(u3=e2[l3],p3&&(u3==="R"||u3==="AL")){f3="R";break}}}f3=s3<1||(u3=e2[s3-1])==="B"?"N":o3[s3-1];break;case"B":m2=!1,n2=!0,f3=v2;break;case"S":r=!0,f3="N"}return f3},N2=function(t4,e2,n3){var r2=t4.split("");return n3&&L2(r2,n3,{hiLevel:v2}),r2.reverse(),e2&&e2.reverse(),r2.join("")},L2=function(t4,e2,i3){var a3,o3,s3,u3,c3,d3=-1,p3=t4.length,g3=0,y3=[],N3=v2?h2:l2,L3=[];for(m2=!1,n2=!1,r=!1,o3=0;o3<p3;o3++)L3[o3]=b2(t4[o3]);for(s3=0;s3<p3;s3++){if(c3=g3,y3[s3]=w2(t4,L3,y3,s3),a3=240&(g3=N3[c3][f2[y3[s3]]]),g3&=15,e2[s3]=u3=N3[g3][5],a3>0)if(a3===16){for(o3=d3;o3<s3;o3++)e2[o3]=1;d3=-1}else d3=-1;if(N3[g3][6])d3===-1&&(d3=s3);else if(d3>-1){for(o3=d3;o3<s3;o3++)e2[o3]=u3;d3=-1}L3[s3]==="B"&&(e2[s3]=0),i3.hiLevel|=u3}r&&(function(t5,e3,n3){for(var r2=0;r2<n3;r2++)if(t5[r2]==="S"){e3[r2]=v2;for(var i4=r2-1;i4>=0&&t5[i4]==="WS";i4--)e3[i4]=v2}})(L3,e2,p3)},x2=function(t4,e2,r2,i3,a3){if(!(a3.hiLevel<t4)){if(t4===1&&v2===1&&!n2)return e2.reverse(),void(r2&&r2.reverse());for(var o3,s3,u3,c3,l3=e2.length,h3=0;h3<l3;){if(i3[h3]>=t4){for(u3=h3+1;u3<l3&&i3[u3]>=t4;)u3++;for(c3=h3,s3=u3-1;c3<s3;c3++,s3--)o3=e2[c3],e2[c3]=e2[s3],e2[s3]=o3,r2&&(o3=r2[c3],r2[c3]=r2[s3],r2[s3]=o3);h3=u3}h3++}}},A2=function(t4,e2,n3){var r2=t4.split(""),i3={hiLevel:v2};return n3||(n3=[]),L2(r2,n3,i3),(function(t5,e3,n4){if(n4.hiLevel!==0&&u2)for(var r3,i4=0;i4<t5.length;i4++)e3[i4]===1&&(r3=p2.indexOf(t5[i4]))>=0&&(t5[i4]=p2[r3+1])})(r2,n3,i3),x2(2,r2,e2,n3,i3),x2(1,r2,e2,n3,i3),r2.join("")};return this.__bidiEngine__.doBidiReorder=function(t4,e2,n3){if((function(t5,e3){if(e3)for(var n4=0;n4<t5.length;n4++)e3[n4]=n4;a2===void 0&&(a2=y2(t5)),s2===void 0&&(s2=y2(t5))})(t4,e2),i2||!o2||s2)if(i2&&o2&&a2^s2)v2=a2?1:0,t4=N2(t4,e2,n3);else if(!i2&&o2&&s2)v2=a2?1:0,t4=A2(t4,e2,n3),t4=N2(t4,e2);else if(!i2||a2||o2||s2){if(i2&&!o2&&a2^s2)t4=N2(t4,e2),a2?(v2=0,t4=A2(t4,e2,n3)):(v2=1,t4=A2(t4,e2,n3),t4=N2(t4,e2));else if(i2&&a2&&!o2&&s2)v2=1,t4=A2(t4,e2,n3),t4=N2(t4,e2);else if(!i2&&!o2&&a2^s2){var r2=u2;a2?(v2=1,t4=A2(t4,e2,n3),v2=0,u2=!1,t4=A2(t4,e2,n3),u2=r2):(v2=0,t4=A2(t4,e2,n3),t4=N2(t4,e2),v2=1,u2=!1,t4=A2(t4,e2,n3),u2=r2,t4=N2(t4,e2))}}else v2=0,t4=A2(t4,e2,n3);else v2=a2?1:0,t4=A2(t4,e2,n3);return t4},this.__bidiEngine__.setOptions=function(t4){t4&&(i2=t4.isInputVisual,o2=t4.isOutputVisual,a2=t4.isInputRtl,s2=t4.isOutputRtl,u2=t4.isSymmetricSwapping)},this.__bidiEngine__.setOptions(t3),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t2.__bidiEngine__({isInputVisual:!0});t2.API.events.push(["postProcessText",function(t3){var e2=t3.text;t3.x,t3.y;var r=t3.options||{};t3.mutex,r.lang;var i2=[];if(r.isInputVisual=typeof r.isInputVisual!="boolean"||r.isInputVisual,n.setOptions(r),Object.prototype.toString.call(e2)==="[object Array]"){var a2=0;for(i2=[],a2=0;a2<e2.length;a2+=1)Object.prototype.toString.call(e2[a2])==="[object Array]"?i2.push([n.doBidiReorder(e2[a2][0]),e2[a2][1],e2[a2][2]]):i2.push([n.doBidiReorder(e2[a2])]);t3.text=i2}else t3.text=n.doBidiReorder(e2);n.setOptions({isInputVisual:!0})}])})(E),E.API.TTFFont=(function(){function t2(t3){var e;if(this.rawData=t3,e=this.contents=new fe(t3),this.contents.pos=4,e.readString(4)==="ttcf")throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new je(this),this.registerTTF()}return t2.open=function(e){return new t2(e)},t2.prototype.parse=function(){return this.directory=new de(this.contents),this.head=new me(this),this.name=new xe(this),this.cmap=new be(this),this.toUnicode={},this.hhea=new ye(this),this.maxp=new Ae(this),this.hmtx=new Se(this),this.post=new Ne(this),this.os2=new we(this),this.loca=new Ie(this),this.glyf=new Pe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t2.prototype.registerTTF=function(){var t3,e,n,r,i2;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var e2,n2,r2,i3;for(i3=[],e2=0,n2=(r2=this.bbox).length;e2<n2;e2++)t3=r2[e2],i3.push(Math.round(t3*this.scaleFactor));return i3}.call(this),this.stemV=0,this.post.exists?(n=255&(r=this.post.italic_angle),32768&(e=r>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i2=this.familyClass)===1||i2===2||i2===3||i2===4||i2===5||i2===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t2.prototype.characterToGlyph=function(t3){var e;return((e=this.cmap.unicode)!=null?e.codeMap[t3]:void 0)||0},t2.prototype.widthOfGlyph=function(t3){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t3).advance*e},t2.prototype.widthOfString=function(t3,e,n){var r,i2,a2,o2;for(a2=0,i2=0,o2=(t3=""+t3).length;0<=o2?i2<o2:i2>o2;i2=0<=o2?++i2:--i2)r=t3.charCodeAt(i2),a2+=this.widthOfGlyph(this.characterToGlyph(r))+n*(1e3/e)||0;return a2*(e/1e3)},t2.prototype.lineHeight=function(t3,e){var n;return e==null&&(e=!1),n=e?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t3},t2})();var he,fe=(function(){function t2(t3){this.data=t3??[],this.pos=0,this.length=this.data.length}return t2.prototype.readByte=function(){return this.data[this.pos++]},t2.prototype.writeByte=function(t3){return this.data[this.pos++]=t3},t2.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t2.prototype.writeUInt32=function(t3){return this.writeByte(t3>>>24&255),this.writeByte(t3>>16&255),this.writeByte(t3>>8&255),this.writeByte(255&t3)},t2.prototype.readInt32=function(){var t3;return(t3=this.readUInt32())>=2147483648?t3-4294967296:t3},t2.prototype.writeInt32=function(t3){return t3<0&&(t3+=4294967296),this.writeUInt32(t3)},t2.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t2.prototype.writeUInt16=function(t3){return this.writeByte(t3>>8&255),this.writeByte(255&t3)},t2.prototype.readInt16=function(){var t3;return(t3=this.readUInt16())>=32768?t3-65536:t3},t2.prototype.writeInt16=function(t3){return t3<0&&(t3+=65536),this.writeUInt16(t3)},t2.prototype.readString=function(t3){var e,n;for(n=[],e=0;0<=t3?e<t3:e>t3;e=0<=t3?++e:--e)n[e]=String.fromCharCode(this.readByte());return n.join("")},t2.prototype.writeString=function(t3){var e,n,r;for(r=[],e=0,n=t3.length;0<=n?e<n:e>n;e=0<=n?++e:--e)r.push(this.writeByte(t3.charCodeAt(e)));return r},t2.prototype.readShort=function(){return this.readInt16()},t2.prototype.writeShort=function(t3){return this.writeInt16(t3)},t2.prototype.readLongLong=function(){var t3,e,n,r,i2,a2,o2,s2;return t3=this.readByte(),e=this.readByte(),n=this.readByte(),r=this.readByte(),i2=this.readByte(),a2=this.readByte(),o2=this.readByte(),s2=this.readByte(),128&t3?-1*(72057594037927940*(255^t3)+281474976710656*(255^e)+1099511627776*(255^n)+4294967296*(255^r)+16777216*(255^i2)+65536*(255^a2)+256*(255^o2)+(255^s2)+1):72057594037927940*t3+281474976710656*e+1099511627776*n+4294967296*r+16777216*i2+65536*a2+256*o2+s2},t2.prototype.writeLongLong=function(t3){var e,n;return e=Math.floor(t3/4294967296),n=4294967295&t3,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t2.prototype.readInt=function(){return this.readInt32()},t2.prototype.writeInt=function(t3){return this.writeInt32(t3)},t2.prototype.read=function(t3){var e,n;for(e=[],n=0;0<=t3?n<t3:n>t3;n=0<=t3?++n:--n)e.push(this.readByte());return e},t2.prototype.write=function(t3){var e,n,r,i2;for(i2=[],n=0,r=t3.length;n<r;n++)e=t3[n],i2.push(this.writeByte(e));return i2},t2})(),de=(function(){var t2;function e(t3){var e2,n,r;for(this.scalarType=t3.readInt(),this.tableCount=t3.readShort(),this.searchRange=t3.readShort(),this.entrySelector=t3.readShort(),this.rangeShift=t3.readShort(),this.tables={},n=0,r=this.tableCount;0<=r?n<r:n>r;n=0<=r?++n:--n)e2={tag:t3.readString(4),checksum:t3.readInt(),offset:t3.readInt(),length:t3.readInt()},this.tables[e2.tag]=e2}return e.prototype.encode=function(e2){var n,r,i2,a2,o2,s2,u2,c2,l2,h2,f2,d2,p2;for(p2 in f2=Object.keys(e2).length,s2=Math.log(2),l2=16*Math.floor(Math.log(f2)/s2),a2=Math.floor(l2/s2),c2=16*f2-l2,(r=new fe).writeInt(this.scalarType),r.writeShort(f2),r.writeShort(l2),r.writeShort(a2),r.writeShort(c2),i2=16*f2,u2=r.pos+i2,o2=null,d2=[],e2)for(h2=e2[p2],r.writeString(p2),r.writeInt(t2(h2)),r.writeInt(u2),r.writeInt(h2.length),d2=d2.concat(h2),p2==="head"&&(o2=u2),u2+=h2.length;u2%4;)d2.push(0),u2++;return r.write(d2),n=2981146554-t2(r.data),r.pos=o2+8,r.writeUInt32(n),r.data},t2=function(t3){var e2,n,r,i2;for(t3=_e.call(t3);t3.length%4;)t3.push(0);for(r=new fe(t3),n=0,e2=0,i2=t3.length;e2<i2;e2=e2+=4)n+=r.readUInt32();return 4294967295&n},e})(),pe={}.hasOwnProperty,ge=function(t2,e){for(var n in e)pe.call(e,n)&&(t2[n]=e[n]);function r(){this.constructor=t2}return r.prototype=e.prototype,t2.prototype=new r,t2.__super__=e.prototype,t2};he=(function(){function t2(t3){var e;this.file=t3,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return t2.prototype.parse=function(){},t2.prototype.encode=function(){},t2.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t2})();var me=(function(){function t2(){return t2.__super__.constructor.apply(this,arguments)}return ge(t2,he),t2.prototype.tag="head",t2.prototype.parse=function(t3){return t3.pos=this.offset,this.version=t3.readInt(),this.revision=t3.readInt(),this.checkSumAdjustment=t3.readInt(),this.magicNumber=t3.readInt(),this.flags=t3.readShort(),this.unitsPerEm=t3.readShort(),this.created=t3.readLongLong(),this.modified=t3.readLongLong(),this.xMin=t3.readShort(),this.yMin=t3.readShort(),this.xMax=t3.readShort(),this.yMax=t3.readShort(),this.macStyle=t3.readShort(),this.lowestRecPPEM=t3.readShort(),this.fontDirectionHint=t3.readShort(),this.indexToLocFormat=t3.readShort(),this.glyphDataFormat=t3.readShort()},t2.prototype.encode=function(t3){var e;return(e=new fe).writeInt(this.version),e.writeInt(this.revision),e.writeInt(this.checkSumAdjustment),e.writeInt(this.magicNumber),e.writeShort(this.flags),e.writeShort(this.unitsPerEm),e.writeLongLong(this.created),e.writeLongLong(this.modified),e.writeShort(this.xMin),e.writeShort(this.yMin),e.writeShort(this.xMax),e.writeShort(this.yMax),e.writeShort(this.macStyle),e.writeShort(this.lowestRecPPEM),e.writeShort(this.fontDirectionHint),e.writeShort(t3),e.writeShort(this.glyphDataFormat),e.data},t2})(),ve=(function(){function t2(t3,e){var n,r,i2,a2,o2,s2,u2,c2,l2,h2,f2,d2,p2,g2,m2,v2,b2;switch(this.platformID=t3.readUInt16(),this.encodingID=t3.readShort(),this.offset=e+t3.readInt(),l2=t3.pos,t3.pos=this.offset,this.format=t3.readUInt16(),this.length=t3.readUInt16(),this.language=t3.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(s2=0;s2<256;++s2)this.codeMap[s2]=t3.readByte();break;case 4:for(f2=t3.readUInt16(),h2=f2/2,t3.pos+=6,i2=(function(){var e2,n2;for(n2=[],s2=e2=0;0<=h2?e2<h2:e2>h2;s2=0<=h2?++e2:--e2)n2.push(t3.readUInt16());return n2})(),t3.pos+=2,p2=(function(){var e2,n2;for(n2=[],s2=e2=0;0<=h2?e2<h2:e2>h2;s2=0<=h2?++e2:--e2)n2.push(t3.readUInt16());return n2})(),u2=(function(){var e2,n2;for(n2=[],s2=e2=0;0<=h2?e2<h2:e2>h2;s2=0<=h2?++e2:--e2)n2.push(t3.readUInt16());return n2})(),c2=(function(){var e2,n2;for(n2=[],s2=e2=0;0<=h2?e2<h2:e2>h2;s2=0<=h2?++e2:--e2)n2.push(t3.readUInt16());return n2})(),r=(this.length-t3.pos+this.offset)/2,o2=(function(){var e2,n2;for(n2=[],s2=e2=0;0<=r?e2<r:e2>r;s2=0<=r?++e2:--e2)n2.push(t3.readUInt16());return n2})(),s2=m2=0,b2=i2.length;m2<b2;s2=++m2)for(g2=i2[s2],n=v2=d2=p2[s2];d2<=g2?v2<=g2:v2>=g2;n=d2<=g2?++v2:--v2)c2[s2]===0?a2=n+u2[s2]:(a2=o2[c2[s2]/2+(n-d2)-(h2-s2)]||0)!==0&&(a2+=u2[s2]),this.codeMap[n]=65535&a2}t3.pos=l2}return t2.encode=function(t3,e){var n,r,i2,a2,o2,s2,u2,c2,l2,h2,f2,d2,p2,g2,m2,v2,b2,y2,w2,N2,L2,x2,A2,S2,_2,P2,k2,F2,I2,j2,C2,O2,B2,M2,q2,E2,R2,D2,T2,z2,U2,H2,W2,V2,G2,Y2;switch(F2=new fe,a2=Object.keys(t3).sort(function(t4,e2){return t4-e2}),e){case"macroman":for(p2=0,g2=(function(){var t4=[];for(d2=0;d2<256;++d2)t4.push(0);return t4})(),v2={0:0},i2={},I2=0,B2=a2.length;I2<B2;I2++)v2[W2=t3[r=a2[I2]]]==null&&(v2[W2]=++p2),i2[r]={old:t3[r],new:v2[t3[r]]},g2[r]=v2[t3[r]];return F2.writeUInt16(1),F2.writeUInt16(0),F2.writeUInt32(12),F2.writeUInt16(0),F2.writeUInt16(262),F2.writeUInt16(0),F2.write(g2),{charMap:i2,subtable:F2.data,maxGlyphID:p2+1};case"unicode":for(P2=[],l2=[],b2=0,v2={},n={},m2=u2=null,j2=0,M2=a2.length;j2<M2;j2++)v2[w2=t3[r=a2[j2]]]==null&&(v2[w2]=++b2),n[r]={old:w2,new:v2[w2]},o2=v2[w2]-r,m2!=null&&o2===u2||(m2&&l2.push(m2),P2.push(r),u2=o2),m2=r;for(m2&&l2.push(m2),l2.push(65535),P2.push(65535),S2=2*(A2=P2.length),x2=2*Math.pow(Math.log(A2)/Math.LN2,2),h2=Math.log(x2/2)/Math.LN2,L2=2*A2-x2,s2=[],N2=[],f2=[],d2=C2=0,q2=P2.length;C2<q2;d2=++C2){if(_2=P2[d2],c2=l2[d2],_2===65535){s2.push(0),N2.push(0);break}if(_2-(k2=n[_2].new)>=32768)for(s2.push(0),N2.push(2*(f2.length+A2-d2)),r=O2=_2;_2<=c2?O2<=c2:O2>=c2;r=_2<=c2?++O2:--O2)f2.push(n[r].new);else s2.push(k2-_2),N2.push(0)}for(F2.writeUInt16(3),F2.writeUInt16(1),F2.writeUInt32(12),F2.writeUInt16(4),F2.writeUInt16(16+8*A2+2*f2.length),F2.writeUInt16(0),F2.writeUInt16(S2),F2.writeUInt16(x2),F2.writeUInt16(h2),F2.writeUInt16(L2),U2=0,E2=l2.length;U2<E2;U2++)r=l2[U2],F2.writeUInt16(r);for(F2.writeUInt16(0),H2=0,R2=P2.length;H2<R2;H2++)r=P2[H2],F2.writeUInt16(r);for(V2=0,D2=s2.length;V2<D2;V2++)o2=s2[V2],F2.writeUInt16(o2);for(G2=0,T2=N2.length;G2<T2;G2++)y2=N2[G2],F2.writeUInt16(y2);for(Y2=0,z2=f2.length;Y2<z2;Y2++)p2=f2[Y2],F2.writeUInt16(p2);return{charMap:n,subtable:F2.data,maxGlyphID:b2+1}}},t2})(),be=(function(){function t2(){return t2.__super__.constructor.apply(this,arguments)}return ge(t2,he),t2.prototype.tag="cmap",t2.prototype.parse=function(t3){var e,n,r;for(t3.pos=this.offset,this.version=t3.readUInt16(),r=t3.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)e=new ve(t3,this.offset),this.tables.push(e),e.isUnicode&&this.unicode==null&&(this.unicode=e);return!0},t2.encode=function(t3,e){var n,r;return e==null&&(e="macroman"),n=ve.encode(t3,e),(r=new fe).writeUInt16(0),r.writeUInt16(1),n.table=r.data.concat(n.subtable),n},t2})(),ye=(function(){function t2(){return t2.__super__.constructor.apply(this,arguments)}return ge(t2,he),t2.prototype.tag="hhea",t2.prototype.parse=function(t3){return t3.pos=this.offset,this.version=t3.readInt(),this.ascender=t3.readShort(),this.decender=t3.readShort(),this.lineGap=t3.readShort(),this.advanceWidthMax=t3.readShort(),this.minLeftSideBearing=t3.readShort(),this.minRightSideBearing=t3.readShort(),this.xMaxExtent=t3.readShort(),this.caretSlopeRise=t3.readShort(),this.caretSlopeRun=t3.readShort(),this.caretOffset=t3.readShort(),t3.pos+=8,this.metricDataFormat=t3.readShort(),this.numberOfMetrics=t3.readUInt16()},t2})(),we=(function(){function t2(){return t2.__super__.constructor.apply(this,arguments)}return ge(t2,he),t2.prototype.tag="OS/2",t2.prototype.parse=function(t3){if(t3.pos=this.offset,this.version=t3.readUInt16(),this.averageCharWidth=t3.readShort(),this.weightClass=t3.readUInt16(),this.widthClass=t3.readUInt16(),this.type=t3.readShort(),this.ySubscriptXSize=t3.readShort(),this.ySubscriptYSize=t3.readShort(),this.ySubscriptXOffset=t3.readShort(),this.ySubscriptYOffset=t3.readShort(),this.ySuperscriptXSize=t3.readShort(),this.ySuperscriptYSize=t3.readShort(),this.ySuperscriptXOffset=t3.readShort(),this.ySuperscriptYOffset=t3.readShort(),this.yStrikeoutSize=t3.readShort(),this.yStrikeoutPosition=t3.readShort(),this.familyClass=t3.readShort(),this.panose=(function(){var e,n;for(n=[],e=0;e<10;++e)n.push(t3.readByte());return n})(),this.charRange=(function(){var e,n;for(n=[],e=0;e<4;++e)n.push(t3.readInt());return n})(),this.vendorID=t3.readString(4),this.selection=t3.readShort(),this.firstCharIndex=t3.readShort(),this.lastCharIndex=t3.readShort(),this.version>0&&(this.ascent=t3.readShort(),this.descent=t3.readShort(),this.lineGap=t3.readShort(),this.winAscent=t3.readShort(),this.winDescent=t3.readShort(),this.codePageRange=(function(){var e,n;for(n=[],e=0;e<2;e=++e)n.push(t3.readInt());return n})(),this.version>1))return this.xHeight=t3.readShort(),this.capHeight=t3.readShort(),this.defaultChar=t3.readShort(),this.breakChar=t3.readShort(),this.maxContext=t3.readShort()},t2})(),Ne=(function(){function t2(){return t2.__super__.constructor.apply(this,arguments)}return ge(t2,he),t2.prototype.tag="post",t2.prototype.parse=function(t3){var e,n,r;switch(t3.pos=this.offset,this.format=t3.readInt(),this.italicAngle=t3.readInt(),this.underlinePosition=t3.readShort(),this.underlineThickness=t3.readShort(),this.isFixedPitch=t3.readInt(),this.minMemType42=t3.readInt(),this.maxMemType42=t3.readInt(),this.minMemType1=t3.readInt(),this.maxMemType1=t3.readInt(),this.format){case 65536:case 196608:break;case 131072:var i2;for(n=t3.readUInt16(),this.glyphNameIndex=[],i2=0;0<=n?i2<n:i2>n;i2=0<=n?++i2:--i2)this.glyphNameIndex.push(t3.readUInt16());for(this.names=[],r=[];t3.pos<this.offset+this.length;)e=t3.readByte(),r.push(this.names.push(t3.readString(e)));return r;case 151552:return n=t3.readUInt16(),this.offsets=t3.read(n);case 262144:return this.map=function(){var e2,n2,r2;for(r2=[],i2=e2=0,n2=this.file.maxp.numGlyphs;0<=n2?e2<n2:e2>n2;i2=0<=n2?++e2:--e2)r2.push(t3.readUInt32());return r2}.call(this)}},t2})(),Le=function(t2,e){this.raw=t2,this.length=t2.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},xe=(function(){function t2(){return t2.__super__.constructor.apply(this,arguments)}return ge(t2,he),t2.prototype.tag="name",t2.prototype.parse=function(t3){var e,n,r,i2,a2,o2,s2,u2,c2,l2,h2;for(t3.pos=this.offset,t3.readShort(),e=t3.readShort(),o2=t3.readShort(),n=[],i2=0;0<=e?i2<e:i2>e;i2=0<=e?++i2:--i2)n.push({platformID:t3.readShort(),encodingID:t3.readShort(),languageID:t3.readShort(),nameID:t3.readShort(),length:t3.readShort(),offset:this.offset+o2+t3.readShort()});for(s2={},i2=c2=0,l2=n.length;c2<l2;i2=++c2)r=n[i2],t3.pos=r.offset,u2=t3.readString(r.length),a2=new Le(u2,r),s2[h2=r.nameID]==null&&(s2[h2]=[]),s2[r.nameID].push(a2);this.strings=s2,this.copyright=s2[0],this.fontFamily=s2[1],this.fontSubfamily=s2[2],this.uniqueSubfamily=s2[3],this.fontName=s2[4],this.version=s2[5];try{this.postscriptName=s2[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=s2[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=s2[7],this.manufacturer=s2[8],this.designer=s2[9],this.description=s2[10],this.vendorUrl=s2[11],this.designerUrl=s2[12],this.license=s2[13],this.licenseUrl=s2[14],this.preferredFamily=s2[15],this.preferredSubfamily=s2[17],this.compatibleFull=s2[18],this.sampleText=s2[19]},t2})(),Ae=(function(){function t2(){return t2.__super__.constructor.apply(this,arguments)}return ge(t2,he),t2.prototype.tag="maxp",t2.prototype.parse=function(t3){return t3.pos=this.offset,this.version=t3.readInt(),this.numGlyphs=t3.readUInt16(),this.maxPoints=t3.readUInt16(),this.maxContours=t3.readUInt16(),this.maxCompositePoints=t3.readUInt16(),this.maxComponentContours=t3.readUInt16(),this.maxZones=t3.readUInt16(),this.maxTwilightPoints=t3.readUInt16(),this.maxStorage=t3.readUInt16(),this.maxFunctionDefs=t3.readUInt16(),this.maxInstructionDefs=t3.readUInt16(),this.maxStackElements=t3.readUInt16(),this.maxSizeOfInstructions=t3.readUInt16(),this.maxComponentElements=t3.readUInt16(),this.maxComponentDepth=t3.readUInt16()},t2})(),Se=(function(){function t2(){return t2.__super__.constructor.apply(this,arguments)}return ge(t2,he),t2.prototype.tag="hmtx",t2.prototype.parse=function(t3){var e,n,r,i2,a2,o2,s2;for(t3.pos=this.offset,this.metrics=[],e=0,o2=this.file.hhea.numberOfMetrics;0<=o2?e<o2:e>o2;e=0<=o2?++e:--e)this.metrics.push({advance:t3.readUInt16(),lsb:t3.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var n2,i3;for(i3=[],e=n2=0;0<=r?n2<r:n2>r;e=0<=r?++n2:--n2)i3.push(t3.readInt16());return i3})(),this.widths=function(){var t4,e2,n2,r2;for(r2=[],t4=0,e2=(n2=this.metrics).length;t4<e2;t4++)i2=n2[t4],r2.push(i2.advance);return r2}.call(this),n=this.widths[this.widths.length-1],s2=[],e=a2=0;0<=r?a2<r:a2>r;e=0<=r?++a2:--a2)s2.push(this.widths.push(n));return s2},t2.prototype.forGlyph=function(t3){return t3 in this.metrics?this.metrics[t3]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t3-this.metrics.length]}},t2})(),_e=[].slice,Pe=(function(){function t2(){return t2.__super__.constructor.apply(this,arguments)}return ge(t2,he),t2.prototype.tag="glyf",t2.prototype.parse=function(){return this.cache={}},t2.prototype.glyphFor=function(t3){var e,n,r,i2,a2,o2,s2,u2,c2,l2;return t3 in this.cache?this.cache[t3]:(i2=this.file.loca,e=this.file.contents,n=i2.indexOf(t3),(r=i2.lengthOf(t3))===0?this.cache[t3]=null:(e.pos=this.offset+n,a2=(o2=new fe(e.read(r))).readShort(),u2=o2.readShort(),l2=o2.readShort(),s2=o2.readShort(),c2=o2.readShort(),this.cache[t3]=a2===-1?new Fe(o2,u2,l2,s2,c2):new ke(o2,a2,u2,l2,s2,c2),this.cache[t3]))},t2.prototype.encode=function(t3,e,n){var r,i2,a2,o2,s2;for(a2=[],i2=[],o2=0,s2=e.length;o2<s2;o2++)r=t3[e[o2]],i2.push(a2.length),r&&(a2=a2.concat(r.encode(n)));return i2.push(a2.length),{table:a2,offsets:i2}},t2})(),ke=(function(){function t2(t3,e,n,r,i2,a2){this.raw=t3,this.numberOfContours=e,this.xMin=n,this.yMin=r,this.xMax=i2,this.yMax=a2,this.compound=!1}return t2.prototype.encode=function(){return this.raw.data},t2})(),Fe=(function(){function t2(t3,e,n,r,i2){var a2,o2;for(this.raw=t3,this.xMin=e,this.yMin=n,this.xMax=r,this.yMax=i2,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a2=this.raw;o2=a2.readShort(),this.glyphOffsets.push(a2.pos),this.glyphIDs.push(a2.readUInt16()),32&o2;)a2.pos+=1&o2?4:2,128&o2?a2.pos+=8:64&o2?a2.pos+=4:8&o2&&(a2.pos+=2)}return t2.prototype.encode=function(){var t3,e,n;for(e=new fe(_e.call(this.raw.data)),t3=0,n=this.glyphIDs.length;t3<n;++t3)e.pos=this.glyphOffsets[t3];return e.data},t2})(),Ie=(function(){function t2(){return t2.__super__.constructor.apply(this,arguments)}return ge(t2,he),t2.prototype.tag="loca",t2.prototype.parse=function(t3){var e,n;return t3.pos=this.offset,e=this.file.head.indexToLocFormat,this.offsets=e===0?function(){var e2,r;for(r=[],n=0,e2=this.length;n<e2;n+=2)r.push(2*t3.readUInt16());return r}.call(this):function(){var e2,r;for(r=[],n=0,e2=this.length;n<e2;n+=4)r.push(t3.readUInt32());return r}.call(this)},t2.prototype.indexOf=function(t3){return this.offsets[t3]},t2.prototype.lengthOf=function(t3){return this.offsets[t3+1]-this.offsets[t3]},t2.prototype.encode=function(t3,e){for(var n=new Uint32Array(this.offsets.length),r=0,i2=0,a2=0;a2<n.length;++a2)if(n[a2]=r,i2<e.length&&e[i2]==a2){++i2,n[a2]=r;var o2=this.offsets[a2],s2=this.offsets[a2+1]-o2;s2>0&&(r+=s2)}for(var u2=new Array(4*n.length),c2=0;c2<n.length;++c2)u2[4*c2+3]=255&n[c2],u2[4*c2+2]=(65280&n[c2])>>8,u2[4*c2+1]=(16711680&n[c2])>>16,u2[4*c2]=(4278190080&n[c2])>>24;return u2},t2})(),je=(function(){function t2(t3){this.font=t3,this.subset={},this.unicodes={},this.next=33}return t2.prototype.generateCmap=function(){var t3,e,n,r,i2;for(e in r=this.font.cmap.tables[0].codeMap,t3={},i2=this.subset)n=i2[e],t3[e]=r[n];return t3},t2.prototype.glyphsFor=function(t3){var e,n,r,i2,a2,o2,s2;for(r={},a2=0,o2=t3.length;a2<o2;a2++)r[i2=t3[a2]]=this.font.glyf.glyphFor(i2);for(i2 in e=[],r)(n=r[i2])!=null&&n.compound&&e.push.apply(e,n.glyphIDs);if(e.length>0)for(i2 in s2=this.glyphsFor(e))n=s2[i2],r[i2]=n;return r},t2.prototype.encode=function(t3,e){var n,r,i2,a2,o2,s2,u2,c2,l2,h2,f2,d2,p2,g2,m2;for(r in n=be.encode(this.generateCmap(),"unicode"),a2=this.glyphsFor(t3),f2={0:0},m2=n.charMap)f2[(s2=m2[r]).old]=s2.new;for(d2 in h2=n.maxGlyphID,a2)d2 in f2||(f2[d2]=h2++);return c2=(function(t4){var e2,n2;for(e2 in n2={},t4)n2[t4[e2]]=e2;return n2})(f2),l2=Object.keys(c2).sort(function(t4,e2){return t4-e2}),p2=(function(){var t4,e2,n2;for(n2=[],t4=0,e2=l2.length;t4<e2;t4++)o2=l2[t4],n2.push(c2[o2]);return n2})(),i2=this.font.glyf.encode(a2,p2,f2),u2=this.font.loca.encode(i2.offsets,p2),g2={cmap:this.font.cmap.raw(),glyf:i2.table,loca:u2,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(g2["OS/2"]=this.font.os2.raw()),this.font.directory.encode(g2)},t2})();E.API.PDFObject=(function(){var t2;function e(){}return t2=function(t3,e2){return(Array(e2+1).join("0")+t3).slice(-e2)},e.convert=function(n){var r,i2,a2,o2;if(Array.isArray(n))return"["+(function(){var t3,i3,a3;for(a3=[],t3=0,i3=n.length;t3<i3;t3++)r=n[t3],a3.push(e.convert(r));return a3})().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n?.isString)return"("+n+")";if(n instanceof Date)return"(D:"+t2(n.getUTCFullYear(),4)+t2(n.getUTCMonth(),2)+t2(n.getUTCDate(),2)+t2(n.getUTCHours(),2)+t2(n.getUTCMinutes(),2)+t2(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(i2 in a2=["<<"],n)o2=n[i2],a2.push("/"+i2+" "+e.convert(o2));return a2.push(">>"),a2.join(`
`)}return""+n},e})();function autoTableText(text,x2,y2,styles,doc){styles=styles||{};var PHYSICAL_LINE_HEIGHT=1.15,k2=doc.internal.scaleFactor,fontSize=doc.internal.getFontSize()/k2,lineHeightFactor=doc.getLineHeightFactor?doc.getLineHeightFactor():PHYSICAL_LINE_HEIGHT,lineHeight=fontSize*lineHeightFactor,splitRegex=/\r\n|\r|\n/g,splitText="",lineCount=1;if((styles.valign==="middle"||styles.valign==="bottom"||styles.halign==="center"||styles.halign==="right")&&(splitText=typeof text=="string"?text.split(splitRegex):text,lineCount=splitText.length||1),y2+=fontSize*(2-PHYSICAL_LINE_HEIGHT),styles.valign==="middle"?y2-=lineCount/2*lineHeight:styles.valign==="bottom"&&(y2-=lineCount*lineHeight),styles.halign==="center"||styles.halign==="right"){var alignSize=fontSize;if(styles.halign==="center"&&(alignSize*=.5),splitText&&lineCount>=1){for(var iLine=0;iLine<splitText.length;iLine++)doc.text(splitText[iLine],x2-doc.getStringUnitWidth(splitText[iLine])*alignSize,y2),y2+=lineHeight;return doc}x2-=doc.getStringUnitWidth(text)*alignSize}return styles.halign==="justify"?doc.text(text,x2,y2,{maxWidth:styles.maxWidth||100,align:"justify"}):doc.text(text,x2,y2),doc}var globalDefaults={},DocHandler=(function(){function DocHandler2(jsPDFDocument){this.jsPDFDocument=jsPDFDocument,this.userStyles={textColor:jsPDFDocument.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:jsPDFDocument.internal.getFontSize(),fontStyle:jsPDFDocument.internal.getFont().fontStyle,font:jsPDFDocument.internal.getFont().fontName,lineWidth:jsPDFDocument.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:jsPDFDocument.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return DocHandler2.setDefaults=function(defaults,doc){doc===void 0&&(doc=null),doc?doc.__autoTableDocumentDefaults=defaults:globalDefaults=defaults},DocHandler2.unifyColor=function(c2){return Array.isArray(c2)?c2:typeof c2=="number"?[c2,c2,c2]:typeof c2=="string"?[c2]:null},DocHandler2.prototype.applyStyles=function(styles,fontOnly){var _a2,_b2,_c;fontOnly===void 0&&(fontOnly=!1),styles.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(styles.fontStyle);var _d=this.jsPDFDocument.internal.getFont(),fontStyle=_d.fontStyle,fontName=_d.fontName;if(styles.font&&(fontName=styles.font),styles.fontStyle){fontStyle=styles.fontStyle;var availableFontStyles=this.getFontList()[fontName];availableFontStyles&&availableFontStyles.indexOf(fontStyle)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(availableFontStyles[0]),fontStyle=availableFontStyles[0])}if(this.jsPDFDocument.setFont(fontName,fontStyle),styles.fontSize&&this.jsPDFDocument.setFontSize(styles.fontSize),!fontOnly){var color=DocHandler2.unifyColor(styles.fillColor);color&&(_a2=this.jsPDFDocument).setFillColor.apply(_a2,color),color=DocHandler2.unifyColor(styles.textColor),color&&(_b2=this.jsPDFDocument).setTextColor.apply(_b2,color),color=DocHandler2.unifyColor(styles.lineColor),color&&(_c=this.jsPDFDocument).setDrawColor.apply(_c,color),typeof styles.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(styles.lineWidth)}},DocHandler2.prototype.splitTextToSize=function(text,size,opts){return this.jsPDFDocument.splitTextToSize(text,size,opts)},DocHandler2.prototype.rect=function(x2,y2,width,height,fillStyle){return this.jsPDFDocument.rect(x2,y2,width,height,fillStyle)},DocHandler2.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},DocHandler2.prototype.getTextWidth=function(text){return this.jsPDFDocument.getTextWidth(text)},DocHandler2.prototype.getDocument=function(){return this.jsPDFDocument},DocHandler2.prototype.setPage=function(page){this.jsPDFDocument.setPage(page)},DocHandler2.prototype.addPage=function(){return this.jsPDFDocument.addPage()},DocHandler2.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},DocHandler2.prototype.getGlobalOptions=function(){return globalDefaults||{}},DocHandler2.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},DocHandler2.prototype.pageSize=function(){var pageSize=this.jsPDFDocument.internal.pageSize;return pageSize.width==null&&(pageSize={width:pageSize.getWidth(),height:pageSize.getHeight()}),pageSize},DocHandler2.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},DocHandler2.prototype.getLineHeightFactor=function(){var doc=this.jsPDFDocument;return doc.getLineHeightFactor?doc.getLineHeightFactor():1.15},DocHandler2.prototype.getLineHeight=function(fontSize){return fontSize/this.scaleFactor()*this.getLineHeightFactor()},DocHandler2.prototype.pageNumber=function(){var pageInfo=this.jsPDFDocument.internal.getCurrentPageInfo();return pageInfo?pageInfo.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},DocHandler2})(),extendStatics=function(d2,b2){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d3,b3){d3.__proto__=b3}||function(d3,b3){for(var p2 in b3)Object.prototype.hasOwnProperty.call(b3,p2)&&(d3[p2]=b3[p2])},extendStatics(d2,b2)};function __extends(d2,b2){if(typeof b2!="function"&&b2!==null)throw new TypeError("Class extends value "+String(b2)+" is not a constructor or null");extendStatics(d2,b2);function __(){this.constructor=d2}d2.prototype=b2===null?Object.create(b2):(__.prototype=b2.prototype,new __)}var HtmlRowInput=(function(_super){__extends(HtmlRowInput2,_super);function HtmlRowInput2(element){var _this=_super.call(this)||this;return _this._element=element,_this}return HtmlRowInput2})(Array);function defaultStyles(scaleFactor){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/scaleFactor,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function getTheme(name){var themes={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return themes[name]}function getStringWidth(text,styles,doc){doc.applyStyles(styles,!0);var textArr=Array.isArray(text)?text:[text],widestLineWidth=textArr.map(function(text2){return doc.getTextWidth(text2)}).reduce(function(a2,b2){return Math.max(a2,b2)},0);return widestLineWidth}function addTableBorder(doc,table,startPos,cursor){var lineWidth=table.settings.tableLineWidth,lineColor=table.settings.tableLineColor;doc.applyStyles({lineWidth,lineColor});var fillStyle=getFillStyle(lineWidth,!1);fillStyle&&doc.rect(startPos.x,startPos.y,table.getWidth(doc.pageSize().width),cursor.y-startPos.y,fillStyle)}function getFillStyle(lineWidth,fillColor){var drawLine=lineWidth>0,drawBackground=fillColor||fillColor===0;return drawLine&&drawBackground?"DF":drawLine?"S":drawBackground?"F":null}function parseSpacing(value,defaultValue){var _a2,_b2,_c,_d;if(value=value||defaultValue,Array.isArray(value)){if(value.length>=4)return{top:value[0],right:value[1],bottom:value[2],left:value[3]};if(value.length===3)return{top:value[0],right:value[1],bottom:value[2],left:value[1]};if(value.length===2)return{top:value[0],right:value[1],bottom:value[0],left:value[1]};value.length===1?value=value[0]:value=defaultValue}return typeof value=="object"?(typeof value.vertical=="number"&&(value.top=value.vertical,value.bottom=value.vertical),typeof value.horizontal=="number"&&(value.right=value.horizontal,value.left=value.horizontal),{left:(_a2=value.left)!==null&&_a2!==void 0?_a2:defaultValue,top:(_b2=value.top)!==null&&_b2!==void 0?_b2:defaultValue,right:(_c=value.right)!==null&&_c!==void 0?_c:defaultValue,bottom:(_d=value.bottom)!==null&&_d!==void 0?_d:defaultValue}):(typeof value!="number"&&(value=defaultValue),{top:value,right:value,bottom:value,left:value})}function getPageAvailableWidth(doc,table){var margins=parseSpacing(table.settings.margin,0);return doc.pageSize().width-(margins.left+margins.right)}function parseCss(supportedFonts,element,scaleFactor,style,window2){var result={},pxScaleFactor=1.3333333333333333,backgroundColor=parseColor(element,function(elem){return window2.getComputedStyle(elem).backgroundColor});backgroundColor!=null&&(result.fillColor=backgroundColor);var textColor=parseColor(element,function(elem){return window2.getComputedStyle(elem).color});textColor!=null&&(result.textColor=textColor);var padding=parsePadding(style,scaleFactor);padding&&(result.cellPadding=padding);var borderColorSide="borderTopColor",finalScaleFactor=pxScaleFactor*scaleFactor,btw=style.borderTopWidth;if(style.borderBottomWidth===btw&&style.borderRightWidth===btw&&style.borderLeftWidth===btw){var borderWidth=(parseFloat(btw)||0)/finalScaleFactor;borderWidth&&(result.lineWidth=borderWidth)}else result.lineWidth={top:(parseFloat(style.borderTopWidth)||0)/finalScaleFactor,right:(parseFloat(style.borderRightWidth)||0)/finalScaleFactor,bottom:(parseFloat(style.borderBottomWidth)||0)/finalScaleFactor,left:(parseFloat(style.borderLeftWidth)||0)/finalScaleFactor},result.lineWidth.top||(result.lineWidth.right?borderColorSide="borderRightColor":result.lineWidth.bottom?borderColorSide="borderBottomColor":result.lineWidth.left&&(borderColorSide="borderLeftColor"));var borderColor=parseColor(element,function(elem){return window2.getComputedStyle(elem)[borderColorSide]});borderColor!=null&&(result.lineColor=borderColor);var accepted=["left","right","center","justify"];accepted.indexOf(style.textAlign)!==-1&&(result.halign=style.textAlign),accepted=["middle","bottom","top"],accepted.indexOf(style.verticalAlign)!==-1&&(result.valign=style.verticalAlign);var res=parseInt(style.fontSize||"");isNaN(res)||(result.fontSize=res/pxScaleFactor);var fontStyle=parseFontStyle(style);fontStyle&&(result.fontStyle=fontStyle);var font=(style.fontFamily||"").toLowerCase();return supportedFonts.indexOf(font)!==-1&&(result.font=font),result}function parseFontStyle(style){var res="";return(style.fontWeight==="bold"||style.fontWeight==="bolder"||parseInt(style.fontWeight)>=700)&&(res="bold"),(style.fontStyle==="italic"||style.fontStyle==="oblique")&&(res+="italic"),res}function parseColor(element,styleGetter){var cssColor=realColor(element,styleGetter);if(!cssColor)return null;var rgba=cssColor.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!rgba||!Array.isArray(rgba))return null;var color=[parseInt(rgba[1]),parseInt(rgba[2]),parseInt(rgba[3])],alpha=parseInt(rgba[4]);return alpha===0||isNaN(color[0])||isNaN(color[1])||isNaN(color[2])?null:color}function realColor(elem,styleGetter){var bg=styleGetter(elem);return bg==="rgba(0, 0, 0, 0)"||bg==="transparent"||bg==="initial"||bg==="inherit"?elem.parentElement==null?null:realColor(elem.parentElement,styleGetter):bg}function parsePadding(style,scaleFactor){var val=[style.paddingTop,style.paddingRight,style.paddingBottom,style.paddingLeft],pxScaleFactor=96/(72/scaleFactor),linePadding=(parseInt(style.lineHeight)-parseInt(style.fontSize))/scaleFactor/2,inputPadding=val.map(function(n){return parseInt(n||"0")/pxScaleFactor}),padding=parseSpacing(inputPadding,0);return linePadding>padding.top&&(padding.top=linePadding),linePadding>padding.bottom&&(padding.bottom=linePadding),padding}function parseHtml(doc,input,window2,includeHiddenHtml,useCss){var _a2,_b2;includeHiddenHtml===void 0&&(includeHiddenHtml=!1),useCss===void 0&&(useCss=!1);var tableElement;typeof input=="string"?tableElement=window2.document.querySelector(input):tableElement=input;var supportedFonts=Object.keys(doc.getFontList()),scaleFactor=doc.scaleFactor(),head=[],body=[],foot=[];if(!tableElement)return console.error("Html table could not be found with input: ",input),{head,body,foot};for(var i2=0;i2<tableElement.rows.length;i2++){var element=tableElement.rows[i2],tagName=(_b2=(_a2=element?.parentElement)===null||_a2===void 0?void 0:_a2.tagName)===null||_b2===void 0?void 0:_b2.toLowerCase(),row=parseRowContent(supportedFonts,scaleFactor,window2,element,includeHiddenHtml,useCss);row&&(tagName==="thead"?head.push(row):tagName==="tfoot"?foot.push(row):body.push(row))}return{head,body,foot}}function parseRowContent(supportedFonts,scaleFactor,window2,row,includeHidden,useCss){for(var resultRow=new HtmlRowInput(row),i2=0;i2<row.cells.length;i2++){var cell=row.cells[i2],style_1=window2.getComputedStyle(cell);if(includeHidden||style_1.display!=="none"){var cellStyles2=void 0;useCss&&(cellStyles2=parseCss(supportedFonts,cell,scaleFactor,style_1,window2)),resultRow.push({rowSpan:cell.rowSpan,colSpan:cell.colSpan,styles:cellStyles2,_element:cell,content:parseCellContent(cell)})}}var style=window2.getComputedStyle(row);if(resultRow.length>0&&(includeHidden||style.display!=="none"))return resultRow}function parseCellContent(orgCell){var cell=orgCell.cloneNode(!0);return cell.innerHTML=cell.innerHTML.replace(/\n/g,"").replace(/ +/g," "),cell.innerHTML=cell.innerHTML.split(/<br.*?>/).map(function(part){return part.trim()}).join(`
`),cell.innerText||cell.textContent||""}function validateInput(global2,document2,current){for(var _i=0,_a2=[global2,document2,current];_i<_a2.length;_i++){var options=_a2[_i];options&&typeof options!="object"&&console.error("The options parameter should be of type object, is: "+typeof options),options.startY&&typeof options.startY!="number"&&(console.error("Invalid value for startY option",options.startY),delete options.startY)}}function assign(target,s2,s1,s22,s3){if(target==null)throw new TypeError("Cannot convert undefined or null to object");for(var to=Object(target),index=1;index<arguments.length;index++){var nextSource=arguments[index];if(nextSource!=null)for(var nextKey in nextSource)Object.prototype.hasOwnProperty.call(nextSource,nextKey)&&(to[nextKey]=nextSource[nextKey])}return to}function parseInput(d2,current){var doc=new DocHandler(d2),document2=doc.getDocumentOptions(),global2=doc.getGlobalOptions();validateInput(global2,document2,current);var options=assign({},global2,document2,current),win;typeof window<"u"&&(win=window);var styles=parseStyles(global2,document2,current),hooks=parseHooks(global2,document2,current),settings=parseSettings(doc,options),content=parseContent$1(doc,options,win);return{id:current.tableId,content,hooks,styles,settings}}function parseStyles(gInput,dInput,cInput){for(var styleOptions={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},_loop_1=function(prop2){if(prop2==="columnStyles"){var global_1=gInput[prop2],document_1=dInput[prop2],current=cInput[prop2];styleOptions.columnStyles=assign({},global_1,document_1,current)}else{var allOptions=[gInput,dInput,cInput],styles=allOptions.map(function(opts){return opts[prop2]||{}});styleOptions[prop2]=assign({},styles[0],styles[1],styles[2])}},_i=0,_a2=Object.keys(styleOptions);_i<_a2.length;_i++){var prop=_a2[_i];_loop_1(prop)}return styleOptions}function parseHooks(global2,document2,current){for(var allOptions=[global2,document2,current],result={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},_i=0,allOptions_1=allOptions;_i<allOptions_1.length;_i++){var options=allOptions_1[_i];options.didParseCell&&result.didParseCell.push(options.didParseCell),options.willDrawCell&&result.willDrawCell.push(options.willDrawCell),options.didDrawCell&&result.didDrawCell.push(options.didDrawCell),options.willDrawPage&&result.willDrawPage.push(options.willDrawPage),options.didDrawPage&&result.didDrawPage.push(options.didDrawPage)}return result}function parseSettings(doc,options){var _a2,_b2,_c,_d,_e2,_f,_g,_h,_j,_k,_l,_m,margin=parseSpacing(options.margin,40/doc.scaleFactor()),startY=(_a2=getStartY(doc,options.startY))!==null&&_a2!==void 0?_a2:margin.top,showFoot;options.showFoot===!0?showFoot="everyPage":options.showFoot===!1?showFoot="never":showFoot=(_b2=options.showFoot)!==null&&_b2!==void 0?_b2:"everyPage";var showHead;options.showHead===!0?showHead="everyPage":options.showHead===!1?showHead="never":showHead=(_c=options.showHead)!==null&&_c!==void 0?_c:"everyPage";var useCss=(_d=options.useCss)!==null&&_d!==void 0?_d:!1,theme=options.theme||(useCss?"plain":"striped"),horizontalPageBreak=!!options.horizontalPageBreak,horizontalPageBreakRepeat=(_e2=options.horizontalPageBreakRepeat)!==null&&_e2!==void 0?_e2:null;return{includeHiddenHtml:(_f=options.includeHiddenHtml)!==null&&_f!==void 0?_f:!1,useCss,theme,startY,margin,pageBreak:(_g=options.pageBreak)!==null&&_g!==void 0?_g:"auto",rowPageBreak:(_h=options.rowPageBreak)!==null&&_h!==void 0?_h:"auto",tableWidth:(_j=options.tableWidth)!==null&&_j!==void 0?_j:"auto",showHead,showFoot,tableLineWidth:(_k=options.tableLineWidth)!==null&&_k!==void 0?_k:0,tableLineColor:(_l=options.tableLineColor)!==null&&_l!==void 0?_l:200,horizontalPageBreak,horizontalPageBreakRepeat,horizontalPageBreakBehaviour:(_m=options.horizontalPageBreakBehaviour)!==null&&_m!==void 0?_m:"afterAllRows"}}function getStartY(doc,userStartY){var previous=doc.getLastAutoTable(),sf=doc.scaleFactor(),currentPage=doc.pageNumber(),isSamePageAsPreviousTable=!1;if(previous&&previous.startPageNumber){var endingPage=previous.startPageNumber+previous.pageNumber-1;isSamePageAsPreviousTable=endingPage===currentPage}return typeof userStartY=="number"?userStartY:(userStartY==null||userStartY===!1)&&isSamePageAsPreviousTable&&previous?.finalY!=null?previous.finalY+20/sf:null}function parseContent$1(doc,options,window2){var head=options.head||[],body=options.body||[],foot=options.foot||[];if(options.html){var hidden=options.includeHiddenHtml;if(window2){var htmlContent=parseHtml(doc,options.html,window2,hidden,options.useCss)||{};head=htmlContent.head||head,body=htmlContent.body||head,foot=htmlContent.foot||head}else console.error("Cannot parse html in non browser environment")}var columns=options.columns||parseColumns(head,body,foot);return{columns,head,body,foot}}function parseColumns(head,body,foot){var firstRow=head[0]||body[0]||foot[0]||[],result=[];return Object.keys(firstRow).filter(function(key){return key!=="_element"}).forEach(function(key){var colSpan=1,input;Array.isArray(firstRow)?input=firstRow[parseInt(key)]:input=firstRow[key],typeof input=="object"&&!Array.isArray(input)&&(colSpan=input?.colSpan||1);for(var i2=0;i2<colSpan;i2++){var id=void 0;Array.isArray(firstRow)?id=result.length:id=key+(i2>0?"_".concat(i2):"");var rowResult={dataKey:id};result.push(rowResult)}}),result}var HookData=(function(){function HookData2(doc,table,cursor){this.table=table,this.pageNumber=table.pageNumber,this.settings=table.settings,this.cursor=cursor,this.doc=doc.getDocument()}return HookData2})(),CellHookData=(function(_super){__extends(CellHookData2,_super);function CellHookData2(doc,table,cell,row,column,cursor){var _this=_super.call(this,doc,table,cursor)||this;return _this.cell=cell,_this.row=row,_this.column=column,_this.section=row.section,_this}return CellHookData2})(HookData),Table=(function(){function Table2(input,content){this.pageNumber=1,this.id=input.id,this.settings=input.settings,this.styles=input.styles,this.hooks=input.hooks,this.columns=content.columns,this.head=content.head,this.body=content.body,this.foot=content.foot}return Table2.prototype.getHeadHeight=function(columns){return this.head.reduce(function(acc,row){return acc+row.getMaxCellHeight(columns)},0)},Table2.prototype.getFootHeight=function(columns){return this.foot.reduce(function(acc,row){return acc+row.getMaxCellHeight(columns)},0)},Table2.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},Table2.prototype.callCellHooks=function(doc,handlers,cell,row,column,cursor){for(var _i=0,handlers_1=handlers;_i<handlers_1.length;_i++){var handler=handlers_1[_i],data=new CellHookData(doc,this,cell,row,column,cursor),result=handler(data)===!1;if(cell.text=Array.isArray(cell.text)?cell.text:[cell.text],result)return!1}return!0},Table2.prototype.callEndPageHooks=function(doc,cursor){doc.applyStyles(doc.userStyles);for(var _i=0,_a2=this.hooks.didDrawPage;_i<_a2.length;_i++){var handler=_a2[_i];handler(new HookData(doc,this,cursor))}},Table2.prototype.callWillDrawPageHooks=function(doc,cursor){for(var _i=0,_a2=this.hooks.willDrawPage;_i<_a2.length;_i++){var handler=_a2[_i];handler(new HookData(doc,this,cursor))}},Table2.prototype.getWidth=function(pageWidth){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var wrappedWidth=this.columns.reduce(function(total,col){return total+col.wrappedWidth},0);return wrappedWidth}else{var margin=this.settings.margin;return pageWidth-margin.left-margin.right}},Table2})(),Row=(function(){function Row2(raw,index,section,cells,spansMultiplePages){spansMultiplePages===void 0&&(spansMultiplePages=!1),this.height=0,this.raw=raw,raw instanceof HtmlRowInput&&(this.raw=raw._element,this.element=raw._element),this.index=index,this.section=section,this.cells=cells,this.spansMultiplePages=spansMultiplePages}return Row2.prototype.getMaxCellHeight=function(columns){var _this=this;return columns.reduce(function(acc,column){var _a2;return Math.max(acc,((_a2=_this.cells[column.index])===null||_a2===void 0?void 0:_a2.height)||0)},0)},Row2.prototype.hasRowSpan=function(columns){var _this=this;return columns.filter(function(column){var cell=_this.cells[column.index];return cell?cell.rowSpan>1:!1}).length>0},Row2.prototype.canEntireRowFit=function(height,columns){return this.getMaxCellHeight(columns)<=height},Row2.prototype.getMinimumRowHeight=function(columns,doc){var _this=this;return columns.reduce(function(acc,column){var cell=_this.cells[column.index];if(!cell)return 0;var lineHeight=doc.getLineHeight(cell.styles.fontSize),vPadding=cell.padding("vertical"),oneRowHeight=vPadding+lineHeight;return oneRowHeight>acc?oneRowHeight:acc},0)},Row2})(),Cell=(function(){function Cell2(raw,styles,section){var _a2;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=styles,this.section=section,this.raw=raw;var content=raw;raw!=null&&typeof raw=="object"&&!Array.isArray(raw)?(this.rowSpan=raw.rowSpan||1,this.colSpan=raw.colSpan||1,content=(_a2=raw.content)!==null&&_a2!==void 0?_a2:raw,raw._element&&(this.raw=raw._element)):(this.rowSpan=1,this.colSpan=1);var text=content!=null?""+content:"",splitRegex=/\r\n|\r|\n/g;this.text=text.split(splitRegex)}return Cell2.prototype.getTextPos=function(){var y2;if(this.styles.valign==="top")y2=this.y+this.padding("top");else if(this.styles.valign==="bottom")y2=this.y+this.height-this.padding("bottom");else{var netHeight=this.height-this.padding("vertical");y2=this.y+netHeight/2+this.padding("top")}var x2;if(this.styles.halign==="right")x2=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var netWidth=this.width-this.padding("horizontal");x2=this.x+netWidth/2+this.padding("left")}else x2=this.x+this.padding("left");return{x:x2,y:y2}},Cell2.prototype.getContentHeight=function(scaleFactor,lineHeightFactor){lineHeightFactor===void 0&&(lineHeightFactor=1.15);var lineCount=Array.isArray(this.text)?this.text.length:1,lineHeight=this.styles.fontSize/scaleFactor*lineHeightFactor,height=lineCount*lineHeight+this.padding("vertical");return Math.max(height,this.styles.minCellHeight)},Cell2.prototype.padding=function(name){var padding=parseSpacing(this.styles.cellPadding,0);return name==="vertical"?padding.top+padding.bottom:name==="horizontal"?padding.left+padding.right:padding[name]},Cell2})(),Column=(function(){function Column2(dataKey,raw,index){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=dataKey,this.raw=raw,this.index=index}return Column2.prototype.getMaxCustomCellWidth=function(table){for(var max=0,_i=0,_a2=table.allRows();_i<_a2.length;_i++){var row=_a2[_i],cell=row.cells[this.index];cell&&typeof cell.styles.cellWidth=="number"&&(max=Math.max(max,cell.styles.cellWidth))}return max},Column2})();function calculateWidths(doc,table){calculate(doc,table);var resizableColumns=[],initialTableWidth=0;table.columns.forEach(function(column){var customWidth=column.getMaxCustomCellWidth(table);customWidth?column.width=customWidth:(column.width=column.wrappedWidth,resizableColumns.push(column)),initialTableWidth+=column.width});var resizeWidth=table.getWidth(doc.pageSize().width)-initialTableWidth;resizeWidth&&(resizeWidth=resizeColumns(resizableColumns,resizeWidth,function(column){return Math.max(column.minReadableWidth,column.minWidth)})),resizeWidth&&(resizeWidth=resizeColumns(resizableColumns,resizeWidth,function(column){return column.minWidth})),resizeWidth=Math.abs(resizeWidth),!table.settings.horizontalPageBreak&&resizeWidth>.1/doc.scaleFactor()&&(resizeWidth=resizeWidth<1?resizeWidth:Math.round(resizeWidth),console.warn("Of the table content, ".concat(resizeWidth," units width could not fit page"))),applyColSpans(table),fitContent(table,doc),applyRowSpans(table)}function calculate(doc,table){var sf=doc.scaleFactor(),horizontalPageBreak=table.settings.horizontalPageBreak,availablePageWidth=getPageAvailableWidth(doc,table);table.allRows().forEach(function(row){for(var _i=0,_a2=table.columns;_i<_a2.length;_i++){var column=_a2[_i],cell=row.cells[column.index];if(cell){var hooks=table.hooks.didParseCell;table.callCellHooks(doc,hooks,cell,row,column,null);var padding=cell.padding("horizontal");cell.contentWidth=getStringWidth(cell.text,cell.styles,doc)+padding;var longestWordWidth=getStringWidth(cell.text.join(" ").split(/[^\S\u00A0]+/),cell.styles,doc);if(cell.minReadableWidth=longestWordWidth+cell.padding("horizontal"),typeof cell.styles.cellWidth=="number")cell.minWidth=cell.styles.cellWidth,cell.wrappedWidth=cell.styles.cellWidth;else if(cell.styles.cellWidth==="wrap"||horizontalPageBreak===!0)cell.contentWidth>availablePageWidth?(cell.minWidth=availablePageWidth,cell.wrappedWidth=availablePageWidth):(cell.minWidth=cell.contentWidth,cell.wrappedWidth=cell.contentWidth);else{var defaultMinWidth=10/sf;cell.minWidth=cell.styles.minCellWidth||defaultMinWidth,cell.wrappedWidth=cell.contentWidth,cell.minWidth>cell.wrappedWidth&&(cell.wrappedWidth=cell.minWidth)}}}}),table.allRows().forEach(function(row){for(var _i=0,_a2=table.columns;_i<_a2.length;_i++){var column=_a2[_i],cell=row.cells[column.index];if(cell&&cell.colSpan===1)column.wrappedWidth=Math.max(column.wrappedWidth,cell.wrappedWidth),column.minWidth=Math.max(column.minWidth,cell.minWidth),column.minReadableWidth=Math.max(column.minReadableWidth,cell.minReadableWidth);else{var columnStyles=table.styles.columnStyles[column.dataKey]||table.styles.columnStyles[column.index]||{},cellWidth=columnStyles.cellWidth||columnStyles.minCellWidth;cellWidth&&typeof cellWidth=="number"&&(column.minWidth=cellWidth,column.wrappedWidth=cellWidth)}cell&&(cell.colSpan>1&&!column.minWidth&&(column.minWidth=cell.minWidth),cell.colSpan>1&&!column.wrappedWidth&&(column.wrappedWidth=cell.minWidth))}})}function resizeColumns(columns,resizeWidth,getMinWidth){for(var initialResizeWidth=resizeWidth,sumWrappedWidth=columns.reduce(function(acc,column2){return acc+column2.wrappedWidth},0),i2=0;i2<columns.length;i2++){var column=columns[i2],ratio=column.wrappedWidth/sumWrappedWidth,suggestedChange=initialResizeWidth*ratio,suggestedWidth=column.width+suggestedChange,minWidth=getMinWidth(column),newWidth=suggestedWidth<minWidth?minWidth:suggestedWidth;resizeWidth-=newWidth-column.width,column.width=newWidth}if(resizeWidth=Math.round(resizeWidth*1e10)/1e10,resizeWidth){var resizableColumns=columns.filter(function(column2){return resizeWidth<0?column2.width>getMinWidth(column2):!0});resizableColumns.length&&(resizeWidth=resizeColumns(resizableColumns,resizeWidth,getMinWidth))}return resizeWidth}function applyRowSpans(table){for(var rowSpanCells={},colRowSpansLeft=1,all=table.allRows(),rowIndex=0;rowIndex<all.length;rowIndex++)for(var row=all[rowIndex],_i=0,_a2=table.columns;_i<_a2.length;_i++){var column=_a2[_i],data=rowSpanCells[column.index];if(colRowSpansLeft>1)colRowSpansLeft--,delete row.cells[column.index];else if(data)data.cell.height+=row.height,colRowSpansLeft=data.cell.colSpan,delete row.cells[column.index],data.left--,data.left<=1&&delete rowSpanCells[column.index];else{var cell=row.cells[column.index];if(!cell)continue;if(cell.height=row.height,cell.rowSpan>1){var remaining=all.length-rowIndex,left=cell.rowSpan>remaining?remaining:cell.rowSpan;rowSpanCells[column.index]={cell,left,row}}}}}function applyColSpans(table){for(var all=table.allRows(),rowIndex=0;rowIndex<all.length;rowIndex++)for(var row=all[rowIndex],colSpanCell=null,combinedColSpanWidth=0,colSpansLeft=0,columnIndex=0;columnIndex<table.columns.length;columnIndex++){var column=table.columns[columnIndex];if(colSpansLeft-=1,colSpansLeft>1&&table.columns[columnIndex+1])combinedColSpanWidth+=column.width,delete row.cells[column.index];else if(colSpanCell){var cell=colSpanCell;delete row.cells[column.index],colSpanCell=null,cell.width=column.width+combinedColSpanWidth}else{var cell=row.cells[column.index];if(!cell)continue;if(colSpansLeft=cell.colSpan,combinedColSpanWidth=0,cell.colSpan>1){colSpanCell=cell,combinedColSpanWidth+=column.width;continue}cell.width=column.width+combinedColSpanWidth}}}function fitContent(table,doc){for(var rowSpanHeight={count:0,height:0},_i=0,_a2=table.allRows();_i<_a2.length;_i++){for(var row=_a2[_i],_b2=0,_c=table.columns;_b2<_c.length;_b2++){var column=_c[_b2],cell=row.cells[column.index];if(cell){doc.applyStyles(cell.styles,!0);var textSpace=cell.width-cell.padding("horizontal");if(cell.styles.overflow==="linebreak")cell.text=doc.splitTextToSize(cell.text,textSpace+1/doc.scaleFactor(),{fontSize:cell.styles.fontSize});else if(cell.styles.overflow==="ellipsize")cell.text=ellipsize(cell.text,textSpace,cell.styles,doc,"...");else if(cell.styles.overflow==="hidden")cell.text=ellipsize(cell.text,textSpace,cell.styles,doc,"");else if(typeof cell.styles.overflow=="function"){var result=cell.styles.overflow(cell.text,textSpace);typeof result=="string"?cell.text=[result]:cell.text=result}cell.contentHeight=cell.getContentHeight(doc.scaleFactor(),doc.getLineHeightFactor());var realContentHeight=cell.contentHeight/cell.rowSpan;cell.rowSpan>1&&rowSpanHeight.count*rowSpanHeight.height<realContentHeight*cell.rowSpan?rowSpanHeight={height:realContentHeight,count:cell.rowSpan}:rowSpanHeight&&rowSpanHeight.count>0&&rowSpanHeight.height>realContentHeight&&(realContentHeight=rowSpanHeight.height),realContentHeight>row.height&&(row.height=realContentHeight)}}rowSpanHeight.count--}}function ellipsize(text,width,styles,doc,overflow){return text.map(function(str){return ellipsizeStr(str,width,styles,doc,overflow)})}function ellipsizeStr(text,width,styles,doc,overflow){var precision=1e4*doc.scaleFactor();if(width=Math.ceil(width*precision)/precision,width>=getStringWidth(text,styles,doc))return text;for(;width<getStringWidth(text+overflow,styles,doc)&&!(text.length<=1);)text=text.substring(0,text.length-1);return text.trim()+overflow}function createTable(jsPDFDoc,input){var doc=new DocHandler(jsPDFDoc),content=parseContent(input,doc.scaleFactor()),table=new Table(input,content);return calculateWidths(doc,table),doc.applyStyles(doc.userStyles),table}function parseContent(input,sf){var content=input.content,columns=createColumns(content.columns);if(content.head.length===0){var sectionRow=generateSectionRow(columns,"head");sectionRow&&content.head.push(sectionRow)}if(content.foot.length===0){var sectionRow=generateSectionRow(columns,"foot");sectionRow&&content.foot.push(sectionRow)}var theme=input.settings.theme,styles=input.styles;return{columns,head:parseSection("head",content.head,columns,styles,theme,sf),body:parseSection("body",content.body,columns,styles,theme,sf),foot:parseSection("foot",content.foot,columns,styles,theme,sf)}}function parseSection(sectionName,sectionRows,columns,styleProps,theme,scaleFactor){var rowSpansLeftForColumn={},result=sectionRows.map(function(rawRow,rowIndex){for(var skippedRowForRowSpans=0,cells={},colSpansAdded=0,columnSpansLeft=0,_i=0,columns_1=columns;_i<columns_1.length;_i++){var column=columns_1[_i];if(rowSpansLeftForColumn[column.index]==null||rowSpansLeftForColumn[column.index].left===0)if(columnSpansLeft===0){var rawCell=void 0;Array.isArray(rawRow)?rawCell=rawRow[column.index-colSpansAdded-skippedRowForRowSpans]:rawCell=rawRow[column.dataKey];var cellInputStyles={};typeof rawCell=="object"&&!Array.isArray(rawCell)&&(cellInputStyles=rawCell?.styles||{});var styles=cellStyles(sectionName,column,rowIndex,theme,styleProps,scaleFactor,cellInputStyles),cell=new Cell(rawCell,styles,sectionName);cells[column.dataKey]=cell,cells[column.index]=cell,columnSpansLeft=cell.colSpan-1,rowSpansLeftForColumn[column.index]={left:cell.rowSpan-1,times:columnSpansLeft}}else columnSpansLeft--,colSpansAdded++;else rowSpansLeftForColumn[column.index].left--,columnSpansLeft=rowSpansLeftForColumn[column.index].times,skippedRowForRowSpans++}return new Row(rawRow,rowIndex,sectionName,cells)});return result}function generateSectionRow(columns,section){var sectionRow={};return columns.forEach(function(col){if(col.raw!=null){var title=getSectionTitle(section,col.raw);title!=null&&(sectionRow[col.dataKey]=title)}}),Object.keys(sectionRow).length>0?sectionRow:null}function getSectionTitle(section,column){if(section==="head"){if(typeof column=="object")return column.header||null;if(typeof column=="string"||typeof column=="number")return column}else if(section==="foot"&&typeof column=="object")return column.footer;return null}function createColumns(columns){return columns.map(function(input,index){var _a2,key;return typeof input=="object"?key=(_a2=input.dataKey)!==null&&_a2!==void 0?_a2:index:key=index,new Column(key,input,index)})}function cellStyles(sectionName,column,rowIndex,themeName,styles,scaleFactor,cellInputStyles){var theme=getTheme(themeName),sectionStyles;sectionName==="head"?sectionStyles=styles.headStyles:sectionName==="body"?sectionStyles=styles.bodyStyles:sectionName==="foot"&&(sectionStyles=styles.footStyles);var otherStyles=assign({},theme.table,theme[sectionName],styles.styles,sectionStyles),columnStyles=styles.columnStyles[column.dataKey]||styles.columnStyles[column.index]||{},colStyles=sectionName==="body"?columnStyles:{},rowStyles=sectionName==="body"&&rowIndex%2===0?assign({},theme.alternateRow,styles.alternateRowStyles):{},defaultStyle=defaultStyles(scaleFactor),themeStyles=assign({},defaultStyle,otherStyles,rowStyles,colStyles);return assign(themeStyles,cellInputStyles)}function getColumnsCanFitInPage(doc,table,config){var _a2;config===void 0&&(config={});var remainingWidth=getPageAvailableWidth(doc,table),repeatColumnsMap=new Map,colIndexes=[],columns=[],horizontalPageBreakRepeat=[];Array.isArray(table.settings.horizontalPageBreakRepeat)?horizontalPageBreakRepeat=table.settings.horizontalPageBreakRepeat:(typeof table.settings.horizontalPageBreakRepeat=="string"||typeof table.settings.horizontalPageBreakRepeat=="number")&&(horizontalPageBreakRepeat=[table.settings.horizontalPageBreakRepeat]),horizontalPageBreakRepeat.forEach(function(field){var col=table.columns.find(function(item){return item.dataKey===field||item.index===field});col&&!repeatColumnsMap.has(col.index)&&(repeatColumnsMap.set(col.index,!0),colIndexes.push(col.index),columns.push(table.columns[col.index]),remainingWidth-=col.wrappedWidth)});for(var first=!0,i2=(_a2=config?.start)!==null&&_a2!==void 0?_a2:0;i2<table.columns.length;){if(repeatColumnsMap.has(i2)){i2++;continue}var colWidth=table.columns[i2].wrappedWidth;if(first||remainingWidth>=colWidth)first=!1,colIndexes.push(i2),columns.push(table.columns[i2]),remainingWidth-=colWidth;else break;i2++}return{colIndexes,columns,lastIndex:i2-1}}function calculateAllColumnsCanFitInPage(doc,table){for(var allResults=[],i2=0;i2<table.columns.length;i2++){var result=getColumnsCanFitInPage(doc,table,{start:i2});result.columns.length&&(allResults.push(result),i2=result.lastIndex)}return allResults}function drawTable(jsPDFDoc,table){var settings=table.settings,startY=settings.startY,margin=settings.margin,cursor={x:margin.left,y:startY},sectionsHeight=table.getHeadHeight(table.columns)+table.getFootHeight(table.columns),minTableBottomPos=startY+margin.bottom+sectionsHeight;if(settings.pageBreak==="avoid"){var rows=table.body,tableHeight=rows.reduce(function(acc,row){return acc+row.height},0);minTableBottomPos+=tableHeight}var doc=new DocHandler(jsPDFDoc);(settings.pageBreak==="always"||settings.startY!=null&&minTableBottomPos>doc.pageSize().height)&&(nextPage(doc),cursor.y=margin.top),table.callWillDrawPageHooks(doc,cursor);var startPos=assign({},cursor);table.startPageNumber=doc.pageNumber(),settings.horizontalPageBreak?printTableWithHorizontalPageBreak(doc,table,startPos,cursor):(doc.applyStyles(doc.userStyles),(settings.showHead==="firstPage"||settings.showHead==="everyPage")&&table.head.forEach(function(row){return printRow(doc,table,row,cursor,table.columns)}),doc.applyStyles(doc.userStyles),table.body.forEach(function(row,index){var isLastRow=index===table.body.length-1;printFullRow(doc,table,row,isLastRow,startPos,cursor,table.columns)}),doc.applyStyles(doc.userStyles),(settings.showFoot==="lastPage"||settings.showFoot==="everyPage")&&table.foot.forEach(function(row){return printRow(doc,table,row,cursor,table.columns)})),addTableBorder(doc,table,startPos,cursor),table.callEndPageHooks(doc,cursor),table.finalY=cursor.y,jsPDFDoc.lastAutoTable=table,doc.applyStyles(doc.userStyles)}function printTableWithHorizontalPageBreak(doc,table,startPos,cursor){var allColumnsCanFitResult=calculateAllColumnsCanFitInPage(doc,table),settings=table.settings;if(settings.horizontalPageBreakBehaviour==="afterAllRows")allColumnsCanFitResult.forEach(function(colsAndIndexes,index){doc.applyStyles(doc.userStyles),index>0?addPage(doc,table,startPos,cursor,colsAndIndexes.columns,!0):printHead(doc,table,cursor,colsAndIndexes.columns),printBody(doc,table,startPos,cursor,colsAndIndexes.columns),printFoot(doc,table,cursor,colsAndIndexes.columns)});else for(var lastRowIndexOfLastPage_1=-1,firstColumnsToFitResult=allColumnsCanFitResult[0],_loop_1=function(){var lastPrintedRowIndex=lastRowIndexOfLastPage_1;if(firstColumnsToFitResult){doc.applyStyles(doc.userStyles);var firstColumnsToFit=firstColumnsToFitResult.columns;lastRowIndexOfLastPage_1>=0?addPage(doc,table,startPos,cursor,firstColumnsToFit,!0):printHead(doc,table,cursor,firstColumnsToFit),lastPrintedRowIndex=printBodyWithoutPageBreaks(doc,table,lastRowIndexOfLastPage_1+1,cursor,firstColumnsToFit),printFoot(doc,table,cursor,firstColumnsToFit)}var maxNumberOfRows=lastPrintedRowIndex-lastRowIndexOfLastPage_1;allColumnsCanFitResult.slice(1).forEach(function(colsAndIndexes){doc.applyStyles(doc.userStyles),addPage(doc,table,startPos,cursor,colsAndIndexes.columns,!0),printBodyWithoutPageBreaks(doc,table,lastRowIndexOfLastPage_1+1,cursor,colsAndIndexes.columns,maxNumberOfRows),printFoot(doc,table,cursor,colsAndIndexes.columns)}),lastRowIndexOfLastPage_1=lastPrintedRowIndex};lastRowIndexOfLastPage_1<table.body.length-1;)_loop_1()}function printHead(doc,table,cursor,columns){var settings=table.settings;doc.applyStyles(doc.userStyles),(settings.showHead==="firstPage"||settings.showHead==="everyPage")&&table.head.forEach(function(row){return printRow(doc,table,row,cursor,columns)})}function printBody(doc,table,startPos,cursor,columns){doc.applyStyles(doc.userStyles),table.body.forEach(function(row,index){var isLastRow=index===table.body.length-1;printFullRow(doc,table,row,isLastRow,startPos,cursor,columns)})}function printBodyWithoutPageBreaks(doc,table,startRowIndex,cursor,columns,maxNumberOfRows){doc.applyStyles(doc.userStyles),maxNumberOfRows=maxNumberOfRows??table.body.length;var endRowIndex=Math.min(startRowIndex+maxNumberOfRows,table.body.length),lastPrintedRowIndex=-1;return table.body.slice(startRowIndex,endRowIndex).forEach(function(row,index){var isLastRow=startRowIndex+index===table.body.length-1,remainingSpace=getRemainingPageSpace(doc,table,isLastRow,cursor);row.canEntireRowFit(remainingSpace,columns)&&(printRow(doc,table,row,cursor,columns),lastPrintedRowIndex=startRowIndex+index)}),lastPrintedRowIndex}function printFoot(doc,table,cursor,columns){var settings=table.settings;doc.applyStyles(doc.userStyles),(settings.showFoot==="lastPage"||settings.showFoot==="everyPage")&&table.foot.forEach(function(row){return printRow(doc,table,row,cursor,columns)})}function getRemainingLineCount(cell,remainingPageSpace,doc){var lineHeight=doc.getLineHeight(cell.styles.fontSize),vPadding=cell.padding("vertical"),remainingLines=Math.floor((remainingPageSpace-vPadding)/lineHeight);return Math.max(0,remainingLines)}function modifyRowToFit(row,remainingPageSpace,table,doc){var cells={};row.spansMultiplePages=!0,row.height=0;for(var rowHeight=0,_i=0,_a2=table.columns;_i<_a2.length;_i++){var column=_a2[_i],cell=row.cells[column.index];if(cell){Array.isArray(cell.text)||(cell.text=[cell.text]);var remainderCell=new Cell(cell.raw,cell.styles,cell.section);remainderCell=assign(remainderCell,cell),remainderCell.text=[];var remainingLineCount=getRemainingLineCount(cell,remainingPageSpace,doc);cell.text.length>remainingLineCount&&(remainderCell.text=cell.text.splice(remainingLineCount,cell.text.length));var scaleFactor=doc.scaleFactor(),lineHeightFactor=doc.getLineHeightFactor();cell.contentHeight=cell.getContentHeight(scaleFactor,lineHeightFactor),cell.contentHeight>=remainingPageSpace&&(cell.contentHeight=remainingPageSpace,remainderCell.styles.minCellHeight-=remainingPageSpace),cell.contentHeight>row.height&&(row.height=cell.contentHeight),remainderCell.contentHeight=remainderCell.getContentHeight(scaleFactor,lineHeightFactor),remainderCell.contentHeight>rowHeight&&(rowHeight=remainderCell.contentHeight),cells[column.index]=remainderCell}}var remainderRow=new Row(row.raw,-1,row.section,cells,!0);remainderRow.height=rowHeight;for(var _b2=0,_c=table.columns;_b2<_c.length;_b2++){var column=_c[_b2],remainderCell=remainderRow.cells[column.index];remainderCell&&(remainderCell.height=remainderRow.height);var cell=row.cells[column.index];cell&&(cell.height=row.height)}return remainderRow}function shouldPrintOnCurrentPage(doc,row,remainingPageSpace,table){var pageHeight=doc.pageSize().height,margin=table.settings.margin,marginHeight=margin.top+margin.bottom,maxRowHeight=pageHeight-marginHeight;row.section==="body"&&(maxRowHeight-=table.getHeadHeight(table.columns)+table.getFootHeight(table.columns));var minRowHeight=row.getMinimumRowHeight(table.columns,doc),minRowFits=minRowHeight<remainingPageSpace;if(minRowHeight>maxRowHeight)return console.error("Will not be able to print row ".concat(row.index," correctly since it's minimum height is larger than page height")),!0;if(!minRowFits)return!1;var rowHasRowSpanCell=row.hasRowSpan(table.columns),rowHigherThanPage=row.getMaxCellHeight(table.columns)>maxRowHeight;return rowHigherThanPage?(rowHasRowSpanCell&&console.error("The content of row ".concat(row.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(rowHasRowSpanCell||table.settings.rowPageBreak==="avoid")}function printFullRow(doc,table,row,isLastRow,startPos,cursor,columns){var remainingSpace=getRemainingPageSpace(doc,table,isLastRow,cursor);if(row.canEntireRowFit(remainingSpace,columns))printRow(doc,table,row,cursor,columns);else if(shouldPrintOnCurrentPage(doc,row,remainingSpace,table)){var remainderRow=modifyRowToFit(row,remainingSpace,table,doc);printRow(doc,table,row,cursor,columns),addPage(doc,table,startPos,cursor,columns),printFullRow(doc,table,remainderRow,isLastRow,startPos,cursor,columns)}else addPage(doc,table,startPos,cursor,columns),printFullRow(doc,table,row,isLastRow,startPos,cursor,columns)}function printRow(doc,table,row,cursor,columns){cursor.x=table.settings.margin.left;for(var _i=0,columns_1=columns;_i<columns_1.length;_i++){var column=columns_1[_i],cell=row.cells[column.index];if(!cell){cursor.x+=column.width;continue}doc.applyStyles(cell.styles),cell.x=cursor.x,cell.y=cursor.y;var result=table.callCellHooks(doc,table.hooks.willDrawCell,cell,row,column,cursor);if(result===!1){cursor.x+=column.width;continue}drawCellRect(doc,cell,cursor);var textPos=cell.getTextPos();autoTableText(cell.text,textPos.x,textPos.y,{halign:cell.styles.halign,valign:cell.styles.valign,maxWidth:Math.ceil(cell.width-cell.padding("left")-cell.padding("right"))},doc.getDocument()),table.callCellHooks(doc,table.hooks.didDrawCell,cell,row,column,cursor),cursor.x+=column.width}cursor.y+=row.height}function drawCellRect(doc,cell,cursor){var cellStyles2=cell.styles;if(doc.getDocument().setFillColor(doc.getDocument().getFillColor()),typeof cellStyles2.lineWidth=="number"){var fillStyle=getFillStyle(cellStyles2.lineWidth,cellStyles2.fillColor);fillStyle&&doc.rect(cell.x,cursor.y,cell.width,cell.height,fillStyle)}else typeof cellStyles2.lineWidth=="object"&&(cellStyles2.fillColor&&doc.rect(cell.x,cursor.y,cell.width,cell.height,"F"),drawCellBorders(doc,cell,cursor,cellStyles2.lineWidth))}function drawCellBorders(doc,cell,cursor,lineWidth){var x1,y1,x2,y2;lineWidth.top&&(x1=cursor.x,y1=cursor.y,x2=cursor.x+cell.width,y2=cursor.y,lineWidth.right&&(x2+=.5*lineWidth.right),lineWidth.left&&(x1-=.5*lineWidth.left),drawLine(lineWidth.top,x1,y1,x2,y2)),lineWidth.bottom&&(x1=cursor.x,y1=cursor.y+cell.height,x2=cursor.x+cell.width,y2=cursor.y+cell.height,lineWidth.right&&(x2+=.5*lineWidth.right),lineWidth.left&&(x1-=.5*lineWidth.left),drawLine(lineWidth.bottom,x1,y1,x2,y2)),lineWidth.left&&(x1=cursor.x,y1=cursor.y,x2=cursor.x,y2=cursor.y+cell.height,lineWidth.top&&(y1-=.5*lineWidth.top),lineWidth.bottom&&(y2+=.5*lineWidth.bottom),drawLine(lineWidth.left,x1,y1,x2,y2)),lineWidth.right&&(x1=cursor.x+cell.width,y1=cursor.y,x2=cursor.x+cell.width,y2=cursor.y+cell.height,lineWidth.top&&(y1-=.5*lineWidth.top),lineWidth.bottom&&(y2+=.5*lineWidth.bottom),drawLine(lineWidth.right,x1,y1,x2,y2));function drawLine(width,x12,y12,x22,y22){doc.getDocument().setLineWidth(width),doc.getDocument().line(x12,y12,x22,y22,"S")}}function getRemainingPageSpace(doc,table,isLastRow,cursor){var bottomContentHeight=table.settings.margin.bottom,showFoot=table.settings.showFoot;return(showFoot==="everyPage"||showFoot==="lastPage"&&isLastRow)&&(bottomContentHeight+=table.getFootHeight(table.columns)),doc.pageSize().height-cursor.y-bottomContentHeight}function addPage(doc,table,startPos,cursor,columns,suppressFooter){columns===void 0&&(columns=[]),suppressFooter===void 0&&(suppressFooter=!1),doc.applyStyles(doc.userStyles),table.settings.showFoot==="everyPage"&&!suppressFooter&&table.foot.forEach(function(row){return printRow(doc,table,row,cursor,columns)}),table.callEndPageHooks(doc,cursor);var margin=table.settings.margin;addTableBorder(doc,table,startPos,cursor),nextPage(doc),table.pageNumber++,cursor.x=margin.left,cursor.y=margin.top,startPos.y=margin.top,table.callWillDrawPageHooks(doc,cursor),table.settings.showHead==="everyPage"&&(table.head.forEach(function(row){return printRow(doc,table,row,cursor,columns)}),doc.applyStyles(doc.userStyles))}function nextPage(doc){var current=doc.pageNumber();doc.setPage(current+1);var newCurrent=doc.pageNumber();return newCurrent===current?(doc.addPage(),!0):!1}function applyPlugin(jsPDF){jsPDF.API.autoTable=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var options=args[0],input=parseInput(this,options),table=createTable(this,input);return drawTable(this,table),this},jsPDF.API.lastAutoTable=!1,jsPDF.API.autoTableText=function(text,x2,y2,styles){autoTableText(text,x2,y2,styles,this)},jsPDF.API.autoTableSetDefaults=function(defaults){return DocHandler.setDefaults(defaults,this),this},jsPDF.autoTableSetDefaults=function(defaults,doc){DocHandler.setDefaults(defaults,doc)},jsPDF.API.autoTableHtmlToJson=function(tableElem,includeHiddenElements){var _a2;if(includeHiddenElements===void 0&&(includeHiddenElements=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var doc=new DocHandler(this),_b2=parseHtml(doc,tableElem,window,includeHiddenElements,!1),head=_b2.head,body=_b2.body,columns=((_a2=head[0])===null||_a2===void 0?void 0:_a2.map(function(c2){return c2.content}))||[];return{columns,rows:body,data:body}}}var _a;function autoTable(d2,options){var input=parseInput(d2,options),table=createTable(d2,input);drawTable(d2,table)}try{if(typeof window<"u"&&window){var anyWindow=window,jsPDF=anyWindow.jsPDF||((_a=anyWindow.jspdf)===null||_a===void 0?void 0:_a.jsPDF);jsPDF&&applyPlugin(jsPDF)}}catch(error){console.error("Could not apply autoTable plugin",error)}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var XLSX={};XLSX.version="0.18.5";var current_ansi=1252,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],set_ansi=function(cp){VALID_ANSI.indexOf(cp)!=-1&&(current_ansi=cp)};function reset_ansi(){set_ansi(1252)}var set_cp=function(cp){set_ansi(cp)};function reset_cp(){set_cp(1200),reset_ansi()}var _getchar=function(x2){return String.fromCharCode(x2)},_getansi=function(x2){return String.fromCharCode(x2)},$cptable,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(input){for(var o2="",c1=0,c2=0,c3=0,e1=0,e2=0,e3=0,e4=0,i2=0;i2<input.length;)c1=input.charCodeAt(i2++),e1=c1>>2,c2=input.charCodeAt(i2++),e2=(c1&3)<<4|c2>>4,c3=input.charCodeAt(i2++),e3=(c2&15)<<2|c3>>6,e4=c3&63,isNaN(c2)?e3=e4=64:isNaN(c3)&&(e4=64),o2+=Base64_map.charAt(e1)+Base64_map.charAt(e2)+Base64_map.charAt(e3)+Base64_map.charAt(e4);return o2}function Base64_decode(input){var o2="",c1=0,c2=0,c3=0,e1=0,e2=0,e3=0,e4=0;input=input.replace(/[^\w\+\/\=]/g,"");for(var i2=0;i2<input.length;)e1=Base64_map.indexOf(input.charAt(i2++)),e2=Base64_map.indexOf(input.charAt(i2++)),c1=e1<<2|e2>>4,o2+=String.fromCharCode(c1),e3=Base64_map.indexOf(input.charAt(i2++)),c2=(e2&15)<<4|e3>>2,e3!==64&&(o2+=String.fromCharCode(c2)),e4=Base64_map.indexOf(input.charAt(i2++)),c3=(e3&3)<<6|e4,e4!==64&&(o2+=String.fromCharCode(c3));return o2}var has_buf=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Buffer_from=(function(){if(typeof Buffer<"u"){var nbfs=!Buffer.from;if(!nbfs)try{Buffer.from("foo","utf8")}catch{nbfs=!0}return nbfs?function(buf,enc){return enc?new Buffer(buf,enc):new Buffer(buf)}:Buffer.from.bind(Buffer)}return function(){}})();function new_raw_buf(len){return has_buf?Buffer.alloc?Buffer.alloc(len):new Buffer(len):typeof Uint8Array<"u"?new Uint8Array(len):new Array(len)}function new_unsafe_buf(len){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(len):new Buffer(len):typeof Uint8Array<"u"?new Uint8Array(len):new Array(len)}var s2a=function(s2){return has_buf?Buffer_from(s2,"binary"):s2.split("").map(function(x2){return x2.charCodeAt(0)&255})};function s2ab(s2){if(typeof ArrayBuffer>"u")return s2a(s2);for(var buf=new ArrayBuffer(s2.length),view=new Uint8Array(buf),i2=0;i2!=s2.length;++i2)view[i2]=s2.charCodeAt(i2)&255;return buf}function a2s(data){if(Array.isArray(data))return data.map(function(c2){return String.fromCharCode(c2)}).join("");for(var o2=[],i2=0;i2<data.length;++i2)o2[i2]=String.fromCharCode(data[i2]);return o2.join("")}function a2u(data){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(data)}var bconcat=has_buf?function(bufs){return Buffer.concat(bufs.map(function(buf){return Buffer.isBuffer(buf)?buf:Buffer_from(buf)}))}:function(bufs){if(typeof Uint8Array<"u"){var i2=0,maxlen=0;for(i2=0;i2<bufs.length;++i2)maxlen+=bufs[i2].length;var o2=new Uint8Array(maxlen),len=0;for(i2=0,maxlen=0;i2<bufs.length;maxlen+=len,++i2)if(len=bufs[i2].length,bufs[i2]instanceof Uint8Array)o2.set(bufs[i2],maxlen);else{if(typeof bufs[i2]=="string")throw"wtf";o2.set(new Uint8Array(bufs[i2]),maxlen)}return o2}return[].concat.apply([],bufs.map(function(buf){return Array.isArray(buf)?buf:[].slice.call(buf)}))};function utf8decode(content){for(var out=[],widx=0,L2=content.length+250,o2=new_raw_buf(content.length+255),ridx=0;ridx<content.length;++ridx){var c2=content.charCodeAt(ridx);if(c2<128)o2[widx++]=c2;else if(c2<2048)o2[widx++]=192|c2>>6&31,o2[widx++]=128|c2&63;else if(c2>=55296&&c2<57344){c2=(c2&1023)+64;var d2=content.charCodeAt(++ridx)&1023;o2[widx++]=240|c2>>8&7,o2[widx++]=128|c2>>2&63,o2[widx++]=128|d2>>6&15|(c2&3)<<4,o2[widx++]=128|d2&63}else o2[widx++]=224|c2>>12&15,o2[widx++]=128|c2>>6&63,o2[widx++]=128|c2&63;widx>L2&&(out.push(o2.slice(0,widx)),widx=0,o2=new_raw_buf(65535),L2=65530)}return out.push(o2.slice(0,widx)),bconcat(out)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(x2){for(var o2="",i2=x2.length-1;i2>=0;)o2+=x2.charAt(i2--);return o2}function pad0(v2,d2){var t2=""+v2;return t2.length>=d2?t2:fill("0",d2-t2.length)+t2}function pad_(v2,d2){var t2=""+v2;return t2.length>=d2?t2:fill(" ",d2-t2.length)+t2}function rpad_(v2,d2){var t2=""+v2;return t2.length>=d2?t2:t2+fill(" ",d2-t2.length)}function pad0r1(v2,d2){var t2=""+Math.round(v2);return t2.length>=d2?t2:fill("0",d2-t2.length)+t2}function pad0r2(v2,d2){var t2=""+v2;return t2.length>=d2?t2:fill("0",d2-t2.length)+t2}var p2_32=Math.pow(2,32);function pad0r(v2,d2){if(v2>p2_32||v2<-p2_32)return pad0r1(v2,d2);var i2=Math.round(v2);return pad0r2(i2,d2)}function SSF_isgeneral(s2,i2){return i2=i2||0,s2.length>=7+i2&&(s2.charCodeAt(i2)|32)===103&&(s2.charCodeAt(i2+1)|32)===101&&(s2.charCodeAt(i2+2)|32)===110&&(s2.charCodeAt(i2+3)|32)===101&&(s2.charCodeAt(i2+4)|32)===114&&(s2.charCodeAt(i2+5)|32)===97&&(s2.charCodeAt(i2+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(t2){return t2||(t2={}),t2[0]="General",t2[1]="0",t2[2]="0.00",t2[3]="#,##0",t2[4]="#,##0.00",t2[9]="0%",t2[10]="0.00%",t2[11]="0.00E+00",t2[12]="# ?/?",t2[13]="# ??/??",t2[14]="m/d/yy",t2[15]="d-mmm-yy",t2[16]="d-mmm",t2[17]="mmm-yy",t2[18]="h:mm AM/PM",t2[19]="h:mm:ss AM/PM",t2[20]="h:mm",t2[21]="h:mm:ss",t2[22]="m/d/yy h:mm",t2[37]="#,##0 ;(#,##0)",t2[38]="#,##0 ;[Red](#,##0)",t2[39]="#,##0.00;(#,##0.00)",t2[40]="#,##0.00;[Red](#,##0.00)",t2[45]="mm:ss",t2[46]="[h]:mm:ss",t2[47]="mmss.0",t2[48]="##0.0E+0",t2[49]="@",t2[56]='"/ "hh""mm""ss" "',t2}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(x2,D2,mixed){for(var sgn=x2<0?-1:1,B2=x2*sgn,P_2=0,P_1=1,P2=0,Q_2=1,Q_1=0,Q2=0,A2=Math.floor(B2);Q_1<D2&&(A2=Math.floor(B2),P2=A2*P_1+P_2,Q2=A2*Q_1+Q_2,!(B2-A2<5e-8));)B2=1/(B2-A2),P_2=P_1,P_1=P2,Q_2=Q_1,Q_1=Q2;if(Q2>D2&&(Q_1>D2?(Q2=Q_2,P2=P_2):(Q2=Q_1,P2=P_1)),!mixed)return[0,sgn*P2,Q2];var q2=Math.floor(sgn*P2/Q2);return[q2,sgn*P2-q2*Q2,Q2]}function SSF_parse_date_code(v2,opts,b2){if(v2>2958465||v2<0)return null;var date=v2|0,time=Math.floor(86400*(v2-date)),dow=0,dout=[],out={D:date,T:time,u:86400*(v2-date)-time,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(out.u)<1e-6&&(out.u=0),opts&&opts.date1904&&(date+=1462),out.u>.9999&&(out.u=0,++time==86400&&(out.T=time=0,++date,++out.D)),date===60)dout=b2?[1317,10,29]:[1900,2,29],dow=3;else if(date===0)dout=b2?[1317,8,29]:[1900,1,0],dow=6;else{date>60&&--date;var d2=new Date(1900,0,1);d2.setDate(d2.getDate()+date-1),dout=[d2.getFullYear(),d2.getMonth()+1,d2.getDate()],dow=d2.getDay(),date<60&&(dow=(dow+6)%7),b2&&(dow=SSF_fix_hijri(d2,dout))}return out.y=dout[0],out.m=dout[1],out.d=dout[2],out.S=time%60,time=Math.floor(time/60),out.M=time%60,time=Math.floor(time/60),out.H=time,out.q=dow,out}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(v2,date1904){var epoch=v2.getTime();return date1904?epoch-=1461*24*60*60*1e3:v2>=SSFbase1904&&(epoch+=1440*60*1e3),(epoch-(SSFdnthresh+(v2.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(1440*60*1e3)}function SSF_strip_decimal(o2){return o2.indexOf(".")==-1?o2:o2.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(o2){return o2.indexOf("E")==-1?o2:o2.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(v2){var w2=v2<0?12:11,o2=SSF_strip_decimal(v2.toFixed(12));return o2.length<=w2||(o2=v2.toPrecision(10),o2.length<=w2)?o2:v2.toExponential(5)}function SSF_large_exp(v2){var o2=SSF_strip_decimal(v2.toFixed(11));return o2.length>(v2<0?12:11)||o2==="0"||o2==="-0"?v2.toPrecision(6):o2}function SSF_general_num(v2){var V2=Math.floor(Math.log(Math.abs(v2))*Math.LOG10E),o2;return V2>=-4&&V2<=-1?o2=v2.toPrecision(10+V2):Math.abs(V2)<=9?o2=SSF_small_exp(v2):V2===10?o2=v2.toFixed(10).substr(0,12):o2=SSF_large_exp(v2),SSF_strip_decimal(SSF_normalize_exp(o2.toUpperCase()))}function SSF_general(v2,opts){switch(typeof v2){case"string":return v2;case"boolean":return v2?"TRUE":"FALSE";case"number":return(v2|0)===v2?v2.toString(10):SSF_general_num(v2);case"undefined":return"";case"object":if(v2==null)return"";if(v2 instanceof Date)return SSF_format(14,datenum_local(v2,opts&&opts.date1904),opts)}throw new Error("unsupported value in General format: "+v2)}function SSF_fix_hijri(date,o2){o2[0]-=581;var dow=date.getDay();return date<60&&(dow=(dow+6)%7),dow}function SSF_write_date(type,fmt,val,ss0){var o2="",ss=0,tt2=0,y2=val.y,out,outl=0;switch(type){case 98:y2=val.y+543;case 121:switch(fmt.length){case 1:case 2:out=y2%100,outl=2;break;default:out=y2%1e4,outl=4;break}break;case 109:switch(fmt.length){case 1:case 2:out=val.m,outl=fmt.length;break;case 3:return months[val.m-1][1];case 5:return months[val.m-1][0];default:return months[val.m-1][2]}break;case 100:switch(fmt.length){case 1:case 2:out=val.d,outl=fmt.length;break;case 3:return days[val.q][0];default:return days[val.q][1]}break;case 104:switch(fmt.length){case 1:case 2:out=1+(val.H+11)%12,outl=fmt.length;break;default:throw"bad hour format: "+fmt}break;case 72:switch(fmt.length){case 1:case 2:out=val.H,outl=fmt.length;break;default:throw"bad hour format: "+fmt}break;case 77:switch(fmt.length){case 1:case 2:out=val.M,outl=fmt.length;break;default:throw"bad minute format: "+fmt}break;case 115:if(fmt!="s"&&fmt!="ss"&&fmt!=".0"&&fmt!=".00"&&fmt!=".000")throw"bad second format: "+fmt;return val.u===0&&(fmt=="s"||fmt=="ss")?pad0(val.S,fmt.length):(ss0>=2?tt2=ss0===3?1e3:100:tt2=ss0===1?10:1,ss=Math.round(tt2*(val.S+val.u)),ss>=60*tt2&&(ss=0),fmt==="s"?ss===0?"0":""+ss/tt2:(o2=pad0(ss,2+ss0),fmt==="ss"?o2.substr(0,2):"."+o2.substr(2,fmt.length-1)));case 90:switch(fmt){case"[h]":case"[hh]":out=val.D*24+val.H;break;case"[m]":case"[mm]":out=(val.D*24+val.H)*60+val.M;break;case"[s]":case"[ss]":out=((val.D*24+val.H)*60+val.M)*60+Math.round(val.S+val.u);break;default:throw"bad abstime format: "+fmt}outl=fmt.length===3?1:2;break;case 101:out=y2,outl=1;break}var outstr=outl>0?pad0(out,outl):"";return outstr}function commaify(s2){var w2=3;if(s2.length<=w2)return s2;for(var j2=s2.length%w2,o2=s2.substr(0,j2);j2!=s2.length;j2+=w2)o2+=(o2.length>0?",":"")+s2.substr(j2,w2);return o2}var pct1=/%/g;function write_num_pct(type,fmt,val){var sfmt=fmt.replace(pct1,""),mul=fmt.length-sfmt.length;return write_num(type,sfmt,val*Math.pow(10,2*mul))+fill("%",mul)}function write_num_cm(type,fmt,val){for(var idx=fmt.length-1;fmt.charCodeAt(idx-1)===44;)--idx;return write_num(type,fmt.substr(0,idx),val/Math.pow(10,3*(fmt.length-idx)))}function write_num_exp(fmt,val){var o2,idx=fmt.indexOf("E")-fmt.indexOf(".")-1;if(fmt.match(/^#+0.0E\+0$/)){if(val==0)return"0.0E+0";if(val<0)return"-"+write_num_exp(fmt,-val);var period=fmt.indexOf(".");period===-1&&(period=fmt.indexOf("E"));var ee2=Math.floor(Math.log(val)*Math.LOG10E)%period;if(ee2<0&&(ee2+=period),o2=(val/Math.pow(10,ee2)).toPrecision(idx+1+(period+ee2)%period),o2.indexOf("e")===-1){var fakee=Math.floor(Math.log(val)*Math.LOG10E);for(o2.indexOf(".")===-1?o2=o2.charAt(0)+"."+o2.substr(1)+"E+"+(fakee-o2.length+ee2):o2+="E+"+(fakee-ee2);o2.substr(0,2)==="0.";)o2=o2.charAt(0)+o2.substr(2,period)+"."+o2.substr(2+period),o2=o2.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");o2=o2.replace(/\+-/,"-")}o2=o2.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function($$,$1,$2,$3){return $1+$2+$3.substr(0,(period+ee2)%period)+"."+$3.substr(ee2)+"E"})}else o2=val.toExponential(idx);return fmt.match(/E\+00$/)&&o2.match(/e[+-]\d$/)&&(o2=o2.substr(0,o2.length-1)+"0"+o2.charAt(o2.length-1)),fmt.match(/E\-/)&&o2.match(/e\+/)&&(o2=o2.replace(/e\+/,"e")),o2.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(r,aval,sign){var den=parseInt(r[4],10),rr=Math.round(aval*den),base=Math.floor(rr/den),myn=rr-base*den,myd=den;return sign+(base===0?"":""+base)+" "+(myn===0?fill(" ",r[1].length+1+r[4].length):pad_(myn,r[1].length)+r[2]+"/"+r[3]+pad0(myd,r[4].length))}function write_num_f2(r,aval,sign){return sign+(aval===0?"":""+aval)+fill(" ",r[1].length+2+r[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(str){for(var o2="",cc,i2=0;i2!=str.length;++i2)switch(cc=str.charCodeAt(i2)){case 35:break;case 63:o2+=" ";break;case 48:o2+="0";break;default:o2+=String.fromCharCode(cc)}return o2}function rnd(val,d2){var dd=Math.pow(10,d2);return""+Math.round(val*dd)/dd}function dec(val,d2){var _frac=val-Math.floor(val),dd=Math.pow(10,d2);return d2<(""+Math.round(_frac*dd)).length?0:Math.round(_frac*dd)}function carry(val,d2){return d2<(""+Math.round((val-Math.floor(val))*Math.pow(10,d2))).length?1:0}function flr(val){return val<2147483647&&val>-2147483648?""+(val>=0?val|0:val-1|0):""+Math.floor(val)}function write_num_flt(type,fmt,val){if(type.charCodeAt(0)===40&&!fmt.match(closeparen)){var ffmt=fmt.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return val>=0?write_num_flt("n",ffmt,val):"("+write_num_flt("n",ffmt,-val)+")"}if(fmt.charCodeAt(fmt.length-1)===44)return write_num_cm(type,fmt,val);if(fmt.indexOf("%")!==-1)return write_num_pct(type,fmt,val);if(fmt.indexOf("E")!==-1)return write_num_exp(fmt,val);if(fmt.charCodeAt(0)===36)return"$"+write_num_flt(type,fmt.substr(fmt.charAt(1)==" "?2:1),val);var o2,r,ri,ff,aval=Math.abs(val),sign=val<0?"-":"";if(fmt.match(/^00+$/))return sign+pad0r(aval,fmt.length);if(fmt.match(/^[#?]+$/))return o2=pad0r(val,0),o2==="0"&&(o2=""),o2.length>fmt.length?o2:hashq(fmt.substr(0,fmt.length-o2.length))+o2;if(r=fmt.match(frac1))return write_num_f1(r,aval,sign);if(fmt.match(/^#+0+$/))return sign+pad0r(aval,fmt.length-fmt.indexOf("0"));if(r=fmt.match(dec1))return o2=rnd(val,r[1].length).replace(/^([^\.]+)$/,"$1."+hashq(r[1])).replace(/\.$/,"."+hashq(r[1])).replace(/\.(\d*)$/,function($$,$1){return"."+$1+fill("0",hashq(r[1]).length-$1.length)}),fmt.indexOf("0.")!==-1?o2:o2.replace(/^0\./,".");if(fmt=fmt.replace(/^#+([0.])/,"$1"),r=fmt.match(/^(0*)\.(#*)$/))return sign+rnd(aval,r[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,r[1].length?"0.":".");if(r=fmt.match(/^#{1,3},##0(\.?)$/))return sign+commaify(pad0r(aval,0));if(r=fmt.match(/^#,##0\.([#0]*0)$/))return val<0?"-"+write_num_flt(type,fmt,-val):commaify(""+(Math.floor(val)+carry(val,r[1].length)))+"."+pad0(dec(val,r[1].length),r[1].length);if(r=fmt.match(/^#,#*,#0/))return write_num_flt(type,fmt.replace(/^#,#*,/,""),val);if(r=fmt.match(/^([0#]+)(\\?-([0#]+))+$/))return o2=_strrev(write_num_flt(type,fmt.replace(/[\\-]/g,""),val)),ri=0,_strrev(_strrev(fmt.replace(/\\/g,"")).replace(/[0#]/g,function(x3){return ri<o2.length?o2.charAt(ri++):x3==="0"?"0":""}));if(fmt.match(phone))return o2=write_num_flt(type,"##########",val),"("+o2.substr(0,3)+") "+o2.substr(3,3)+"-"+o2.substr(6);var oa="";if(r=fmt.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return ri=Math.min(r[4].length,7),ff=SSF_frac(aval,Math.pow(10,ri)-1,!1),o2=""+sign,oa=write_num("n",r[1],ff[1]),oa.charAt(oa.length-1)==" "&&(oa=oa.substr(0,oa.length-1)+"0"),o2+=oa+r[2]+"/"+r[3],oa=rpad_(ff[2],ri),oa.length<r[4].length&&(oa=hashq(r[4].substr(r[4].length-oa.length))+oa),o2+=oa,o2;if(r=fmt.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return ri=Math.min(Math.max(r[1].length,r[4].length),7),ff=SSF_frac(aval,Math.pow(10,ri)-1,!0),sign+(ff[0]||(ff[1]?"":"0"))+" "+(ff[1]?pad_(ff[1],ri)+r[2]+"/"+r[3]+rpad_(ff[2],ri):fill(" ",2*ri+1+r[2].length+r[3].length));if(r=fmt.match(/^[#0?]+$/))return o2=pad0r(val,0),fmt.length<=o2.length?o2:hashq(fmt.substr(0,fmt.length-o2.length))+o2;if(r=fmt.match(/^([#0?]+)\.([#0]+)$/)){o2=""+val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,"$1"),ri=o2.indexOf(".");var lres=fmt.indexOf(".")-ri,rres=fmt.length-o2.length-lres;return hashq(fmt.substr(0,lres)+o2+fmt.substr(fmt.length-rres))}if(r=fmt.match(/^00,000\.([#0]*0)$/))return ri=dec(val,r[1].length),val<0?"-"+write_num_flt(type,fmt,-val):commaify(flr(val)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function($$){return"00,"+($$.length<3?pad0(0,3-$$.length):"")+$$})+"."+pad0(ri,r[1].length);switch(fmt){case"###,##0.00":return write_num_flt(type,"#,##0.00",val);case"###,###":case"##,###":case"#,###":var x2=commaify(pad0r(aval,0));return x2!=="0"?sign+x2:"";case"###,###.00":return write_num_flt(type,"###,##0.00",val).replace(/^0\./,".");case"#,###.00":return write_num_flt(type,"#,##0.00",val).replace(/^0\./,".")}throw new Error("unsupported format |"+fmt+"|")}function write_num_cm2(type,fmt,val){for(var idx=fmt.length-1;fmt.charCodeAt(idx-1)===44;)--idx;return write_num(type,fmt.substr(0,idx),val/Math.pow(10,3*(fmt.length-idx)))}function write_num_pct2(type,fmt,val){var sfmt=fmt.replace(pct1,""),mul=fmt.length-sfmt.length;return write_num(type,sfmt,val*Math.pow(10,2*mul))+fill("%",mul)}function write_num_exp2(fmt,val){var o2,idx=fmt.indexOf("E")-fmt.indexOf(".")-1;if(fmt.match(/^#+0.0E\+0$/)){if(val==0)return"0.0E+0";if(val<0)return"-"+write_num_exp2(fmt,-val);var period=fmt.indexOf(".");period===-1&&(period=fmt.indexOf("E"));var ee2=Math.floor(Math.log(val)*Math.LOG10E)%period;if(ee2<0&&(ee2+=period),o2=(val/Math.pow(10,ee2)).toPrecision(idx+1+(period+ee2)%period),!o2.match(/[Ee]/)){var fakee=Math.floor(Math.log(val)*Math.LOG10E);o2.indexOf(".")===-1?o2=o2.charAt(0)+"."+o2.substr(1)+"E+"+(fakee-o2.length+ee2):o2+="E+"+(fakee-ee2),o2=o2.replace(/\+-/,"-")}o2=o2.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function($$,$1,$2,$3){return $1+$2+$3.substr(0,(period+ee2)%period)+"."+$3.substr(ee2)+"E"})}else o2=val.toExponential(idx);return fmt.match(/E\+00$/)&&o2.match(/e[+-]\d$/)&&(o2=o2.substr(0,o2.length-1)+"0"+o2.charAt(o2.length-1)),fmt.match(/E\-/)&&o2.match(/e\+/)&&(o2=o2.replace(/e\+/,"e")),o2.replace("e","E")}function write_num_int(type,fmt,val){if(type.charCodeAt(0)===40&&!fmt.match(closeparen)){var ffmt=fmt.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return val>=0?write_num_int("n",ffmt,val):"("+write_num_int("n",ffmt,-val)+")"}if(fmt.charCodeAt(fmt.length-1)===44)return write_num_cm2(type,fmt,val);if(fmt.indexOf("%")!==-1)return write_num_pct2(type,fmt,val);if(fmt.indexOf("E")!==-1)return write_num_exp2(fmt,val);if(fmt.charCodeAt(0)===36)return"$"+write_num_int(type,fmt.substr(fmt.charAt(1)==" "?2:1),val);var o2,r,ri,ff,aval=Math.abs(val),sign=val<0?"-":"";if(fmt.match(/^00+$/))return sign+pad0(aval,fmt.length);if(fmt.match(/^[#?]+$/))return o2=""+val,val===0&&(o2=""),o2.length>fmt.length?o2:hashq(fmt.substr(0,fmt.length-o2.length))+o2;if(r=fmt.match(frac1))return write_num_f2(r,aval,sign);if(fmt.match(/^#+0+$/))return sign+pad0(aval,fmt.length-fmt.indexOf("0"));if(r=fmt.match(dec1))return o2=(""+val).replace(/^([^\.]+)$/,"$1."+hashq(r[1])).replace(/\.$/,"."+hashq(r[1])),o2=o2.replace(/\.(\d*)$/,function($$,$1){return"."+$1+fill("0",hashq(r[1]).length-$1.length)}),fmt.indexOf("0.")!==-1?o2:o2.replace(/^0\./,".");if(fmt=fmt.replace(/^#+([0.])/,"$1"),r=fmt.match(/^(0*)\.(#*)$/))return sign+(""+aval).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,r[1].length?"0.":".");if(r=fmt.match(/^#{1,3},##0(\.?)$/))return sign+commaify(""+aval);if(r=fmt.match(/^#,##0\.([#0]*0)$/))return val<0?"-"+write_num_int(type,fmt,-val):commaify(""+val)+"."+fill("0",r[1].length);if(r=fmt.match(/^#,#*,#0/))return write_num_int(type,fmt.replace(/^#,#*,/,""),val);if(r=fmt.match(/^([0#]+)(\\?-([0#]+))+$/))return o2=_strrev(write_num_int(type,fmt.replace(/[\\-]/g,""),val)),ri=0,_strrev(_strrev(fmt.replace(/\\/g,"")).replace(/[0#]/g,function(x3){return ri<o2.length?o2.charAt(ri++):x3==="0"?"0":""}));if(fmt.match(phone))return o2=write_num_int(type,"##########",val),"("+o2.substr(0,3)+") "+o2.substr(3,3)+"-"+o2.substr(6);var oa="";if(r=fmt.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return ri=Math.min(r[4].length,7),ff=SSF_frac(aval,Math.pow(10,ri)-1,!1),o2=""+sign,oa=write_num("n",r[1],ff[1]),oa.charAt(oa.length-1)==" "&&(oa=oa.substr(0,oa.length-1)+"0"),o2+=oa+r[2]+"/"+r[3],oa=rpad_(ff[2],ri),oa.length<r[4].length&&(oa=hashq(r[4].substr(r[4].length-oa.length))+oa),o2+=oa,o2;if(r=fmt.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return ri=Math.min(Math.max(r[1].length,r[4].length),7),ff=SSF_frac(aval,Math.pow(10,ri)-1,!0),sign+(ff[0]||(ff[1]?"":"0"))+" "+(ff[1]?pad_(ff[1],ri)+r[2]+"/"+r[3]+rpad_(ff[2],ri):fill(" ",2*ri+1+r[2].length+r[3].length));if(r=fmt.match(/^[#0?]+$/))return o2=""+val,fmt.length<=o2.length?o2:hashq(fmt.substr(0,fmt.length-o2.length))+o2;if(r=fmt.match(/^([#0]+)\.([#0]+)$/)){o2=""+val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,"$1"),ri=o2.indexOf(".");var lres=fmt.indexOf(".")-ri,rres=fmt.length-o2.length-lres;return hashq(fmt.substr(0,lres)+o2+fmt.substr(fmt.length-rres))}if(r=fmt.match(/^00,000\.([#0]*0)$/))return val<0?"-"+write_num_int(type,fmt,-val):commaify(""+val).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function($$){return"00,"+($$.length<3?pad0(0,3-$$.length):"")+$$})+"."+pad0(0,r[1].length);switch(fmt){case"###,###":case"##,###":case"#,###":var x2=commaify(""+aval);return x2!=="0"?sign+x2:"";default:if(fmt.match(/\.[0#?]*$/))return write_num_int(type,fmt.slice(0,fmt.lastIndexOf(".")),val)+hashq(fmt.slice(fmt.lastIndexOf(".")))}throw new Error("unsupported format |"+fmt+"|")}function write_num(type,fmt,val){return(val|0)===val?write_num_int(type,fmt,val):write_num_flt(type,fmt,val)}function SSF_split_fmt(fmt){for(var out=[],in_str=!1,i2=0,j2=0;i2<fmt.length;++i2)switch(fmt.charCodeAt(i2)){case 34:in_str=!in_str;break;case 95:case 42:case 92:++i2;break;case 59:out[out.length]=fmt.substr(j2,i2-j2),j2=i2+1}if(out[out.length]=fmt.substr(j2),in_str===!0)throw new Error("Format |"+fmt+"| unterminated string ");return out}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(fmt){for(var i2=0,c2="",o2="";i2<fmt.length;)switch(c2=fmt.charAt(i2)){case"G":SSF_isgeneral(fmt,i2)&&(i2+=6),i2++;break;case'"':for(;fmt.charCodeAt(++i2)!==34&&i2<fmt.length;);++i2;break;case"\\":i2+=2;break;case"_":i2+=2;break;case"@":++i2;break;case"B":case"b":if(fmt.charAt(i2+1)==="1"||fmt.charAt(i2+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(fmt.substr(i2,3).toUpperCase()==="A/P"||fmt.substr(i2,5).toUpperCase()==="AM/PM"||fmt.substr(i2,5).toUpperCase()==="/")return!0;++i2;break;case"[":for(o2=c2;fmt.charAt(i2++)!=="]"&&i2<fmt.length;)o2+=fmt.charAt(i2);if(o2.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;i2<fmt.length&&("0#?.,E+-%".indexOf(c2=fmt.charAt(++i2))>-1||c2=="\\"&&fmt.charAt(i2+1)=="-"&&"0#".indexOf(fmt.charAt(i2+2))>-1););break;case"?":for(;fmt.charAt(++i2)===c2;);break;case"*":++i2,(fmt.charAt(i2)==" "||fmt.charAt(i2)=="*")&&++i2;break;case"(":case")":++i2;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;i2<fmt.length&&"0123456789".indexOf(fmt.charAt(++i2))>-1;);break;case" ":++i2;break;default:++i2;break}return!1}function eval_fmt(fmt,v2,opts,flen){for(var out=[],o2="",i2=0,c2="",lst="t",dt2,j2,cc,hr="H";i2<fmt.length;)switch(c2=fmt.charAt(i2)){case"G":if(!SSF_isgeneral(fmt,i2))throw new Error("unrecognized character "+c2+" in "+fmt);out[out.length]={t:"G",v:"General"},i2+=7;break;case'"':for(o2="";(cc=fmt.charCodeAt(++i2))!==34&&i2<fmt.length;)o2+=String.fromCharCode(cc);out[out.length]={t:"t",v:o2},++i2;break;case"\\":var w2=fmt.charAt(++i2),t2=w2==="("||w2===")"?w2:"t";out[out.length]={t:t2,v:w2},++i2;break;case"_":out[out.length]={t:"t",v:" "},i2+=2;break;case"@":out[out.length]={t:"T",v:v2},++i2;break;case"B":case"b":if(fmt.charAt(i2+1)==="1"||fmt.charAt(i2+1)==="2"){if(dt2==null&&(dt2=SSF_parse_date_code(v2,opts,fmt.charAt(i2+1)==="2"),dt2==null))return"";out[out.length]={t:"X",v:fmt.substr(i2,2)},lst=c2,i2+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c2=c2.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(v2<0||dt2==null&&(dt2=SSF_parse_date_code(v2,opts),dt2==null))return"";for(o2=c2;++i2<fmt.length&&fmt.charAt(i2).toLowerCase()===c2;)o2+=c2;c2==="m"&&lst.toLowerCase()==="h"&&(c2="M"),c2==="h"&&(c2=hr),out[out.length]={t:c2,v:o2},lst=c2;break;case"A":case"a":case"":var q2={t:c2,v:c2};if(dt2==null&&(dt2=SSF_parse_date_code(v2,opts)),fmt.substr(i2,3).toUpperCase()==="A/P"?(dt2!=null&&(q2.v=dt2.H>=12?"P":"A"),q2.t="T",hr="h",i2+=3):fmt.substr(i2,5).toUpperCase()==="AM/PM"?(dt2!=null&&(q2.v=dt2.H>=12?"PM":"AM"),q2.t="T",i2+=5,hr="h"):fmt.substr(i2,5).toUpperCase()==="/"?(dt2!=null&&(q2.v=dt2.H>=12?"":""),q2.t="T",i2+=5,hr="h"):(q2.t="t",++i2),dt2==null&&q2.t==="T")return"";out[out.length]=q2,lst=c2;break;case"[":for(o2=c2;fmt.charAt(i2++)!=="]"&&i2<fmt.length;)o2+=fmt.charAt(i2);if(o2.slice(-1)!=="]")throw'unterminated "[" block: |'+o2+"|";if(o2.match(SSF_abstime)){if(dt2==null&&(dt2=SSF_parse_date_code(v2,opts),dt2==null))return"";out[out.length]={t:"Z",v:o2.toLowerCase()},lst=o2.charAt(1)}else o2.indexOf("$")>-1&&(o2=(o2.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(fmt)||(out[out.length]={t:"t",v:o2}));break;case".":if(dt2!=null){for(o2=c2;++i2<fmt.length&&(c2=fmt.charAt(i2))==="0";)o2+=c2;out[out.length]={t:"s",v:o2};break}case"0":case"#":for(o2=c2;++i2<fmt.length&&"0#?.,E+-%".indexOf(c2=fmt.charAt(i2))>-1;)o2+=c2;out[out.length]={t:"n",v:o2};break;case"?":for(o2=c2;fmt.charAt(++i2)===c2;)o2+=c2;out[out.length]={t:c2,v:o2},lst=c2;break;case"*":++i2,(fmt.charAt(i2)==" "||fmt.charAt(i2)=="*")&&++i2;break;case"(":case")":out[out.length]={t:flen===1?"t":c2,v:c2},++i2;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o2=c2;i2<fmt.length&&"0123456789".indexOf(fmt.charAt(++i2))>-1;)o2+=fmt.charAt(i2);out[out.length]={t:"D",v:o2};break;case" ":out[out.length]={t:c2,v:c2},++i2;break;case"$":out[out.length]={t:"t",v:"$"},++i2;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c2)===-1)throw new Error("unrecognized character "+c2+" in "+fmt);out[out.length]={t:"t",v:c2},++i2;break}var bt2=0,ss0=0,ssm;for(i2=out.length-1,lst="t";i2>=0;--i2)switch(out[i2].t){case"h":case"H":out[i2].t=hr,lst="h",bt2<1&&(bt2=1);break;case"s":(ssm=out[i2].v.match(/\.0+$/))&&(ss0=Math.max(ss0,ssm[0].length-1)),bt2<3&&(bt2=3);case"d":case"y":case"M":case"e":lst=out[i2].t;break;case"m":lst==="s"&&(out[i2].t="M",bt2<2&&(bt2=2));break;case"X":break;case"Z":bt2<1&&out[i2].v.match(/[Hh]/)&&(bt2=1),bt2<2&&out[i2].v.match(/[Mm]/)&&(bt2=2),bt2<3&&out[i2].v.match(/[Ss]/)&&(bt2=3)}switch(bt2){case 0:break;case 1:dt2.u>=.5&&(dt2.u=0,++dt2.S),dt2.S>=60&&(dt2.S=0,++dt2.M),dt2.M>=60&&(dt2.M=0,++dt2.H);break;case 2:dt2.u>=.5&&(dt2.u=0,++dt2.S),dt2.S>=60&&(dt2.S=0,++dt2.M);break}var nstr="",jj;for(i2=0;i2<out.length;++i2)switch(out[i2].t){case"t":case"T":case" ":case"D":break;case"X":out[i2].v="",out[i2].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":out[i2].v=SSF_write_date(out[i2].t.charCodeAt(0),out[i2].v,dt2,ss0),out[i2].t="t";break;case"n":case"?":for(jj=i2+1;out[jj]!=null&&((c2=out[jj].t)==="?"||c2==="D"||(c2===" "||c2==="t")&&out[jj+1]!=null&&(out[jj+1].t==="?"||out[jj+1].t==="t"&&out[jj+1].v==="/")||out[i2].t==="("&&(c2===" "||c2==="n"||c2===")")||c2==="t"&&(out[jj].v==="/"||out[jj].v===" "&&out[jj+1]!=null&&out[jj+1].t=="?"));)out[i2].v+=out[jj].v,out[jj]={v:"",t:";"},++jj;nstr+=out[i2].v,i2=jj-1;break;case"G":out[i2].t="t",out[i2].v=SSF_general(v2,opts);break}var vv="",myv,ostr;if(nstr.length>0){nstr.charCodeAt(0)==40?(myv=v2<0&&nstr.charCodeAt(0)===45?-v2:v2,ostr=write_num("n",nstr,myv)):(myv=v2<0&&flen>1?-v2:v2,ostr=write_num("n",nstr,myv),myv<0&&out[0]&&out[0].t=="t"&&(ostr=ostr.substr(1),out[0].v="-"+out[0].v)),jj=ostr.length-1;var decpt=out.length;for(i2=0;i2<out.length;++i2)if(out[i2]!=null&&out[i2].t!="t"&&out[i2].v.indexOf(".")>-1){decpt=i2;break}var lasti=out.length;if(decpt===out.length&&ostr.indexOf("E")===-1){for(i2=out.length-1;i2>=0;--i2)out[i2]==null||"n?".indexOf(out[i2].t)===-1||(jj>=out[i2].v.length-1?(jj-=out[i2].v.length,out[i2].v=ostr.substr(jj+1,out[i2].v.length)):jj<0?out[i2].v="":(out[i2].v=ostr.substr(0,jj+1),jj=-1),out[i2].t="t",lasti=i2);jj>=0&&lasti<out.length&&(out[lasti].v=ostr.substr(0,jj+1)+out[lasti].v)}else if(decpt!==out.length&&ostr.indexOf("E")===-1){for(jj=ostr.indexOf(".")-1,i2=decpt;i2>=0;--i2)if(!(out[i2]==null||"n?".indexOf(out[i2].t)===-1)){for(j2=out[i2].v.indexOf(".")>-1&&i2===decpt?out[i2].v.indexOf(".")-1:out[i2].v.length-1,vv=out[i2].v.substr(j2+1);j2>=0;--j2)jj>=0&&(out[i2].v.charAt(j2)==="0"||out[i2].v.charAt(j2)==="#")&&(vv=ostr.charAt(jj--)+vv);out[i2].v=vv,out[i2].t="t",lasti=i2}for(jj>=0&&lasti<out.length&&(out[lasti].v=ostr.substr(0,jj+1)+out[lasti].v),jj=ostr.indexOf(".")+1,i2=decpt;i2<out.length;++i2)if(!(out[i2]==null||"n?(".indexOf(out[i2].t)===-1&&i2!==decpt)){for(j2=out[i2].v.indexOf(".")>-1&&i2===decpt?out[i2].v.indexOf(".")+1:0,vv=out[i2].v.substr(0,j2);j2<out[i2].v.length;++j2)jj<ostr.length&&(vv+=ostr.charAt(jj++));out[i2].v=vv,out[i2].t="t",lasti=i2}}}for(i2=0;i2<out.length;++i2)out[i2]!=null&&"n?".indexOf(out[i2].t)>-1&&(myv=flen>1&&v2<0&&i2>0&&out[i2-1].v==="-"?-v2:v2,out[i2].v=write_num(out[i2].t,out[i2].v,myv),out[i2].t="t");var retval="";for(i2=0;i2!==out.length;++i2)out[i2]!=null&&(retval+=out[i2].v);return retval}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(v2,rr){if(rr==null)return!1;var thresh=parseFloat(rr[2]);switch(rr[1]){case"=":if(v2==thresh)return!0;break;case">":if(v2>thresh)return!0;break;case"<":if(v2<thresh)return!0;break;case"<>":if(v2!=thresh)return!0;break;case">=":if(v2>=thresh)return!0;break;case"<=":if(v2<=thresh)return!0;break}return!1}function choose_fmt(f2,v2){var fmt=SSF_split_fmt(f2),l2=fmt.length,lat=fmt[l2-1].indexOf("@");if(l2<4&&lat>-1&&--l2,fmt.length>4)throw new Error("cannot find right format for |"+fmt.join("|")+"|");if(typeof v2!="number")return[4,fmt.length===4||lat>-1?fmt[fmt.length-1]:"@"];switch(fmt.length){case 1:fmt=lat>-1?["General","General","General",fmt[0]]:[fmt[0],fmt[0],fmt[0],"@"];break;case 2:fmt=lat>-1?[fmt[0],fmt[0],fmt[0],fmt[1]]:[fmt[0],fmt[1],fmt[0],"@"];break;case 3:fmt=lat>-1?[fmt[0],fmt[1],fmt[0],fmt[2]]:[fmt[0],fmt[1],fmt[2],"@"];break}var ff=v2>0?fmt[0]:v2<0?fmt[1]:fmt[2];if(fmt[0].indexOf("[")===-1&&fmt[1].indexOf("[")===-1)return[l2,ff];if(fmt[0].match(/\[[=<>]/)!=null||fmt[1].match(/\[[=<>]/)!=null){var m1=fmt[0].match(cfregex2),m2=fmt[1].match(cfregex2);return chkcond(v2,m1)?[l2,fmt[0]]:chkcond(v2,m2)?[l2,fmt[1]]:[l2,fmt[m1!=null&&m2!=null?2:1]]}return[l2,ff]}function SSF_format(fmt,v2,o2){o2==null&&(o2={});var sfmt="";switch(typeof fmt){case"string":fmt=="m/d/yy"&&o2.dateNF?sfmt=o2.dateNF:sfmt=fmt;break;case"number":fmt==14&&o2.dateNF?sfmt=o2.dateNF:sfmt=(o2.table!=null?o2.table:table_fmt)[fmt],sfmt==null&&(sfmt=o2.table&&o2.table[SSF_default_map[fmt]]||table_fmt[SSF_default_map[fmt]]),sfmt==null&&(sfmt=SSF_default_str[fmt]||"General");break}if(SSF_isgeneral(sfmt,0))return SSF_general(v2,o2);v2 instanceof Date&&(v2=datenum_local(v2,o2.date1904));var f2=choose_fmt(sfmt,v2);if(SSF_isgeneral(f2[1]))return SSF_general(v2,o2);if(v2===!0)v2="TRUE";else if(v2===!1)v2="FALSE";else if(v2===""||v2==null)return"";return eval_fmt(f2[1],v2,o2,f2[0])}function SSF_load(fmt,idx){if(typeof idx!="number"){idx=+idx||-1;for(var i2=0;i2<392;++i2){if(table_fmt[i2]==null){idx<0&&(idx=i2);continue}if(table_fmt[i2]==fmt){idx=i2;break}}idx<0&&(idx=391)}return table_fmt[idx]=fmt,idx}function SSF_load_table(tbl){for(var i2=0;i2!=392;++i2)tbl[i2]!==void 0&&SSF_load(tbl[i2],i2)}function make_ssf(){table_fmt=SSF_init_table()}var dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(dateNF){var fmt=typeof dateNF=="number"?table_fmt[dateNF]:dateNF;return fmt=fmt.replace(dateNFregex,"(\\d+)"),new RegExp("^"+fmt+"$")}function dateNF_fix(str,dateNF,match){var Y2=-1,m2=-1,d2=-1,H2=-1,M2=-1,S2=-1;(dateNF.match(dateNFregex)||[]).forEach(function(n,i2){var v2=parseInt(match[i2+1],10);switch(n.toLowerCase().charAt(0)){case"y":Y2=v2;break;case"d":d2=v2;break;case"h":H2=v2;break;case"s":S2=v2;break;case"m":H2>=0?M2=v2:m2=v2;break}}),S2>=0&&M2==-1&&m2>=0&&(M2=m2,m2=-1);var datestr=(""+(Y2>=0?Y2:new Date().getFullYear())).slice(-4)+"-"+("00"+(m2>=1?m2:1)).slice(-2)+"-"+("00"+(d2>=1?d2:1)).slice(-2);datestr.length==7&&(datestr="0"+datestr),datestr.length==8&&(datestr="20"+datestr);var timestr=("00"+(H2>=0?H2:0)).slice(-2)+":"+("00"+(M2>=0?M2:0)).slice(-2)+":"+("00"+(S2>=0?S2:0)).slice(-2);return H2==-1&&M2==-1&&S2==-1?datestr:Y2==-1&&m2==-1&&d2==-1?timestr:datestr+"T"+timestr}var CRC32=(function(){var CRC322={};CRC322.version="1.2.0";function signed_crc_table(){for(var c2=0,table=new Array(256),n=0;n!=256;++n)c2=n,c2=c2&1?-306674912^c2>>>1:c2>>>1,c2=c2&1?-306674912^c2>>>1:c2>>>1,c2=c2&1?-306674912^c2>>>1:c2>>>1,c2=c2&1?-306674912^c2>>>1:c2>>>1,c2=c2&1?-306674912^c2>>>1:c2>>>1,c2=c2&1?-306674912^c2>>>1:c2>>>1,c2=c2&1?-306674912^c2>>>1:c2>>>1,c2=c2&1?-306674912^c2>>>1:c2>>>1,table[n]=c2;return typeof Int32Array<"u"?new Int32Array(table):table}var T0=signed_crc_table();function slice_by_16_tables(T10){var c2=0,v2=0,n=0,table=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(n=0;n!=256;++n)table[n]=T10[n];for(n=0;n!=256;++n)for(v2=T10[n],c2=256+n;c2<4096;c2+=256)v2=table[c2]=v2>>>8^T10[v2&255];var out=[];for(n=1;n!=16;++n)out[n-1]=typeof Int32Array<"u"?table.subarray(n*256,n*256+256):table.slice(n*256,n*256+256);return out}var TT=slice_by_16_tables(T0),T1=TT[0],T2=TT[1],T3=TT[2],T4=TT[3],T5=TT[4],T6=TT[5],T7=TT[6],T8=TT[7],T9=TT[8],Ta=TT[9],Tb=TT[10],Tc=TT[11],Td=TT[12],Te=TT[13],Tf=TT[14];function crc32_bstr(bstr,seed){for(var C2=seed^-1,i2=0,L2=bstr.length;i2<L2;)C2=C2>>>8^T0[(C2^bstr.charCodeAt(i2++))&255];return~C2}function crc32_buf(B2,seed){for(var C2=seed^-1,L2=B2.length-15,i2=0;i2<L2;)C2=Tf[B2[i2++]^C2&255]^Te[B2[i2++]^C2>>8&255]^Td[B2[i2++]^C2>>16&255]^Tc[B2[i2++]^C2>>>24]^Tb[B2[i2++]]^Ta[B2[i2++]]^T9[B2[i2++]]^T8[B2[i2++]]^T7[B2[i2++]]^T6[B2[i2++]]^T5[B2[i2++]]^T4[B2[i2++]]^T3[B2[i2++]]^T2[B2[i2++]]^T1[B2[i2++]]^T0[B2[i2++]];for(L2+=15;i2<L2;)C2=C2>>>8^T0[(C2^B2[i2++])&255];return~C2}function crc32_str(str,seed){for(var C2=seed^-1,i2=0,L2=str.length,c2=0,d2=0;i2<L2;)c2=str.charCodeAt(i2++),c2<128?C2=C2>>>8^T0[(C2^c2)&255]:c2<2048?(C2=C2>>>8^T0[(C2^(192|c2>>6&31))&255],C2=C2>>>8^T0[(C2^(128|c2&63))&255]):c2>=55296&&c2<57344?(c2=(c2&1023)+64,d2=str.charCodeAt(i2++)&1023,C2=C2>>>8^T0[(C2^(240|c2>>8&7))&255],C2=C2>>>8^T0[(C2^(128|c2>>2&63))&255],C2=C2>>>8^T0[(C2^(128|d2>>6&15|(c2&3)<<4))&255],C2=C2>>>8^T0[(C2^(128|d2&63))&255]):(C2=C2>>>8^T0[(C2^(224|c2>>12&15))&255],C2=C2>>>8^T0[(C2^(128|c2>>6&63))&255],C2=C2>>>8^T0[(C2^(128|c2&63))&255]);return~C2}return CRC322.table=T0,CRC322.bstr=crc32_bstr,CRC322.buf=crc32_buf,CRC322.str=crc32_str,CRC322})(),CFB=(function(){var exports$1={};exports$1.version="1.2.1";function namecmp(l2,r){for(var L2=l2.split("/"),R2=r.split("/"),i3=0,c2=0,Z2=Math.min(L2.length,R2.length);i3<Z2;++i3){if(c2=L2[i3].length-R2[i3].length)return c2;if(L2[i3]!=R2[i3])return L2[i3]<R2[i3]?-1:1}return L2.length-R2.length}function dirname(p2){if(p2.charAt(p2.length-1)=="/")return p2.slice(0,-1).indexOf("/")===-1?p2:dirname(p2.slice(0,-1));var c2=p2.lastIndexOf("/");return c2===-1?p2:p2.slice(0,c2+1)}function filename(p2){if(p2.charAt(p2.length-1)=="/")return filename(p2.slice(0,-1));var c2=p2.lastIndexOf("/");return c2===-1?p2:p2.slice(c2+1)}function write_dos_date(buf,date){typeof date=="string"&&(date=new Date(date));var hms=date.getHours();hms=hms<<6|date.getMinutes(),hms=hms<<5|date.getSeconds()>>>1,buf.write_shift(2,hms);var ymd=date.getFullYear()-1980;ymd=ymd<<4|date.getMonth()+1,ymd=ymd<<5|date.getDate(),buf.write_shift(2,ymd)}function parse_dos_date(buf){var hms=buf.read_shift(2)&65535,ymd=buf.read_shift(2)&65535,val=new Date,d2=ymd&31;ymd>>>=5;var m2=ymd&15;ymd>>>=4,val.setMilliseconds(0),val.setFullYear(ymd+1980),val.setMonth(m2-1),val.setDate(d2);var S2=hms&31;hms>>>=5;var M2=hms&63;return hms>>>=6,val.setHours(hms),val.setMinutes(M2),val.setSeconds(S2<<1),val}function parse_extra_field(blob){prep_blob(blob,0);for(var o2={},flags=0;blob.l<=blob.length-4;){var type=blob.read_shift(2),sz=blob.read_shift(2),tgt=blob.l+sz,p2={};switch(type){case 21589:flags=blob.read_shift(1),flags&1&&(p2.mtime=blob.read_shift(4)),sz>5&&(flags&2&&(p2.atime=blob.read_shift(4)),flags&4&&(p2.ctime=blob.read_shift(4))),p2.mtime&&(p2.mt=new Date(p2.mtime*1e3));break}blob.l=tgt,o2[type]=p2}return o2}var fs;function get_fs(){return fs||(fs={})}function parse(file,options){if(file[0]==80&&file[1]==75)return parse_zip(file,options);if((file[0]|32)==109&&(file[1]|32)==105)return parse_mad(file,options);if(file.length<512)throw new Error("CFB file size "+file.length+" < 512");var mver=3,ssz=512,nmfs=0,difat_sec_cnt=0,dir_start=0,minifat_start=0,difat_start=0,fat_addrs=[],blob=file.slice(0,512);prep_blob(blob,0);var mv=check_get_mver(blob);switch(mver=mv[0],mver){case 3:ssz=512;break;case 4:ssz=4096;break;case 0:if(mv[1]==0)return parse_zip(file,options);default:throw new Error("Major Version: Expected 3 or 4 saw "+mver)}ssz!==512&&(blob=file.slice(0,ssz),prep_blob(blob,28));var header=file.slice(0,ssz);check_shifts(blob,mver);var dir_cnt=blob.read_shift(4,"i");if(mver===3&&dir_cnt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+dir_cnt);blob.l+=4,dir_start=blob.read_shift(4,"i"),blob.l+=4,blob.chk("00100000","Mini Stream Cutoff Size: "),minifat_start=blob.read_shift(4,"i"),nmfs=blob.read_shift(4,"i"),difat_start=blob.read_shift(4,"i"),difat_sec_cnt=blob.read_shift(4,"i");for(var q3=-1,j2=0;j2<109&&(q3=blob.read_shift(4,"i"),!(q3<0));++j2)fat_addrs[j2]=q3;var sectors=sectorify(file,ssz);sleuth_fat(difat_start,difat_sec_cnt,sectors,ssz,fat_addrs);var sector_list=make_sector_list(sectors,dir_start,fat_addrs,ssz);sector_list[dir_start].name="!Directory",nmfs>0&&minifat_start!==ENDOFCHAIN&&(sector_list[minifat_start].name="!MiniFAT"),sector_list[fat_addrs[0]].name="!FAT",sector_list.fat_addrs=fat_addrs,sector_list.ssz=ssz;var files={},Paths=[],FileIndex=[],FullPaths=[];read_directory(dir_start,sector_list,sectors,Paths,nmfs,files,FileIndex,minifat_start),build_full_paths(FileIndex,FullPaths,Paths),Paths.shift();var o2={FileIndex,FullPaths};return options&&options.raw&&(o2.raw={header,sectors}),o2}function check_get_mver(blob){if(blob[blob.l]==80&&blob[blob.l+1]==75)return[0,0];blob.chk(HEADER_SIGNATURE,"Header Signature: "),blob.l+=16;var mver=blob.read_shift(2,"u");return[blob.read_shift(2,"u"),mver]}function check_shifts(blob,mver){var shift=9;switch(blob.l+=2,shift=blob.read_shift(2)){case 9:if(mver!=3)throw new Error("Sector Shift: Expected 9 saw "+shift);break;case 12:if(mver!=4)throw new Error("Sector Shift: Expected 12 saw "+shift);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+shift)}blob.chk("0600","Mini Sector Shift: "),blob.chk("000000000000","Reserved: ")}function sectorify(file,ssz){for(var nsectors=Math.ceil(file.length/ssz)-1,sectors=[],i3=1;i3<nsectors;++i3)sectors[i3-1]=file.slice(i3*ssz,(i3+1)*ssz);return sectors[nsectors-1]=file.slice(nsectors*ssz),sectors}function build_full_paths(FI,FP,Paths){for(var i3=0,L2=0,R2=0,C2=0,j2=0,pl=Paths.length,dad=[],q3=[];i3<pl;++i3)dad[i3]=q3[i3]=i3,FP[i3]=Paths[i3];for(;j2<q3.length;++j2)i3=q3[j2],L2=FI[i3].L,R2=FI[i3].R,C2=FI[i3].C,dad[i3]===i3&&(L2!==-1&&dad[L2]!==L2&&(dad[i3]=dad[L2]),R2!==-1&&dad[R2]!==R2&&(dad[i3]=dad[R2])),C2!==-1&&(dad[C2]=i3),L2!==-1&&i3!=dad[i3]&&(dad[L2]=dad[i3],q3.lastIndexOf(L2)<j2&&q3.push(L2)),R2!==-1&&i3!=dad[i3]&&(dad[R2]=dad[i3],q3.lastIndexOf(R2)<j2&&q3.push(R2));for(i3=1;i3<pl;++i3)dad[i3]===i3&&(R2!==-1&&dad[R2]!==R2?dad[i3]=dad[R2]:L2!==-1&&dad[L2]!==L2&&(dad[i3]=dad[L2]));for(i3=1;i3<pl;++i3)if(FI[i3].type!==0){if(j2=i3,j2!=dad[j2])do j2=dad[j2],FP[i3]=FP[j2]+"/"+FP[i3];while(j2!==0&&dad[j2]!==-1&&j2!=dad[j2]);dad[i3]=-1}for(FP[0]+="/",i3=1;i3<pl;++i3)FI[i3].type!==2&&(FP[i3]+="/")}function get_mfat_entry(entry,payload,mini){for(var start=entry.start,size=entry.size,o2=[],idx=start;mini&&size>0&&idx>=0;)o2.push(payload.slice(idx*MSSZ,idx*MSSZ+MSSZ)),size-=MSSZ,idx=__readInt32LE(mini,idx*4);return o2.length===0?new_buf(0):bconcat(o2).slice(0,entry.size)}function sleuth_fat(idx,cnt,sectors,ssz,fat_addrs){var q3=ENDOFCHAIN;if(idx===ENDOFCHAIN){if(cnt!==0)throw new Error("DIFAT chain shorter than expected")}else if(idx!==-1){var sector=sectors[idx],m2=(ssz>>>2)-1;if(!sector)return;for(var i3=0;i3<m2&&(q3=__readInt32LE(sector,i3*4))!==ENDOFCHAIN;++i3)fat_addrs.push(q3);sleuth_fat(__readInt32LE(sector,ssz-4),cnt-1,sectors,ssz,fat_addrs)}}function get_sector_list(sectors,start,fat_addrs,ssz,chkd){var buf=[],buf_chain=[];chkd||(chkd=[]);var modulus=ssz-1,j2=0,jj=0;for(j2=start;j2>=0;){chkd[j2]=!0,buf[buf.length]=j2,buf_chain.push(sectors[j2]);var addr=fat_addrs[Math.floor(j2*4/ssz)];if(jj=j2*4&modulus,ssz<4+jj)throw new Error("FAT boundary crossed: "+j2+" 4 "+ssz);if(!sectors[addr])break;j2=__readInt32LE(sectors[addr],jj)}return{nodes:buf,data:__toBuffer([buf_chain])}}function make_sector_list(sectors,dir_start,fat_addrs,ssz){var sl=sectors.length,sector_list=[],chkd=[],buf=[],buf_chain=[],modulus=ssz-1,i3=0,j2=0,k2=0,jj=0;for(i3=0;i3<sl;++i3)if(buf=[],k2=i3+dir_start,k2>=sl&&(k2-=sl),!chkd[k2]){buf_chain=[];var seen=[];for(j2=k2;j2>=0;){seen[j2]=!0,chkd[j2]=!0,buf[buf.length]=j2,buf_chain.push(sectors[j2]);var addr=fat_addrs[Math.floor(j2*4/ssz)];if(jj=j2*4&modulus,ssz<4+jj)throw new Error("FAT boundary crossed: "+j2+" 4 "+ssz);if(!sectors[addr]||(j2=__readInt32LE(sectors[addr],jj),seen[j2]))break}sector_list[k2]={nodes:buf,data:__toBuffer([buf_chain])}}return sector_list}function read_directory(dir_start,sector_list,sectors,Paths,nmfs,files,FileIndex,mini){for(var minifat_store=0,pl=Paths.length?2:0,sector=sector_list[dir_start].data,i3=0,namelen=0,name;i3<sector.length;i3+=128){var blob=sector.slice(i3,i3+128);prep_blob(blob,64),namelen=blob.read_shift(2),name=__utf16le(blob,0,namelen-pl),Paths.push(name);var o2={name,type:blob.read_shift(1),color:blob.read_shift(1),L:blob.read_shift(4,"i"),R:blob.read_shift(4,"i"),C:blob.read_shift(4,"i"),clsid:blob.read_shift(16),state:blob.read_shift(4,"i"),start:0,size:0},ctime=blob.read_shift(2)+blob.read_shift(2)+blob.read_shift(2)+blob.read_shift(2);ctime!==0&&(o2.ct=read_date(blob,blob.l-8));var mtime=blob.read_shift(2)+blob.read_shift(2)+blob.read_shift(2)+blob.read_shift(2);mtime!==0&&(o2.mt=read_date(blob,blob.l-8)),o2.start=blob.read_shift(4,"i"),o2.size=blob.read_shift(4,"i"),o2.size<0&&o2.start<0&&(o2.size=o2.type=0,o2.start=ENDOFCHAIN,o2.name=""),o2.type===5?(minifat_store=o2.start,nmfs>0&&minifat_store!==ENDOFCHAIN&&(sector_list[minifat_store].name="!StreamData")):o2.size>=4096?(o2.storage="fat",sector_list[o2.start]===void 0&&(sector_list[o2.start]=get_sector_list(sectors,o2.start,sector_list.fat_addrs,sector_list.ssz)),sector_list[o2.start].name=o2.name,o2.content=sector_list[o2.start].data.slice(0,o2.size)):(o2.storage="minifat",o2.size<0?o2.size=0:minifat_store!==ENDOFCHAIN&&o2.start!==ENDOFCHAIN&&sector_list[minifat_store]&&(o2.content=get_mfat_entry(o2,sector_list[minifat_store].data,(sector_list[mini]||{}).data))),o2.content&&prep_blob(o2.content,0),files[name]=o2,FileIndex.push(o2)}}function read_date(blob,offset){return new Date((__readUInt32LE(blob,offset+4)/1e7*Math.pow(2,32)+__readUInt32LE(blob,offset)/1e7-11644473600)*1e3)}function read_file(filename2,options){return get_fs(),parse(fs.readFileSync(filename2),options)}function read(blob,options){var type=options&&options.type;switch(type||has_buf&&Buffer.isBuffer(blob)&&(type="buffer"),type||"base64"){case"file":return read_file(blob,options);case"base64":return parse(s2a(Base64_decode(blob)),options);case"binary":return parse(s2a(blob),options)}return parse(blob,options)}function init_cfb(cfb,opts){var o2=opts||{},root=o2.root||"Root Entry";if(cfb.FullPaths||(cfb.FullPaths=[]),cfb.FileIndex||(cfb.FileIndex=[]),cfb.FullPaths.length!==cfb.FileIndex.length)throw new Error("inconsistent CFB structure");cfb.FullPaths.length===0&&(cfb.FullPaths[0]=root+"/",cfb.FileIndex[0]={name:root,type:5}),o2.CLSID&&(cfb.FileIndex[0].clsid=o2.CLSID),seed_cfb(cfb)}function seed_cfb(cfb){var nm="Sh33tJ5";if(!CFB.find(cfb,"/"+nm)){var p2=new_buf(4);p2[0]=55,p2[1]=p2[3]=50,p2[2]=54,cfb.FileIndex.push({name:nm,type:2,content:p2,size:4,L:69,R:69,C:69}),cfb.FullPaths.push(cfb.FullPaths[0]+nm),rebuild_cfb(cfb)}}function rebuild_cfb(cfb,f2){init_cfb(cfb);for(var gc=!1,s2=!1,i3=cfb.FullPaths.length-1;i3>=0;--i3){var _file=cfb.FileIndex[i3];switch(_file.type){case 0:s2?gc=!0:(cfb.FileIndex.pop(),cfb.FullPaths.pop());break;case 1:case 2:case 5:s2=!0,isNaN(_file.R*_file.L*_file.C)&&(gc=!0),_file.R>-1&&_file.L>-1&&_file.R==_file.L&&(gc=!0);break;default:gc=!0;break}}if(!(!gc&&!f2)){var now=new Date(1987,1,19),j2=0,fullPaths=Object.create?Object.create(null):{},data=[];for(i3=0;i3<cfb.FullPaths.length;++i3)fullPaths[cfb.FullPaths[i3]]=!0,cfb.FileIndex[i3].type!==0&&data.push([cfb.FullPaths[i3],cfb.FileIndex[i3]]);for(i3=0;i3<data.length;++i3){var dad=dirname(data[i3][0]);s2=fullPaths[dad],s2||(data.push([dad,{name:filename(dad).replace("/",""),type:1,clsid:HEADER_CLSID,ct:now,mt:now,content:null}]),fullPaths[dad]=!0)}for(data.sort(function(x2,y2){return namecmp(x2[0],y2[0])}),cfb.FullPaths=[],cfb.FileIndex=[],i3=0;i3<data.length;++i3)cfb.FullPaths[i3]=data[i3][0],cfb.FileIndex[i3]=data[i3][1];for(i3=0;i3<data.length;++i3){var elt=cfb.FileIndex[i3],nm=cfb.FullPaths[i3];if(elt.name=filename(nm).replace("/",""),elt.L=elt.R=elt.C=-(elt.color=1),elt.size=elt.content?elt.content.length:0,elt.start=0,elt.clsid=elt.clsid||HEADER_CLSID,i3===0)elt.C=data.length>1?1:-1,elt.size=0,elt.type=5;else if(nm.slice(-1)=="/"){for(j2=i3+1;j2<data.length&&dirname(cfb.FullPaths[j2])!=nm;++j2);for(elt.C=j2>=data.length?-1:j2,j2=i3+1;j2<data.length&&dirname(cfb.FullPaths[j2])!=dirname(nm);++j2);elt.R=j2>=data.length?-1:j2,elt.type=1}else dirname(cfb.FullPaths[i3+1]||"")==dirname(nm)&&(elt.R=i3+1),elt.type=2}}}function _write(cfb,options){var _opts=options||{};if(_opts.fileType=="mad")return write_mad(cfb,_opts);switch(rebuild_cfb(cfb),_opts.fileType){case"zip":return write_zip2(cfb,_opts)}var L2=(function(cfb2){for(var mini_size=0,fat_size=0,i4=0;i4<cfb2.FileIndex.length;++i4){var file2=cfb2.FileIndex[i4];if(file2.content){var flen2=file2.content.length;flen2>0&&(flen2<4096?mini_size+=flen2+63>>6:fat_size+=flen2+511>>9)}}for(var dir_cnt=cfb2.FullPaths.length+3>>2,mini_cnt=mini_size+7>>3,mfat_cnt=mini_size+127>>7,fat_base=mini_cnt+fat_size+dir_cnt+mfat_cnt,fat_cnt=fat_base+127>>7,difat_cnt=fat_cnt<=109?0:Math.ceil((fat_cnt-109)/127);fat_base+fat_cnt+difat_cnt+127>>7>fat_cnt;)difat_cnt=++fat_cnt<=109?0:Math.ceil((fat_cnt-109)/127);var L3=[1,difat_cnt,fat_cnt,mfat_cnt,dir_cnt,fat_size,mini_size,0];return cfb2.FileIndex[0].size=mini_size<<6,L3[7]=(cfb2.FileIndex[0].start=L3[0]+L3[1]+L3[2]+L3[3]+L3[4]+L3[5])+(L3[6]+7>>3),L3})(cfb),o2=new_buf(L2[7]<<9),i3=0,T2=0;{for(i3=0;i3<8;++i3)o2.write_shift(1,HEADER_SIG[i3]);for(i3=0;i3<8;++i3)o2.write_shift(2,0);for(o2.write_shift(2,62),o2.write_shift(2,3),o2.write_shift(2,65534),o2.write_shift(2,9),o2.write_shift(2,6),i3=0;i3<3;++i3)o2.write_shift(2,0);for(o2.write_shift(4,0),o2.write_shift(4,L2[2]),o2.write_shift(4,L2[0]+L2[1]+L2[2]+L2[3]-1),o2.write_shift(4,0),o2.write_shift(4,4096),o2.write_shift(4,L2[3]?L2[0]+L2[1]+L2[2]-1:ENDOFCHAIN),o2.write_shift(4,L2[3]),o2.write_shift(-4,L2[1]?L2[0]-1:ENDOFCHAIN),o2.write_shift(4,L2[1]),i3=0;i3<109;++i3)o2.write_shift(-4,i3<L2[2]?L2[1]+i3:-1)}if(L2[1])for(T2=0;T2<L2[1];++T2){for(;i3<236+T2*127;++i3)o2.write_shift(-4,i3<L2[2]?L2[1]+i3:-1);o2.write_shift(-4,T2===L2[1]-1?ENDOFCHAIN:T2+1)}var chainit=function(w2){for(T2+=w2;i3<T2-1;++i3)o2.write_shift(-4,i3+1);w2&&(++i3,o2.write_shift(-4,ENDOFCHAIN))};for(T2=i3=0,T2+=L2[1];i3<T2;++i3)o2.write_shift(-4,consts.DIFSECT);for(T2+=L2[2];i3<T2;++i3)o2.write_shift(-4,consts.FATSECT);chainit(L2[3]),chainit(L2[4]);for(var j2=0,flen=0,file=cfb.FileIndex[0];j2<cfb.FileIndex.length;++j2)file=cfb.FileIndex[j2],file.content&&(flen=file.content.length,!(flen<4096)&&(file.start=T2,chainit(flen+511>>9)));for(chainit(L2[6]+7>>3);o2.l&511;)o2.write_shift(-4,consts.ENDOFCHAIN);for(T2=i3=0,j2=0;j2<cfb.FileIndex.length;++j2)file=cfb.FileIndex[j2],file.content&&(flen=file.content.length,!(!flen||flen>=4096)&&(file.start=T2,chainit(flen+63>>6)));for(;o2.l&511;)o2.write_shift(-4,consts.ENDOFCHAIN);for(i3=0;i3<L2[4]<<2;++i3){var nm=cfb.FullPaths[i3];if(!nm||nm.length===0){for(j2=0;j2<17;++j2)o2.write_shift(4,0);for(j2=0;j2<3;++j2)o2.write_shift(4,-1);for(j2=0;j2<12;++j2)o2.write_shift(4,0);continue}file=cfb.FileIndex[i3],i3===0&&(file.start=file.size?file.start-1:ENDOFCHAIN);var _nm=i3===0&&_opts.root||file.name;if(flen=2*(_nm.length+1),o2.write_shift(64,_nm,"utf16le"),o2.write_shift(2,flen),o2.write_shift(1,file.type),o2.write_shift(1,file.color),o2.write_shift(-4,file.L),o2.write_shift(-4,file.R),o2.write_shift(-4,file.C),file.clsid)o2.write_shift(16,file.clsid,"hex");else for(j2=0;j2<4;++j2)o2.write_shift(4,0);o2.write_shift(4,file.state||0),o2.write_shift(4,0),o2.write_shift(4,0),o2.write_shift(4,0),o2.write_shift(4,0),o2.write_shift(4,file.start),o2.write_shift(4,file.size),o2.write_shift(4,0)}for(i3=1;i3<cfb.FileIndex.length;++i3)if(file=cfb.FileIndex[i3],file.size>=4096)if(o2.l=file.start+1<<9,has_buf&&Buffer.isBuffer(file.content))file.content.copy(o2,o2.l,0,file.size),o2.l+=file.size+511&-512;else{for(j2=0;j2<file.size;++j2)o2.write_shift(1,file.content[j2]);for(;j2&511;++j2)o2.write_shift(1,0)}for(i3=1;i3<cfb.FileIndex.length;++i3)if(file=cfb.FileIndex[i3],file.size>0&&file.size<4096)if(has_buf&&Buffer.isBuffer(file.content))file.content.copy(o2,o2.l,0,file.size),o2.l+=file.size+63&-64;else{for(j2=0;j2<file.size;++j2)o2.write_shift(1,file.content[j2]);for(;j2&63;++j2)o2.write_shift(1,0)}if(has_buf)o2.l=o2.length;else for(;o2.l<o2.length;)o2.write_shift(1,0);return o2}function find(cfb,path){var UCFullPaths=cfb.FullPaths.map(function(x2){return x2.toUpperCase()}),UCPaths=UCFullPaths.map(function(x2){var y2=x2.split("/");return y2[y2.length-(x2.slice(-1)=="/"?2:1)]}),k2=!1;path.charCodeAt(0)===47?(k2=!0,path=UCFullPaths[0].slice(0,-1)+path):k2=path.indexOf("/")!==-1;var UCPath=path.toUpperCase(),w2=k2===!0?UCFullPaths.indexOf(UCPath):UCPaths.indexOf(UCPath);if(w2!==-1)return cfb.FileIndex[w2];var m2=!UCPath.match(chr1);for(UCPath=UCPath.replace(chr0,""),m2&&(UCPath=UCPath.replace(chr1,"!")),w2=0;w2<UCFullPaths.length;++w2)if((m2?UCFullPaths[w2].replace(chr1,"!"):UCFullPaths[w2]).replace(chr0,"")==UCPath||(m2?UCPaths[w2].replace(chr1,"!"):UCPaths[w2]).replace(chr0,"")==UCPath)return cfb.FileIndex[w2];return null}var MSSZ=64,ENDOFCHAIN=-2,HEADER_SIGNATURE="d0cf11e0a1b11ae1",HEADER_SIG=[208,207,17,224,161,177,26,225],HEADER_CLSID="00000000000000000000000000000000",consts={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN,FREESECT:-1,HEADER_SIGNATURE,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function write_file(cfb,filename2,options){get_fs();var o2=_write(cfb,options);fs.writeFileSync(filename2,o2)}function a2s2(o2){for(var out=new Array(o2.length),i3=0;i3<o2.length;++i3)out[i3]=String.fromCharCode(o2[i3]);return out.join("")}function write(cfb,options){var o2=_write(cfb,options);switch(options&&options.type||"buffer"){case"file":return get_fs(),fs.writeFileSync(options.filename,o2),o2;case"binary":return typeof o2=="string"?o2:a2s2(o2);case"base64":return Base64_encode(typeof o2=="string"?o2:a2s2(o2));case"buffer":if(has_buf)return Buffer.isBuffer(o2)?o2:Buffer_from(o2);case"array":return typeof o2=="string"?s2a(o2):o2}return o2}var _zlib;function use_zlib(zlib){try{var InflateRaw=zlib.InflateRaw,InflRaw=new InflateRaw;if(InflRaw._processChunk(new Uint8Array([3,0]),InflRaw._finishFlushFlag),InflRaw.bytesRead)_zlib=zlib;else throw new Error("zlib does not expose bytesRead")}catch(e){console.error("cannot use native zlib: "+(e.message||e))}}function _inflateRawSync(payload,usz){if(!_zlib)return _inflate(payload,usz);var InflateRaw=_zlib.InflateRaw,InflRaw=new InflateRaw,out=InflRaw._processChunk(payload.slice(payload.l),InflRaw._finishFlushFlag);return payload.l+=InflRaw.bytesRead,out}function _deflateRawSync(payload){return _zlib?_zlib.deflateRawSync(payload):_deflate(payload)}var CLEN_ORDER=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],LEN_LN=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],DST_LN=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function bit_swap_8(n){var t2=(n<<1|n<<11)&139536|(n<<5|n<<15)&558144;return(t2>>16|t2>>8|t2)&255}for(var use_typed_arrays=typeof Uint8Array<"u",bitswap8=use_typed_arrays?new Uint8Array(256):[],q2=0;q2<256;++q2)bitswap8[q2]=bit_swap_8(q2);function bit_swap_n(n,b2){var rev2=bitswap8[n&255];return b2<=8?rev2>>>8-b2:(rev2=rev2<<8|bitswap8[n>>8&255],b2<=16?rev2>>>16-b2:(rev2=rev2<<8|bitswap8[n>>16&255],rev2>>>24-b2))}function read_bits_2(buf,bl){var w2=bl&7,h2=bl>>>3;return(buf[h2]|(w2<=6?0:buf[h2+1]<<8))>>>w2&3}function read_bits_3(buf,bl){var w2=bl&7,h2=bl>>>3;return(buf[h2]|(w2<=5?0:buf[h2+1]<<8))>>>w2&7}function read_bits_4(buf,bl){var w2=bl&7,h2=bl>>>3;return(buf[h2]|(w2<=4?0:buf[h2+1]<<8))>>>w2&15}function read_bits_5(buf,bl){var w2=bl&7,h2=bl>>>3;return(buf[h2]|(w2<=3?0:buf[h2+1]<<8))>>>w2&31}function read_bits_7(buf,bl){var w2=bl&7,h2=bl>>>3;return(buf[h2]|(w2<=1?0:buf[h2+1]<<8))>>>w2&127}function read_bits_n(buf,bl,n){var w2=bl&7,h2=bl>>>3,f2=(1<<n)-1,v2=buf[h2]>>>w2;return n<8-w2||(v2|=buf[h2+1]<<8-w2,n<16-w2)||(v2|=buf[h2+2]<<16-w2,n<24-w2)||(v2|=buf[h2+3]<<24-w2),v2&f2}function write_bits_3(buf,bl,v2){var w2=bl&7,h2=bl>>>3;return w2<=5?buf[h2]|=(v2&7)<<w2:(buf[h2]|=v2<<w2&255,buf[h2+1]=(v2&7)>>8-w2),bl+3}function write_bits_1(buf,bl,v2){var w2=bl&7,h2=bl>>>3;return v2=(v2&1)<<w2,buf[h2]|=v2,bl+1}function write_bits_8(buf,bl,v2){var w2=bl&7,h2=bl>>>3;return v2<<=w2,buf[h2]|=v2&255,v2>>>=8,buf[h2+1]=v2,bl+8}function write_bits_16(buf,bl,v2){var w2=bl&7,h2=bl>>>3;return v2<<=w2,buf[h2]|=v2&255,v2>>>=8,buf[h2+1]=v2&255,buf[h2+2]=v2>>>8,bl+16}function realloc(b2,sz){var L2=b2.length,M2=2*L2>sz?2*L2:sz+5,i3=0;if(L2>=sz)return b2;if(has_buf){var o2=new_unsafe_buf(M2);if(b2.copy)b2.copy(o2);else for(;i3<b2.length;++i3)o2[i3]=b2[i3];return o2}else if(use_typed_arrays){var a2=new Uint8Array(M2);if(a2.set)a2.set(b2);else for(;i3<L2;++i3)a2[i3]=b2[i3];return a2}return b2.length=M2,b2}function zero_fill_array(n){for(var o2=new Array(n),i3=0;i3<n;++i3)o2[i3]=0;return o2}function build_tree(clens,cmap,MAX){var maxlen=1,w2=0,i3=0,j2=0,ccode=0,L2=clens.length,bl_count=use_typed_arrays?new Uint16Array(32):zero_fill_array(32);for(i3=0;i3<32;++i3)bl_count[i3]=0;for(i3=L2;i3<MAX;++i3)clens[i3]=0;L2=clens.length;var ctree=use_typed_arrays?new Uint16Array(L2):zero_fill_array(L2);for(i3=0;i3<L2;++i3)bl_count[w2=clens[i3]]++,maxlen<w2&&(maxlen=w2),ctree[i3]=0;for(bl_count[0]=0,i3=1;i3<=maxlen;++i3)bl_count[i3+16]=ccode=ccode+bl_count[i3-1]<<1;for(i3=0;i3<L2;++i3)ccode=clens[i3],ccode!=0&&(ctree[i3]=bl_count[ccode+16]++);var cleni=0;for(i3=0;i3<L2;++i3)if(cleni=clens[i3],cleni!=0)for(ccode=bit_swap_n(ctree[i3],maxlen)>>maxlen-cleni,j2=(1<<maxlen+4-cleni)-1;j2>=0;--j2)cmap[ccode|j2<<cleni]=cleni&15|i3<<4;return maxlen}var fix_lmap=use_typed_arrays?new Uint16Array(512):zero_fill_array(512),fix_dmap=use_typed_arrays?new Uint16Array(32):zero_fill_array(32);if(!use_typed_arrays){for(var i2=0;i2<512;++i2)fix_lmap[i2]=0;for(i2=0;i2<32;++i2)fix_dmap[i2]=0}(function(){for(var dlens=[],i3=0;i3<32;i3++)dlens.push(5);build_tree(dlens,fix_dmap,32);var clens=[];for(i3=0;i3<=143;i3++)clens.push(8);for(;i3<=255;i3++)clens.push(9);for(;i3<=279;i3++)clens.push(7);for(;i3<=287;i3++)clens.push(8);build_tree(clens,fix_lmap,288)})();var _deflateRaw=(function(){for(var DST_LN_RE=use_typed_arrays?new Uint8Array(32768):[],j2=0,k2=0;j2<DST_LN.length-1;++j2)for(;k2<DST_LN[j2+1];++k2)DST_LN_RE[k2]=j2;for(;k2<32768;++k2)DST_LN_RE[k2]=29;var LEN_LN_RE=use_typed_arrays?new Uint8Array(259):[];for(j2=0,k2=0;j2<LEN_LN.length-1;++j2)for(;k2<LEN_LN[j2+1];++k2)LEN_LN_RE[k2]=j2;function write_stored(data,out){for(var boff=0;boff<data.length;){var L2=Math.min(65535,data.length-boff),h2=boff+L2==data.length;for(out.write_shift(1,+h2),out.write_shift(2,L2),out.write_shift(2,~L2&65535);L2-- >0;)out[out.l++]=data[boff++]}return out.l}function write_huff_fixed(data,out){for(var bl=0,boff=0,addrs=use_typed_arrays?new Uint16Array(32768):[];boff<data.length;){var L2=Math.min(65535,data.length-boff);if(L2<10){for(bl=write_bits_3(out,bl,+(boff+L2==data.length)),bl&7&&(bl+=8-(bl&7)),out.l=bl/8|0,out.write_shift(2,L2),out.write_shift(2,~L2&65535);L2-- >0;)out[out.l++]=data[boff++];bl=out.l*8;continue}bl=write_bits_3(out,bl,+(boff+L2==data.length)+2);for(var hash=0;L2-- >0;){var d2=data[boff];hash=(hash<<5^d2)&32767;var match=-1,mlen=0;if((match=addrs[hash])&&(match|=boff&-32768,match>boff&&(match-=32768),match<boff))for(;data[match+mlen]==data[boff+mlen]&&mlen<250;)++mlen;if(mlen>2){d2=LEN_LN_RE[mlen],d2<=22?bl=write_bits_8(out,bl,bitswap8[d2+1]>>1)-1:(write_bits_8(out,bl,3),bl+=5,write_bits_8(out,bl,bitswap8[d2-23]>>5),bl+=3);var len_eb=d2<8?0:d2-4>>2;len_eb>0&&(write_bits_16(out,bl,mlen-LEN_LN[d2]),bl+=len_eb),d2=DST_LN_RE[boff-match],bl=write_bits_8(out,bl,bitswap8[d2]>>3),bl-=3;var dst_eb=d2<4?0:d2-2>>1;dst_eb>0&&(write_bits_16(out,bl,boff-match-DST_LN[d2]),bl+=dst_eb);for(var q3=0;q3<mlen;++q3)addrs[hash]=boff&32767,hash=(hash<<5^data[boff])&32767,++boff;L2-=mlen-1}else d2<=143?d2=d2+48:bl=write_bits_1(out,bl,1),bl=write_bits_8(out,bl,bitswap8[d2]),addrs[hash]=boff&32767,++boff}bl=write_bits_8(out,bl,0)-1}return out.l=(bl+7)/8|0,out.l}return function(data,out){return data.length<8?write_stored(data,out):write_huff_fixed(data,out)}})();function _deflate(data){var buf=new_buf(50+Math.floor(data.length*1.1)),off=_deflateRaw(data,buf);return buf.slice(0,off)}var dyn_lmap=use_typed_arrays?new Uint16Array(32768):zero_fill_array(32768),dyn_dmap=use_typed_arrays?new Uint16Array(32768):zero_fill_array(32768),dyn_cmap=use_typed_arrays?new Uint16Array(128):zero_fill_array(128),dyn_len_1=1,dyn_len_2=1;function dyn(data,boff){var _HLIT=read_bits_5(data,boff)+257;boff+=5;var _HDIST=read_bits_5(data,boff)+1;boff+=5;var _HCLEN=read_bits_4(data,boff)+4;boff+=4;for(var w2=0,clens=use_typed_arrays?new Uint8Array(19):zero_fill_array(19),ctree=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],maxlen=1,bl_count=use_typed_arrays?new Uint8Array(8):zero_fill_array(8),next_code=use_typed_arrays?new Uint8Array(8):zero_fill_array(8),L2=clens.length,i3=0;i3<_HCLEN;++i3)clens[CLEN_ORDER[i3]]=w2=read_bits_3(data,boff),maxlen<w2&&(maxlen=w2),bl_count[w2]++,boff+=3;var ccode=0;for(bl_count[0]=0,i3=1;i3<=maxlen;++i3)next_code[i3]=ccode=ccode+bl_count[i3-1]<<1;for(i3=0;i3<L2;++i3)(ccode=clens[i3])!=0&&(ctree[i3]=next_code[ccode]++);var cleni=0;for(i3=0;i3<L2;++i3)if(cleni=clens[i3],cleni!=0){ccode=bitswap8[ctree[i3]]>>8-cleni;for(var j2=(1<<7-cleni)-1;j2>=0;--j2)dyn_cmap[ccode|j2<<cleni]=cleni&7|i3<<3}var hcodes=[];for(maxlen=1;hcodes.length<_HLIT+_HDIST;)switch(ccode=dyn_cmap[read_bits_7(data,boff)],boff+=ccode&7,ccode>>>=3){case 16:for(w2=3+read_bits_2(data,boff),boff+=2,ccode=hcodes[hcodes.length-1];w2-- >0;)hcodes.push(ccode);break;case 17:for(w2=3+read_bits_3(data,boff),boff+=3;w2-- >0;)hcodes.push(0);break;case 18:for(w2=11+read_bits_7(data,boff),boff+=7;w2-- >0;)hcodes.push(0);break;default:hcodes.push(ccode),maxlen<ccode&&(maxlen=ccode);break}var h1=hcodes.slice(0,_HLIT),h2=hcodes.slice(_HLIT);for(i3=_HLIT;i3<286;++i3)h1[i3]=0;for(i3=_HDIST;i3<30;++i3)h2[i3]=0;return dyn_len_1=build_tree(h1,dyn_lmap,286),dyn_len_2=build_tree(h2,dyn_dmap,30),boff}function inflate2(data,usz){if(data[0]==3&&!(data[1]&3))return[new_raw_buf(usz),2];for(var boff=0,header=0,outbuf=new_unsafe_buf(usz||1<<18),woff=0,OL=outbuf.length>>>0,max_len_1=0,max_len_2=0;(header&1)==0;){if(header=read_bits_3(data,boff),boff+=3,header>>>1)header>>1==1?(max_len_1=9,max_len_2=5):(boff=dyn(data,boff),max_len_1=dyn_len_1,max_len_2=dyn_len_2);else{boff&7&&(boff+=8-(boff&7));var sz=data[boff>>>3]|data[(boff>>>3)+1]<<8;if(boff+=32,sz>0)for(!usz&&OL<woff+sz&&(outbuf=realloc(outbuf,woff+sz),OL=outbuf.length);sz-- >0;)outbuf[woff++]=data[boff>>>3],boff+=8;continue}for(;;){!usz&&OL<woff+32767&&(outbuf=realloc(outbuf,woff+32767),OL=outbuf.length);var bits=read_bits_n(data,boff,max_len_1),code=header>>>1==1?fix_lmap[bits]:dyn_lmap[bits];if(boff+=code&15,code>>>=4,(code>>>8&255)===0)outbuf[woff++]=code;else{if(code==256)break;code-=257;var len_eb=code<8?0:code-4>>2;len_eb>5&&(len_eb=0);var tgt=woff+LEN_LN[code];len_eb>0&&(tgt+=read_bits_n(data,boff,len_eb),boff+=len_eb),bits=read_bits_n(data,boff,max_len_2),code=header>>>1==1?fix_dmap[bits]:dyn_dmap[bits],boff+=code&15,code>>>=4;var dst_eb=code<4?0:code-2>>1,dst=DST_LN[code];for(dst_eb>0&&(dst+=read_bits_n(data,boff,dst_eb),boff+=dst_eb),!usz&&OL<tgt&&(outbuf=realloc(outbuf,tgt+100),OL=outbuf.length);woff<tgt;)outbuf[woff]=outbuf[woff-dst],++woff}}}return usz?[outbuf,boff+7>>>3]:[outbuf.slice(0,woff),boff+7>>>3]}function _inflate(payload,usz){var data=payload.slice(payload.l||0),out=inflate2(data,usz);return payload.l+=out[1],out[0]}function warn_or_throw(wrn,msg){if(wrn)typeof console<"u"&&console.error(msg);else throw new Error(msg)}function parse_zip(file,options){var blob=file;prep_blob(blob,0);var FileIndex=[],FullPaths=[],o2={FileIndex,FullPaths};init_cfb(o2,{root:options.root});for(var i3=blob.length-4;(blob[i3]!=80||blob[i3+1]!=75||blob[i3+2]!=5||blob[i3+3]!=6)&&i3>=0;)--i3;blob.l=i3+4,blob.l+=4;var fcnt=blob.read_shift(2);blob.l+=6;var start_cd=blob.read_shift(4);for(blob.l=start_cd,i3=0;i3<fcnt;++i3){blob.l+=20;var csz=blob.read_shift(4),usz=blob.read_shift(4),namelen=blob.read_shift(2),efsz=blob.read_shift(2),fcsz=blob.read_shift(2);blob.l+=8;var offset=blob.read_shift(4),EF=parse_extra_field(blob.slice(blob.l+namelen,blob.l+namelen+efsz));blob.l+=namelen+efsz+fcsz;var L2=blob.l;blob.l=offset+4,parse_local_file(blob,csz,usz,o2,EF),blob.l=L2}return o2}function parse_local_file(blob,csz,usz,o2,EF){blob.l+=2;var flags=blob.read_shift(2),meth=blob.read_shift(2),date=parse_dos_date(blob);if(flags&8257)throw new Error("Unsupported ZIP encryption");for(var crc322=blob.read_shift(4),_csz=blob.read_shift(4),_usz=blob.read_shift(4),namelen=blob.read_shift(2),efsz=blob.read_shift(2),name="",i3=0;i3<namelen;++i3)name+=String.fromCharCode(blob[blob.l++]);if(efsz){var ef=parse_extra_field(blob.slice(blob.l,blob.l+efsz));(ef[21589]||{}).mt&&(date=ef[21589].mt),((EF||{})[21589]||{}).mt&&(date=EF[21589].mt)}blob.l+=efsz;var data=blob.slice(blob.l,blob.l+_csz);switch(meth){case 8:data=_inflateRawSync(blob,_usz);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+meth)}var wrn=!1;flags&8&&(crc322=blob.read_shift(4),crc322==134695760&&(crc322=blob.read_shift(4),wrn=!0),_csz=blob.read_shift(4),_usz=blob.read_shift(4)),_csz!=csz&&warn_or_throw(wrn,"Bad compressed size: "+csz+" != "+_csz),_usz!=usz&&warn_or_throw(wrn,"Bad uncompressed size: "+usz+" != "+_usz),cfb_add(o2,name,data,{unsafe:!0,mt:date})}function write_zip2(cfb,options){var _opts=options||{},out=[],cdirs=[],o2=new_buf(1),method=_opts.compression?8:0,flags=0,i3=0,j2=0,start_cd=0,fcnt=0,root=cfb.FullPaths[0],fp=root,fi=cfb.FileIndex[0],crcs=[],sz_cd=0;for(i3=1;i3<cfb.FullPaths.length;++i3)if(fp=cfb.FullPaths[i3].slice(root.length),fi=cfb.FileIndex[i3],!(!fi.size||!fi.content||fp=="Sh33tJ5")){var start=start_cd,namebuf=new_buf(fp.length);for(j2=0;j2<fp.length;++j2)namebuf.write_shift(1,fp.charCodeAt(j2)&127);namebuf=namebuf.slice(0,namebuf.l),crcs[fcnt]=CRC32.buf(fi.content,0);var outbuf=fi.content;method==8&&(outbuf=_deflateRawSync(outbuf)),o2=new_buf(30),o2.write_shift(4,67324752),o2.write_shift(2,20),o2.write_shift(2,flags),o2.write_shift(2,method),fi.mt?write_dos_date(o2,fi.mt):o2.write_shift(4,0),o2.write_shift(-4,crcs[fcnt]),o2.write_shift(4,outbuf.length),o2.write_shift(4,fi.content.length),o2.write_shift(2,namebuf.length),o2.write_shift(2,0),start_cd+=o2.length,out.push(o2),start_cd+=namebuf.length,out.push(namebuf),start_cd+=outbuf.length,out.push(outbuf),o2=new_buf(46),o2.write_shift(4,33639248),o2.write_shift(2,0),o2.write_shift(2,20),o2.write_shift(2,flags),o2.write_shift(2,method),o2.write_shift(4,0),o2.write_shift(-4,crcs[fcnt]),o2.write_shift(4,outbuf.length),o2.write_shift(4,fi.content.length),o2.write_shift(2,namebuf.length),o2.write_shift(2,0),o2.write_shift(2,0),o2.write_shift(2,0),o2.write_shift(2,0),o2.write_shift(4,0),o2.write_shift(4,start),sz_cd+=o2.l,cdirs.push(o2),sz_cd+=namebuf.length,cdirs.push(namebuf),++fcnt}return o2=new_buf(22),o2.write_shift(4,101010256),o2.write_shift(2,0),o2.write_shift(2,0),o2.write_shift(2,fcnt),o2.write_shift(2,fcnt),o2.write_shift(4,sz_cd),o2.write_shift(4,start_cd),o2.write_shift(2,0),bconcat([bconcat(out),bconcat(cdirs),o2])}var ContentTypeMap={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function get_content_type(fi,fp){if(fi.ctype)return fi.ctype;var ext=fi.name||"",m2=ext.match(/\.([^\.]+)$/);return m2&&ContentTypeMap[m2[1]]||fp&&(m2=(ext=fp).match(/[\.\\]([^\.\\])+$/),m2&&ContentTypeMap[m2[1]])?ContentTypeMap[m2[1]]:"application/octet-stream"}function write_base64_76(bstr){for(var data=Base64_encode(bstr),o2=[],i3=0;i3<data.length;i3+=76)o2.push(data.slice(i3,i3+76));return o2.join(`\r
`)+`\r
`}function write_quoted_printable(text){var encoded=text.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(c2){var w2=c2.charCodeAt(0).toString(16).toUpperCase();return"="+(w2.length==1?"0"+w2:w2)});encoded=encoded.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),encoded.charAt(0)==`
`&&(encoded="=0D"+encoded.slice(1)),encoded=encoded.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var o2=[],split=encoded.split(`\r
`),si=0;si<split.length;++si){var str=split[si];if(str.length==0){o2.push("");continue}for(var i3=0;i3<str.length;){var end=76,tmp=str.slice(i3,i3+end);tmp.charAt(end-1)=="="?end--:tmp.charAt(end-2)=="="?end-=2:tmp.charAt(end-3)=="="&&(end-=3),tmp=str.slice(i3,i3+end),i3+=end,i3<str.length&&(tmp+="="),o2.push(tmp)}}return o2.join(`\r
`)}function parse_quoted_printable(data){for(var o2=[],di=0;di<data.length;++di){for(var line=data[di];di<=data.length&&line.charAt(line.length-1)=="=";)line=line.slice(0,line.length-1)+data[++di];o2.push(line)}for(var oi=0;oi<o2.length;++oi)o2[oi]=o2[oi].replace(/[=][0-9A-Fa-f]{2}/g,function($$){return String.fromCharCode(parseInt($$.slice(1),16))});return s2a(o2.join(`\r
`))}function parse_mime(cfb,data,root){for(var fname="",cte="",ctype="",fdata,di=0;di<10;++di){var line=data[di];if(!line||line.match(/^\s*$/))break;var m2=line.match(/^(.*?):\s*([^\s].*)$/);if(m2)switch(m2[1].toLowerCase()){case"content-location":fname=m2[2].trim();break;case"content-type":ctype=m2[2].trim();break;case"content-transfer-encoding":cte=m2[2].trim();break}}switch(++di,cte.toLowerCase()){case"base64":fdata=s2a(Base64_decode(data.slice(di).join("")));break;case"quoted-printable":fdata=parse_quoted_printable(data.slice(di));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+cte)}var file=cfb_add(cfb,fname.slice(root.length),fdata,{unsafe:!0});ctype&&(file.ctype=ctype)}function parse_mad(file,options){if(a2s2(file.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var root=options&&options.root||"",data=(has_buf&&Buffer.isBuffer(file)?file.toString("binary"):a2s2(file)).split(`\r
`),di=0,row="";for(di=0;di<data.length;++di)if(row=data[di],!!/^Content-Location:/i.test(row)&&(row=row.slice(row.indexOf("file")),root||(root=row.slice(0,row.lastIndexOf("/")+1)),row.slice(0,root.length)!=root))for(;root.length>0&&(root=root.slice(0,root.length-1),root=root.slice(0,root.lastIndexOf("/")+1),row.slice(0,root.length)!=root););var mboundary=(data[1]||"").match(/boundary="(.*?)"/);if(!mboundary)throw new Error("MAD cannot find boundary");var boundary="--"+(mboundary[1]||""),FileIndex=[],FullPaths=[],o2={FileIndex,FullPaths};init_cfb(o2);var start_di,fcnt=0;for(di=0;di<data.length;++di){var line=data[di];line!==boundary&&line!==boundary+"--"||(fcnt++&&parse_mime(o2,data.slice(start_di,di),root),start_di=di)}return o2}function write_mad(cfb,options){var opts=options||{},boundary=opts.boundary||"SheetJS";boundary="------="+boundary;for(var out=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+boundary.slice(2)+'"',"","",""],root=cfb.FullPaths[0],fp=root,fi=cfb.FileIndex[0],i3=1;i3<cfb.FullPaths.length;++i3)if(fp=cfb.FullPaths[i3].slice(root.length),fi=cfb.FileIndex[i3],!(!fi.size||!fi.content||fp=="Sh33tJ5")){fp=fp.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(c2){return"_x"+c2.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(u2){return"_u"+u2.charCodeAt(0).toString(16)+"_"});for(var ca=fi.content,cstr=has_buf&&Buffer.isBuffer(ca)?ca.toString("binary"):a2s2(ca),dispcnt=0,L2=Math.min(1024,cstr.length),cc=0,csl=0;csl<=L2;++csl)(cc=cstr.charCodeAt(csl))>=32&&cc<128&&++dispcnt;var qp=dispcnt>=L2*4/5;out.push(boundary),out.push("Content-Location: "+(opts.root||"file:///C:/SheetJS/")+fp),out.push("Content-Transfer-Encoding: "+(qp?"quoted-printable":"base64")),out.push("Content-Type: "+get_content_type(fi,fp)),out.push(""),out.push(qp?write_quoted_printable(cstr):write_base64_76(cstr))}return out.push(boundary+`--\r
`),out.join(`\r
`)}function cfb_new(opts){var o2={};return init_cfb(o2,opts),o2}function cfb_add(cfb,name,content,opts){var unsafe=opts&&opts.unsafe;unsafe||init_cfb(cfb);var file=!unsafe&&CFB.find(cfb,name);if(!file){var fpath=cfb.FullPaths[0];name.slice(0,fpath.length)==fpath?fpath=name:(fpath.slice(-1)!="/"&&(fpath+="/"),fpath=(fpath+name).replace("//","/")),file={name:filename(name),type:2},cfb.FileIndex.push(file),cfb.FullPaths.push(fpath),unsafe||CFB.utils.cfb_gc(cfb)}return file.content=content,file.size=content?content.length:0,opts&&(opts.CLSID&&(file.clsid=opts.CLSID),opts.mt&&(file.mt=opts.mt),opts.ct&&(file.ct=opts.ct)),file}function cfb_del(cfb,name){init_cfb(cfb);var file=CFB.find(cfb,name);if(file){for(var j2=0;j2<cfb.FileIndex.length;++j2)if(cfb.FileIndex[j2]==file)return cfb.FileIndex.splice(j2,1),cfb.FullPaths.splice(j2,1),!0}return!1}function cfb_mov(cfb,old_name,new_name){init_cfb(cfb);var file=CFB.find(cfb,old_name);if(file){for(var j2=0;j2<cfb.FileIndex.length;++j2)if(cfb.FileIndex[j2]==file)return cfb.FileIndex[j2].name=filename(new_name),cfb.FullPaths[j2]=new_name,!0}return!1}function cfb_gc(cfb){rebuild_cfb(cfb,!0)}return exports$1.find=find,exports$1.read=read,exports$1.parse=parse,exports$1.write=write,exports$1.writeFile=write_file,exports$1.utils={cfb_new,cfb_add,cfb_del,cfb_mov,cfb_gc,ReadShift,CheckField,prep_blob,bconcat,use_zlib,_deflateRaw:_deflate,_inflateRaw:_inflate,consts},exports$1})();function blobify(data){return typeof data=="string"?s2ab(data):Array.isArray(data)?a2u(data):data}function write_dl(fname,payload,enc){if(typeof Deno<"u"){if(enc&&typeof payload=="string")switch(enc){case"utf8":payload=new TextEncoder(enc).encode(payload);break;case"binary":payload=s2ab(payload);break;default:throw new Error("Unsupported encoding "+enc)}return Deno.writeFileSync(fname,payload)}var data=enc=="utf8"?utf8write(payload):payload;if(typeof IE_SaveFile<"u")return IE_SaveFile(data,fname);if(typeof Blob<"u"){var blob=new Blob([blobify(data)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(blob,fname);if(typeof saveAs<"u")return saveAs(blob,fname);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var url=URL.createObjectURL(blob);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(url)},6e4),chrome.downloads.download({url,filename:fname,saveAs:!0});var a2=document.createElement("a");if(a2.download!=null)return a2.download=fname,a2.href=url,document.body.appendChild(a2),a2.click(),document.body.removeChild(a2),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(url)},6e4),url}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var out=File(fname);return out.open("w"),out.encoding="binary",Array.isArray(payload)&&(payload=a2s(payload)),out.write(payload),out.close(),payload}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("cannot save file "+fname)}function keys(o2){for(var ks=Object.keys(o2),o22=[],i2=0;i2<ks.length;++i2)Object.prototype.hasOwnProperty.call(o2,ks[i2])&&o22.push(ks[i2]);return o22}function evert_key(obj,key){for(var o2=[],K2=keys(obj),i2=0;i2!==K2.length;++i2)o2[obj[K2[i2]][key]]==null&&(o2[obj[K2[i2]][key]]=K2[i2]);return o2}function evert(obj){for(var o2=[],K2=keys(obj),i2=0;i2!==K2.length;++i2)o2[obj[K2[i2]]]=K2[i2];return o2}function evert_num(obj){for(var o2=[],K2=keys(obj),i2=0;i2!==K2.length;++i2)o2[obj[K2[i2]]]=parseInt(K2[i2],10);return o2}function evert_arr(obj){for(var o2=[],K2=keys(obj),i2=0;i2!==K2.length;++i2)o2[obj[K2[i2]]]==null&&(o2[obj[K2[i2]]]=[]),o2[obj[K2[i2]]].push(K2[i2]);return o2}var basedate=new Date(1899,11,30,0,0,0);function datenum(v2,date1904){var epoch=v2.getTime(),dnthresh2=basedate.getTime()+(v2.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(epoch-dnthresh2)/(1440*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(v2){var out=new Date;return out.setTime(v2*24*60*60*1e3+dnthresh),out.getTimezoneOffset()!==refoffset&&out.setTime(out.getTime()+(out.getTimezoneOffset()-refoffset)*6e4),out}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(str,fixdate){var d2=new Date(str);if(good_pd)return fixdate>0?d2.setTime(d2.getTime()+d2.getTimezoneOffset()*60*1e3):fixdate<0&&d2.setTime(d2.getTime()-d2.getTimezoneOffset()*60*1e3),d2;if(str instanceof Date)return str;if(good_pd_date.getFullYear()==1917&&!isNaN(d2.getFullYear())){var s2=d2.getFullYear();return str.indexOf(""+s2)>-1||d2.setFullYear(d2.getFullYear()+100),d2}var n=str.match(/\d+/g)||["2017","2","19","0","0","0"],out=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return str.indexOf("Z")>-1&&(out=new Date(out.getTime()-out.getTimezoneOffset()*60*1e3)),out}function cc2str(arr,debomit){if(has_buf&&Buffer.isBuffer(arr))return arr.toString("binary");if(typeof TextDecoder<"u")try{var rev2={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(arr)&&(arr=new Uint8Array(arr)),new TextDecoder("latin1").decode(arr).replace(/[]/g,function(c2){return rev2[c2]||c2})}catch{}for(var o2=[],i2=0;i2!=arr.length;++i2)o2.push(String.fromCharCode(arr[i2]));return o2.join("")}function dup(o2){if(typeof JSON<"u"&&!Array.isArray(o2))return JSON.parse(JSON.stringify(o2));if(typeof o2!="object"||o2==null)return o2;if(o2 instanceof Date)return new Date(o2.getTime());var out={};for(var k2 in o2)Object.prototype.hasOwnProperty.call(o2,k2)&&(out[k2]=dup(o2[k2]));return out}function fill(c2,l2){for(var o2="";o2.length<l2;)o2+=c2;return o2}function fuzzynum(s2){var v2=Number(s2);if(!isNaN(v2))return isFinite(v2)?v2:NaN;if(!/\d/.test(s2))return v2;var wt2=1,ss=s2.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return wt2*=100,""});return!isNaN(v2=Number(ss))||(ss=ss.replace(/[(](.*)[)]/,function($$,$1){return wt2=-wt2,$1}),!isNaN(v2=Number(ss)))?v2/wt2:v2}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(s2){var o2=new Date(s2),n=new Date(NaN),y2=o2.getYear(),m2=o2.getMonth(),d2=o2.getDate();if(isNaN(d2))return n;var lower=s2.toLowerCase();if(lower.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(lower=lower.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),lower.length>3&&lower_months.indexOf(lower)==-1)return n}else if(lower.match(/[a-z]/))return n;return y2<0||y2>8099?n:(m2>0||d2>1)&&y2!=101?o2:s2.match(/[^-0-9:,\/\\]/)?n:o2}function zip_add_file(zip,path,content){if(zip.FullPaths){if(typeof content=="string"){var res;return has_buf?res=Buffer_from(content):res=utf8decode(content),CFB.utils.cfb_add(zip,path,res)}CFB.utils.cfb_add(zip,path,content)}else zip.file(path,content)}function zip_new(){return CFB.utils.cfb_new()}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f]/g;function escapexml(text){var s2=text+"";return s2.replace(decregex,function(y2){return rencoding[y2]}).replace(charegex,function(s3){return"_x"+("000"+s3.charCodeAt(0).toString(16)).slice(-4)+"_"})}function escapexmltag(text){return escapexml(text).replace(/ /g,"_x0020_")}var htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(text){var s2=text+"";return s2.replace(decregex,function(y2){return rencoding[y2]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(s3){return"&#x"+("000"+s3.charCodeAt(0).toString(16)).slice(-4)+";"})}function escapexlml(text){var s2=text+"";return s2.replace(decregex,function(y2){return rencoding[y2]}).replace(htmlcharegex,function(s3){return"&#x"+s3.charCodeAt(0).toString(16).toUpperCase()+";"})}function xlml_unfixstr(str){return str.replace(/(\r\n|[\r\n])/g,"&#10;")}function parsexmlbool(value){switch(value){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function utf8reada(orig){for(var out="",i2=0,c2=0,d2=0,e=0,f2=0,w2=0;i2<orig.length;){if(c2=orig.charCodeAt(i2++),c2<128){out+=String.fromCharCode(c2);continue}if(d2=orig.charCodeAt(i2++),c2>191&&c2<224){f2=(c2&31)<<6,f2|=d2&63,out+=String.fromCharCode(f2);continue}if(e=orig.charCodeAt(i2++),c2<240){out+=String.fromCharCode((c2&15)<<12|(d2&63)<<6|e&63);continue}f2=orig.charCodeAt(i2++),w2=((c2&7)<<18|(d2&63)<<12|(e&63)<<6|f2&63)-65536,out+=String.fromCharCode(55296+(w2>>>10&1023)),out+=String.fromCharCode(56320+(w2&1023))}return out}function utf8readb(data){var out=new_raw_buf(2*data.length),w2,i2,j2=1,k2=0,ww=0,c2;for(i2=0;i2<data.length;i2+=j2)j2=1,(c2=data.charCodeAt(i2))<128?w2=c2:c2<224?(w2=(c2&31)*64+(data.charCodeAt(i2+1)&63),j2=2):c2<240?(w2=(c2&15)*4096+(data.charCodeAt(i2+1)&63)*64+(data.charCodeAt(i2+2)&63),j2=3):(j2=4,w2=(c2&7)*262144+(data.charCodeAt(i2+1)&63)*4096+(data.charCodeAt(i2+2)&63)*64+(data.charCodeAt(i2+3)&63),w2-=65536,ww=55296+(w2>>>10&1023),w2=56320+(w2&1023)),ww!==0&&(out[k2++]=ww&255,out[k2++]=ww>>>8,ww=0),out[k2++]=w2%256,out[k2++]=w2>>>8;return out.slice(0,k2).toString("ucs2")}function utf8readc(data){return Buffer_from(data,"binary").toString("utf8")}var utf8corpus="foo bar baz",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(data){return Buffer_from(data,"utf8").toString("binary")}:function(orig){for(var out=[],i2=0,c2=0,d2=0;i2<orig.length;)switch(c2=orig.charCodeAt(i2++),!0){case c2<128:out.push(String.fromCharCode(c2));break;case c2<2048:out.push(String.fromCharCode(192+(c2>>6))),out.push(String.fromCharCode(128+(c2&63)));break;case(c2>=55296&&c2<57344):c2-=55296,d2=orig.charCodeAt(i2++)-56320+(c2<<10),out.push(String.fromCharCode(240+(d2>>18&7))),out.push(String.fromCharCode(144+(d2>>12&63))),out.push(String.fromCharCode(128+(d2>>6&63))),out.push(String.fromCharCode(128+(d2&63)));break;default:out.push(String.fromCharCode(224+(c2>>12))),out.push(String.fromCharCode(128+(c2>>6&63))),out.push(String.fromCharCode(128+(c2&63)))}return out.join("")},htmldecode=(function(){var entities=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(x2){return[new RegExp("&"+x2[0]+";","ig"),x2[1]]});return function(str){for(var o2=str.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i2=0;i2<entities.length;++i2)o2=o2.replace(entities[i2][0],entities[i2][1]);return o2}})(),wtregex=/(^\s|\s$|\n)/;function writetag(f2,g2){return"<"+f2+(g2.match(wtregex)?' xml:space="preserve"':"")+">"+g2+"</"+f2+">"}function wxt_helper(h2){return keys(h2).map(function(k2){return" "+k2+'="'+h2[k2]+'"'}).join("")}function writextag(f2,g2,h2){return"<"+f2+(h2!=null?wxt_helper(h2):"")+(g2!=null?(g2.match(wtregex)?' xml:space="preserve"':"")+">"+g2+"</"+f2:"/")+">"}function write_w3cdtf(d2,t2){try{return d2.toISOString().replace(/\.\d*/,"")}catch(e){if(t2)throw e}return""}function write_vt(s2,xlsx){switch(typeof s2){case"string":var o2=writextag("vt:lpwstr",escapexml(s2));return o2=o2.replace(/&quot;/g,"_x0022_"),o2;case"number":return writextag((s2|0)==s2?"vt:i4":"vt:r8",escapexml(String(s2)));case"boolean":return writextag("vt:bool",s2?"true":"false")}if(s2 instanceof Date)return writextag("vt:filetime",write_w3cdtf(s2));throw new Error("Unable to serialize "+s2)}var XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],XLMLNS={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function read_double_le(b2,idx){for(var s2=1-2*(b2[idx+7]>>>7),e=((b2[idx+7]&127)<<4)+(b2[idx+6]>>>4&15),m2=b2[idx+6]&15,i2=5;i2>=0;--i2)m2=m2*256+b2[idx+i2];return e==2047?m2==0?s2*(1/0):NaN:(e==0?e=-1022:(e-=1023,m2+=Math.pow(2,52)),s2*Math.pow(2,e-52)*m2)}function write_double_le(b2,v2,idx){var bs=(v2<0||1/v2==-1/0?1:0)<<7,e=0,m2=0,av=bs?-v2:v2;isFinite(av)?av==0?e=m2=0:(e=Math.floor(Math.log(av)/Math.LN2),m2=av*Math.pow(2,52-e),e<=-1023&&(!isFinite(m2)||m2<Math.pow(2,52))?e=-1022:(m2-=Math.pow(2,52),e+=1023)):(e=2047,m2=isNaN(v2)?26985:0);for(var i2=0;i2<=5;++i2,m2/=256)b2[idx+i2]=m2&255;b2[idx+6]=(e&15)<<4|m2&15,b2[idx+7]=e>>4|bs}var ___toBuffer=function(bufs){for(var x2=[],w2=10240,i2=0;i2<bufs[0].length;++i2)if(bufs[0][i2])for(var j2=0,L2=bufs[0][i2].length;j2<L2;j2+=w2)x2.push.apply(x2,bufs[0][i2].slice(j2,j2+w2));return x2},__toBuffer=has_buf?function(bufs){return bufs[0].length>0&&Buffer.isBuffer(bufs[0][0])?Buffer.concat(bufs[0].map(function(x2){return Buffer.isBuffer(x2)?x2:Buffer_from(x2)})):___toBuffer(bufs)}:___toBuffer,___utf16le=function(b2,s2,e){for(var ss=[],i2=s2;i2<e;i2+=2)ss.push(String.fromCharCode(__readUInt16LE(b2,i2)));return ss.join("").replace(chr0,"")},__utf16le=has_buf?function(b2,s2,e){return Buffer.isBuffer(b2)?b2.toString("utf16le",s2,e).replace(chr0,""):___utf16le(b2,s2,e)}:___utf16le,___hexlify=function(b2,s2,l2){for(var ss=[],i2=s2;i2<s2+l2;++i2)ss.push(("0"+b2[i2].toString(16)).slice(-2));return ss.join("")},__hexlify=has_buf?function(b2,s2,l2){return Buffer.isBuffer(b2)?b2.toString("hex",s2,s2+l2):___hexlify(b2,s2,l2)}:___hexlify,___utf8=function(b2,s2,e){for(var ss=[],i2=s2;i2<e;i2++)ss.push(String.fromCharCode(__readUInt8(b2,i2)));return ss.join("")},__utf8=has_buf?function(b2,s2,e){return Buffer.isBuffer(b2)?b2.toString("utf8",s2,e):___utf8(b2,s2,e)}:___utf8,___lpstr=function(b2,i2){var len=__readUInt32LE(b2,i2);return len>0?__utf8(b2,i2+4,i2+4+len-1):""},__lpstr=___lpstr,___cpstr=function(b2,i2){var len=__readUInt32LE(b2,i2);return len>0?__utf8(b2,i2+4,i2+4+len-1):""},__cpstr=___cpstr,___lpwstr=function(b2,i2){var len=2*__readUInt32LE(b2,i2);return len>0?__utf8(b2,i2+4,i2+4+len-1):""},__lpwstr=___lpwstr,___lpp4=function(b2,i2){var len=__readUInt32LE(b2,i2);return len>0?__utf16le(b2,i2+4,i2+4+len):""},__lpp4=___lpp4,___8lpp4=function(b2,i2){var len=__readUInt32LE(b2,i2);return len>0?__utf8(b2,i2+4,i2+4+len):""},__8lpp4=___8lpp4,___double=function(b2,idx){return read_double_le(b2,idx)},__double=___double,is_buf=function(a2){return Array.isArray(a2)||typeof Uint8Array<"u"&&a2 instanceof Uint8Array};has_buf&&(__lpstr=function(b2,i2){if(!Buffer.isBuffer(b2))return ___lpstr(b2,i2);var len=b2.readUInt32LE(i2);return len>0?b2.toString("utf8",i2+4,i2+4+len-1):""},__cpstr=function(b2,i2){if(!Buffer.isBuffer(b2))return ___cpstr(b2,i2);var len=b2.readUInt32LE(i2);return len>0?b2.toString("utf8",i2+4,i2+4+len-1):""},__lpwstr=function(b2,i2){if(!Buffer.isBuffer(b2))return ___lpwstr(b2,i2);var len=2*b2.readUInt32LE(i2);return b2.toString("utf16le",i2+4,i2+4+len-1)},__lpp4=function(b2,i2){if(!Buffer.isBuffer(b2))return ___lpp4(b2,i2);var len=b2.readUInt32LE(i2);return b2.toString("utf16le",i2+4,i2+4+len)},__8lpp4=function(b2,i2){if(!Buffer.isBuffer(b2))return ___8lpp4(b2,i2);var len=b2.readUInt32LE(i2);return b2.toString("utf8",i2+4,i2+4+len)},__double=function(b2,i2){return Buffer.isBuffer(b2)?b2.readDoubleLE(i2):___double(b2,i2)},is_buf=function(a2){return Buffer.isBuffer(a2)||Array.isArray(a2)||typeof Uint8Array<"u"&&a2 instanceof Uint8Array});var __readUInt8=function(b2,idx){return b2[idx]},__readUInt16LE=function(b2,idx){return b2[idx+1]*256+b2[idx]},__readInt16LE=function(b2,idx){var u2=b2[idx+1]*256+b2[idx];return u2<32768?u2:(65535-u2+1)*-1},__readUInt32LE=function(b2,idx){return b2[idx+3]*(1<<24)+(b2[idx+2]<<16)+(b2[idx+1]<<8)+b2[idx]},__readInt32LE=function(b2,idx){return b2[idx+3]<<24|b2[idx+2]<<16|b2[idx+1]<<8|b2[idx]},__readInt32BE=function(b2,idx){return b2[idx]<<24|b2[idx+1]<<16|b2[idx+2]<<8|b2[idx+3]};function ReadShift(size,t2){var o2="",oI,oR,oo=[],w2,vv,i2,loc;switch(t2){case"dbcs":if(loc=this.l,has_buf&&Buffer.isBuffer(this))o2=this.slice(this.l,this.l+2*size).toString("utf16le");else for(i2=0;i2<size;++i2)o2+=String.fromCharCode(__readUInt16LE(this,loc)),loc+=2;size*=2;break;case"utf8":o2=__utf8(this,this.l,this.l+size);break;case"utf16le":size*=2,o2=__utf16le(this,this.l,this.l+size);break;case"wstr":return ReadShift.call(this,size,"dbcs");case"lpstr-ansi":o2=__lpstr(this,this.l),size=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":o2=__cpstr(this,this.l),size=4+__readUInt32LE(this,this.l);break;case"lpwstr":o2=__lpwstr(this,this.l),size=4+2*__readUInt32LE(this,this.l);break;case"lpp4":size=4+__readUInt32LE(this,this.l),o2=__lpp4(this,this.l),size&2&&(size+=2);break;case"8lpp4":size=4+__readUInt32LE(this,this.l),o2=__8lpp4(this,this.l),size&3&&(size+=4-(size&3));break;case"cstr":for(size=0,o2="";(w2=__readUInt8(this,this.l+size++))!==0;)oo.push(_getchar(w2));o2=oo.join("");break;case"_wstr":for(size=0,o2="";(w2=__readUInt16LE(this,this.l+size))!==0;)oo.push(_getchar(w2)),size+=2;size+=2,o2=oo.join("");break;case"dbcs-cont":for(o2="",loc=this.l,i2=0;i2<size;++i2){if(this.lens&&this.lens.indexOf(loc)!==-1)return w2=__readUInt8(this,loc),this.l=loc+1,vv=ReadShift.call(this,size-i2,w2?"dbcs-cont":"sbcs-cont"),oo.join("")+vv;oo.push(_getchar(__readUInt16LE(this,loc))),loc+=2}o2=oo.join(""),size*=2;break;case"cpstr":case"sbcs-cont":for(o2="",loc=this.l,i2=0;i2!=size;++i2){if(this.lens&&this.lens.indexOf(loc)!==-1)return w2=__readUInt8(this,loc),this.l=loc+1,vv=ReadShift.call(this,size-i2,w2?"dbcs-cont":"sbcs-cont"),oo.join("")+vv;oo.push(_getchar(__readUInt8(this,loc))),loc+=1}o2=oo.join("");break;default:switch(size){case 1:return oI=__readUInt8(this,this.l),this.l++,oI;case 2:return oI=(t2==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,oI;case 4:case-4:return t2==="i"||(this[this.l+3]&128)===0?(oI=(size>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,oI):(oR=__readUInt32LE(this,this.l),this.l+=4,oR);case 8:case-8:if(t2==="f")return size==8?oR=__double(this,this.l):oR=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,oR;size=8;case 16:o2=__hexlify(this,this.l,size);break}}return this.l+=size,o2}var __writeUInt32LE=function(b2,val,idx){b2[idx]=val&255,b2[idx+1]=val>>>8&255,b2[idx+2]=val>>>16&255,b2[idx+3]=val>>>24&255},__writeInt32LE=function(b2,val,idx){b2[idx]=val&255,b2[idx+1]=val>>8&255,b2[idx+2]=val>>16&255,b2[idx+3]=val>>24&255},__writeUInt16LE=function(b2,val,idx){b2[idx]=val&255,b2[idx+1]=val>>>8&255};function WriteShift(t2,val,f2){var size=0,i2=0;if(f2==="dbcs"){for(i2=0;i2!=val.length;++i2)__writeUInt16LE(this,val.charCodeAt(i2),this.l+2*i2);size=2*val.length}else if(f2==="sbcs"){for(val=val.replace(/[^\x00-\x7F]/g,"_"),i2=0;i2!=val.length;++i2)this[this.l+i2]=val.charCodeAt(i2)&255;size=val.length}else if(f2==="hex"){for(;i2<t2;++i2)this[this.l++]=parseInt(val.slice(2*i2,2*i2+2),16)||0;return this}else if(f2==="utf16le"){var end=Math.min(this.l+t2,this.length);for(i2=0;i2<Math.min(val.length,t2);++i2){var cc=val.charCodeAt(i2);this[this.l++]=cc&255,this[this.l++]=cc>>8}for(;this.l<end;)this[this.l++]=0;return this}else switch(t2){case 1:size=1,this[this.l]=val&255;break;case 2:size=2,this[this.l]=val&255,val>>>=8,this[this.l+1]=val&255;break;case 3:size=3,this[this.l]=val&255,val>>>=8,this[this.l+1]=val&255,val>>>=8,this[this.l+2]=val&255;break;case 4:size=4,__writeUInt32LE(this,val,this.l);break;case 8:if(size=8,f2==="f"){write_double_le(this,val,this.l);break}case 16:break;case-4:size=4,__writeInt32LE(this,val,this.l);break}return this.l+=size,this}function CheckField(hexstr,fld){var m2=__hexlify(this,this.l,hexstr.length>>1);if(m2!==hexstr)throw new Error(fld+"Expected "+hexstr+" saw "+m2);this.l+=hexstr.length>>1}function prep_blob(blob,pos){blob.l=pos,blob.read_shift=ReadShift,blob.chk=CheckField,blob.write_shift=WriteShift}function parsenoop(blob,length){blob.l+=length}function new_buf(sz){var o2=new_raw_buf(sz);return prep_blob(o2,0),o2}function buf_array(){var bufs=[],blksz=has_buf?256:2048,newblk=function(sz){var o2=new_buf(sz);return prep_blob(o2,0),o2},curbuf=newblk(blksz),endbuf=function(){curbuf&&(curbuf.length>curbuf.l&&(curbuf=curbuf.slice(0,curbuf.l),curbuf.l=curbuf.length),curbuf.length>0&&bufs.push(curbuf),curbuf=null)},next=function(sz){return curbuf&&sz<curbuf.length-curbuf.l?curbuf:(endbuf(),curbuf=newblk(Math.max(sz+1,blksz)))},end=function(){return endbuf(),bconcat(bufs)},push=function(buf){endbuf(),curbuf=buf,curbuf.l==null&&(curbuf.l=curbuf.length),next(blksz)};return{next,push,end,_bufs:bufs}}function write_record(ba,type,payload,length){var t2=+type,l2;if(!isNaN(t2)){length||(length=XLSBRecordEnum[t2].p||(payload||[]).length||0),l2=1+(t2>=128?1:0)+1,length>=128&&++l2,length>=16384&&++l2,length>=2097152&&++l2;var o2=ba.next(l2);t2<=127?o2.write_shift(1,t2):(o2.write_shift(1,(t2&127)+128),o2.write_shift(1,t2>>7));for(var i2=0;i2!=4;++i2)if(length>=128)o2.write_shift(1,(length&127)+128),length>>=7;else{o2.write_shift(1,length);break}length>0&&is_buf(payload)&&ba.push(payload)}}function shift_cell_xls(cell,tgt,opts){var out=dup(cell);if(tgt.s?(out.cRel&&(out.c+=tgt.s.c),out.rRel&&(out.r+=tgt.s.r)):(out.cRel&&(out.c+=tgt.c),out.rRel&&(out.r+=tgt.r)),!opts||opts.biff<12){for(;out.c>=256;)out.c-=256;for(;out.r>=65536;)out.r-=65536}return out}function shift_range_xls(cell,range,opts){var out=dup(cell);return out.s=shift_cell_xls(out.s,range.s,opts),out.e=shift_cell_xls(out.e,range.s,opts),out}function encode_cell_xls(c2,biff){if(c2.cRel&&c2.c<0)for(c2=dup(c2);c2.c<0;)c2.c+=biff>8?16384:256;if(c2.rRel&&c2.r<0)for(c2=dup(c2);c2.r<0;)c2.r+=biff>8?1048576:biff>5?65536:16384;var s2=encode_cell(c2);return!c2.cRel&&c2.cRel!=null&&(s2=fix_col(s2)),!c2.rRel&&c2.rRel!=null&&(s2=fix_row(s2)),s2}function encode_range_xls(r,opts){return r.s.r==0&&!r.s.rRel&&r.e.r==(opts.biff>=12?1048575:opts.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+encode_col(r.s.c)+":"+(r.e.cRel?"":"$")+encode_col(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(opts.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+encode_row(r.s.r)+":"+(r.e.rRel?"":"$")+encode_row(r.e.r):encode_cell_xls(r.s,opts.biff)+":"+encode_cell_xls(r.e,opts.biff)}function decode_row(rowstr){return parseInt(unfix_row(rowstr),10)-1}function encode_row(row){return""+(row+1)}function fix_row(cstr){return cstr.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(cstr){return cstr.replace(/\$(\d+)$/,"$1")}function decode_col(colstr){for(var c2=unfix_col(colstr),d2=0,i2=0;i2!==c2.length;++i2)d2=26*d2+c2.charCodeAt(i2)-64;return d2-1}function encode_col(col){if(col<0)throw new Error("invalid column "+col);var s2="";for(++col;col;col=Math.floor((col-1)/26))s2=String.fromCharCode((col-1)%26+65)+s2;return s2}function fix_col(cstr){return cstr.replace(/^([A-Z])/,"$$$1")}function unfix_col(cstr){return cstr.replace(/^\$([A-Z])/,"$1")}function split_cell(cstr){return cstr.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(cstr){for(var R2=0,C2=0,i2=0;i2<cstr.length;++i2){var cc=cstr.charCodeAt(i2);cc>=48&&cc<=57?R2=10*R2+(cc-48):cc>=65&&cc<=90&&(C2=26*C2+(cc-64))}return{c:C2-1,r:R2-1}}function encode_cell(cell){for(var col=cell.c+1,s2="";col;col=(col-1)/26|0)s2=String.fromCharCode((col-1)%26+65)+s2;return s2+(cell.r+1)}function decode_range(range){var idx=range.indexOf(":");return idx==-1?{s:decode_cell(range),e:decode_cell(range)}:{s:decode_cell(range.slice(0,idx)),e:decode_cell(range.slice(idx+1))}}function encode_range(cs,ce2){return typeof ce2>"u"||typeof ce2=="number"?encode_range(cs.s,cs.e):(typeof cs!="string"&&(cs=encode_cell(cs)),typeof ce2!="string"&&(ce2=encode_cell(ce2)),cs==ce2?cs:cs+":"+ce2)}function safe_decode_range(range){var o2={s:{c:0,r:0},e:{c:0,r:0}},idx=0,i2=0,cc=0,len=range.length;for(idx=0;i2<len&&!((cc=range.charCodeAt(i2)-64)<1||cc>26);++i2)idx=26*idx+cc;for(o2.s.c=--idx,idx=0;i2<len&&!((cc=range.charCodeAt(i2)-48)<0||cc>9);++i2)idx=10*idx+cc;if(o2.s.r=--idx,i2===len||cc!=10)return o2.e.c=o2.s.c,o2.e.r=o2.s.r,o2;for(++i2,idx=0;i2!=len&&!((cc=range.charCodeAt(i2)-64)<1||cc>26);++i2)idx=26*idx+cc;for(o2.e.c=--idx,idx=0;i2!=len&&!((cc=range.charCodeAt(i2)-48)<0||cc>9);++i2)idx=10*idx+cc;return o2.e.r=--idx,o2}function safe_format_cell(cell,v2){var q2=cell.t=="d"&&v2 instanceof Date;if(cell.z!=null)try{return cell.w=SSF_format(cell.z,q2?datenum(v2):v2)}catch{}try{return cell.w=SSF_format((cell.XF||{}).numFmtId||(q2?14:0),q2?datenum(v2):v2)}catch{return""+v2}}function format_cell(cell,v2,o2){return cell==null||cell.t==null||cell.t=="z"?"":cell.w!==void 0?cell.w:(cell.t=="d"&&!cell.z&&o2&&o2.dateNF&&(cell.z=o2.dateNF),cell.t=="e"?BErr[cell.v]||cell.v:v2==null?safe_format_cell(cell,cell.v):safe_format_cell(cell,v2))}function sheet_to_workbook(sheet,opts){var n=opts&&opts.sheet?opts.sheet:"Sheet1",sheets={};return sheets[n]=sheet,{SheetNames:[n],Sheets:sheets}}function sheet_add_aoa(_ws,data,opts){var o2=opts||{},dense=_ws?Array.isArray(_ws):o2.dense,ws=_ws||(dense?[]:{}),_R=0,_C=0;if(ws&&o2.origin!=null){if(typeof o2.origin=="number")_R=o2.origin;else{var _origin=typeof o2.origin=="string"?decode_cell(o2.origin):o2.origin;_R=_origin.r,_C=_origin.c}ws["!ref"]||(ws["!ref"]="A1:A1")}var range={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(ws["!ref"]){var _range=safe_decode_range(ws["!ref"]);range.s.c=_range.s.c,range.s.r=_range.s.r,range.e.c=Math.max(range.e.c,_range.e.c),range.e.r=Math.max(range.e.r,_range.e.r),_R==-1&&(range.e.r=_R=_range.e.r+1)}for(var R2=0;R2!=data.length;++R2)if(data[R2]){if(!Array.isArray(data[R2]))throw new Error("aoa_to_sheet expects an array of arrays");for(var C2=0;C2!=data[R2].length;++C2)if(!(typeof data[R2][C2]>"u")){var cell={v:data[R2][C2]},__R=_R+R2,__C=_C+C2;if(range.s.r>__R&&(range.s.r=__R),range.s.c>__C&&(range.s.c=__C),range.e.r<__R&&(range.e.r=__R),range.e.c<__C&&(range.e.c=__C),data[R2][C2]&&typeof data[R2][C2]=="object"&&!Array.isArray(data[R2][C2])&&!(data[R2][C2]instanceof Date))cell=data[R2][C2];else if(Array.isArray(cell.v)&&(cell.f=data[R2][C2][1],cell.v=cell.v[0]),cell.v===null)if(cell.f)cell.t="n";else if(o2.nullError)cell.t="e",cell.v=0;else if(o2.sheetStubs)cell.t="z";else continue;else typeof cell.v=="number"?cell.t="n":typeof cell.v=="boolean"?cell.t="b":cell.v instanceof Date?(cell.z=o2.dateNF||table_fmt[14],o2.cellDates?(cell.t="d",cell.w=SSF_format(cell.z,datenum(cell.v))):(cell.t="n",cell.v=datenum(cell.v),cell.w=SSF_format(cell.z,cell.v))):cell.t="s";if(dense)ws[__R]||(ws[__R]=[]),ws[__R][__C]&&ws[__R][__C].z&&(cell.z=ws[__R][__C].z),ws[__R][__C]=cell;else{var cell_ref=encode_cell({c:__C,r:__R});ws[cell_ref]&&ws[cell_ref].z&&(cell.z=ws[cell_ref].z),ws[cell_ref]=cell}}}return range.s.c<1e7&&(ws["!ref"]=encode_range(range)),ws}function aoa_to_sheet(data,opts){return sheet_add_aoa(null,data,opts)}function parse_Int32LE(data){return data.read_shift(4,"i")}function write_UInt32LE(x2,o2){return o2||(o2=new_buf(4)),o2.write_shift(4,x2),o2}function parse_XLWideString(data){var cchCharacters=data.read_shift(4);return cchCharacters===0?"":data.read_shift(cchCharacters,"dbcs")}function write_XLWideString(data,o2){var _null=!1;return o2==null&&(_null=!0,o2=new_buf(4+2*data.length)),o2.write_shift(4,data.length),data.length>0&&o2.write_shift(0,data,"dbcs"),_null?o2.slice(0,o2.l):o2}function parse_StrRun(data){return{ich:data.read_shift(2),ifnt:data.read_shift(2)}}function write_StrRun(run,o2){return o2||(o2=new_buf(4)),o2.write_shift(2,0),o2.write_shift(2,0),o2}function parse_RichStr(data,length){var start=data.l,flags=data.read_shift(1),str=parse_XLWideString(data),rgsStrRun=[],z2={t:str,h:str};if((flags&1)!==0){for(var dwSizeStrRun=data.read_shift(4),i2=0;i2!=dwSizeStrRun;++i2)rgsStrRun.push(parse_StrRun(data));z2.r=rgsStrRun}else z2.r=[{ich:0,ifnt:0}];return data.l=start+length,z2}function write_RichStr(str,o2){var _null=!1;return o2==null&&(_null=!0,o2=new_buf(15+4*str.t.length)),o2.write_shift(1,0),write_XLWideString(str.t,o2),_null?o2.slice(0,o2.l):o2}var parse_BrtCommentText=parse_RichStr;function write_BrtCommentText(str,o2){var _null=!1;return o2==null&&(_null=!0,o2=new_buf(23+4*str.t.length)),o2.write_shift(1,1),write_XLWideString(str.t,o2),o2.write_shift(4,1),write_StrRun({},o2),_null?o2.slice(0,o2.l):o2}function parse_XLSBCell(data){var col=data.read_shift(4),iStyleRef=data.read_shift(2);return iStyleRef+=data.read_shift(1)<<16,data.l++,{c:col,iStyleRef}}function write_XLSBCell(cell,o2){return o2==null&&(o2=new_buf(8)),o2.write_shift(-4,cell.c),o2.write_shift(3,cell.iStyleRef||cell.s),o2.write_shift(1,0),o2}function parse_XLSBShortCell(data){var iStyleRef=data.read_shift(2);return iStyleRef+=data.read_shift(1)<<16,data.l++,{c:-1,iStyleRef}}function write_XLSBShortCell(cell,o2){return o2==null&&(o2=new_buf(4)),o2.write_shift(3,cell.iStyleRef||cell.s),o2.write_shift(1,0),o2}var parse_XLSBCodeName=parse_XLWideString,write_XLSBCodeName=write_XLWideString;function parse_XLNullableWideString(data){var cchCharacters=data.read_shift(4);return cchCharacters===0||cchCharacters===4294967295?"":data.read_shift(cchCharacters,"dbcs")}function write_XLNullableWideString(data,o2){var _null=!1;return o2==null&&(_null=!0,o2=new_buf(127)),o2.write_shift(4,data.length>0?data.length:4294967295),data.length>0&&o2.write_shift(0,data,"dbcs"),_null?o2.slice(0,o2.l):o2}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString,write_RelID=write_XLNullableWideString;function parse_RkNumber(data){var b2=data.slice(data.l,data.l+4),fX100=b2[0]&1,fInt=b2[0]&2;data.l+=4;var RK=fInt===0?__double([0,0,0,0,b2[0]&252,b2[1],b2[2],b2[3]],0):__readInt32LE(b2,0)>>2;return fX100?RK/100:RK}function write_RkNumber(data,o2){o2==null&&(o2=new_buf(4));var fX100=0,fInt=0,d100=data*100;if(data==(data|0)&&data>=-536870912&&data<1<<29?fInt=1:d100==(d100|0)&&d100>=-536870912&&d100<1<<29&&(fInt=1,fX100=1),fInt)o2.write_shift(-4,((fX100?d100:data)<<2)+(fX100+2));else throw new Error("unsupported RkNumber "+data)}function parse_RfX(data){var cell={s:{},e:{}};return cell.s.r=data.read_shift(4),cell.e.r=data.read_shift(4),cell.s.c=data.read_shift(4),cell.e.c=data.read_shift(4),cell}function write_RfX(r,o2){return o2||(o2=new_buf(16)),o2.write_shift(4,r.s.r),o2.write_shift(4,r.e.r),o2.write_shift(4,r.s.c),o2.write_shift(4,r.e.c),o2}var parse_UncheckedRfX=parse_RfX,write_UncheckedRfX=write_RfX;function parse_Xnum(data){if(data.length-data.l<8)throw"XLS Xnum Buffer underflow";return data.read_shift(8,"f")}function write_Xnum(data,o2){return(o2||new_buf(8)).write_shift(8,data,"f")}function parse_BrtColor(data){var out={},d2=data.read_shift(1),xColorType=d2>>>1,index=data.read_shift(1),nTS=data.read_shift(2,"i"),bR=data.read_shift(1),bG=data.read_shift(1),bB=data.read_shift(1);switch(data.l++,xColorType){case 0:out.auto=1;break;case 1:out.index=index;var icv=XLSIcv[index];icv&&(out.rgb=rgb2Hex(icv));break;case 2:out.rgb=rgb2Hex([bR,bG,bB]);break;case 3:out.theme=index;break}return nTS!=0&&(out.tint=nTS>0?nTS/32767:nTS/32768),out}function write_BrtColor(color,o2){if(o2||(o2=new_buf(8)),!color||color.auto)return o2.write_shift(4,0),o2.write_shift(4,0),o2;color.index!=null?(o2.write_shift(1,2),o2.write_shift(1,color.index)):color.theme!=null?(o2.write_shift(1,6),o2.write_shift(1,color.theme)):(o2.write_shift(1,5),o2.write_shift(1,0));var nTS=color.tint||0;if(nTS>0?nTS*=32767:nTS<0&&(nTS*=32768),o2.write_shift(2,nTS),!color.rgb||color.theme!=null)o2.write_shift(2,0),o2.write_shift(1,0),o2.write_shift(1,0);else{var rgb=color.rgb||"FFFFFF";typeof rgb=="number"&&(rgb=("000000"+rgb.toString(16)).slice(-6)),o2.write_shift(1,parseInt(rgb.slice(0,2),16)),o2.write_shift(1,parseInt(rgb.slice(2,4),16)),o2.write_shift(1,parseInt(rgb.slice(4,6),16)),o2.write_shift(1,255)}return o2}function parse_FontFlags(data){var d2=data.read_shift(1);data.l++;var out={fBold:d2&1,fItalic:d2&2,fUnderline:d2&4,fStrikeout:d2&8,fOutline:d2&16,fShadow:d2&32,fCondense:d2&64,fExtend:d2&128};return out}function write_FontFlags(font,o2){o2||(o2=new_buf(2));var grbit=(font.italic?2:0)|(font.strike?8:0)|(font.outline?16:0)|(font.shadow?32:0)|(font.condense?64:0)|(font.extend?128:0);return o2.write_shift(1,grbit),o2.write_shift(1,0),o2}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}};function rgbify(arr){return arr.map(function(x2){return[x2>>16&255,x2>>8&255,x2&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},CT_LIST={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function write_ct(ct2,opts){var type2ct=evert_arr(ct2type),o2=[],v2;o2[o2.length]=XML_HEADER,o2[o2.length]=writextag("Types",null,{xmlns:XMLNS.CT,"xmlns:xsd":XMLNS.xsd,"xmlns:xsi":XMLNS.xsi}),o2=o2.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(x2){return writextag("Default",null,{Extension:x2[0],ContentType:x2[1]})}));var f1=function(w2){ct2[w2]&&ct2[w2].length>0&&(v2=ct2[w2][0],o2[o2.length]=writextag("Override",null,{PartName:(v2[0]=="/"?"":"/")+v2,ContentType:CT_LIST[w2][opts.bookType]||CT_LIST[w2].xlsx}))},f2=function(w2){(ct2[w2]||[]).forEach(function(v3){o2[o2.length]=writextag("Override",null,{PartName:(v3[0]=="/"?"":"/")+v3,ContentType:CT_LIST[w2][opts.bookType]||CT_LIST[w2].xlsx})})},f3=function(t2){(ct2[t2]||[]).forEach(function(v3){o2[o2.length]=writextag("Override",null,{PartName:(v3[0]=="/"?"":"/")+v3,ContentType:type2ct[t2][0]})})};return f1("workbooks"),f2("sheets"),f2("charts"),f3("themes"),["strs","styles"].forEach(f1),["coreprops","extprops","custprops"].forEach(f3),f3("vba"),f3("comments"),f3("threadedcomments"),f3("drawings"),f2("metadata"),f3("people"),o2.length>2&&(o2[o2.length]="</Types>",o2[1]=o2[1].replace("/>",">")),o2.join("")}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(file){var n=file.lastIndexOf("/");return file.slice(0,n+1)+"_rels/"+file.slice(n+1)+".rels"}function write_rels(rels){var o2=[XML_HEADER,writextag("Relationships",null,{xmlns:XMLNS.RELS})];return keys(rels["!id"]).forEach(function(rid){o2[o2.length]=writextag("Relationship",null,rels["!id"][rid])}),o2.length>2&&(o2[o2.length]="</Relationships>",o2[1]=o2[1].replace("/>",">")),o2.join("")}function add_rels(rels,rId,f2,type,relobj,targetmode){if(relobj||(relobj={}),rels["!id"]||(rels["!id"]={}),rels["!idx"]||(rels["!idx"]=1),rId<0)for(rId=rels["!idx"];rels["!id"]["rId"+rId];++rId);if(rels["!idx"]=rId+1,relobj.Id="rId"+rId,relobj.Type=type,relobj.Target=f2,[RELS.HLINK,RELS.XPATH,RELS.XMISS].indexOf(relobj.Type)>-1&&(relobj.TargetMode="External"),rels["!id"][relobj.Id])throw new Error("Cannot rewrite rId "+rId);return rels["!id"][relobj.Id]=relobj,rels[("/"+relobj.Target).replace("//","/")]=relobj,rId}function write_manifest(manifest){var o2=[XML_HEADER];o2.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),o2.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var i2=0;i2<manifest.length;++i2)o2.push('  <manifest:file-entry manifest:full-path="'+manifest[i2][0]+'" manifest:media-type="'+manifest[i2][1]+`"/>
`);return o2.push("</manifest:manifest>"),o2.join("")}function write_rdf_type(file,res,tag){return['  <rdf:Description rdf:about="'+file+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(tag||"odf")+"#"+res+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf_has(base,file){return['  <rdf:Description rdf:about="'+base+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+file+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf(rdf){var o2=[XML_HEADER];o2.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var i2=0;i2!=rdf.length;++i2)o2.push(write_rdf_type(rdf[i2][0],rdf[i2][1])),o2.push(write_rdf_has("",rdf[i2][0]));return o2.push(write_rdf_type("","Document","pkg")),o2.push("</rdf:RDF>"),o2.join("")}function write_meta_ods(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+XLSX.version+"</meta:generator></office:meta></office:document-meta>"}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function cp_doit(f2,g2,h2,o2,p2){p2[f2]!=null||g2==null||g2===""||(p2[f2]=g2,g2=escapexml(g2),o2[o2.length]=h2?writextag(f2,g2,h2):writetag(f2,g2))}function write_core_props(cp,_opts){var opts=_opts||{},o2=[XML_HEADER,writextag("cp:coreProperties",null,{"xmlns:cp":XMLNS.CORE_PROPS,"xmlns:dc":XMLNS.dc,"xmlns:dcterms":XMLNS.dcterms,"xmlns:dcmitype":XMLNS.dcmitype,"xmlns:xsi":XMLNS.xsi})],p2={};if(!cp&&!opts.Props)return o2.join("");cp&&(cp.CreatedDate!=null&&cp_doit("dcterms:created",typeof cp.CreatedDate=="string"?cp.CreatedDate:write_w3cdtf(cp.CreatedDate,opts.WTF),{"xsi:type":"dcterms:W3CDTF"},o2,p2),cp.ModifiedDate!=null&&cp_doit("dcterms:modified",typeof cp.ModifiedDate=="string"?cp.ModifiedDate:write_w3cdtf(cp.ModifiedDate,opts.WTF),{"xsi:type":"dcterms:W3CDTF"},o2,p2));for(var i2=0;i2!=CORE_PROPS.length;++i2){var f2=CORE_PROPS[i2],v2=opts.Props&&opts.Props[f2[1]]!=null?opts.Props[f2[1]]:cp?cp[f2[1]]:null;v2===!0?v2="1":v2===!1?v2="0":typeof v2=="number"&&(v2=String(v2)),v2!=null&&cp_doit(f2[0],v2,null,o2,p2)}return o2.length>2&&(o2[o2.length]="</cp:coreProperties>",o2[1]=o2[1].replace("/>",">")),o2.join("")}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PseudoPropsPairs=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function write_ext_props(cp){var o2=[],W2=writextag;return cp||(cp={}),cp.Application="SheetJS",o2[o2.length]=XML_HEADER,o2[o2.length]=writextag("Properties",null,{xmlns:XMLNS.EXT_PROPS,"xmlns:vt":XMLNS.vt}),EXT_PROPS.forEach(function(f2){if(cp[f2[1]]!==void 0){var v2;switch(f2[2]){case"string":v2=escapexml(String(cp[f2[1]]));break;case"bool":v2=cp[f2[1]]?"true":"false";break}v2!==void 0&&(o2[o2.length]=W2(f2[0],v2))}}),o2[o2.length]=W2("HeadingPairs",W2("vt:vector",W2("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+W2("vt:variant",W2("vt:i4",String(cp.Worksheets))),{size:2,baseType:"variant"})),o2[o2.length]=W2("TitlesOfParts",W2("vt:vector",cp.SheetNames.map(function(s2){return"<vt:lpstr>"+escapexml(s2)+"</vt:lpstr>"}).join(""),{size:cp.Worksheets,baseType:"lpstr"})),o2.length>2&&(o2[o2.length]="</Properties>",o2[1]=o2[1].replace("/>",">")),o2.join("")}function write_cust_props(cp){var o2=[XML_HEADER,writextag("Properties",null,{xmlns:XMLNS.CUST_PROPS,"xmlns:vt":XMLNS.vt})];if(!cp)return o2.join("");var pid=1;return keys(cp).forEach(function(k2){++pid,o2[o2.length]=writextag("property",write_vt(cp[k2]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid,name:escapexml(k2)})}),o2.length>2&&(o2[o2.length]="</Properties>",o2[1]=o2[1].replace("/>",">")),o2.join("")}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function xlml_write_docprops(Props,opts){var o2=[];return keys(XLMLDocPropsMap).map(function(m2){for(var i2=0;i2<CORE_PROPS.length;++i2)if(CORE_PROPS[i2][1]==m2)return CORE_PROPS[i2];for(i2=0;i2<EXT_PROPS.length;++i2)if(EXT_PROPS[i2][1]==m2)return EXT_PROPS[i2];throw m2}).forEach(function(p2){if(Props[p2[1]]!=null){var m2=opts&&opts.Props&&opts.Props[p2[1]]!=null?opts.Props[p2[1]]:Props[p2[1]];switch(p2[2]){case"date":m2=new Date(m2).toISOString().replace(/\.\d*Z/,"Z");break}typeof m2=="number"?m2=String(m2):m2===!0||m2===!1?m2=m2?"1":"0":m2 instanceof Date&&(m2=new Date(m2).toISOString().replace(/\.\d*Z/,"")),o2.push(writetag(XLMLDocPropsMap[p2[1]]||p2[1],m2))}}),writextag("DocumentProperties",o2.join(""),{xmlns:XLMLNS.o})}function xlml_write_custprops(Props,Custprops){var BLACKLIST=["Worksheets","SheetNames"],T2="CustomDocumentProperties",o2=[];return Props&&keys(Props).forEach(function(k2){if(Object.prototype.hasOwnProperty.call(Props,k2)){for(var i2=0;i2<CORE_PROPS.length;++i2)if(k2==CORE_PROPS[i2][1])return;for(i2=0;i2<EXT_PROPS.length;++i2)if(k2==EXT_PROPS[i2][1])return;for(i2=0;i2<BLACKLIST.length;++i2)if(k2==BLACKLIST[i2])return;var m2=Props[k2],t2="string";typeof m2=="number"?(t2="float",m2=String(m2)):m2===!0||m2===!1?(t2="boolean",m2=m2?"1":"0"):m2=String(m2),o2.push(writextag(escapexmltag(k2),m2,{"dt:dt":t2}))}}),Custprops&&keys(Custprops).forEach(function(k2){if(Object.prototype.hasOwnProperty.call(Custprops,k2)&&!(Props&&Object.prototype.hasOwnProperty.call(Props,k2))){var m2=Custprops[k2],t2="string";typeof m2=="number"?(t2="float",m2=String(m2)):m2===!0||m2===!1?(t2="boolean",m2=m2?"1":"0"):m2 instanceof Date?(t2="dateTime.tz",m2=m2.toISOString()):m2=String(m2),o2.push(writextag(escapexmltag(k2),m2,{"dt:dt":t2}))}}),"<"+T2+' xmlns="'+XLMLNS.o+'">'+o2.join("")+"</"+T2+">"}function write_FILETIME(time){var date=typeof time=="string"?new Date(Date.parse(time)):time,t2=date.getTime()/1e3+11644473600,l2=t2%Math.pow(2,32),h2=(t2-l2)/Math.pow(2,32);l2*=1e7,h2*=1e7;var w2=l2/Math.pow(2,32)|0;w2>0&&(l2=l2%Math.pow(2,32),h2+=w2);var o2=new_buf(8);return o2.write_shift(4,l2),o2.write_shift(4,h2),o2}function write_TypedPropertyValue(type,value){var o2=new_buf(4),p2=new_buf(4);switch(o2.write_shift(4,type==80?31:type),type){case 3:p2.write_shift(-4,value);break;case 5:p2=new_buf(8),p2.write_shift(8,value,"f");break;case 11:p2.write_shift(4,value?1:0);break;case 64:p2=write_FILETIME(value);break;case 31:case 80:for(p2=new_buf(4+2*(value.length+1)+(value.length%2?0:2)),p2.write_shift(4,value.length+1),p2.write_shift(0,value,"dbcs");p2.l!=p2.length;)p2.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+type+" "+value)}return bconcat([o2,p2])}var XLSPSSkip=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function guess_property_type(val){switch(typeof val){case"boolean":return 11;case"number":return(val|0)==val?3:5;case"string":return 31;case"object":if(val instanceof Date)return 64;break}return-1}function write_PropertySet(entries,RE,PIDSI){var hdr=new_buf(8),piao=[],prop=[],sz=8,i2=0,pr=new_buf(8),pio=new_buf(8);if(pr.write_shift(4,2),pr.write_shift(4,1200),pio.write_shift(4,1),prop.push(pr),piao.push(pio),sz+=8+pr.length,!RE){pio=new_buf(8),pio.write_shift(4,0),piao.unshift(pio);var bufs=[new_buf(4)];for(bufs[0].write_shift(4,entries.length),i2=0;i2<entries.length;++i2){var value=entries[i2][0];for(pr=new_buf(8+2*(value.length+1)+(value.length%2?0:2)),pr.write_shift(4,i2+2),pr.write_shift(4,value.length+1),pr.write_shift(0,value,"dbcs");pr.l!=pr.length;)pr.write_shift(1,0);bufs.push(pr)}pr=bconcat(bufs),prop.unshift(pr),sz+=8+pr.length}for(i2=0;i2<entries.length;++i2)if(!(RE&&!RE[entries[i2][0]])&&!(XLSPSSkip.indexOf(entries[i2][0])>-1||PseudoPropsPairs.indexOf(entries[i2][0])>-1)&&entries[i2][1]!=null){var val=entries[i2][1],idx=0;if(RE){idx=+RE[entries[i2][0]];var pinfo=PIDSI[idx];if(pinfo.p=="version"&&typeof val=="string"){var arr=val.split(".");val=(+arr[0]<<16)+(+arr[1]||0)}pr=write_TypedPropertyValue(pinfo.t,val)}else{var T2=guess_property_type(val);T2==-1&&(T2=31,val=String(val)),pr=write_TypedPropertyValue(T2,val)}prop.push(pr),pio=new_buf(8),pio.write_shift(4,RE?idx:2+i2),piao.push(pio),sz+=8+pr.length}var w2=8*(prop.length+1);for(i2=0;i2<prop.length;++i2)piao[i2].write_shift(4,w2),w2+=prop[i2].length;return hdr.write_shift(4,sz),hdr.write_shift(4,prop.length),bconcat([hdr].concat(piao).concat(prop))}function write_PropertySetStream(entries,clsid,RE,PIDSI,entries2,clsid2){var hdr=new_buf(entries2?68:48),bufs=[hdr];hdr.write_shift(2,65534),hdr.write_shift(2,0),hdr.write_shift(4,842412599),hdr.write_shift(16,CFB.utils.consts.HEADER_CLSID,"hex"),hdr.write_shift(4,entries2?2:1),hdr.write_shift(16,clsid,"hex"),hdr.write_shift(4,entries2?68:48);var ps0=write_PropertySet(entries,RE,PIDSI);if(bufs.push(ps0),entries2){var ps1=write_PropertySet(entries2,null,null);hdr.write_shift(16,clsid2,"hex"),hdr.write_shift(4,68+ps0.length),bufs.push(ps1)}return bconcat(bufs)}function writezeroes(n,o2){o2||(o2=new_buf(n));for(var j2=0;j2<n;++j2)o2.write_shift(1,0);return o2}function parsebool(blob,length){return blob.read_shift(length)===1}function writebool(v2,o2){return o2||(o2=new_buf(2)),o2.write_shift(2,+!!v2),o2}function parseuint16(blob){return blob.read_shift(2,"u")}function writeuint16(v2,o2){return o2||(o2=new_buf(2)),o2.write_shift(2,v2),o2}function write_Bes(v2,t2,o2){return o2||(o2=new_buf(2)),o2.write_shift(1,t2=="e"?+v2:+!!v2),o2.write_shift(1,t2=="e"?1:0),o2}function parse_ShortXLUnicodeString(blob,length,opts){var cch=blob.read_shift(opts&&opts.biff>=12?2:1),encoding="sbcs-cont";if(opts&&opts.biff>=8,!opts||opts.biff==8){var fHighByte=blob.read_shift(1);fHighByte&&(encoding="dbcs-cont")}else opts.biff==12&&(encoding="wstr");opts.biff>=2&&opts.biff<=5&&(encoding="cpstr");var o2=cch?blob.read_shift(cch,encoding):"";return o2}function write_XLUnicodeRichExtendedString(xlstr){var str=xlstr.t||"",hdr=new_buf(3);hdr.write_shift(2,str.length),hdr.write_shift(1,1);var otext=new_buf(2*str.length);otext.write_shift(2*str.length,str,"utf16le");var out=[hdr,otext];return bconcat(out)}function parse_XLUnicodeStringNoCch(blob,cch,opts){var retval;if(opts){if(opts.biff>=2&&opts.biff<=5)return blob.read_shift(cch,"cpstr");if(opts.biff>=12)return blob.read_shift(cch,"dbcs-cont")}var fHighByte=blob.read_shift(1);return fHighByte===0?retval=blob.read_shift(cch,"sbcs-cont"):retval=blob.read_shift(cch,"dbcs-cont"),retval}function parse_XLUnicodeString(blob,length,opts){var cch=blob.read_shift(opts&&opts.biff==2?1:2);return cch===0?(blob.l++,""):parse_XLUnicodeStringNoCch(blob,cch,opts)}function parse_XLUnicodeString2(blob,length,opts){if(opts.biff>5)return parse_XLUnicodeString(blob,length,opts);var cch=blob.read_shift(1);return cch===0?(blob.l++,""):blob.read_shift(cch,opts.biff<=4||!blob.lens?"cpstr":"sbcs-cont")}function write_XLUnicodeString(str,opts,o2){return o2||(o2=new_buf(3+2*str.length)),o2.write_shift(2,str.length),o2.write_shift(1,1),o2.write_shift(31,str,"utf16le"),o2}function write_HyperlinkString(str,o2){o2||(o2=new_buf(6+str.length*2)),o2.write_shift(4,1+str.length);for(var i2=0;i2<str.length;++i2)o2.write_shift(2,str.charCodeAt(i2));return o2.write_shift(2,0),o2}function write_Hyperlink(hl){var out=new_buf(512),i2=0,Target=hl.Target;Target.slice(0,7)=="file://"&&(Target=Target.slice(7));var hashidx=Target.indexOf("#"),F2=hashidx>-1?31:23;switch(Target.charAt(0)){case"#":F2=28;break;case".":F2&=-3;break}out.write_shift(4,2),out.write_shift(4,F2);var data=[8,6815827,6619237,4849780,83];for(i2=0;i2<data.length;++i2)out.write_shift(4,data[i2]);if(F2==28)Target=Target.slice(1),write_HyperlinkString(Target,out);else if(F2&2){for(data="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i2=0;i2<data.length;++i2)out.write_shift(1,parseInt(data[i2],16));var Pretarget=hashidx>-1?Target.slice(0,hashidx):Target;for(out.write_shift(4,2*(Pretarget.length+1)),i2=0;i2<Pretarget.length;++i2)out.write_shift(2,Pretarget.charCodeAt(i2));out.write_shift(2,0),F2&8&&write_HyperlinkString(hashidx>-1?Target.slice(hashidx+1):"",out)}else{for(data="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),i2=0;i2<data.length;++i2)out.write_shift(1,parseInt(data[i2],16));for(var P2=0;Target.slice(P2*3,P2*3+3)=="../"||Target.slice(P2*3,P2*3+3)=="..\\";)++P2;for(out.write_shift(2,P2),out.write_shift(4,Target.length-3*P2+1),i2=0;i2<Target.length-3*P2;++i2)out.write_shift(1,Target.charCodeAt(i2+3*P2)&255);for(out.write_shift(1,0),out.write_shift(2,65535),out.write_shift(2,57005),i2=0;i2<6;++i2)out.write_shift(4,0)}return out.slice(0,out.l)}function write_XLSCell(R2,C2,ixfe,o2){return o2||(o2=new_buf(6)),o2.write_shift(2,R2),o2.write_shift(2,C2),o2.write_shift(2,ixfe||0),o2}function parse_XTI(blob,length,opts){var w2=opts.biff>8?4:2,iSupBook=blob.read_shift(w2),itabFirst=blob.read_shift(w2,"i"),itabLast=blob.read_shift(w2,"i");return[iSupBook,itabFirst,itabLast]}function parse_Ref8U(blob){var rwFirst=blob.read_shift(2),rwLast=blob.read_shift(2),colFirst=blob.read_shift(2),colLast=blob.read_shift(2);return{s:{c:colFirst,r:rwFirst},e:{c:colLast,r:rwLast}}}function write_Ref8U(r,o2){return o2||(o2=new_buf(8)),o2.write_shift(2,r.s.r),o2.write_shift(2,r.e.r),o2.write_shift(2,r.s.c),o2.write_shift(2,r.e.c),o2}function write_BOF(wb,t2,o2){var h2=1536,w2=16;switch(o2.bookType){case"biff8":break;case"biff5":h2=1280,w2=8;break;case"biff4":h2=4,w2=6;break;case"biff3":h2=3,w2=6;break;case"biff2":h2=2,w2=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var out=new_buf(w2);return out.write_shift(2,h2),out.write_shift(2,t2),w2>4&&out.write_shift(2,29282),w2>6&&out.write_shift(2,1997),w2>8&&(out.write_shift(2,49161),out.write_shift(2,1),out.write_shift(2,1798),out.write_shift(2,0)),out}function write_WriteAccess(s2,opts){var b8=!opts||opts.biff==8,o2=new_buf(b8?112:54);for(o2.write_shift(opts.biff==8?2:1,7),b8&&o2.write_shift(1,0),o2.write_shift(4,859007059),o2.write_shift(4,5458548|(b8?0:536870912));o2.l<o2.length;)o2.write_shift(1,b8?0:32);return o2}function write_BoundSheet8(data,opts){var w2=!opts||opts.biff>=8?2:1,o2=new_buf(8+w2*data.name.length);o2.write_shift(4,data.pos),o2.write_shift(1,data.hs||0),o2.write_shift(1,data.dt),o2.write_shift(1,data.name.length),opts.biff>=8&&o2.write_shift(1,1),o2.write_shift(w2*data.name.length,data.name,opts.biff<8?"sbcs":"utf16le");var out=o2.slice(0,o2.l);return out.l=o2.l,out}function write_SST(sst,opts){var header=new_buf(8);header.write_shift(4,sst.Count),header.write_shift(4,sst.Unique);for(var strs=[],j2=0;j2<sst.length;++j2)strs[j2]=write_XLUnicodeRichExtendedString(sst[j2]);var o2=bconcat([header].concat(strs));return o2.parts=[header.length].concat(strs.map(function(str){return str.length})),o2}function write_Window1(){var o2=new_buf(18);return o2.write_shift(2,0),o2.write_shift(2,0),o2.write_shift(2,29280),o2.write_shift(2,17600),o2.write_shift(2,56),o2.write_shift(2,0),o2.write_shift(2,0),o2.write_shift(2,1),o2.write_shift(2,500),o2}function write_Window2(view){var o2=new_buf(18),f2=1718;return view&&view.RTL&&(f2|=64),o2.write_shift(2,f2),o2.write_shift(4,0),o2.write_shift(4,64),o2.write_shift(4,0),o2.write_shift(4,0),o2}function write_Font(data,opts){var name=data.name||"Arial",b5=opts&&opts.biff==5,w2=b5?15+name.length:16+2*name.length,o2=new_buf(w2);return o2.write_shift(2,data.sz*20),o2.write_shift(4,0),o2.write_shift(2,400),o2.write_shift(4,0),o2.write_shift(2,0),o2.write_shift(1,name.length),b5||o2.write_shift(1,1),o2.write_shift((b5?1:2)*name.length,name,b5?"sbcs":"utf16le"),o2}function write_LabelSst(R2,C2,v2,os){var o2=new_buf(10);return write_XLSCell(R2,C2,os,o2),o2.write_shift(4,v2),o2}function write_Label(R2,C2,v2,os,opts){var b8=!opts||opts.biff==8,o2=new_buf(8+ +b8+(1+b8)*v2.length);return write_XLSCell(R2,C2,os,o2),o2.write_shift(2,v2.length),b8&&o2.write_shift(1,1),o2.write_shift((1+b8)*v2.length,v2,b8?"utf16le":"sbcs"),o2}function write_Format(i2,f2,opts,o2){var b5=opts&&opts.biff==5;o2||(o2=new_buf(b5?3+f2.length:5+2*f2.length)),o2.write_shift(2,i2),o2.write_shift(b5?1:2,f2.length),b5||o2.write_shift(1,1),o2.write_shift((b5?1:2)*f2.length,f2,b5?"sbcs":"utf16le");var out=o2.length>o2.l?o2.slice(0,o2.l):o2;return out.l==null&&(out.l=out.length),out}function write_Dimensions(range,opts){var w2=opts.biff==8||!opts.biff?4:2,o2=new_buf(2*w2+6);return o2.write_shift(w2,range.s.r),o2.write_shift(w2,range.e.r+1),o2.write_shift(2,range.s.c),o2.write_shift(2,range.e.c+1),o2.write_shift(2,0),o2}function write_XF(data,ixfeP,opts,o2){var b5=opts&&opts.biff==5;o2||(o2=new_buf(b5?16:20)),o2.write_shift(2,0),data.style?(o2.write_shift(2,data.numFmtId||0),o2.write_shift(2,65524)):(o2.write_shift(2,data.numFmtId||0),o2.write_shift(2,ixfeP<<4));var f2=0;return data.numFmtId>0&&b5&&(f2|=1024),o2.write_shift(4,f2),o2.write_shift(4,0),b5||o2.write_shift(4,0),o2.write_shift(2,0),o2}function write_Guts(guts){var o2=new_buf(8);return o2.write_shift(4,0),o2.write_shift(2,0),o2.write_shift(2,0),o2}function write_BoolErr(R2,C2,v2,os,opts,t2){var o2=new_buf(8);return write_XLSCell(R2,C2,os,o2),write_Bes(v2,t2,o2),o2}function write_Number(R2,C2,v2,os){var o2=new_buf(14);return write_XLSCell(R2,C2,os,o2),write_Xnum(v2,o2),o2}function parse_ExternSheet(blob,length,opts){if(opts.biff<8)return parse_BIFF5ExternSheet(blob,length,opts);for(var o2=[],target=blob.l+length,len=blob.read_shift(opts.biff>8?4:2);len--!==0;)o2.push(parse_XTI(blob,opts.biff>8?12:6,opts));if(blob.l!=target)throw new Error("Bad ExternSheet: "+blob.l+" != "+target);return o2}function parse_BIFF5ExternSheet(blob,length,opts){blob[blob.l+1]==3&&blob[blob.l]++;var o2=parse_ShortXLUnicodeString(blob,length,opts);return o2.charCodeAt(0)==3?o2.slice(1):o2}function write_MergeCells(merges){var o2=new_buf(2+merges.length*8);o2.write_shift(2,merges.length);for(var i2=0;i2<merges.length;++i2)write_Ref8U(merges[i2],o2);return o2}function write_HLink(hl){var O2=new_buf(24),ref=decode_cell(hl[0]);O2.write_shift(2,ref.r),O2.write_shift(2,ref.r),O2.write_shift(2,ref.c),O2.write_shift(2,ref.c);for(var clsid="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i2=0;i2<16;++i2)O2.write_shift(1,parseInt(clsid[i2],16));return bconcat([O2,write_Hyperlink(hl[1])])}function write_HLinkTooltip(hl){var TT=hl[1].Tooltip,O2=new_buf(10+2*(TT.length+1));O2.write_shift(2,2048);var ref=decode_cell(hl[0]);O2.write_shift(2,ref.r),O2.write_shift(2,ref.r),O2.write_shift(2,ref.c),O2.write_shift(2,ref.c);for(var i2=0;i2<TT.length;++i2)O2.write_shift(2,TT.charCodeAt(i2));return O2.write_shift(2,0),O2}function write_Country(o2){return o2||(o2=new_buf(4)),o2.write_shift(2,1),o2.write_shift(2,1),o2}function parse_ColInfo(blob,length,opts){if(!opts.cellStyles)return parsenoop(blob,length);var w2=opts&&opts.biff>=12?4:2,colFirst=blob.read_shift(w2),colLast=blob.read_shift(w2),coldx=blob.read_shift(w2),ixfe=blob.read_shift(w2),flags=blob.read_shift(2);w2==2&&(blob.l+=2);var o2={s:colFirst,e:colLast,w:coldx,ixfe,flags};return(opts.biff>=5||!opts.biff)&&(o2.level=flags>>8&7),o2}function write_ColInfo(col,idx){var o2=new_buf(12);o2.write_shift(2,idx),o2.write_shift(2,idx),o2.write_shift(2,col.width*256),o2.write_shift(2,0);var f2=0;return col.hidden&&(f2|=1),o2.write_shift(1,f2),f2=col.level||0,o2.write_shift(1,f2),o2.write_shift(2,0),o2}function write_RRTabId(n){for(var out=new_buf(2*n),i2=0;i2<n;++i2)out.write_shift(2,i2+1);return out}function write_BIFF2NUM(r,c2,val){var out=new_buf(15);return write_BIFF2Cell(out,r,c2),out.write_shift(8,val,"f"),out}function write_BIFF2INT(r,c2,val){var out=new_buf(9);return write_BIFF2Cell(out,r,c2),out.write_shift(2,val),out}var DBF=(function(){var dbf_codepage_map={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},dbf_reverse_map=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function dbf_to_aoa(buf,opts){var out=[],d2=new_raw_buf(1);switch(opts.type){case"base64":d2=s2a(Base64_decode(buf));break;case"binary":d2=s2a(buf);break;case"buffer":case"array":d2=buf;break}prep_blob(d2,0);var ft2=d2.read_shift(1),memo=!!(ft2&136),vfp=!1,l7=!1;switch(ft2){case 2:break;case 3:break;case 48:vfp=!0,memo=!0;break;case 49:vfp=!0,memo=!0;break;case 131:break;case 139:break;case 140:l7=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+ft2.toString(16))}var nrow=0,fpos=521;ft2==2&&(nrow=d2.read_shift(2)),d2.l+=3,ft2!=2&&(nrow=d2.read_shift(4)),nrow>1048576&&(nrow=1e6),ft2!=2&&(fpos=d2.read_shift(2));var rlen=d2.read_shift(2),current_cp=opts.codepage||1252;ft2!=2&&(d2.l+=16,d2.read_shift(1),d2[d2.l]!==0&&(current_cp=dbf_codepage_map[d2[d2.l]]),d2.l+=1,d2.l+=2),l7&&(d2.l+=36);for(var fields=[],field={},hend=Math.min(d2.length,ft2==2?521:fpos-10-(vfp?264:0)),ww=l7?32:11;d2.l<hend&&d2[d2.l]!=13;)switch(field={},field.name=$cptable.utils.decode(current_cp,d2.slice(d2.l,d2.l+ww)).replace(/[\u0000\r\n].*$/g,""),d2.l+=ww,field.type=String.fromCharCode(d2.read_shift(1)),ft2!=2&&!l7&&(field.offset=d2.read_shift(4)),field.len=d2.read_shift(1),ft2==2&&(field.offset=d2.read_shift(2)),field.dec=d2.read_shift(1),field.name.length&&fields.push(field),ft2!=2&&(d2.l+=l7?13:14),field.type){case"B":(!vfp||field.len!=8)&&opts.WTF&&console.log("Skipping "+field.name+":"+field.type);break;case"G":case"P":opts.WTF&&console.log("Skipping "+field.name+":"+field.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+field.type)}if(d2[d2.l]!==13&&(d2.l=fpos-1),d2.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d2.l+" "+d2[d2.l]);d2.l=fpos;var R2=0,C2=0;for(out[0]=[],C2=0;C2!=fields.length;++C2)out[0][C2]=fields[C2].name;for(;nrow-- >0;){if(d2[d2.l]===42){d2.l+=rlen;continue}for(++d2.l,out[++R2]=[],C2=0,C2=0;C2!=fields.length;++C2){var dd=d2.slice(d2.l,d2.l+fields[C2].len);d2.l+=fields[C2].len,prep_blob(dd,0);var s2=$cptable.utils.decode(current_cp,dd);switch(fields[C2].type){case"C":s2.trim().length&&(out[R2][C2]=s2.replace(/\s+$/,""));break;case"D":s2.length===8?out[R2][C2]=new Date(+s2.slice(0,4),+s2.slice(4,6)-1,+s2.slice(6,8)):out[R2][C2]=s2;break;case"F":out[R2][C2]=parseFloat(s2.trim());break;case"+":case"I":out[R2][C2]=l7?dd.read_shift(-4,"i")^2147483648:dd.read_shift(4,"i");break;case"L":switch(s2.trim().toUpperCase()){case"Y":case"T":out[R2][C2]=!0;break;case"N":case"F":out[R2][C2]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+s2+"|")}break;case"M":if(!memo)throw new Error("DBF Unexpected MEMO for type "+ft2.toString(16));out[R2][C2]="##MEMO##"+(l7?parseInt(s2.trim(),10):dd.read_shift(4));break;case"N":s2=s2.replace(/\u0000/g,"").trim(),s2&&s2!="."&&(out[R2][C2]=+s2||0);break;case"@":out[R2][C2]=new Date(dd.read_shift(-8,"f")-621356832e5);break;case"T":out[R2][C2]=new Date((dd.read_shift(4)-2440588)*864e5+dd.read_shift(4));break;case"Y":out[R2][C2]=dd.read_shift(4,"i")/1e4+dd.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":out[R2][C2]=-dd.read_shift(-8,"f");break;case"B":if(vfp&&fields[C2].len==8){out[R2][C2]=dd.read_shift(8,"f");break}case"G":case"P":dd.l+=fields[C2].len;break;case"0":if(fields[C2].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+fields[C2].type)}}}if(ft2!=2&&d2.l<d2.length&&d2[d2.l++]!=26)throw new Error("DBF EOF Marker missing "+(d2.l-1)+" of "+d2.length+" "+d2[d2.l-1].toString(16));return opts&&opts.sheetRows&&(out=out.slice(0,opts.sheetRows)),opts.DBF=fields,out}function dbf_to_sheet(buf,opts){var o2=opts||{};o2.dateNF||(o2.dateNF="yyyymmdd");var ws=aoa_to_sheet(dbf_to_aoa(buf,o2),o2);return ws["!cols"]=o2.DBF.map(function(field){return{wch:field.len,DBF:field}}),delete o2.DBF,ws}function dbf_to_workbook(buf,opts){try{return sheet_to_workbook(dbf_to_sheet(buf,opts),opts)}catch(e){if(opts&&opts.WTF)throw e}return{SheetNames:[],Sheets:{}}}var _RLEN={B:8,C:250,L:1,D:8,"?":0,"":0};function sheet_to_dbf(ws,opts){var o2=opts||{};if(+o2.codepage>=0&&set_cp(+o2.codepage),o2.type=="string")throw new Error("Cannot write DBF to JS string");var ba=buf_array(),aoa=sheet_to_json(ws,{header:1,raw:!0,cellDates:!0}),headers=aoa[0],data=aoa.slice(1),cols=ws["!cols"]||[],i2=0,j2=0,hcnt=0,rlen=1;for(i2=0;i2<headers.length;++i2){if(((cols[i2]||{}).DBF||{}).name){headers[i2]=cols[i2].DBF.name,++hcnt;continue}if(headers[i2]!=null){if(++hcnt,typeof headers[i2]=="number"&&(headers[i2]=headers[i2].toString(10)),typeof headers[i2]!="string")throw new Error("DBF Invalid column name "+headers[i2]+" |"+typeof headers[i2]+"|");if(headers.indexOf(headers[i2])!==i2){for(j2=0;j2<1024;++j2)if(headers.indexOf(headers[i2]+"_"+j2)==-1){headers[i2]+="_"+j2;break}}}}var range=safe_decode_range(ws["!ref"]),coltypes=[],colwidths=[],coldecimals=[];for(i2=0;i2<=range.e.c-range.s.c;++i2){var guess="",_guess="",maxlen=0,col=[];for(j2=0;j2<data.length;++j2)data[j2][i2]!=null&&col.push(data[j2][i2]);if(col.length==0||headers[i2]==null){coltypes[i2]="?";continue}for(j2=0;j2<col.length;++j2){switch(typeof col[j2]){case"number":_guess="B";break;case"string":_guess="C";break;case"boolean":_guess="L";break;case"object":_guess=col[j2]instanceof Date?"D":"C";break;default:_guess="C"}maxlen=Math.max(maxlen,String(col[j2]).length),guess=guess&&guess!=_guess?"C":_guess}maxlen>250&&(maxlen=250),_guess=((cols[i2]||{}).DBF||{}).type,_guess=="C"&&cols[i2].DBF.len>maxlen&&(maxlen=cols[i2].DBF.len),guess=="B"&&_guess=="N"&&(guess="N",coldecimals[i2]=cols[i2].DBF.dec,maxlen=cols[i2].DBF.len),colwidths[i2]=guess=="C"||_guess=="N"?maxlen:_RLEN[guess]||0,rlen+=colwidths[i2],coltypes[i2]=guess}var h2=ba.next(32);for(h2.write_shift(4,318902576),h2.write_shift(4,data.length),h2.write_shift(2,296+32*hcnt),h2.write_shift(2,rlen),i2=0;i2<4;++i2)h2.write_shift(4,0);for(h2.write_shift(4,0|(+dbf_reverse_map[current_ansi]||3)<<8),i2=0,j2=0;i2<headers.length;++i2)if(headers[i2]!=null){var hf=ba.next(32),_f=(headers[i2].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);hf.write_shift(1,_f,"sbcs"),hf.write_shift(1,coltypes[i2]=="?"?"C":coltypes[i2],"sbcs"),hf.write_shift(4,j2),hf.write_shift(1,colwidths[i2]||_RLEN[coltypes[i2]]||0),hf.write_shift(1,coldecimals[i2]||0),hf.write_shift(1,2),hf.write_shift(4,0),hf.write_shift(1,0),hf.write_shift(4,0),hf.write_shift(4,0),j2+=colwidths[i2]||_RLEN[coltypes[i2]]||0}var hb=ba.next(264);for(hb.write_shift(4,13),i2=0;i2<65;++i2)hb.write_shift(4,0);for(i2=0;i2<data.length;++i2){var rout=ba.next(rlen);for(rout.write_shift(1,0),j2=0;j2<headers.length;++j2)if(headers[j2]!=null)switch(coltypes[j2]){case"L":rout.write_shift(1,data[i2][j2]==null?63:data[i2][j2]?84:70);break;case"B":rout.write_shift(8,data[i2][j2]||0,"f");break;case"N":var _n="0";for(typeof data[i2][j2]=="number"&&(_n=data[i2][j2].toFixed(coldecimals[j2]||0)),hcnt=0;hcnt<colwidths[j2]-_n.length;++hcnt)rout.write_shift(1,32);rout.write_shift(1,_n,"sbcs");break;case"D":data[i2][j2]?(rout.write_shift(4,("0000"+data[i2][j2].getFullYear()).slice(-4),"sbcs"),rout.write_shift(2,("00"+(data[i2][j2].getMonth()+1)).slice(-2),"sbcs"),rout.write_shift(2,("00"+data[i2][j2].getDate()).slice(-2),"sbcs")):rout.write_shift(8,"00000000","sbcs");break;case"C":var _s=String(data[i2][j2]!=null?data[i2][j2]:"").slice(0,colwidths[j2]);for(rout.write_shift(1,_s,"sbcs"),hcnt=0;hcnt<colwidths[j2]-_s.length;++hcnt)rout.write_shift(1,32);break}}return ba.next(1).write_shift(1,26),ba.end()}return{to_workbook:dbf_to_workbook,to_sheet:dbf_to_sheet,from_sheet:sheet_to_dbf}})(),SYLK=(function(){var sylk_escapes={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},sylk_char_regex=new RegExp("\x1BN("+keys(sylk_escapes).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),sylk_char_fn=function(_2,$1){var o2=sylk_escapes[$1];return typeof o2=="number"?_getansi(o2):o2},decode_sylk_char=function($$,$1,$2){var newcc=$1.charCodeAt(0)-32<<4|$2.charCodeAt(0)-48;return newcc==59?$$:_getansi(newcc)};sylk_escapes["|"]=254;function sylk_to_aoa(d2,opts){switch(opts.type){case"base64":return sylk_to_aoa_str(Base64_decode(d2),opts);case"binary":return sylk_to_aoa_str(d2,opts);case"buffer":return sylk_to_aoa_str(has_buf&&Buffer.isBuffer(d2)?d2.toString("binary"):a2s(d2),opts);case"array":return sylk_to_aoa_str(cc2str(d2),opts)}throw new Error("Unrecognized type "+opts.type)}function sylk_to_aoa_str(str,opts){var records=str.split(/[\n\r]+/),R2=-1,C2=-1,ri=0,rj=0,arr=[],formats=[],next_cell_format=null,sht={},rowinfo=[],colinfo=[],cw=[],Mval=0,j2;for(+opts.codepage>=0&&set_cp(+opts.codepage);ri!==records.length;++ri){Mval=0;var rstr=records[ri].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,decode_sylk_char).replace(sylk_char_regex,sylk_char_fn),record=rstr.replace(/;;/g,"\0").split(";").map(function(x2){return x2.replace(/\u0000/g,";")}),RT=record[0],val;if(rstr.length>0)switch(RT){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":record[1].charAt(0)=="P"&&formats.push(rstr.slice(3).replace(/;;/g,";"));break;case"C":var C_seen_K=!1,C_seen_X=!1,C_seen_S=!1,C_seen_E=!1,_R=-1,_C=-1;for(rj=1;rj<record.length;++rj)switch(record[rj].charAt(0)){case"A":break;case"X":C2=parseInt(record[rj].slice(1))-1,C_seen_X=!0;break;case"Y":for(R2=parseInt(record[rj].slice(1))-1,C_seen_X||(C2=0),j2=arr.length;j2<=R2;++j2)arr[j2]=[];break;case"K":val=record[rj].slice(1),val.charAt(0)==='"'?val=val.slice(1,val.length-1):val==="TRUE"?val=!0:val==="FALSE"?val=!1:isNaN(fuzzynum(val))?isNaN(fuzzydate(val).getDate())||(val=parseDate(val)):(val=fuzzynum(val),next_cell_format!==null&&fmt_is_date(next_cell_format)&&(val=numdate(val))),C_seen_K=!0;break;case"E":C_seen_E=!0;var formula=rc_to_a1(record[rj].slice(1),{r:R2,c:C2});arr[R2][C2]=[arr[R2][C2],formula];break;case"S":C_seen_S=!0,arr[R2][C2]=[arr[R2][C2],"S5S"];break;case"G":break;case"R":_R=parseInt(record[rj].slice(1))-1;break;case"C":_C=parseInt(record[rj].slice(1))-1;break;default:if(opts&&opts.WTF)throw new Error("SYLK bad record "+rstr)}if(C_seen_K&&(arr[R2][C2]&&arr[R2][C2].length==2?arr[R2][C2][0]=val:arr[R2][C2]=val,next_cell_format=null),C_seen_S){if(C_seen_E)throw new Error("SYLK shared formula cannot have own formula");var shrbase=_R>-1&&arr[_R][_C];if(!shrbase||!shrbase[1])throw new Error("SYLK shared formula cannot find base");arr[R2][C2][1]=shift_formula_str(shrbase[1],{r:R2-_R,c:C2-_C})}break;case"F":var F_seen=0;for(rj=1;rj<record.length;++rj)switch(record[rj].charAt(0)){case"X":C2=parseInt(record[rj].slice(1))-1,++F_seen;break;case"Y":for(R2=parseInt(record[rj].slice(1))-1,j2=arr.length;j2<=R2;++j2)arr[j2]=[];break;case"M":Mval=parseInt(record[rj].slice(1))/20;break;case"F":break;case"G":break;case"P":next_cell_format=formats[parseInt(record[rj].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(cw=record[rj].slice(1).split(" "),j2=parseInt(cw[0],10);j2<=parseInt(cw[1],10);++j2)Mval=parseInt(cw[2],10),colinfo[j2-1]=Mval===0?{hidden:!0}:{wch:Mval},process_col(colinfo[j2-1]);break;case"C":C2=parseInt(record[rj].slice(1))-1,colinfo[C2]||(colinfo[C2]={});break;case"R":R2=parseInt(record[rj].slice(1))-1,rowinfo[R2]||(rowinfo[R2]={}),Mval>0?(rowinfo[R2].hpt=Mval,rowinfo[R2].hpx=pt2px(Mval)):Mval===0&&(rowinfo[R2].hidden=!0);break;default:if(opts&&opts.WTF)throw new Error("SYLK bad record "+rstr)}F_seen<1&&(next_cell_format=null);break;default:if(opts&&opts.WTF)throw new Error("SYLK bad record "+rstr)}}return rowinfo.length>0&&(sht["!rows"]=rowinfo),colinfo.length>0&&(sht["!cols"]=colinfo),opts&&opts.sheetRows&&(arr=arr.slice(0,opts.sheetRows)),[arr,sht]}function sylk_to_sheet(d2,opts){var aoasht=sylk_to_aoa(d2,opts),aoa=aoasht[0],ws=aoasht[1],o2=aoa_to_sheet(aoa,opts);return keys(ws).forEach(function(k2){o2[k2]=ws[k2]}),o2}function sylk_to_workbook(d2,opts){return sheet_to_workbook(sylk_to_sheet(d2,opts),opts)}function write_ws_cell_sylk(cell,ws,R2,C2){var o2="C;Y"+(R2+1)+";X"+(C2+1)+";K";switch(cell.t){case"n":o2+=cell.v||0,cell.f&&!cell.F&&(o2+=";E"+a1_to_rc(cell.f,{r:R2,c:C2}));break;case"b":o2+=cell.v?"TRUE":"FALSE";break;case"e":o2+=cell.w||cell.v;break;case"d":o2+='"'+(cell.w||cell.v)+'"';break;case"s":o2+='"'+cell.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return o2}function write_ws_cols_sylk(out,cols){cols.forEach(function(col,i2){var rec="F;W"+(i2+1)+" "+(i2+1)+" ";col.hidden?rec+="0":(typeof col.width=="number"&&!col.wpx&&(col.wpx=width2px(col.width)),typeof col.wpx=="number"&&!col.wch&&(col.wch=px2char(col.wpx)),typeof col.wch=="number"&&(rec+=Math.round(col.wch))),rec.charAt(rec.length-1)!=" "&&out.push(rec)})}function write_ws_rows_sylk(out,rows){rows.forEach(function(row,i2){var rec="F;";row.hidden?rec+="M0;":row.hpt?rec+="M"+20*row.hpt+";":row.hpx&&(rec+="M"+20*px2pt(row.hpx)+";"),rec.length>2&&out.push(rec+"R"+(i2+1))})}function sheet_to_sylk(ws,opts){var preamble=["ID;PWXL;N;E"],o2=[],r=safe_decode_range(ws["!ref"]),cell,dense=Array.isArray(ws),RS=`\r
`;preamble.push("P;PGeneral"),preamble.push("F;P0;DG0G8;M255"),ws["!cols"]&&write_ws_cols_sylk(preamble,ws["!cols"]),ws["!rows"]&&write_ws_rows_sylk(preamble,ws["!rows"]),preamble.push("B;Y"+(r.e.r-r.s.r+1)+";X"+(r.e.c-r.s.c+1)+";D"+[r.s.c,r.s.r,r.e.c,r.e.r].join(" "));for(var R2=r.s.r;R2<=r.e.r;++R2)for(var C2=r.s.c;C2<=r.e.c;++C2){var coord=encode_cell({r:R2,c:C2});cell=dense?(ws[R2]||[])[C2]:ws[coord],!(!cell||cell.v==null&&(!cell.f||cell.F))&&o2.push(write_ws_cell_sylk(cell,ws,R2,C2))}return preamble.join(RS)+RS+o2.join(RS)+RS+"E"+RS}return{to_workbook:sylk_to_workbook,to_sheet:sylk_to_sheet,from_sheet:sheet_to_sylk}})(),DIF=(function(){function dif_to_aoa(d2,opts){switch(opts.type){case"base64":return dif_to_aoa_str(Base64_decode(d2),opts);case"binary":return dif_to_aoa_str(d2,opts);case"buffer":return dif_to_aoa_str(has_buf&&Buffer.isBuffer(d2)?d2.toString("binary"):a2s(d2),opts);case"array":return dif_to_aoa_str(cc2str(d2),opts)}throw new Error("Unrecognized type "+opts.type)}function dif_to_aoa_str(str,opts){for(var records=str.split(`
`),R2=-1,C2=-1,ri=0,arr=[];ri!==records.length;++ri){if(records[ri].trim()==="BOT"){arr[++R2]=[],C2=0;continue}if(!(R2<0)){var metadata=records[ri].trim().split(","),type=metadata[0],value=metadata[1];++ri;for(var data=records[ri]||"";(data.match(/["]/g)||[]).length&1&&ri<records.length-1;)data+=`
`+records[++ri];switch(data=data.trim(),+type){case-1:if(data==="BOT"){arr[++R2]=[],C2=0;continue}else if(data!=="EOD")throw new Error("Unrecognized DIF special command "+data);break;case 0:data==="TRUE"?arr[R2][C2]=!0:data==="FALSE"?arr[R2][C2]=!1:isNaN(fuzzynum(value))?isNaN(fuzzydate(value).getDate())?arr[R2][C2]=value:arr[R2][C2]=parseDate(value):arr[R2][C2]=fuzzynum(value),++C2;break;case 1:data=data.slice(1,data.length-1),data=data.replace(/""/g,'"'),data&&data.match(/^=".*"$/)&&(data=data.slice(2,-1)),arr[R2][C2++]=data!==""?data:null;break}if(data==="EOD")break}}return opts&&opts.sheetRows&&(arr=arr.slice(0,opts.sheetRows)),arr}function dif_to_sheet(str,opts){return aoa_to_sheet(dif_to_aoa(str,opts),opts)}function dif_to_workbook(str,opts){return sheet_to_workbook(dif_to_sheet(str,opts),opts)}var sheet_to_dif=(function(){var push_field=function(o2,topic,v2,n,s2){o2.push(topic),o2.push(v2+","+n),o2.push('"'+s2.replace(/"/g,'""')+'"')},push_value=function(o2,type,v2,s2){o2.push(type+","+v2),o2.push(type==1?'"'+s2.replace(/"/g,'""')+'"':s2)};return function(ws){var o2=[],r=safe_decode_range(ws["!ref"]),cell,dense=Array.isArray(ws);push_field(o2,"TABLE",0,1,"sheetjs"),push_field(o2,"VECTORS",0,r.e.r-r.s.r+1,""),push_field(o2,"TUPLES",0,r.e.c-r.s.c+1,""),push_field(o2,"DATA",0,0,"");for(var R2=r.s.r;R2<=r.e.r;++R2){push_value(o2,-1,0,"BOT");for(var C2=r.s.c;C2<=r.e.c;++C2){var coord=encode_cell({r:R2,c:C2});if(cell=dense?(ws[R2]||[])[C2]:ws[coord],!cell){push_value(o2,1,0,"");continue}switch(cell.t){case"n":var val=cell.w;!val&&cell.v!=null&&(val=cell.v),val==null?cell.f&&!cell.F?push_value(o2,1,0,"="+cell.f):push_value(o2,1,0,""):push_value(o2,0,val,"V");break;case"b":push_value(o2,0,cell.v?1:0,cell.v?"TRUE":"FALSE");break;case"s":push_value(o2,1,0,isNaN(cell.v)?cell.v:'="'+cell.v+'"');break;case"d":cell.w||(cell.w=SSF_format(cell.z||table_fmt[14],datenum(parseDate(cell.v)))),push_value(o2,0,cell.w,"V");break;default:push_value(o2,1,0,"")}}}push_value(o2,-1,0,"EOD");var RS=`\r
`,oo=o2.join(RS);return oo}})();return{to_workbook:dif_to_workbook,to_sheet:dif_to_sheet,from_sheet:sheet_to_dif}})(),ETH=(function(){function decode2(s2){return s2.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function encode2(s2){return s2.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function eth_to_aoa(str,opts){for(var records=str.split(`
`),R2=-1,C2=-1,ri=0,arr=[];ri!==records.length;++ri){var record=records[ri].trim().split(":");if(record[0]==="cell"){var addr=decode_cell(record[1]);if(arr.length<=addr.r)for(R2=arr.length;R2<=addr.r;++R2)arr[R2]||(arr[R2]=[]);switch(R2=addr.r,C2=addr.c,record[2]){case"t":arr[R2][C2]=decode2(record[3]);break;case"v":arr[R2][C2]=+record[3];break;case"vtf":var _f=record[record.length-1];case"vtc":switch(record[3]){case"nl":arr[R2][C2]=!!+record[4];break;default:arr[R2][C2]=+record[4];break}record[2]=="vtf"&&(arr[R2][C2]=[arr[R2][C2],_f])}}}return opts&&opts.sheetRows&&(arr=arr.slice(0,opts.sheetRows)),arr}function eth_to_sheet(d2,opts){return aoa_to_sheet(eth_to_aoa(d2,opts),opts)}function eth_to_workbook(d2,opts){return sheet_to_workbook(eth_to_sheet(d2,opts),opts)}var header=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),sep=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,meta=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),end="--SocialCalcSpreadsheetControlSave--";function sheet_to_eth_data(ws){if(!ws||!ws["!ref"])return"";for(var o2=[],oo=[],cell,coord="",r=decode_range(ws["!ref"]),dense=Array.isArray(ws),R2=r.s.r;R2<=r.e.r;++R2)for(var C2=r.s.c;C2<=r.e.c;++C2)if(coord=encode_cell({r:R2,c:C2}),cell=dense?(ws[R2]||[])[C2]:ws[coord],!(!cell||cell.v==null||cell.t==="z")){switch(oo=["cell",coord,"t"],cell.t){case"s":case"str":oo.push(encode2(cell.v));break;case"n":cell.f?(oo[2]="vtf",oo[3]="n",oo[4]=cell.v,oo[5]=encode2(cell.f)):(oo[2]="v",oo[3]=cell.v);break;case"b":oo[2]="vt"+(cell.f?"f":"c"),oo[3]="nl",oo[4]=cell.v?"1":"0",oo[5]=encode2(cell.f||(cell.v?"TRUE":"FALSE"));break;case"d":var t2=datenum(parseDate(cell.v));oo[2]="vtc",oo[3]="nd",oo[4]=""+t2,oo[5]=cell.w||SSF_format(cell.z||table_fmt[14],t2);break;case"e":continue}o2.push(oo.join(":"))}return o2.push("sheet:c:"+(r.e.c-r.s.c+1)+":r:"+(r.e.r-r.s.r+1)+":tvf:1"),o2.push("valueformat:1:text-wiki"),o2.join(`
`)}function sheet_to_eth(ws){return[header,sep,meta,sep,sheet_to_eth_data(ws),end].join(`
`)}return{to_workbook:eth_to_workbook,to_sheet:eth_to_sheet,from_sheet:sheet_to_eth}})(),PRN=(function(){function set_text_arr(data,arr,R2,C2,o2){o2.raw?arr[R2][C2]=data:data===""||(data==="TRUE"?arr[R2][C2]=!0:data==="FALSE"?arr[R2][C2]=!1:isNaN(fuzzynum(data))?isNaN(fuzzydate(data).getDate())?arr[R2][C2]=data:arr[R2][C2]=parseDate(data):arr[R2][C2]=fuzzynum(data))}function prn_to_aoa_str(f2,opts){var o2=opts||{},arr=[];if(!f2||f2.length===0)return arr;for(var lines=f2.split(/[\r\n]/),L2=lines.length-1;L2>=0&&lines[L2].length===0;)--L2;for(var start=10,idx=0,R2=0;R2<=L2;++R2)idx=lines[R2].indexOf(" "),idx==-1?idx=lines[R2].length:idx++,start=Math.max(start,idx);for(R2=0;R2<=L2;++R2){arr[R2]=[];var C2=0;for(set_text_arr(lines[R2].slice(0,start).trim(),arr,R2,C2,o2),C2=1;C2<=(lines[R2].length-start)/10+1;++C2)set_text_arr(lines[R2].slice(start+(C2-1)*10,start+C2*10).trim(),arr,R2,C2,o2)}return o2.sheetRows&&(arr=arr.slice(0,o2.sheetRows)),arr}var guess_seps={44:",",9:"	",59:";",124:"|"},guess_sep_weights={44:3,9:2,59:1,124:0};function guess_sep(str){for(var cnt={},instr=!1,end=0,cc=0;end<str.length;++end)(cc=str.charCodeAt(end))==34?instr=!instr:!instr&&cc in guess_seps&&(cnt[cc]=(cnt[cc]||0)+1);cc=[];for(end in cnt)Object.prototype.hasOwnProperty.call(cnt,end)&&cc.push([cnt[end],end]);if(!cc.length){cnt=guess_sep_weights;for(end in cnt)Object.prototype.hasOwnProperty.call(cnt,end)&&cc.push([cnt[end],end])}return cc.sort(function(a2,b2){return a2[0]-b2[0]||guess_sep_weights[a2[1]]-guess_sep_weights[b2[1]]}),guess_seps[cc.pop()[1]]||44}function dsv_to_sheet_str(str,opts){var o2=opts||{},sep="",ws=o2.dense?[]:{},range={s:{c:0,r:0},e:{c:0,r:0}};str.slice(0,4)=="sep="?str.charCodeAt(5)==13&&str.charCodeAt(6)==10?(sep=str.charAt(4),str=str.slice(7)):str.charCodeAt(5)==13||str.charCodeAt(5)==10?(sep=str.charAt(4),str=str.slice(6)):sep=guess_sep(str.slice(0,1024)):o2&&o2.FS?sep=o2.FS:sep=guess_sep(str.slice(0,1024));var R2=0,C2=0,v2=0,start=0,end=0,sepcc=sep.charCodeAt(0),instr=!1,cc=0,startcc=str.charCodeAt(0);str=str.replace(/\r\n/mg,`
`);var _re=o2.dateNF!=null?dateNF_regex(o2.dateNF):null;function finish_cell(){var s2=str.slice(start,end),cell={};if(s2.charAt(0)=='"'&&s2.charAt(s2.length-1)=='"'&&(s2=s2.slice(1,-1).replace(/""/g,'"')),s2.length===0)cell.t="z";else if(o2.raw)cell.t="s",cell.v=s2;else if(s2.trim().length===0)cell.t="s",cell.v=s2;else if(s2.charCodeAt(0)==61)s2.charCodeAt(1)==34&&s2.charCodeAt(s2.length-1)==34?(cell.t="s",cell.v=s2.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(s2)?(cell.t="n",cell.f=s2.slice(1)):(cell.t="s",cell.v=s2);else if(s2=="TRUE")cell.t="b",cell.v=!0;else if(s2=="FALSE")cell.t="b",cell.v=!1;else if(!isNaN(v2=fuzzynum(s2)))cell.t="n",o2.cellText!==!1&&(cell.w=s2),cell.v=v2;else if(!isNaN(fuzzydate(s2).getDate())||_re&&s2.match(_re)){cell.z=o2.dateNF||table_fmt[14];var k2=0;_re&&s2.match(_re)&&(s2=dateNF_fix(s2,o2.dateNF,s2.match(_re)||[]),k2=1),o2.cellDates?(cell.t="d",cell.v=parseDate(s2,k2)):(cell.t="n",cell.v=datenum(parseDate(s2,k2))),o2.cellText!==!1&&(cell.w=SSF_format(cell.z,cell.v instanceof Date?datenum(cell.v):cell.v)),o2.cellNF||delete cell.z}else cell.t="s",cell.v=s2;if(cell.t=="z"||(o2.dense?(ws[R2]||(ws[R2]=[]),ws[R2][C2]=cell):ws[encode_cell({c:C2,r:R2})]=cell),start=end+1,startcc=str.charCodeAt(start),range.e.c<C2&&(range.e.c=C2),range.e.r<R2&&(range.e.r=R2),cc==sepcc)++C2;else if(C2=0,++R2,o2.sheetRows&&o2.sheetRows<=R2)return!0}outer:for(;end<str.length;++end)switch(cc=str.charCodeAt(end)){case 34:startcc===34&&(instr=!instr);break;case sepcc:case 10:case 13:if(!instr&&finish_cell())break outer;break}return end-start>0&&finish_cell(),ws["!ref"]=encode_range(range),ws}function prn_to_sheet_str(str,opts){return!(opts&&opts.PRN)||opts.FS||str.slice(0,4)=="sep="||str.indexOf("	")>=0||str.indexOf(",")>=0||str.indexOf(";")>=0?dsv_to_sheet_str(str,opts):aoa_to_sheet(prn_to_aoa_str(str,opts),opts)}function prn_to_sheet(d2,opts){var str="",bytes=opts.type=="string"?[0,0,0,0]:firstbyte(d2,opts);switch(opts.type){case"base64":str=Base64_decode(d2);break;case"binary":str=d2;break;case"buffer":opts.codepage==65001?str=d2.toString("utf8"):opts.codepage&&typeof $cptable<"u"||(str=has_buf&&Buffer.isBuffer(d2)?d2.toString("binary"):a2s(d2));break;case"array":str=cc2str(d2);break;case"string":str=d2;break;default:throw new Error("Unrecognized type "+opts.type)}return bytes[0]==239&&bytes[1]==187&&bytes[2]==191?str=utf8read(str.slice(3)):opts.type!="string"&&opts.type!="buffer"&&opts.codepage==65001?str=utf8read(str):opts.type=="binary"&&typeof $cptable<"u",str.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(opts.type=="string"?str:utf8read(str),opts):prn_to_sheet_str(str,opts)}function prn_to_workbook(d2,opts){return sheet_to_workbook(prn_to_sheet(d2,opts),opts)}function sheet_to_prn(ws){for(var o2=[],r=safe_decode_range(ws["!ref"]),cell,dense=Array.isArray(ws),R2=r.s.r;R2<=r.e.r;++R2){for(var oo=[],C2=r.s.c;C2<=r.e.c;++C2){var coord=encode_cell({r:R2,c:C2});if(cell=dense?(ws[R2]||[])[C2]:ws[coord],!cell||cell.v==null){oo.push("          ");continue}for(var w2=(cell.w||(format_cell(cell),cell.w)||"").slice(0,10);w2.length<10;)w2+=" ";oo.push(w2+(C2===0?" ":""))}o2.push(oo.join(""))}return o2.join(`
`)}return{to_workbook:prn_to_workbook,to_sheet:prn_to_sheet,from_sheet:sheet_to_prn}})(),WK_=(function(){function lotushopper(data,cb,opts){if(data){prep_blob(data,data.l||0);for(var Enum=opts.Enum||WK1Enum;data.l<data.length;){var RT=data.read_shift(2),R2=Enum[RT]||Enum[65535],length=data.read_shift(2),tgt=data.l+length,d2=R2.f&&R2.f(data,length,opts);if(data.l=tgt,cb(d2,R2,RT))return}}}function lotus_to_workbook(d2,opts){switch(opts.type){case"base64":return lotus_to_workbook_buf(s2a(Base64_decode(d2)),opts);case"binary":return lotus_to_workbook_buf(s2a(d2),opts);case"buffer":case"array":return lotus_to_workbook_buf(d2,opts)}throw"Unsupported type "+opts.type}function lotus_to_workbook_buf(d2,opts){if(!d2)return d2;var o2=opts||{},s2=o2.dense?[]:{},n="Sheet1",next_n="",sidx=0,sheets={},snames=[],realnames=[],refguess={s:{r:0,c:0},e:{r:0,c:0}},sheetRows=o2.sheetRows||0;if(d2[2]==0&&(d2[3]==8||d2[3]==9)&&d2.length>=16&&d2[14]==5&&d2[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(d2[2]==2)o2.Enum=WK1Enum,lotushopper(d2,function(val,R2,RT){switch(RT){case 0:o2.vers=val,val>=4096&&(o2.qpro=!0);break;case 6:refguess=val;break;case 204:val&&(next_n=val);break;case 222:next_n=val;break;case 15:case 51:o2.qpro||(val[1].v=val[1].v.slice(1));case 13:case 14:case 16:RT==14&&(val[2]&112)==112&&(val[2]&15)>1&&(val[2]&15)<15&&(val[1].z=o2.dateNF||table_fmt[14],o2.cellDates&&(val[1].t="d",val[1].v=numdate(val[1].v))),o2.qpro&&val[3]>sidx&&(s2["!ref"]=encode_range(refguess),sheets[n]=s2,snames.push(n),s2=o2.dense?[]:{},refguess={s:{r:0,c:0},e:{r:0,c:0}},sidx=val[3],n=next_n||"Sheet"+(sidx+1),next_n="");var tmpcell=o2.dense?(s2[val[0].r]||[])[val[0].c]:s2[encode_cell(val[0])];if(tmpcell){tmpcell.t=val[1].t,tmpcell.v=val[1].v,val[1].z!=null&&(tmpcell.z=val[1].z),val[1].f!=null&&(tmpcell.f=val[1].f);break}o2.dense?(s2[val[0].r]||(s2[val[0].r]=[]),s2[val[0].r][val[0].c]=val[1]):s2[encode_cell(val[0])]=val[1];break}},o2);else if(d2[2]==26||d2[2]==14)o2.Enum=WK3Enum,d2[2]==14&&(o2.qpro=!0,d2.l=0),lotushopper(d2,function(val,R2,RT){switch(RT){case 204:n=val;break;case 22:val[1].v=val[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(val[3]>sidx&&(s2["!ref"]=encode_range(refguess),sheets[n]=s2,snames.push(n),s2=o2.dense?[]:{},refguess={s:{r:0,c:0},e:{r:0,c:0}},sidx=val[3],n="Sheet"+(sidx+1)),sheetRows>0&&val[0].r>=sheetRows)break;o2.dense?(s2[val[0].r]||(s2[val[0].r]=[]),s2[val[0].r][val[0].c]=val[1]):s2[encode_cell(val[0])]=val[1],refguess.e.c<val[0].c&&(refguess.e.c=val[0].c),refguess.e.r<val[0].r&&(refguess.e.r=val[0].r);break;case 27:val[14e3]&&(realnames[val[14e3][0]]=val[14e3][1]);break;case 1537:realnames[val[0]]=val[1],val[0]==sidx&&(n=val[1]);break}},o2);else throw new Error("Unrecognized LOTUS BOF "+d2[2]);if(s2["!ref"]=encode_range(refguess),sheets[next_n||n]=s2,snames.push(next_n||n),!realnames.length)return{SheetNames:snames,Sheets:sheets};for(var osheets={},rnames=[],i2=0;i2<realnames.length;++i2)sheets[snames[i2]]?(rnames.push(realnames[i2]||snames[i2]),osheets[realnames[i2]]=sheets[realnames[i2]]||sheets[snames[i2]]):(rnames.push(realnames[i2]),osheets[realnames[i2]]={"!ref":"A1"});return{SheetNames:rnames,Sheets:osheets}}function sheet_to_wk1(ws,opts){var o2=opts||{};if(+o2.codepage>=0&&set_cp(+o2.codepage),o2.type=="string")throw new Error("Cannot write WK1 to JS string");var ba=buf_array(),range=safe_decode_range(ws["!ref"]),dense=Array.isArray(ws),cols=[];write_biff_rec(ba,0,write_BOF_WK1(1030)),write_biff_rec(ba,6,write_RANGE(range));for(var max_R=Math.min(range.e.r,8191),R2=range.s.r;R2<=max_R;++R2)for(var rr=encode_row(R2),C2=range.s.c;C2<=range.e.c;++C2){R2===range.s.r&&(cols[C2]=encode_col(C2));var ref=cols[C2]+rr,cell=dense?(ws[R2]||[])[C2]:ws[ref];if(!(!cell||cell.t=="z"))if(cell.t=="n")(cell.v|0)==cell.v&&cell.v>=-32768&&cell.v<=32767?write_biff_rec(ba,13,write_INTEGER(R2,C2,cell.v)):write_biff_rec(ba,14,write_NUMBER(R2,C2,cell.v));else{var str=format_cell(cell);write_biff_rec(ba,15,write_LABEL(R2,C2,str.slice(0,239)))}}return write_biff_rec(ba,1),ba.end()}function book_to_wk3(wb,opts){var o2=opts||{};if(+o2.codepage>=0&&set_cp(+o2.codepage),o2.type=="string")throw new Error("Cannot write WK3 to JS string");var ba=buf_array();write_biff_rec(ba,0,write_BOF_WK3(wb));for(var i2=0,cnt=0;i2<wb.SheetNames.length;++i2)(wb.Sheets[wb.SheetNames[i2]]||{})["!ref"]&&write_biff_rec(ba,27,write_XFORMAT_SHEETNAME(wb.SheetNames[i2],cnt++));var wsidx=0;for(i2=0;i2<wb.SheetNames.length;++i2){var ws=wb.Sheets[wb.SheetNames[i2]];if(!(!ws||!ws["!ref"])){for(var range=safe_decode_range(ws["!ref"]),dense=Array.isArray(ws),cols=[],max_R=Math.min(range.e.r,8191),R2=range.s.r;R2<=max_R;++R2)for(var rr=encode_row(R2),C2=range.s.c;C2<=range.e.c;++C2){R2===range.s.r&&(cols[C2]=encode_col(C2));var ref=cols[C2]+rr,cell=dense?(ws[R2]||[])[C2]:ws[ref];if(!(!cell||cell.t=="z"))if(cell.t=="n")write_biff_rec(ba,23,write_NUMBER_17(R2,C2,wsidx,cell.v));else{var str=format_cell(cell);write_biff_rec(ba,22,write_LABEL_16(R2,C2,wsidx,str.slice(0,239)))}}++wsidx}}return write_biff_rec(ba,1),ba.end()}function write_BOF_WK1(v2){var out=new_buf(2);return out.write_shift(2,v2),out}function write_BOF_WK3(wb){var out=new_buf(26);out.write_shift(2,4096),out.write_shift(2,4),out.write_shift(4,0);for(var rows=0,cols=0,wscnt=0,i2=0;i2<wb.SheetNames.length;++i2){var name=wb.SheetNames[i2],ws=wb.Sheets[name];if(!(!ws||!ws["!ref"])){++wscnt;var range=decode_range(ws["!ref"]);rows<range.e.r&&(rows=range.e.r),cols<range.e.c&&(cols=range.e.c)}}return rows>8191&&(rows=8191),out.write_shift(2,rows),out.write_shift(1,wscnt),out.write_shift(1,cols),out.write_shift(2,0),out.write_shift(2,0),out.write_shift(1,1),out.write_shift(1,2),out.write_shift(4,0),out.write_shift(4,0),out}function parse_RANGE(blob,length,opts){var o2={s:{c:0,r:0},e:{c:0,r:0}};return length==8&&opts.qpro?(o2.s.c=blob.read_shift(1),blob.l++,o2.s.r=blob.read_shift(2),o2.e.c=blob.read_shift(1),blob.l++,o2.e.r=blob.read_shift(2),o2):(o2.s.c=blob.read_shift(2),o2.s.r=blob.read_shift(2),length==12&&opts.qpro&&(blob.l+=2),o2.e.c=blob.read_shift(2),o2.e.r=blob.read_shift(2),length==12&&opts.qpro&&(blob.l+=2),o2.s.c==65535&&(o2.s.c=o2.e.c=o2.s.r=o2.e.r=0),o2)}function write_RANGE(range){var out=new_buf(8);return out.write_shift(2,range.s.c),out.write_shift(2,range.s.r),out.write_shift(2,range.e.c),out.write_shift(2,range.e.r),out}function parse_cell(blob,length,opts){var o2=[{c:0,r:0},{t:"n",v:0},0,0];return opts.qpro&&opts.vers!=20768?(o2[0].c=blob.read_shift(1),o2[3]=blob.read_shift(1),o2[0].r=blob.read_shift(2),blob.l+=2):(o2[2]=blob.read_shift(1),o2[0].c=blob.read_shift(2),o2[0].r=blob.read_shift(2)),o2}function parse_LABEL(blob,length,opts){var tgt=blob.l+length,o2=parse_cell(blob,length,opts);if(o2[1].t="s",opts.vers==20768){blob.l++;var len=blob.read_shift(1);return o2[1].v=blob.read_shift(len,"utf8"),o2}return opts.qpro&&blob.l++,o2[1].v=blob.read_shift(tgt-blob.l,"cstr"),o2}function write_LABEL(R2,C2,s2){var o2=new_buf(7+s2.length);o2.write_shift(1,255),o2.write_shift(2,C2),o2.write_shift(2,R2),o2.write_shift(1,39);for(var i2=0;i2<o2.length;++i2){var cc=s2.charCodeAt(i2);o2.write_shift(1,cc>=128?95:cc)}return o2.write_shift(1,0),o2}function parse_INTEGER(blob,length,opts){var o2=parse_cell(blob,length,opts);return o2[1].v=blob.read_shift(2,"i"),o2}function write_INTEGER(R2,C2,v2){var o2=new_buf(7);return o2.write_shift(1,255),o2.write_shift(2,C2),o2.write_shift(2,R2),o2.write_shift(2,v2,"i"),o2}function parse_NUMBER(blob,length,opts){var o2=parse_cell(blob,length,opts);return o2[1].v=blob.read_shift(8,"f"),o2}function write_NUMBER(R2,C2,v2){var o2=new_buf(13);return o2.write_shift(1,255),o2.write_shift(2,C2),o2.write_shift(2,R2),o2.write_shift(8,v2,"f"),o2}function parse_FORMULA(blob,length,opts){var tgt=blob.l+length,o2=parse_cell(blob,length,opts);if(o2[1].v=blob.read_shift(8,"f"),opts.qpro)blob.l=tgt;else{var flen=blob.read_shift(2);wk1_fmla_to_csf(blob.slice(blob.l,blob.l+flen),o2),blob.l+=flen}return o2}function wk1_parse_rc(B2,V2,col){var rel=V2&32768;return V2&=-32769,V2=(rel?B2:0)+(V2>=8192?V2-16384:V2),(rel?"":"$")+(col?encode_col(V2):encode_row(V2))}var FuncTab={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},BinOpTab=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function wk1_fmla_to_csf(blob,o2){prep_blob(blob,0);for(var out=[],argc=0,R2="",C2="",argL="",argR="";blob.l<blob.length;){var cc=blob[blob.l++];switch(cc){case 0:out.push(blob.read_shift(8,"f"));break;case 1:C2=wk1_parse_rc(o2[0].c,blob.read_shift(2),!0),R2=wk1_parse_rc(o2[0].r,blob.read_shift(2),!1),out.push(C2+R2);break;case 2:{var c2=wk1_parse_rc(o2[0].c,blob.read_shift(2),!0),r=wk1_parse_rc(o2[0].r,blob.read_shift(2),!1);C2=wk1_parse_rc(o2[0].c,blob.read_shift(2),!0),R2=wk1_parse_rc(o2[0].r,blob.read_shift(2),!1),out.push(c2+r+":"+C2+R2)}break;case 3:if(blob.l<blob.length){console.error("WK1 premature formula end");return}break;case 4:out.push("("+out.pop()+")");break;case 5:out.push(blob.read_shift(2));break;case 6:{for(var Z2="";cc=blob[blob.l++];)Z2+=String.fromCharCode(cc);out.push('"'+Z2.replace(/"/g,'""')+'"')}break;case 8:out.push("-"+out.pop());break;case 23:out.push("+"+out.pop());break;case 22:out.push("NOT("+out.pop()+")");break;case 20:case 21:argR=out.pop(),argL=out.pop(),out.push(["AND","OR"][cc-20]+"("+argL+","+argR+")");break;default:if(cc<32&&BinOpTab[cc])argR=out.pop(),argL=out.pop(),out.push(argL+BinOpTab[cc]+argR);else if(FuncTab[cc]){if(argc=FuncTab[cc][1],argc==69&&(argc=blob[blob.l++]),argc>out.length){console.error("WK1 bad formula parse 0x"+cc.toString(16)+":|"+out.join("|")+"|");return}var args=out.slice(-argc);out.length-=argc,out.push(FuncTab[cc][0]+"("+args.join(",")+")")}else return cc<=7?console.error("WK1 invalid opcode "+cc.toString(16)):cc<=24?console.error("WK1 unsupported op "+cc.toString(16)):cc<=30?console.error("WK1 invalid opcode "+cc.toString(16)):cc<=115?console.error("WK1 unsupported function opcode "+cc.toString(16)):console.error("WK1 unrecognized opcode "+cc.toString(16))}}out.length==1?o2[1].f=""+out[0]:console.error("WK1 bad formula parse |"+out.join("|")+"|")}function parse_cell_3(blob){var o2=[{c:0,r:0},{t:"n",v:0},0];return o2[0].r=blob.read_shift(2),o2[3]=blob[blob.l++],o2[0].c=blob[blob.l++],o2}function parse_LABEL_16(blob,length){var o2=parse_cell_3(blob);return o2[1].t="s",o2[1].v=blob.read_shift(length-4,"cstr"),o2}function write_LABEL_16(R2,C2,wsidx,s2){var o2=new_buf(6+s2.length);o2.write_shift(2,R2),o2.write_shift(1,wsidx),o2.write_shift(1,C2),o2.write_shift(1,39);for(var i2=0;i2<s2.length;++i2){var cc=s2.charCodeAt(i2);o2.write_shift(1,cc>=128?95:cc)}return o2.write_shift(1,0),o2}function parse_NUMBER_18(blob,length){var o2=parse_cell_3(blob);o2[1].v=blob.read_shift(2);var v2=o2[1].v>>1;if(o2[1].v&1)switch(v2&7){case 0:v2=(v2>>3)*5e3;break;case 1:v2=(v2>>3)*500;break;case 2:v2=(v2>>3)/20;break;case 3:v2=(v2>>3)/200;break;case 4:v2=(v2>>3)/2e3;break;case 5:v2=(v2>>3)/2e4;break;case 6:v2=(v2>>3)/16;break;case 7:v2=(v2>>3)/64;break}return o2[1].v=v2,o2}function parse_NUMBER_17(blob,length){var o2=parse_cell_3(blob),v1=blob.read_shift(4),v2=blob.read_shift(4),e=blob.read_shift(2);if(e==65535)return v1===0&&v2===3221225472?(o2[1].t="e",o2[1].v=15):v1===0&&v2===3489660928?(o2[1].t="e",o2[1].v=42):o2[1].v=0,o2;var s2=e&32768;return e=(e&32767)-16446,o2[1].v=(1-s2*2)*(v2*Math.pow(2,e+32)+v1*Math.pow(2,e)),o2}function write_NUMBER_17(R2,C2,wsidx,v2){var o2=new_buf(14);if(o2.write_shift(2,R2),o2.write_shift(1,wsidx),o2.write_shift(1,C2),v2==0)return o2.write_shift(4,0),o2.write_shift(4,0),o2.write_shift(2,65535),o2;var s2=0,e=0,v1=0,v22=0;return v2<0&&(s2=1,v2=-v2),e=Math.log2(v2)|0,v2/=Math.pow(2,e-31),v22=v2>>>0,(v22&2147483648)==0&&(v2/=2,++e,v22=v2>>>0),v2-=v22,v22|=2147483648,v22>>>=0,v2*=Math.pow(2,32),v1=v2>>>0,o2.write_shift(4,v1),o2.write_shift(4,v22),e+=16383+(s2?32768:0),o2.write_shift(2,e),o2}function parse_FORMULA_19(blob,length){var o2=parse_NUMBER_17(blob);return blob.l+=length-14,o2}function parse_NUMBER_25(blob,length){var o2=parse_cell_3(blob),v1=blob.read_shift(4);return o2[1].v=v1>>6,o2}function parse_NUMBER_27(blob,length){var o2=parse_cell_3(blob),v1=blob.read_shift(8,"f");return o2[1].v=v1,o2}function parse_FORMULA_28(blob,length){var o2=parse_NUMBER_27(blob);return blob.l+=length-10,o2}function parse_SHEETNAMECS(blob,length){return blob[blob.l+length-1]==0?blob.read_shift(length,"cstr"):""}function parse_SHEETNAMELP(blob,length){var len=blob[blob.l++];len>length-1&&(len=length-1);for(var o2="";o2.length<len;)o2+=String.fromCharCode(blob[blob.l++]);return o2}function parse_SHEETINFOQP(blob,length,opts){if(!(!opts.qpro||length<21)){var id=blob.read_shift(1);blob.l+=17,blob.l+=1,blob.l+=2;var nm=blob.read_shift(length-21,"cstr");return[id,nm]}}function parse_XFORMAT(blob,length){for(var o2={},tgt=blob.l+length;blob.l<tgt;){var dt2=blob.read_shift(2);if(dt2==14e3){for(o2[dt2]=[0,""],o2[dt2][0]=blob.read_shift(2);blob[blob.l];)o2[dt2][1]+=String.fromCharCode(blob[blob.l]),blob.l++;blob.l++}}return o2}function write_XFORMAT_SHEETNAME(name,wsidx){var out=new_buf(5+name.length);out.write_shift(2,14e3),out.write_shift(2,wsidx);for(var i2=0;i2<name.length;++i2){var cc=name.charCodeAt(i2);out[out.l++]=cc>127?95:cc}return out[out.l++]=0,out}var WK1Enum={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:parse_RANGE},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:parse_INTEGER},14:{n:"NUMBER",f:parse_NUMBER},15:{n:"LABEL",f:parse_LABEL},16:{n:"FORMULA",f:parse_FORMULA},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:parse_LABEL},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:parse_SHEETNAMECS},222:{n:"SHEETNAMELP",f:parse_SHEETNAMELP},65535:{n:""}},WK3Enum={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:parse_LABEL_16},23:{n:"NUMBER17",f:parse_NUMBER_17},24:{n:"NUMBER18",f:parse_NUMBER_18},25:{n:"FORMULA19",f:parse_FORMULA_19},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:parse_XFORMAT},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:parse_NUMBER_25},38:{n:"??"},39:{n:"NUMBER27",f:parse_NUMBER_27},40:{n:"FORMULA28",f:parse_FORMULA_28},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:parse_SHEETNAMECS},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:parse_SHEETINFOQP},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1,book_to_wk3,to_workbook:lotus_to_workbook}})(),straywsregex=/^\s|\s$|[\t\n\r]/;function write_sst_xml(sst,opts){if(!opts.bookSST)return"";var o2=[XML_HEADER];o2[o2.length]=writextag("sst",null,{xmlns:XMLNS_main[0],count:sst.Count,uniqueCount:sst.Unique});for(var i2=0;i2!=sst.length;++i2)if(sst[i2]!=null){var s2=sst[i2],sitag="<si>";s2.r?sitag+=s2.r:(sitag+="<t",s2.t||(s2.t=""),s2.t.match(straywsregex)&&(sitag+=' xml:space="preserve"'),sitag+=">"+escapexml(s2.t)+"</t>"),sitag+="</si>",o2[o2.length]=sitag}return o2.length>2&&(o2[o2.length]="</sst>",o2[1]=o2[1].replace("/>",">")),o2.join("")}function parse_BrtBeginSst(data){return[data.read_shift(4),data.read_shift(4)]}function write_BrtBeginSst(sst,o2){return o2||(o2=new_buf(8)),o2.write_shift(4,sst.Count),o2.write_shift(4,sst.Unique),o2}var write_BrtSSTItem=write_RichStr;function write_sst_bin(sst){var ba=buf_array();write_record(ba,159,write_BrtBeginSst(sst));for(var i2=0;i2<sst.length;++i2)write_record(ba,19,write_BrtSSTItem(sst[i2]));return write_record(ba,160),ba.end()}function _JS2ANSI(str){for(var o2=[],oo=str.split(""),i2=0;i2<oo.length;++i2)o2[i2]=oo[i2].charCodeAt(0);return o2}function crypto_CreatePasswordVerifier_Method1(Password){var Verifier=0,PasswordArray,PasswordDecoded=_JS2ANSI(Password),len=PasswordDecoded.length+1,i2,PasswordByte,Intermediate1,Intermediate2,Intermediate3;for(PasswordArray=new_raw_buf(len),PasswordArray[0]=PasswordDecoded.length,i2=1;i2!=len;++i2)PasswordArray[i2]=PasswordDecoded[i2-1];for(i2=len-1;i2>=0;--i2)PasswordByte=PasswordArray[i2],Intermediate1=(Verifier&16384)===0?0:1,Intermediate2=Verifier<<1&32767,Intermediate3=Intermediate1|Intermediate2,Verifier=Intermediate3^PasswordByte;return Verifier^52811}var RTF=(function(){function rtf_to_sheet(d2,opts){switch(opts.type){case"base64":return rtf_to_sheet_str(Base64_decode(d2),opts);case"binary":return rtf_to_sheet_str(d2,opts);case"buffer":return rtf_to_sheet_str(has_buf&&Buffer.isBuffer(d2)?d2.toString("binary"):a2s(d2),opts);case"array":return rtf_to_sheet_str(cc2str(d2),opts)}throw new Error("Unrecognized type "+opts.type)}function rtf_to_sheet_str(str,opts){var o2=opts||{},ws=o2.dense?[]:{},rows=str.match(/\\trowd.*?\\row\b/g);if(!rows.length)throw new Error("RTF missing table");var range={s:{c:0,r:0},e:{c:0,r:rows.length-1}};return rows.forEach(function(rowtf,R2){Array.isArray(ws)&&(ws[R2]=[]);for(var rtfre=/\\\w+\b/g,last_index=0,res,C2=-1;res=rtfre.exec(rowtf);){switch(res[0]){case"\\cell":var data=rowtf.slice(last_index,rtfre.lastIndex-res[0].length);if(data[0]==" "&&(data=data.slice(1)),++C2,data.length){var cell={v:data,t:"s"};Array.isArray(ws)?ws[R2][C2]=cell:ws[encode_cell({r:R2,c:C2})]=cell}break}last_index=rtfre.lastIndex}C2>range.e.c&&(range.e.c=C2)}),ws["!ref"]=encode_range(range),ws}function rtf_to_workbook(d2,opts){return sheet_to_workbook(rtf_to_sheet(d2,opts),opts)}function sheet_to_rtf(ws){for(var o2=["{\\rtf1\\ansi"],r=safe_decode_range(ws["!ref"]),cell,dense=Array.isArray(ws),R2=r.s.r;R2<=r.e.r;++R2){o2.push("\\trowd\\trautofit1");for(var C2=r.s.c;C2<=r.e.c;++C2)o2.push("\\cellx"+(C2+1));for(o2.push("\\pard\\intbl"),C2=r.s.c;C2<=r.e.c;++C2){var coord=encode_cell({r:R2,c:C2});cell=dense?(ws[R2]||[])[C2]:ws[coord],!(!cell||cell.v==null&&(!cell.f||cell.F))&&(o2.push(" "+(cell.w||(format_cell(cell),cell.w))),o2.push("\\cell"))}o2.push("\\pard\\intbl\\row")}return o2.join("")+"}"}return{to_workbook:rtf_to_workbook,to_sheet:rtf_to_sheet,from_sheet:sheet_to_rtf}})();function rgb2Hex(rgb){for(var i2=0,o2=1;i2!=3;++i2)o2=o2*256+(rgb[i2]>255?255:rgb[i2]<0?0:rgb[i2]);return o2.toString(16).toUpperCase().slice(1)}var DEF_MDW=6,MDW=DEF_MDW;function width2px(width){return Math.floor((width+Math.round(128/MDW)/256)*MDW)}function px2char(px){return Math.floor((px-5)/MDW*100+.5)/100}function char2width(chr){return Math.round((chr*MDW+5)/MDW*256)/256}function process_col(coll){coll.width?(coll.wpx=width2px(coll.width),coll.wch=px2char(coll.wpx),coll.MDW=MDW):coll.wpx?(coll.wch=px2char(coll.wpx),coll.width=char2width(coll.wch),coll.MDW=MDW):typeof coll.wch=="number"&&(coll.width=char2width(coll.wch),coll.wpx=width2px(coll.width),coll.MDW=MDW),coll.customWidth&&delete coll.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(px){return px*96/PPI}function pt2px(pt2){return pt2*PPI/96}function write_numFmts(NF){var o2=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i2=r[0];i2<=r[1];++i2)NF[i2]!=null&&(o2[o2.length]=writextag("numFmt",null,{numFmtId:i2,formatCode:escapexml(NF[i2])}))}),o2.length===1?"":(o2[o2.length]="</numFmts>",o2[0]=writextag("numFmts",null,{count:o2.length-2}).replace("/>",">"),o2.join(""))}function write_cellXfs(cellXfs){var o2=[];return o2[o2.length]=writextag("cellXfs",null),cellXfs.forEach(function(c2){o2[o2.length]=writextag("xf",null,c2)}),o2[o2.length]="</cellXfs>",o2.length===2?"":(o2[0]=writextag("cellXfs",null,{count:o2.length-2}).replace("/>",">"),o2.join(""))}function write_sty_xml(wb,opts){var o2=[XML_HEADER,writextag("styleSheet",null,{xmlns:XMLNS_main[0],"xmlns:vt":XMLNS.vt})],w2;return wb.SSF&&(w2=write_numFmts(wb.SSF))!=null&&(o2[o2.length]=w2),o2[o2.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',o2[o2.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',o2[o2.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',o2[o2.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(w2=write_cellXfs(opts.cellXfs))&&(o2[o2.length]=w2),o2[o2.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',o2[o2.length]='<dxfs count="0"/>',o2[o2.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',o2.length>2&&(o2[o2.length]="</styleSheet>",o2[1]=o2[1].replace("/>",">")),o2.join("")}function parse_BrtFmt(data,length){var numFmtId=data.read_shift(2),stFmtCode=parse_XLWideString(data);return[numFmtId,stFmtCode]}function write_BrtFmt(i2,f2,o2){o2||(o2=new_buf(6+4*f2.length)),o2.write_shift(2,i2),write_XLWideString(f2,o2);var out=o2.length>o2.l?o2.slice(0,o2.l):o2;return o2.l==null&&(o2.l=o2.length),out}function parse_BrtFont(data,length,opts){var out={};out.sz=data.read_shift(2)/20;var grbit=parse_FontFlags(data);grbit.fItalic&&(out.italic=1),grbit.fCondense&&(out.condense=1),grbit.fExtend&&(out.extend=1),grbit.fShadow&&(out.shadow=1),grbit.fOutline&&(out.outline=1),grbit.fStrikeout&&(out.strike=1);var bls=data.read_shift(2);switch(bls===700&&(out.bold=1),data.read_shift(2)){case 1:out.vertAlign="superscript";break;case 2:out.vertAlign="subscript";break}var underline=data.read_shift(1);underline!=0&&(out.underline=underline);var family=data.read_shift(1);family>0&&(out.family=family);var bCharSet=data.read_shift(1);switch(bCharSet>0&&(out.charset=bCharSet),data.l++,out.color=parse_BrtColor(data),data.read_shift(1)){case 1:out.scheme="major";break;case 2:out.scheme="minor";break}return out.name=parse_XLWideString(data),out}function write_BrtFont(font,o2){o2||(o2=new_buf(153)),o2.write_shift(2,font.sz*20),write_FontFlags(font,o2),o2.write_shift(2,font.bold?700:400);var sss=0;font.vertAlign=="superscript"?sss=1:font.vertAlign=="subscript"&&(sss=2),o2.write_shift(2,sss),o2.write_shift(1,font.underline||0),o2.write_shift(1,font.family||0),o2.write_shift(1,font.charset||0),o2.write_shift(1,0),write_BrtColor(font.color,o2);var scheme=0;return scheme=2,o2.write_shift(1,scheme),write_XLWideString(font.name,o2),o2.length>o2.l?o2.slice(0,o2.l):o2}var XLSBFillPTNames=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rev_XLSBFillPTNames,parse_BrtFill=parsenoop;function write_BrtFill(fill2,o2){o2||(o2=new_buf(84)),rev_XLSBFillPTNames||(rev_XLSBFillPTNames=evert(XLSBFillPTNames));var fls=rev_XLSBFillPTNames[fill2.patternType];fls==null&&(fls=40),o2.write_shift(4,fls);var j2=0;if(fls!=40)for(write_BrtColor({auto:1},o2),write_BrtColor({auto:1},o2);j2<12;++j2)o2.write_shift(4,0);else{for(;j2<4;++j2)o2.write_shift(4,0);for(;j2<12;++j2)o2.write_shift(4,0)}return o2.length>o2.l?o2.slice(0,o2.l):o2}function parse_BrtXF(data,length){var tgt=data.l+length,ixfeParent=data.read_shift(2),ifmt=data.read_shift(2);return data.l=tgt,{ixfe:ixfeParent,numFmtId:ifmt}}function write_BrtXF(data,ixfeP,o2){o2||(o2=new_buf(16)),o2.write_shift(2,ixfeP||0),o2.write_shift(2,data.numFmtId||0),o2.write_shift(2,0),o2.write_shift(2,0),o2.write_shift(2,0),o2.write_shift(1,0),o2.write_shift(1,0);var flow=0;return o2.write_shift(1,flow),o2.write_shift(1,0),o2.write_shift(1,0),o2.write_shift(1,0),o2}function write_Blxf(data,o2){return o2||(o2=new_buf(10)),o2.write_shift(1,0),o2.write_shift(1,0),o2.write_shift(4,0),o2.write_shift(4,0),o2}var parse_BrtBorder=parsenoop;function write_BrtBorder(border,o2){return o2||(o2=new_buf(51)),o2.write_shift(1,0),write_Blxf(null,o2),write_Blxf(null,o2),write_Blxf(null,o2),write_Blxf(null,o2),write_Blxf(null,o2),o2.length>o2.l?o2.slice(0,o2.l):o2}function write_BrtStyle(style,o2){return o2||(o2=new_buf(52)),o2.write_shift(4,style.xfId),o2.write_shift(2,1),o2.write_shift(1,0),o2.write_shift(1,0),write_XLNullableWideString(style.name||"",o2),o2.length>o2.l?o2.slice(0,o2.l):o2}function write_BrtBeginTableStyles(cnt,defTableStyle,defPivotStyle){var o2=new_buf(2052);return o2.write_shift(4,cnt),write_XLNullableWideString(defTableStyle,o2),write_XLNullableWideString(defPivotStyle,o2),o2.length>o2.l?o2.slice(0,o2.l):o2}function write_FMTS_bin(ba,NF){if(NF){var cnt=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i2=r[0];i2<=r[1];++i2)NF[i2]!=null&&++cnt}),cnt!=0&&(write_record(ba,615,write_UInt32LE(cnt)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i2=r[0];i2<=r[1];++i2)NF[i2]!=null&&write_record(ba,44,write_BrtFmt(i2,NF[i2]))}),write_record(ba,616))}}function write_FONTS_bin(ba){var cnt=1;write_record(ba,611,write_UInt32LE(cnt)),write_record(ba,43,write_BrtFont({sz:12,color:{theme:1},name:"Calibri",family:2})),write_record(ba,612)}function write_FILLS_bin(ba){var cnt=2;write_record(ba,603,write_UInt32LE(cnt)),write_record(ba,45,write_BrtFill({patternType:"none"})),write_record(ba,45,write_BrtFill({patternType:"gray125"})),write_record(ba,604)}function write_BORDERS_bin(ba){var cnt=1;write_record(ba,613,write_UInt32LE(cnt)),write_record(ba,46,write_BrtBorder()),write_record(ba,614)}function write_CELLSTYLEXFS_bin(ba){var cnt=1;write_record(ba,626,write_UInt32LE(cnt)),write_record(ba,47,write_BrtXF({numFmtId:0},65535)),write_record(ba,627)}function write_CELLXFS_bin(ba,data){write_record(ba,617,write_UInt32LE(data.length)),data.forEach(function(c2){write_record(ba,47,write_BrtXF(c2,0))}),write_record(ba,618)}function write_STYLES_bin(ba){var cnt=1;write_record(ba,619,write_UInt32LE(cnt)),write_record(ba,48,write_BrtStyle({xfId:0,name:"Normal"})),write_record(ba,620)}function write_DXFS_bin(ba){var cnt=0;write_record(ba,505,write_UInt32LE(cnt)),write_record(ba,506)}function write_TABLESTYLES_bin(ba){var cnt=0;write_record(ba,508,write_BrtBeginTableStyles(cnt,"TableStyleMedium9","PivotStyleMedium4")),write_record(ba,509)}function write_sty_bin(wb,opts){var ba=buf_array();return write_record(ba,278),write_FMTS_bin(ba,wb.SSF),write_FONTS_bin(ba),write_FILLS_bin(ba),write_BORDERS_bin(ba),write_CELLSTYLEXFS_bin(ba),write_CELLXFS_bin(ba,opts.cellXfs),write_STYLES_bin(ba),write_DXFS_bin(ba),write_TABLESTYLES_bin(ba),write_record(ba,279),ba.end()}function write_theme(Themes,opts){if(opts&&opts.themeXLSX)return opts.themeXLSX;if(Themes&&typeof Themes.raw=="string")return Themes.raw;var o2=[XML_HEADER];return o2[o2.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',o2[o2.length]="<a:themeElements>",o2[o2.length]='<a:clrScheme name="Office">',o2[o2.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',o2[o2.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',o2[o2.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',o2[o2.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',o2[o2.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',o2[o2.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',o2[o2.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',o2[o2.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',o2[o2.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',o2[o2.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',o2[o2.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',o2[o2.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',o2[o2.length]="</a:clrScheme>",o2[o2.length]='<a:fontScheme name="Office">',o2[o2.length]="<a:majorFont>",o2[o2.length]='<a:latin typeface="Cambria"/>',o2[o2.length]='<a:ea typeface=""/>',o2[o2.length]='<a:cs typeface=""/>',o2[o2.length]='<a:font script="Jpan" typeface=" "/>',o2[o2.length]='<a:font script="Hang" typeface=" "/>',o2[o2.length]='<a:font script="Hans" typeface=""/>',o2[o2.length]='<a:font script="Hant" typeface=""/>',o2[o2.length]='<a:font script="Arab" typeface="Times New Roman"/>',o2[o2.length]='<a:font script="Hebr" typeface="Times New Roman"/>',o2[o2.length]='<a:font script="Thai" typeface="Tahoma"/>',o2[o2.length]='<a:font script="Ethi" typeface="Nyala"/>',o2[o2.length]='<a:font script="Beng" typeface="Vrinda"/>',o2[o2.length]='<a:font script="Gujr" typeface="Shruti"/>',o2[o2.length]='<a:font script="Khmr" typeface="MoolBoran"/>',o2[o2.length]='<a:font script="Knda" typeface="Tunga"/>',o2[o2.length]='<a:font script="Guru" typeface="Raavi"/>',o2[o2.length]='<a:font script="Cans" typeface="Euphemia"/>',o2[o2.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',o2[o2.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',o2[o2.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',o2[o2.length]='<a:font script="Thaa" typeface="MV Boli"/>',o2[o2.length]='<a:font script="Deva" typeface="Mangal"/>',o2[o2.length]='<a:font script="Telu" typeface="Gautami"/>',o2[o2.length]='<a:font script="Taml" typeface="Latha"/>',o2[o2.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',o2[o2.length]='<a:font script="Orya" typeface="Kalinga"/>',o2[o2.length]='<a:font script="Mlym" typeface="Kartika"/>',o2[o2.length]='<a:font script="Laoo" typeface="DokChampa"/>',o2[o2.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',o2[o2.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',o2[o2.length]='<a:font script="Viet" typeface="Times New Roman"/>',o2[o2.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',o2[o2.length]='<a:font script="Geor" typeface="Sylfaen"/>',o2[o2.length]="</a:majorFont>",o2[o2.length]="<a:minorFont>",o2[o2.length]='<a:latin typeface="Calibri"/>',o2[o2.length]='<a:ea typeface=""/>',o2[o2.length]='<a:cs typeface=""/>',o2[o2.length]='<a:font script="Jpan" typeface=" "/>',o2[o2.length]='<a:font script="Hang" typeface=" "/>',o2[o2.length]='<a:font script="Hans" typeface=""/>',o2[o2.length]='<a:font script="Hant" typeface=""/>',o2[o2.length]='<a:font script="Arab" typeface="Arial"/>',o2[o2.length]='<a:font script="Hebr" typeface="Arial"/>',o2[o2.length]='<a:font script="Thai" typeface="Tahoma"/>',o2[o2.length]='<a:font script="Ethi" typeface="Nyala"/>',o2[o2.length]='<a:font script="Beng" typeface="Vrinda"/>',o2[o2.length]='<a:font script="Gujr" typeface="Shruti"/>',o2[o2.length]='<a:font script="Khmr" typeface="DaunPenh"/>',o2[o2.length]='<a:font script="Knda" typeface="Tunga"/>',o2[o2.length]='<a:font script="Guru" typeface="Raavi"/>',o2[o2.length]='<a:font script="Cans" typeface="Euphemia"/>',o2[o2.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',o2[o2.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',o2[o2.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',o2[o2.length]='<a:font script="Thaa" typeface="MV Boli"/>',o2[o2.length]='<a:font script="Deva" typeface="Mangal"/>',o2[o2.length]='<a:font script="Telu" typeface="Gautami"/>',o2[o2.length]='<a:font script="Taml" typeface="Latha"/>',o2[o2.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',o2[o2.length]='<a:font script="Orya" typeface="Kalinga"/>',o2[o2.length]='<a:font script="Mlym" typeface="Kartika"/>',o2[o2.length]='<a:font script="Laoo" typeface="DokChampa"/>',o2[o2.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',o2[o2.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',o2[o2.length]='<a:font script="Viet" typeface="Arial"/>',o2[o2.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',o2[o2.length]='<a:font script="Geor" typeface="Sylfaen"/>',o2[o2.length]="</a:minorFont>",o2[o2.length]="</a:fontScheme>",o2[o2.length]='<a:fmtScheme name="Office">',o2[o2.length]="<a:fillStyleLst>",o2[o2.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',o2[o2.length]='<a:gradFill rotWithShape="1">',o2[o2.length]="<a:gsLst>",o2[o2.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',o2[o2.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',o2[o2.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o2[o2.length]="</a:gsLst>",o2[o2.length]='<a:lin ang="16200000" scaled="1"/>',o2[o2.length]="</a:gradFill>",o2[o2.length]='<a:gradFill rotWithShape="1">',o2[o2.length]="<a:gsLst>",o2[o2.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',o2[o2.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o2[o2.length]="</a:gsLst>",o2[o2.length]='<a:lin ang="16200000" scaled="0"/>',o2[o2.length]="</a:gradFill>",o2[o2.length]="</a:fillStyleLst>",o2[o2.length]="<a:lnStyleLst>",o2[o2.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',o2[o2.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',o2[o2.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',o2[o2.length]="</a:lnStyleLst>",o2[o2.length]="<a:effectStyleLst>",o2[o2.length]="<a:effectStyle>",o2[o2.length]="<a:effectLst>",o2[o2.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',o2[o2.length]="</a:effectLst>",o2[o2.length]="</a:effectStyle>",o2[o2.length]="<a:effectStyle>",o2[o2.length]="<a:effectLst>",o2[o2.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',o2[o2.length]="</a:effectLst>",o2[o2.length]="</a:effectStyle>",o2[o2.length]="<a:effectStyle>",o2[o2.length]="<a:effectLst>",o2[o2.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',o2[o2.length]="</a:effectLst>",o2[o2.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',o2[o2.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',o2[o2.length]="</a:effectStyle>",o2[o2.length]="</a:effectStyleLst>",o2[o2.length]="<a:bgFillStyleLst>",o2[o2.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',o2[o2.length]='<a:gradFill rotWithShape="1">',o2[o2.length]="<a:gsLst>",o2[o2.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o2[o2.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o2[o2.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',o2[o2.length]="</a:gsLst>",o2[o2.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',o2[o2.length]="</a:gradFill>",o2[o2.length]='<a:gradFill rotWithShape="1">',o2[o2.length]="<a:gsLst>",o2[o2.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',o2[o2.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',o2[o2.length]="</a:gsLst>",o2[o2.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',o2[o2.length]="</a:gradFill>",o2[o2.length]="</a:bgFillStyleLst>",o2[o2.length]="</a:fmtScheme>",o2[o2.length]="</a:themeElements>",o2[o2.length]="<a:objectDefaults>",o2[o2.length]="<a:spDef>",o2[o2.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',o2[o2.length]="</a:spDef>",o2[o2.length]="<a:lnDef>",o2[o2.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',o2[o2.length]="</a:lnDef>",o2[o2.length]="</a:objectDefaults>",o2[o2.length]="<a:extraClrSchemeLst/>",o2[o2.length]="</a:theme>",o2.join("")}function parse_BrtMdtinfo(data,length){return{flags:data.read_shift(4),version:data.read_shift(4),name:parse_XLWideString(data)}}function write_BrtMdtinfo(data){var o2=new_buf(12+2*data.name.length);return o2.write_shift(4,data.flags),o2.write_shift(4,data.version),write_XLWideString(data.name,o2),o2.slice(0,o2.l)}function parse_BrtMdb(data){for(var out=[],cnt=data.read_shift(4);cnt-- >0;)out.push([data.read_shift(4),data.read_shift(4)]);return out}function write_BrtMdb(mdb){var o2=new_buf(4+8*mdb.length);o2.write_shift(4,mdb.length);for(var i2=0;i2<mdb.length;++i2)o2.write_shift(4,mdb[i2][0]),o2.write_shift(4,mdb[i2][1]);return o2}function write_BrtBeginEsfmd(cnt,name){var o2=new_buf(8+2*name.length);return o2.write_shift(4,cnt),write_XLWideString(name,o2),o2.slice(0,o2.l)}function parse_BrtBeginEsmdb(data){return data.l+=4,data.read_shift(4)!=0}function write_BrtBeginEsmdb(cnt,cm){var o2=new_buf(8);return o2.write_shift(4,cnt),o2.write_shift(4,1),o2}function write_xlmeta_bin(){var ba=buf_array();return write_record(ba,332),write_record(ba,334,write_UInt32LE(1)),write_record(ba,335,write_BrtMdtinfo({name:"XLDAPR",version:12e4,flags:3496657072})),write_record(ba,336),write_record(ba,339,write_BrtBeginEsfmd(1,"XLDAPR")),write_record(ba,52),write_record(ba,35,write_UInt32LE(514)),write_record(ba,4096,write_UInt32LE(0)),write_record(ba,4097,writeuint16(1)),write_record(ba,36),write_record(ba,53),write_record(ba,340),write_record(ba,337,write_BrtBeginEsmdb(1)),write_record(ba,51,write_BrtMdb([[1,0]])),write_record(ba,338),write_record(ba,333),ba.end()}function write_xlmeta_xml(){var o2=[XML_HEADER];return o2.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),o2.join("")}function parse_BrtCalcChainItem$(data){var out={};out.i=data.read_shift(4);var cell={};cell.r=data.read_shift(4),cell.c=data.read_shift(4),out.r=encode_cell(cell);var flags=data.read_shift(1);return flags&2&&(out.l="1"),flags&8&&(out.a="1"),out}var _shapeid=1024;function write_comments_vml(rId,comments){for(var csize=[21600,21600],bbox=["m0,0l0",csize[1],csize[0],csize[1],csize[0],"0xe"].join(","),o2=[writextag("xml",null,{"xmlns:v":XLMLNS.v,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:mv":XLMLNS.mv}).replace(/\/>/,">"),writextag("o:shapelayout",writextag("o:idmap",null,{"v:ext":"edit",data:rId}),{"v:ext":"edit"}),writextag("v:shapetype",[writextag("v:stroke",null,{joinstyle:"miter"}),writextag("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:csize.join(","),path:bbox})];_shapeid<rId*1e3;)_shapeid+=1e3;return comments.forEach(function(x2){var c2=decode_cell(x2[0]),fillopts={color2:"#BEFF82",type:"gradient"};fillopts.type=="gradient"&&(fillopts.angle="-180");var fillparm=fillopts.type=="gradient"?writextag("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,fillxml=writextag("v:fill",fillparm,fillopts),shadata={on:"t",obscured:"t"};++_shapeid,o2=o2.concat(["<v:shape"+wxt_helper({id:"_x0000_s"+_shapeid,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(x2[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",fillxml,writextag("v:shadow",null,shadata),writextag("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",writetag("x:Anchor",[c2.c+1,0,c2.r+1,0,c2.c+3,20,c2.r+5,20].join(",")),writetag("x:AutoFill","False"),writetag("x:Row",String(c2.r)),writetag("x:Column",String(c2.c)),x2[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),o2.push("</xml>"),o2.join("")}function write_comments_xml(data){var o2=[XML_HEADER,writextag("comments",null,{xmlns:XMLNS_main[0]})],iauthor=[];return o2.push("<authors>"),data.forEach(function(x2){x2[1].forEach(function(w2){var a2=escapexml(w2.a);iauthor.indexOf(a2)==-1&&(iauthor.push(a2),o2.push("<author>"+a2+"</author>")),w2.T&&w2.ID&&iauthor.indexOf("tc="+w2.ID)==-1&&(iauthor.push("tc="+w2.ID),o2.push("<author>tc="+w2.ID+"</author>"))})}),iauthor.length==0&&(iauthor.push("SheetJ5"),o2.push("<author>SheetJ5</author>")),o2.push("</authors>"),o2.push("<commentList>"),data.forEach(function(d2){var lastauthor=0,ts=[];if(d2[1][0]&&d2[1][0].T&&d2[1][0].ID?lastauthor=iauthor.indexOf("tc="+d2[1][0].ID):d2[1].forEach(function(c2){c2.a&&(lastauthor=iauthor.indexOf(escapexml(c2.a))),ts.push(c2.t||"")}),o2.push('<comment ref="'+d2[0]+'" authorId="'+lastauthor+'"><text>'),ts.length<=1)o2.push(writetag("t",escapexml(ts[0]||"")));else{for(var t2=`Comment:
    `+ts[0]+`
`,i2=1;i2<ts.length;++i2)t2+=`Reply:
    `+ts[i2]+`
`;o2.push(writetag("t",escapexml(t2)))}o2.push("</text></comment>")}),o2.push("</commentList>"),o2.length>2&&(o2[o2.length]="</comments>",o2[1]=o2[1].replace("/>",">")),o2.join("")}function write_tcmnt_xml(comments,people,opts){var o2=[XML_HEADER,writextag("ThreadedComments",null,{xmlns:XMLNS.TCMNT}).replace(/[\/]>/,">")];return comments.forEach(function(carr){var rootid="";(carr[1]||[]).forEach(function(c2,idx){if(!c2.T){delete c2.ID;return}c2.a&&people.indexOf(c2.a)==-1&&people.push(c2.a);var tcopts={ref:carr[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+opts.tcid++).slice(-12)+"}"};idx==0?rootid=tcopts.id:tcopts.parentId=rootid,c2.ID=tcopts.id,c2.a&&(tcopts.personId="{54EE7950-7262-4200-6969-"+("000000000000"+people.indexOf(c2.a)).slice(-12)+"}"),o2.push(writextag("threadedComment",writetag("text",c2.t||""),tcopts))})}),o2.push("</ThreadedComments>"),o2.join("")}function write_people_xml(people){var o2=[XML_HEADER,writextag("personList",null,{xmlns:XMLNS.TCMNT,"xmlns:x":XMLNS_main[0]}).replace(/[\/]>/,">")];return people.forEach(function(person,idx){o2.push(writextag("person",null,{displayName:person,id:"{54EE7950-7262-4200-6969-"+("000000000000"+idx).slice(-12)+"}",userId:person,providerId:"None"}))}),o2.push("</personList>"),o2.join("")}function parse_BrtBeginComment(data){var out={};out.iauthor=data.read_shift(4);var rfx=parse_UncheckedRfX(data);return out.rfx=rfx.s,out.ref=encode_cell(rfx.s),data.l+=16,out}function write_BrtBeginComment(data,o2){return o2==null&&(o2=new_buf(36)),o2.write_shift(4,data[1].iauthor),write_UncheckedRfX(data[0],o2),o2.write_shift(4,0),o2.write_shift(4,0),o2.write_shift(4,0),o2.write_shift(4,0),o2}var parse_BrtCommentAuthor=parse_XLWideString;function write_BrtCommentAuthor(data){return write_XLWideString(data.slice(0,54))}function write_comments_bin(data){var ba=buf_array(),iauthor=[];return write_record(ba,628),write_record(ba,630),data.forEach(function(comment){comment[1].forEach(function(c2){iauthor.indexOf(c2.a)>-1||(iauthor.push(c2.a.slice(0,54)),write_record(ba,632,write_BrtCommentAuthor(c2.a)))})}),write_record(ba,631),write_record(ba,633),data.forEach(function(comment){comment[1].forEach(function(c2){c2.iauthor=iauthor.indexOf(c2.a);var range={s:decode_cell(comment[0]),e:decode_cell(comment[0])};write_record(ba,635,write_BrtBeginComment([range,c2])),c2.t&&c2.t.length>0&&write_record(ba,637,write_BrtCommentText(c2)),write_record(ba,636),delete c2.iauthor})}),write_record(ba,634),write_record(ba,629),ba.end()}function fill_vba_xls(cfb,vba){vba.FullPaths.forEach(function(p2,i2){if(i2!=0){var newpath=p2.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");newpath.slice(-1)!=="/"&&CFB.utils.cfb_add(cfb,newpath,vba.FileIndex[i2].content)}})}var VBAFMTS=["xlsb","xlsm","xlam","biff8","xla"],rc_to_a1=(function(){var rcregex=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,rcbase={r:0,c:0};function rcfunc($$,$1,$2,$3){var cRel=!1,rRel=!1;$2.length==0?rRel=!0:$2.charAt(0)=="["&&(rRel=!0,$2=$2.slice(1,-1)),$3.length==0?cRel=!0:$3.charAt(0)=="["&&(cRel=!0,$3=$3.slice(1,-1));var R2=$2.length>0?parseInt($2,10)|0:0,C2=$3.length>0?parseInt($3,10)|0:0;return cRel?C2+=rcbase.c:--C2,rRel?R2+=rcbase.r:--R2,$1+(cRel?"":"$")+encode_col(C2)+(rRel?"":"$")+encode_row(R2)}return function(fstr,base){return rcbase=base,fstr.replace(rcregex,rcfunc)}})(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=(function(){return function(fstr,base){return fstr.replace(crefregex,function($0,$1,$2,$3,$4,$5){var c2=decode_col($3)-($2?0:base.c),r=decode_row($5)-($4?0:base.r),R2=r==0?"":$4?r+1:"["+r+"]",C2=c2==0?"":$2?c2+1:"["+c2+"]";return $1+"R"+R2+"C"+C2})}})();function shift_formula_str(f2,delta){return f2.replace(crefregex,function($0,$1,$2,$3,$4,$5){return $1+($2=="$"?$2+$3:encode_col(decode_col($3)+delta.c))+($4=="$"?$4+$5:encode_row(decode_row($5)+delta.r))})}function fuzzyfmla(f2){return f2.length!=1}function parseread1(blob){blob.l+=1}function parse_ColRelU(blob,length){var c2=blob.read_shift(2);return[c2&16383,c2>>14&1,c2>>15&1]}function parse_RgceArea(blob,length,opts){var w2=2;if(opts){if(opts.biff>=2&&opts.biff<=5)return parse_RgceArea_BIFF2(blob);opts.biff==12&&(w2=4)}var r=blob.read_shift(w2),R2=blob.read_shift(w2),c2=parse_ColRelU(blob),C2=parse_ColRelU(blob);return{s:{r,c:c2[0],cRel:c2[1],rRel:c2[2]},e:{r:R2,c:C2[0],cRel:C2[1],rRel:C2[2]}}}function parse_RgceArea_BIFF2(blob){var r=parse_ColRelU(blob),R2=parse_ColRelU(blob),c2=blob.read_shift(1),C2=blob.read_shift(1);return{s:{r:r[0],c:c2,cRel:r[1],rRel:r[2]},e:{r:R2[0],c:C2,cRel:R2[1],rRel:R2[2]}}}function parse_RgceAreaRel(blob,length,opts){if(opts.biff<8)return parse_RgceArea_BIFF2(blob);var r=blob.read_shift(opts.biff==12?4:2),R2=blob.read_shift(opts.biff==12?4:2),c2=parse_ColRelU(blob),C2=parse_ColRelU(blob);return{s:{r,c:c2[0],cRel:c2[1],rRel:c2[2]},e:{r:R2,c:C2[0],cRel:C2[1],rRel:C2[2]}}}function parse_RgceLoc(blob,length,opts){if(opts&&opts.biff>=2&&opts.biff<=5)return parse_RgceLoc_BIFF2(blob);var r=blob.read_shift(opts&&opts.biff==12?4:2),c2=parse_ColRelU(blob);return{r,c:c2[0],cRel:c2[1],rRel:c2[2]}}function parse_RgceLoc_BIFF2(blob){var r=parse_ColRelU(blob),c2=blob.read_shift(1);return{r:r[0],c:c2,cRel:r[1],rRel:r[2]}}function parse_RgceElfLoc(blob){var r=blob.read_shift(2),c2=blob.read_shift(2);return{r,c:c2&255,fQuoted:!!(c2&16384),cRel:c2>>15,rRel:c2>>15}}function parse_RgceLocRel(blob,length,opts){var biff=opts&&opts.biff?opts.biff:8;if(biff>=2&&biff<=5)return parse_RgceLocRel_BIFF2(blob);var r=blob.read_shift(biff>=12?4:2),cl=blob.read_shift(2),cRel=(cl&16384)>>14,rRel=(cl&32768)>>15;if(cl&=16383,rRel==1)for(;r>524287;)r-=1048576;if(cRel==1)for(;cl>8191;)cl=cl-16384;return{r,c:cl,cRel,rRel}}function parse_RgceLocRel_BIFF2(blob){var rl=blob.read_shift(2),c2=blob.read_shift(1),rRel=(rl&32768)>>15,cRel=(rl&16384)>>14;return rl&=16383,rRel==1&&rl>=8192&&(rl=rl-16384),cRel==1&&c2>=128&&(c2=c2-256),{r:rl,c:c2,cRel,rRel}}function parse_PtgArea(blob,length,opts){var type=(blob[blob.l++]&96)>>5,area=parse_RgceArea(blob,opts.biff>=2&&opts.biff<=5?6:8,opts);return[type,area]}function parse_PtgArea3d(blob,length,opts){var type=(blob[blob.l++]&96)>>5,ixti=blob.read_shift(2,"i"),w2=8;if(opts)switch(opts.biff){case 5:blob.l+=12,w2=6;break;case 12:w2=12;break}var area=parse_RgceArea(blob,w2,opts);return[type,ixti,area]}function parse_PtgAreaErr(blob,length,opts){var type=(blob[blob.l++]&96)>>5;return blob.l+=opts&&opts.biff>8?12:opts.biff<8?6:8,[type]}function parse_PtgAreaErr3d(blob,length,opts){var type=(blob[blob.l++]&96)>>5,ixti=blob.read_shift(2),w2=8;if(opts)switch(opts.biff){case 5:blob.l+=12,w2=6;break;case 12:w2=12;break}return blob.l+=w2,[type,ixti]}function parse_PtgAreaN(blob,length,opts){var type=(blob[blob.l++]&96)>>5,area=parse_RgceAreaRel(blob,length-1,opts);return[type,area]}function parse_PtgArray(blob,length,opts){var type=(blob[blob.l++]&96)>>5;return blob.l+=opts.biff==2?6:opts.biff==12?14:7,[type]}function parse_PtgAttrBaxcel(blob){var bitSemi=blob[blob.l+1]&1,bitBaxcel=1;return blob.l+=4,[bitSemi,bitBaxcel]}function parse_PtgAttrChoose(blob,length,opts){blob.l+=2;for(var offset=blob.read_shift(opts&&opts.biff==2?1:2),o2=[],i2=0;i2<=offset;++i2)o2.push(blob.read_shift(opts&&opts.biff==2?1:2));return o2}function parse_PtgAttrGoto(blob,length,opts){var bitGoto=blob[blob.l+1]&255?1:0;return blob.l+=2,[bitGoto,blob.read_shift(opts&&opts.biff==2?1:2)]}function parse_PtgAttrIf(blob,length,opts){var bitIf=blob[blob.l+1]&255?1:0;return blob.l+=2,[bitIf,blob.read_shift(opts&&opts.biff==2?1:2)]}function parse_PtgAttrIfError(blob){var bitIf=blob[blob.l+1]&255?1:0;return blob.l+=2,[bitIf,blob.read_shift(2)]}function parse_PtgAttrSemi(blob,length,opts){var bitSemi=blob[blob.l+1]&255?1:0;return blob.l+=opts&&opts.biff==2?3:4,[bitSemi]}function parse_PtgAttrSpaceType(blob){var type=blob.read_shift(1),cch=blob.read_shift(1);return[type,cch]}function parse_PtgAttrSpace(blob){return blob.read_shift(2),parse_PtgAttrSpaceType(blob)}function parse_PtgAttrSpaceSemi(blob){return blob.read_shift(2),parse_PtgAttrSpaceType(blob)}function parse_PtgRef(blob,length,opts){var type=(blob[blob.l]&96)>>5;blob.l+=1;var loc=parse_RgceLoc(blob,0,opts);return[type,loc]}function parse_PtgRefN(blob,length,opts){var type=(blob[blob.l]&96)>>5;blob.l+=1;var loc=parse_RgceLocRel(blob,0,opts);return[type,loc]}function parse_PtgRef3d(blob,length,opts){var type=(blob[blob.l]&96)>>5;blob.l+=1;var ixti=blob.read_shift(2);opts&&opts.biff==5&&(blob.l+=12);var loc=parse_RgceLoc(blob,0,opts);return[type,ixti,loc]}function parse_PtgFunc(blob,length,opts){var type=(blob[blob.l]&96)>>5;blob.l+=1;var iftab=blob.read_shift(opts&&opts.biff<=3?1:2);return[FtabArgc[iftab],Ftab[iftab],type]}function parse_PtgFuncVar(blob,length,opts){var type=blob[blob.l++],cparams=blob.read_shift(1),tab=opts&&opts.biff<=3?[type==88?-1:0,blob.read_shift(1)]:parsetab(blob);return[cparams,(tab[0]===0?Ftab:Cetab)[tab[1]]]}function parsetab(blob){return[blob[blob.l+1]>>7,blob.read_shift(2)&32767]}function parse_PtgAttrSum(blob,length,opts){blob.l+=opts&&opts.biff==2?3:4}function parse_PtgExp(blob,length,opts){if(blob.l++,opts&&opts.biff==12)return[blob.read_shift(4,"i"),0];var row=blob.read_shift(2),col=blob.read_shift(opts&&opts.biff==2?1:2);return[row,col]}function parse_PtgErr(blob){return blob.l++,BErr[blob.read_shift(1)]}function parse_PtgInt(blob){return blob.l++,blob.read_shift(2)}function parse_PtgBool(blob){return blob.l++,blob.read_shift(1)!==0}function parse_PtgNum(blob){return blob.l++,parse_Xnum(blob)}function parse_PtgStr(blob,length,opts){return blob.l++,parse_ShortXLUnicodeString(blob,length-1,opts)}function parse_SerAr(blob,biff){var val=[blob.read_shift(1)];if(biff==12)switch(val[0]){case 2:val[0]=4;break;case 4:val[0]=16;break;case 0:val[0]=1;break;case 1:val[0]=2;break}switch(val[0]){case 4:val[1]=parsebool(blob,1)?"TRUE":"FALSE",biff!=12&&(blob.l+=7);break;case 37:case 16:val[1]=BErr[blob[blob.l]],blob.l+=biff==12?4:8;break;case 0:blob.l+=8;break;case 1:val[1]=parse_Xnum(blob);break;case 2:val[1]=parse_XLUnicodeString2(blob,0,{biff:biff>0&&biff<8?2:biff});break;default:throw new Error("Bad SerAr: "+val[0])}return val}function parse_PtgExtraMem(blob,cce,opts){for(var count=blob.read_shift(opts.biff==12?4:2),out=[],i2=0;i2!=count;++i2)out.push((opts.biff==12?parse_UncheckedRfX:parse_Ref8U)(blob));return out}function parse_PtgExtraArray(blob,length,opts){var rows=0,cols=0;opts.biff==12?(rows=blob.read_shift(4),cols=blob.read_shift(4)):(cols=1+blob.read_shift(1),rows=1+blob.read_shift(2)),opts.biff>=2&&opts.biff<8&&(--rows,--cols==0&&(cols=256));for(var i2=0,o2=[];i2!=rows&&(o2[i2]=[]);++i2)for(var j2=0;j2!=cols;++j2)o2[i2][j2]=parse_SerAr(blob,opts.biff);return o2}function parse_PtgName(blob,length,opts){var type=blob.read_shift(1)>>>5&3,w2=!opts||opts.biff>=8?4:2,nameindex=blob.read_shift(w2);switch(opts.biff){case 2:blob.l+=5;break;case 3:case 4:blob.l+=8;break;case 5:blob.l+=12;break}return[type,0,nameindex]}function parse_PtgNameX(blob,length,opts){if(opts.biff==5)return parse_PtgNameX_BIFF5(blob);var type=blob.read_shift(1)>>>5&3,ixti=blob.read_shift(2),nameindex=blob.read_shift(4);return[type,ixti,nameindex]}function parse_PtgNameX_BIFF5(blob){var type=blob.read_shift(1)>>>5&3,ixti=blob.read_shift(2,"i");blob.l+=8;var nameindex=blob.read_shift(2);return blob.l+=12,[type,ixti,nameindex]}function parse_PtgMemArea(blob,length,opts){var type=blob.read_shift(1)>>>5&3;blob.l+=opts&&opts.biff==2?3:4;var cce=blob.read_shift(opts&&opts.biff==2?1:2);return[type,cce]}function parse_PtgMemFunc(blob,length,opts){var type=blob.read_shift(1)>>>5&3,cce=blob.read_shift(opts&&opts.biff==2?1:2);return[type,cce]}function parse_PtgRefErr(blob,length,opts){var type=blob.read_shift(1)>>>5&3;return blob.l+=4,opts.biff<8&&blob.l--,opts.biff==12&&(blob.l+=2),[type]}function parse_PtgRefErr3d(blob,length,opts){var type=(blob[blob.l++]&96)>>5,ixti=blob.read_shift(2),w2=4;if(opts)switch(opts.biff){case 5:w2=15;break;case 12:w2=6;break}return blob.l+=w2,[type,ixti]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(blob,length,opts){return blob.l+=2,[parse_RgceElfLoc(blob)]}function parse_PtgElfNoop(blob){return blob.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(blob){return blob.l+=2,[parseuint16(blob),blob.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(blob){blob.l+=2;var ixti=blob.read_shift(2),flags=blob.read_shift(2),idx=blob.read_shift(4),c2=blob.read_shift(2),C2=blob.read_shift(2),rt2=PtgListRT[flags>>2&31];return{ixti,coltype:flags&3,rt:rt2,idx,c:c2,C:C2}}function parse_PtgSxName(blob){return blob.l+=2,[blob.read_shift(4)]}function parse_PtgSheet(blob,length,opts){return blob.l+=5,blob.l+=2,blob.l+=opts.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(blob,length,opts){return blob.l+=opts.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(blob){var type=blob.read_shift(1)>>>5&3,cce=blob.read_shift(2);return[type,cce]}function parse_PtgMemNoMemN(blob){var type=blob.read_shift(1)>>>5&3,cce=blob.read_shift(2);return[type,cce]}function parse_PtgAttrNoop(blob){return blob.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(blob,length,rgce,opts){if(opts.biff<8)return parsenoop(blob,length);for(var target=blob.l+length,o2=[],i2=0;i2!==rgce.length;++i2)switch(rgce[i2][0]){case"PtgArray":rgce[i2][1]=parse_PtgExtraArray(blob,0,opts),o2.push(rgce[i2][1]);break;case"PtgMemArea":rgce[i2][2]=parse_PtgExtraMem(blob,rgce[i2][1],opts),o2.push(rgce[i2][2]);break;case"PtgExp":opts&&opts.biff==12&&(rgce[i2][1][1]=blob.read_shift(4),o2.push(rgce[i2][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+rgce[i2][0]}return length=target-blob.l,length!==0&&o2.push(parsenoop(blob,length)),o2}function parse_Rgce(blob,length,opts){for(var target=blob.l+length,R2,id,ptgs=[];target!=blob.l;)length=target-blob.l,id=blob[blob.l],R2=PtgTypes[id]||PtgTypes[PtgDupes[id]],(id===24||id===25)&&(R2=(id===24?Ptg18:Ptg19)[blob[blob.l+1]]),!R2||!R2.f?parsenoop(blob,length):ptgs.push([R2.n,R2.f(blob,length,opts)]);return ptgs}function stringify_array(f2){for(var o2=[],i2=0;i2<f2.length;++i2){for(var x2=f2[i2],r=[],j2=0;j2<x2.length;++j2){var y2=x2[j2];if(y2)switch(y2[0]){case 2:r.push('"'+y2[1].replace(/"/g,'""')+'"');break;default:r.push(y2[1])}else r.push("")}o2.push(r.join(","))}return o2.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function formula_quote_sheet_name(sname,opts){if(!sname&&!(opts&&opts.biff<=5&&opts.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(sname)?"'"+sname+"'":sname}function get_ixti_raw(supbooks,ixti,opts){if(!supbooks)return"SH33TJSERR0";if(opts.biff>8&&(!supbooks.XTI||!supbooks.XTI[ixti]))return supbooks.SheetNames[ixti];if(!supbooks.XTI)return"SH33TJSERR6";var XTI=supbooks.XTI[ixti];if(opts.biff<8)return ixti>1e4&&(ixti-=65536),ixti<0&&(ixti=-ixti),ixti==0?"":supbooks.XTI[ixti-1];if(!XTI)return"SH33TJSERR1";var o2="";if(opts.biff>8)switch(supbooks[XTI[0]][0]){case 357:return o2=XTI[1]==-1?"#REF":supbooks.SheetNames[XTI[1]],XTI[1]==XTI[2]?o2:o2+":"+supbooks.SheetNames[XTI[2]];case 358:return opts.SID!=null?supbooks.SheetNames[opts.SID]:"SH33TJSSAME"+supbooks[XTI[0]][0];case 355:default:return"SH33TJSSRC"+supbooks[XTI[0]][0]}switch(supbooks[XTI[0]][0][0]){case 1025:return o2=XTI[1]==-1?"#REF":supbooks.SheetNames[XTI[1]]||"SH33TJSERR3",XTI[1]==XTI[2]?o2:o2+":"+supbooks.SheetNames[XTI[2]];case 14849:return supbooks[XTI[0]].slice(1).map(function(name){return name.Name}).join(";;");default:return supbooks[XTI[0]][0][3]?(o2=XTI[1]==-1?"#REF":supbooks[XTI[0]][0][3][XTI[1]]||"SH33TJSERR4",XTI[1]==XTI[2]?o2:o2+":"+supbooks[XTI[0]][0][3][XTI[2]]):"SH33TJSERR2"}}function get_ixti(supbooks,ixti,opts){var ixtiraw=get_ixti_raw(supbooks,ixti,opts);return ixtiraw=="#REF"?ixtiraw:formula_quote_sheet_name(ixtiraw,opts)}function stringify_formula(formula,range,cell,supbooks,opts){var biff=opts&&opts.biff||8,_range={s:{c:0,r:0}},stack=[],e1,e2,c2,ixti=0,nameidx=0,r,sname="";if(!formula[0]||!formula[0][0])return"";for(var last_sp=-1,sp="",ff=0,fflen=formula[0].length;ff<fflen;++ff){var f2=formula[0][ff];switch(f2[0]){case"PtgUminus":stack.push("-"+stack.pop());break;case"PtgUplus":stack.push("+"+stack.pop());break;case"PtgPercent":stack.push(stack.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(e1=stack.pop(),e2=stack.pop(),last_sp>=0){switch(formula[0][last_sp][1][0]){case 0:sp=fill(" ",formula[0][last_sp][1][1]);break;case 1:sp=fill("\r",formula[0][last_sp][1][1]);break;default:if(sp="",opts.WTF)throw new Error("Unexpected PtgAttrSpaceType "+formula[0][last_sp][1][0])}e2=e2+sp,last_sp=-1}stack.push(e2+PtgBinOp[f2[0]]+e1);break;case"PtgIsect":e1=stack.pop(),e2=stack.pop(),stack.push(e2+" "+e1);break;case"PtgUnion":e1=stack.pop(),e2=stack.pop(),stack.push(e2+","+e1);break;case"PtgRange":e1=stack.pop(),e2=stack.pop(),stack.push(e2+":"+e1);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c2=shift_cell_xls(f2[1][1],_range,opts),stack.push(encode_cell_xls(c2,biff));break;case"PtgRefN":c2=cell?shift_cell_xls(f2[1][1],cell,opts):f2[1][1],stack.push(encode_cell_xls(c2,biff));break;case"PtgRef3d":ixti=f2[1][1],c2=shift_cell_xls(f2[1][2],_range,opts),sname=get_ixti(supbooks,ixti,opts),stack.push(sname+"!"+encode_cell_xls(c2,biff));break;case"PtgFunc":case"PtgFuncVar":var argc=f2[1][0],func=f2[1][1];argc||(argc=0),argc&=127;var args=argc==0?[]:stack.slice(-argc);stack.length-=argc,func==="User"&&(func=args.shift()),stack.push(func+"("+args.join(",")+")");break;case"PtgBool":stack.push(f2[1]?"TRUE":"FALSE");break;case"PtgInt":stack.push(f2[1]);break;case"PtgNum":stack.push(String(f2[1]));break;case"PtgStr":stack.push('"'+f2[1].replace(/"/g,'""')+'"');break;case"PtgErr":stack.push(f2[1]);break;case"PtgAreaN":r=shift_range_xls(f2[1][1],cell?{s:cell}:_range,opts),stack.push(encode_range_xls(r,opts));break;case"PtgArea":r=shift_range_xls(f2[1][1],_range,opts),stack.push(encode_range_xls(r,opts));break;case"PtgArea3d":ixti=f2[1][1],r=f2[1][2],sname=get_ixti(supbooks,ixti,opts),stack.push(sname+"!"+encode_range_xls(r,opts));break;case"PtgAttrSum":stack.push("SUM("+stack.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":nameidx=f2[1][2];var lbl=(supbooks.names||[])[nameidx-1]||(supbooks[0]||[])[nameidx],name=lbl?lbl.Name:"SH33TJSNAME"+String(nameidx);name&&name.slice(0,6)=="_xlfn."&&!opts.xlfn&&(name=name.slice(6)),stack.push(name);break;case"PtgNameX":var bookidx=f2[1][1];nameidx=f2[1][2];var externbook;if(opts.biff<=5)bookidx<0&&(bookidx=-bookidx),supbooks[bookidx]&&(externbook=supbooks[bookidx][nameidx]);else{var o2="";if(((supbooks[bookidx]||[])[0]||[])[0]==14849||(((supbooks[bookidx]||[])[0]||[])[0]==1025?supbooks[bookidx][nameidx]&&supbooks[bookidx][nameidx].itab>0&&(o2=supbooks.SheetNames[supbooks[bookidx][nameidx].itab-1]+"!"):o2=supbooks.SheetNames[nameidx-1]+"!"),supbooks[bookidx]&&supbooks[bookidx][nameidx])o2+=supbooks[bookidx][nameidx].Name;else if(supbooks[0]&&supbooks[0][nameidx])o2+=supbooks[0][nameidx].Name;else{var ixtidata=(get_ixti_raw(supbooks,bookidx,opts)||"").split(";;");ixtidata[nameidx-1]?o2=ixtidata[nameidx-1]:o2+="SH33TJSERRX"}stack.push(o2);break}externbook||(externbook={Name:"SH33TJSERRY"}),stack.push(externbook.Name);break;case"PtgParen":var lp="(",rp=")";if(last_sp>=0){switch(sp="",formula[0][last_sp][1][0]){case 2:lp=fill(" ",formula[0][last_sp][1][1])+lp;break;case 3:lp=fill("\r",formula[0][last_sp][1][1])+lp;break;case 4:rp=fill(" ",formula[0][last_sp][1][1])+rp;break;case 5:rp=fill("\r",formula[0][last_sp][1][1])+rp;break;default:if(opts.WTF)throw new Error("Unexpected PtgAttrSpaceType "+formula[0][last_sp][1][0])}last_sp=-1}stack.push(lp+stack.pop()+rp);break;case"PtgRefErr":stack.push("#REF!");break;case"PtgRefErr3d":stack.push("#REF!");break;case"PtgExp":c2={c:f2[1][1],r:f2[1][0]};var q2={c:cell.c,r:cell.r};if(supbooks.sharedf[encode_cell(c2)]){var parsedf=supbooks.sharedf[encode_cell(c2)];stack.push(stringify_formula(parsedf,_range,q2,supbooks,opts))}else{var fnd=!1;for(e1=0;e1!=supbooks.arrayf.length;++e1)if(e2=supbooks.arrayf[e1],!(c2.c<e2[0].s.c||c2.c>e2[0].e.c)&&!(c2.r<e2[0].s.r||c2.r>e2[0].e.r)){stack.push(stringify_formula(e2[1],_range,q2,supbooks,opts)),fnd=!0;break}fnd||stack.push(f2[1])}break;case"PtgArray":stack.push("{"+stringify_array(f2[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":last_sp=ff;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":stack.push("");break;case"PtgAreaErr":stack.push("#REF!");break;case"PtgAreaErr3d":stack.push("#REF!");break;case"PtgList":stack.push("Table"+f2[1].idx+"[#"+f2[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(f2));default:throw new Error("Unrecognized Formula Token: "+String(f2))}var PtgNonDisp=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(opts.biff!=3&&last_sp>=0&&PtgNonDisp.indexOf(formula[0][ff][0])==-1){f2=formula[0][last_sp];var _left=!0;switch(f2[1][0]){case 4:_left=!1;case 0:sp=fill(" ",f2[1][1]);break;case 5:_left=!1;case 1:sp=fill("\r",f2[1][1]);break;default:if(sp="",opts.WTF)throw new Error("Unexpected PtgAttrSpaceType "+f2[1][0])}stack.push((_left?sp:"")+stack.pop()+(_left?"":sp)),last_sp=-1}}if(stack.length>1&&opts.WTF)throw new Error("bad formula stack");return stack[0]}function write_FormulaValue(value){if(value==null){var o2=new_buf(8);return o2.write_shift(1,3),o2.write_shift(1,0),o2.write_shift(2,0),o2.write_shift(2,0),o2.write_shift(2,65535),o2}else if(typeof value=="number")return write_Xnum(value);return write_Xnum(0)}function write_Formula(cell,R2,C2,opts,os){var o1=write_XLSCell(R2,C2,os),o2=write_FormulaValue(cell.v),o3=new_buf(6),flags=33;o3.write_shift(2,flags),o3.write_shift(4,0);for(var bf=new_buf(cell.bf.length),i2=0;i2<cell.bf.length;++i2)bf[i2]=cell.bf[i2];var out=bconcat([o1,o2,o3,bf]);return out}function parse_XLSBParsedFormula(data,length,opts){var cce=data.read_shift(4),rgce=parse_Rgce(data,cce,opts),cb=data.read_shift(4),rgcb=cb>0?parse_RgbExtra(data,cb,rgce,opts):null;return[rgce,rgcb]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function csf_to_ods_formula(f2){var o2="of:="+f2.replace(crefregex,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return o2.replace(/;/g,"|").replace(/,/g,";")}function csf_to_ods_3D(r){return r.replace(/\./,"!")}var browser_has_Map=typeof Map<"u";function get_sst_id(sst,str,rev2){var i2=0,len=sst.length;if(rev2){if(browser_has_Map?rev2.has(str):Object.prototype.hasOwnProperty.call(rev2,str)){for(var revarr=browser_has_Map?rev2.get(str):rev2[str];i2<revarr.length;++i2)if(sst[revarr[i2]].t===str)return sst.Count++,revarr[i2]}}else for(;i2<len;++i2)if(sst[i2].t===str)return sst.Count++,i2;return sst[len]={t:str},sst.Count++,sst.Unique++,rev2&&(browser_has_Map?(rev2.has(str)||rev2.set(str,[]),rev2.get(str).push(len)):(Object.prototype.hasOwnProperty.call(rev2,str)||(rev2[str]=[]),rev2[str].push(len))),len}function col_obj_w(C2,col){var p2={min:C2+1,max:C2+1},wch=-1;return col.MDW&&(MDW=col.MDW),col.width!=null?p2.customWidth=1:col.wpx!=null?wch=px2char(col.wpx):col.wch!=null&&(wch=col.wch),wch>-1?(p2.width=char2width(wch),p2.customWidth=1):col.width!=null&&(p2.width=col.width),col.hidden&&(p2.hidden=!0),col.level!=null&&(p2.outlineLevel=p2.level=col.level),p2}function default_margins(margins,mode){if(margins){var defs=[.7,.7,.75,.75,.3,.3];margins.left==null&&(margins.left=defs[0]),margins.right==null&&(margins.right=defs[1]),margins.top==null&&(margins.top=defs[2]),margins.bottom==null&&(margins.bottom=defs[3]),margins.header==null&&(margins.header=defs[4]),margins.footer==null&&(margins.footer=defs[5])}}function get_cell_style(styles,cell,opts){var z2=opts.revssf[cell.z!=null?cell.z:"General"],i2=60,len=styles.length;if(z2==null&&opts.ssf){for(;i2<392;++i2)if(opts.ssf[i2]==null){SSF_load(cell.z,i2),opts.ssf[i2]=cell.z,opts.revssf[cell.z]=z2=i2;break}}for(i2=0;i2!=len;++i2)if(styles[i2].numFmtId===z2)return i2;return styles[len]={numFmtId:z2,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},len}function check_ws(ws,sname,i2){if(ws&&ws["!ref"]){var range=safe_decode_range(ws["!ref"]);if(range.e.c<range.s.c||range.e.r<range.s.r)throw new Error("Bad range ("+i2+"): "+ws["!ref"])}}function write_ws_xml_merges(merges){if(merges.length===0)return"";for(var o2='<mergeCells count="'+merges.length+'">',i2=0;i2!=merges.length;++i2)o2+='<mergeCell ref="'+encode_range(merges[i2])+'"/>';return o2+"</mergeCells>"}function write_ws_xml_sheetpr(ws,wb,idx,opts,o2){var needed=!1,props={},payload=null;if(opts.bookType!=="xlsx"&&wb.vbaraw){var cname=wb.SheetNames[idx];try{wb.Workbook&&(cname=wb.Workbook.Sheets[idx].CodeName||cname)}catch{}needed=!0,props.codeName=utf8write(escapexml(cname))}if(ws&&ws["!outline"]){var outlineprops={summaryBelow:1,summaryRight:1};ws["!outline"].above&&(outlineprops.summaryBelow=0),ws["!outline"].left&&(outlineprops.summaryRight=0),payload=(payload||"")+writextag("outlinePr",null,outlineprops)}!needed&&!payload||(o2[o2.length]=writextag("sheetPr",payload,props))}var sheetprot_deffalse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sheetprot_deftrue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function write_ws_xml_protection(sp){var o2={sheet:1};return sheetprot_deffalse.forEach(function(n){sp[n]!=null&&sp[n]&&(o2[n]="1")}),sheetprot_deftrue.forEach(function(n){sp[n]!=null&&!sp[n]&&(o2[n]="0")}),sp.password&&(o2.password=crypto_CreatePasswordVerifier_Method1(sp.password).toString(16).toUpperCase()),writextag("sheetProtection",null,o2)}function write_ws_xml_margins(margin){return default_margins(margin),writextag("pageMargins",null,margin)}function write_ws_xml_cols(ws,cols){for(var o2=["<cols>"],col,i2=0;i2!=cols.length;++i2)(col=cols[i2])&&(o2[o2.length]=writextag("col",null,col_obj_w(i2,col)));return o2[o2.length]="</cols>",o2.join("")}function write_ws_xml_autofilter(data,ws,wb,idx){var ref=typeof data.ref=="string"?data.ref:encode_range(data.ref);wb.Workbook||(wb.Workbook={Sheets:[]}),wb.Workbook.Names||(wb.Workbook.Names=[]);var names=wb.Workbook.Names,range=decode_range(ref);range.s.r==range.e.r&&(range.e.r=decode_range(ws["!ref"]).e.r,ref=encode_range(range));for(var i2=0;i2<names.length;++i2){var name=names[i2];if(name.Name=="_xlnm._FilterDatabase"&&name.Sheet==idx){name.Ref="'"+wb.SheetNames[idx]+"'!"+ref;break}}return i2==names.length&&names.push({Name:"_xlnm._FilterDatabase",Sheet:idx,Ref:"'"+wb.SheetNames[idx]+"'!"+ref}),writextag("autoFilter",null,{ref})}function write_ws_xml_sheetviews(ws,opts,idx,wb){var sview={workbookViewId:"0"};return(((wb||{}).Workbook||{}).Views||[])[0]&&(sview.rightToLeft=wb.Workbook.Views[0].RTL?"1":"0"),writextag("sheetViews",writextag("sheetView",null,sview),{})}function write_ws_xml_cell(cell,ref,ws,opts){if(cell.c&&ws["!comments"].push([ref,cell.c]),cell.v===void 0&&typeof cell.f!="string"||cell.t==="z"&&!cell.f)return"";var vv="",oldt=cell.t,oldv=cell.v;if(cell.t!=="z")switch(cell.t){case"b":vv=cell.v?"1":"0";break;case"n":vv=""+cell.v;break;case"e":vv=BErr[cell.v];break;case"d":opts&&opts.cellDates?vv=parseDate(cell.v,-1).toISOString():(cell=dup(cell),cell.t="n",vv=""+(cell.v=datenum(parseDate(cell.v)))),typeof cell.z>"u"&&(cell.z=table_fmt[14]);break;default:vv=cell.v;break}var v2=writetag("v",escapexml(vv)),o2={r:ref},os=get_cell_style(opts.cellXfs,cell,opts);switch(os!==0&&(o2.s=os),cell.t){case"n":break;case"d":o2.t="d";break;case"b":o2.t="b";break;case"e":o2.t="e";break;case"z":break;default:if(cell.v==null){delete cell.t;break}if(cell.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(opts&&opts.bookSST){v2=writetag("v",""+get_sst_id(opts.Strings,cell.v,opts.revStrings)),o2.t="s";break}o2.t="str";break}if(cell.t!=oldt&&(cell.t=oldt,cell.v=oldv),typeof cell.f=="string"&&cell.f){var ff=cell.F&&cell.F.slice(0,ref.length)==ref?{t:"array",ref:cell.F}:null;v2=writextag("f",escapexml(cell.f),ff)+(cell.v!=null?v2:"")}return cell.l&&ws["!links"].push([ref,cell.l]),cell.D&&(o2.cm=1),writextag("c",v2,o2)}function write_ws_xml_data(ws,opts,idx,wb){var o2=[],r=[],range=safe_decode_range(ws["!ref"]),cell="",ref,rr="",cols=[],R2=0,C2=0,rows=ws["!rows"],dense=Array.isArray(ws),params={r:rr},row,height=-1;for(C2=range.s.c;C2<=range.e.c;++C2)cols[C2]=encode_col(C2);for(R2=range.s.r;R2<=range.e.r;++R2){for(r=[],rr=encode_row(R2),C2=range.s.c;C2<=range.e.c;++C2){ref=cols[C2]+rr;var _cell=dense?(ws[R2]||[])[C2]:ws[ref];_cell!==void 0&&(cell=write_ws_xml_cell(_cell,ref,ws,opts))!=null&&r.push(cell)}(r.length>0||rows&&rows[R2])&&(params={r:rr},rows&&rows[R2]&&(row=rows[R2],row.hidden&&(params.hidden=1),height=-1,row.hpx?height=px2pt(row.hpx):row.hpt&&(height=row.hpt),height>-1&&(params.ht=height,params.customHeight=1),row.level&&(params.outlineLevel=row.level)),o2[o2.length]=writextag("row",r.join(""),params))}if(rows)for(;R2<rows.length;++R2)rows&&rows[R2]&&(params={r:R2+1},row=rows[R2],row.hidden&&(params.hidden=1),height=-1,row.hpx?height=px2pt(row.hpx):row.hpt&&(height=row.hpt),height>-1&&(params.ht=height,params.customHeight=1),row.level&&(params.outlineLevel=row.level),o2[o2.length]=writextag("row","",params));return o2.join("")}function write_ws_xml(idx,opts,wb,rels){var o2=[XML_HEADER,writextag("worksheet",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r})],s2=wb.SheetNames[idx],sidx=0,rdata="",ws=wb.Sheets[s2];ws==null&&(ws={});var ref=ws["!ref"]||"A1",range=safe_decode_range(ref);if(range.e.c>16383||range.e.r>1048575){if(opts.WTF)throw new Error("Range "+ref+" exceeds format limit A1:XFD1048576");range.e.c=Math.min(range.e.c,16383),range.e.r=Math.min(range.e.c,1048575),ref=encode_range(range)}rels||(rels={}),ws["!comments"]=[];var _drawing=[];write_ws_xml_sheetpr(ws,wb,idx,opts,o2),o2[o2.length]=writextag("dimension",null,{ref}),o2[o2.length]=write_ws_xml_sheetviews(ws,opts,idx,wb),opts.sheetFormat&&(o2[o2.length]=writextag("sheetFormatPr",null,{defaultRowHeight:opts.sheetFormat.defaultRowHeight||"16",baseColWidth:opts.sheetFormat.baseColWidth||"10",outlineLevelRow:opts.sheetFormat.outlineLevelRow||"7"})),ws["!cols"]!=null&&ws["!cols"].length>0&&(o2[o2.length]=write_ws_xml_cols(ws,ws["!cols"])),o2[sidx=o2.length]="<sheetData/>",ws["!links"]=[],ws["!ref"]!=null&&(rdata=write_ws_xml_data(ws,opts),rdata.length>0&&(o2[o2.length]=rdata)),o2.length>sidx+1&&(o2[o2.length]="</sheetData>",o2[sidx]=o2[sidx].replace("/>",">")),ws["!protect"]&&(o2[o2.length]=write_ws_xml_protection(ws["!protect"])),ws["!autofilter"]!=null&&(o2[o2.length]=write_ws_xml_autofilter(ws["!autofilter"],ws,wb,idx)),ws["!merges"]!=null&&ws["!merges"].length>0&&(o2[o2.length]=write_ws_xml_merges(ws["!merges"]));var relc=-1,rel,rId=-1;return ws["!links"].length>0&&(o2[o2.length]="<hyperlinks>",ws["!links"].forEach(function(l2){l2[1].Target&&(rel={ref:l2[0]},l2[1].Target.charAt(0)!="#"&&(rId=add_rels(rels,-1,escapexml(l2[1].Target).replace(/#.*$/,""),RELS.HLINK),rel["r:id"]="rId"+rId),(relc=l2[1].Target.indexOf("#"))>-1&&(rel.location=escapexml(l2[1].Target.slice(relc+1))),l2[1].Tooltip&&(rel.tooltip=escapexml(l2[1].Tooltip)),o2[o2.length]=writextag("hyperlink",null,rel))}),o2[o2.length]="</hyperlinks>"),delete ws["!links"],ws["!margins"]!=null&&(o2[o2.length]=write_ws_xml_margins(ws["!margins"])),(!opts||opts.ignoreEC||opts.ignoreEC==null)&&(o2[o2.length]=writetag("ignoredErrors",writextag("ignoredError",null,{numberStoredAsText:1,sqref:ref}))),_drawing.length>0&&(rId=add_rels(rels,-1,"../drawings/drawing"+(idx+1)+".xml",RELS.DRAW),o2[o2.length]=writextag("drawing",null,{"r:id":"rId"+rId}),ws["!drawing"]=_drawing),ws["!comments"].length>0&&(rId=add_rels(rels,-1,"../drawings/vmlDrawing"+(idx+1)+".vml",RELS.VML),o2[o2.length]=writextag("legacyDrawing",null,{"r:id":"rId"+rId}),ws["!legacy"]=rId),o2.length>1&&(o2[o2.length]="</worksheet>",o2[1]=o2[1].replace("/>",">")),o2.join("")}function parse_BrtRowHdr(data,length){var z2={},tgt=data.l+length;z2.r=data.read_shift(4),data.l+=4;var miyRw=data.read_shift(2);data.l+=1;var flags=data.read_shift(1);return data.l=tgt,flags&7&&(z2.level=flags&7),flags&16&&(z2.hidden=!0),flags&32&&(z2.hpt=miyRw/20),z2}function write_BrtRowHdr(R2,range,ws){var o2=new_buf(145),row=(ws["!rows"]||[])[R2]||{};o2.write_shift(4,R2),o2.write_shift(4,0);var miyRw=320;row.hpx?miyRw=px2pt(row.hpx)*20:row.hpt&&(miyRw=row.hpt*20),o2.write_shift(2,miyRw),o2.write_shift(1,0);var flags=0;row.level&&(flags|=row.level),row.hidden&&(flags|=16),(row.hpx||row.hpt)&&(flags|=32),o2.write_shift(1,flags),o2.write_shift(1,0);var ncolspan=0,lcs=o2.l;o2.l+=4;for(var caddr={r:R2,c:0},i2=0;i2<16;++i2)if(!(range.s.c>i2+1<<10||range.e.c<i2<<10)){for(var first=-1,last=-1,j2=i2<<10;j2<i2+1<<10;++j2){caddr.c=j2;var cell=Array.isArray(ws)?(ws[caddr.r]||[])[caddr.c]:ws[encode_cell(caddr)];cell&&(first<0&&(first=j2),last=j2)}first<0||(++ncolspan,o2.write_shift(4,first),o2.write_shift(4,last))}var l2=o2.l;return o2.l=lcs,o2.write_shift(4,ncolspan),o2.l=l2,o2.length>o2.l?o2.slice(0,o2.l):o2}function write_row_header(ba,ws,range,R2){var o2=write_BrtRowHdr(R2,range,ws);(o2.length>17||(ws["!rows"]||[])[R2])&&write_record(ba,0,o2)}var parse_BrtWsDim=parse_UncheckedRfX,write_BrtWsDim=write_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(data,length){var z2={},f2=data[data.l];return++data.l,z2.above=!(f2&64),z2.left=!(f2&128),data.l+=18,z2.name=parse_XLSBCodeName(data),z2}function write_BrtWsProp(str,outl,o2){o2==null&&(o2=new_buf(84+4*str.length));var f2=192;outl&&(outl.above&&(f2&=-65),outl.left&&(f2&=-129)),o2.write_shift(1,f2);for(var i2=1;i2<3;++i2)o2.write_shift(1,0);return write_BrtColor({auto:1},o2),o2.write_shift(-4,-1),o2.write_shift(-4,-1),write_XLSBCodeName(str,o2),o2.slice(0,o2.l)}function parse_BrtCellBlank(data){var cell=parse_XLSBCell(data);return[cell]}function write_BrtCellBlank(cell,ncell,o2){return o2==null&&(o2=new_buf(8)),write_XLSBCell(ncell,o2)}function parse_BrtShortBlank(data){var cell=parse_XLSBShortCell(data);return[cell]}function write_BrtShortBlank(cell,ncell,o2){return o2==null&&(o2=new_buf(4)),write_XLSBShortCell(ncell,o2)}function parse_BrtCellBool(data){var cell=parse_XLSBCell(data),fBool=data.read_shift(1);return[cell,fBool,"b"]}function write_BrtCellBool(cell,ncell,o2){return o2==null&&(o2=new_buf(9)),write_XLSBCell(ncell,o2),o2.write_shift(1,cell.v?1:0),o2}function parse_BrtShortBool(data){var cell=parse_XLSBShortCell(data),fBool=data.read_shift(1);return[cell,fBool,"b"]}function write_BrtShortBool(cell,ncell,o2){return o2==null&&(o2=new_buf(5)),write_XLSBShortCell(ncell,o2),o2.write_shift(1,cell.v?1:0),o2}function parse_BrtCellError(data){var cell=parse_XLSBCell(data),bError=data.read_shift(1);return[cell,bError,"e"]}function write_BrtCellError(cell,ncell,o2){return o2==null&&(o2=new_buf(9)),write_XLSBCell(ncell,o2),o2.write_shift(1,cell.v),o2}function parse_BrtShortError(data){var cell=parse_XLSBShortCell(data),bError=data.read_shift(1);return[cell,bError,"e"]}function write_BrtShortError(cell,ncell,o2){return o2==null&&(o2=new_buf(8)),write_XLSBShortCell(ncell,o2),o2.write_shift(1,cell.v),o2.write_shift(2,0),o2.write_shift(1,0),o2}function parse_BrtCellIsst(data){var cell=parse_XLSBCell(data),isst=data.read_shift(4);return[cell,isst,"s"]}function write_BrtCellIsst(cell,ncell,o2){return o2==null&&(o2=new_buf(12)),write_XLSBCell(ncell,o2),o2.write_shift(4,ncell.v),o2}function parse_BrtShortIsst(data){var cell=parse_XLSBShortCell(data),isst=data.read_shift(4);return[cell,isst,"s"]}function write_BrtShortIsst(cell,ncell,o2){return o2==null&&(o2=new_buf(8)),write_XLSBShortCell(ncell,o2),o2.write_shift(4,ncell.v),o2}function parse_BrtCellReal(data){var cell=parse_XLSBCell(data),value=parse_Xnum(data);return[cell,value,"n"]}function write_BrtCellReal(cell,ncell,o2){return o2==null&&(o2=new_buf(16)),write_XLSBCell(ncell,o2),write_Xnum(cell.v,o2),o2}function parse_BrtShortReal(data){var cell=parse_XLSBShortCell(data),value=parse_Xnum(data);return[cell,value,"n"]}function write_BrtShortReal(cell,ncell,o2){return o2==null&&(o2=new_buf(12)),write_XLSBShortCell(ncell,o2),write_Xnum(cell.v,o2),o2}function parse_BrtCellRk(data){var cell=parse_XLSBCell(data),value=parse_RkNumber(data);return[cell,value,"n"]}function write_BrtCellRk(cell,ncell,o2){return o2==null&&(o2=new_buf(12)),write_XLSBCell(ncell,o2),write_RkNumber(cell.v,o2),o2}function parse_BrtShortRk(data){var cell=parse_XLSBShortCell(data),value=parse_RkNumber(data);return[cell,value,"n"]}function write_BrtShortRk(cell,ncell,o2){return o2==null&&(o2=new_buf(8)),write_XLSBShortCell(ncell,o2),write_RkNumber(cell.v,o2),o2}function parse_BrtCellRString(data){var cell=parse_XLSBCell(data),value=parse_RichStr(data);return[cell,value,"is"]}function parse_BrtCellSt(data){var cell=parse_XLSBCell(data),value=parse_XLWideString(data);return[cell,value,"str"]}function write_BrtCellSt(cell,ncell,o2){return o2==null&&(o2=new_buf(12+4*cell.v.length)),write_XLSBCell(ncell,o2),write_XLWideString(cell.v,o2),o2.length>o2.l?o2.slice(0,o2.l):o2}function parse_BrtShortSt(data){var cell=parse_XLSBShortCell(data),value=parse_XLWideString(data);return[cell,value,"str"]}function write_BrtShortSt(cell,ncell,o2){return o2==null&&(o2=new_buf(8+4*cell.v.length)),write_XLSBShortCell(ncell,o2),write_XLWideString(cell.v,o2),o2.length>o2.l?o2.slice(0,o2.l):o2}function parse_BrtFmlaBool(data,length,opts){var end=data.l+length,cell=parse_XLSBCell(data);cell.r=opts["!row"];var value=data.read_shift(1),o2=[cell,value,"b"];if(opts.cellFormula){data.l+=2;var formula=parse_XLSBCellParsedFormula(data,end-data.l,opts);o2[3]=stringify_formula(formula,null,cell,opts.supbooks,opts)}else data.l=end;return o2}function parse_BrtFmlaError(data,length,opts){var end=data.l+length,cell=parse_XLSBCell(data);cell.r=opts["!row"];var value=data.read_shift(1),o2=[cell,value,"e"];if(opts.cellFormula){data.l+=2;var formula=parse_XLSBCellParsedFormula(data,end-data.l,opts);o2[3]=stringify_formula(formula,null,cell,opts.supbooks,opts)}else data.l=end;return o2}function parse_BrtFmlaNum(data,length,opts){var end=data.l+length,cell=parse_XLSBCell(data);cell.r=opts["!row"];var value=parse_Xnum(data),o2=[cell,value,"n"];if(opts.cellFormula){data.l+=2;var formula=parse_XLSBCellParsedFormula(data,end-data.l,opts);o2[3]=stringify_formula(formula,null,cell,opts.supbooks,opts)}else data.l=end;return o2}function parse_BrtFmlaString(data,length,opts){var end=data.l+length,cell=parse_XLSBCell(data);cell.r=opts["!row"];var value=parse_XLWideString(data),o2=[cell,value,"str"];if(opts.cellFormula){data.l+=2;var formula=parse_XLSBCellParsedFormula(data,end-data.l,opts);o2[3]=stringify_formula(formula,null,cell,opts.supbooks,opts)}else data.l=end;return o2}var parse_BrtMergeCell=parse_UncheckedRfX,write_BrtMergeCell=write_UncheckedRfX;function write_BrtBeginMergeCells(cnt,o2){return o2==null&&(o2=new_buf(4)),o2.write_shift(4,cnt),o2}function parse_BrtHLink(data,length){var end=data.l+length,rfx=parse_UncheckedRfX(data),relId=parse_XLNullableWideString(data),loc=parse_XLWideString(data),tooltip=parse_XLWideString(data),display=parse_XLWideString(data);data.l=end;var o2={rfx,relId,loc,display};return tooltip&&(o2.Tooltip=tooltip),o2}function write_BrtHLink(l2,rId){var o2=new_buf(50+4*(l2[1].Target.length+(l2[1].Tooltip||"").length));write_UncheckedRfX({s:decode_cell(l2[0]),e:decode_cell(l2[0])},o2),write_RelID("rId"+rId,o2);var locidx=l2[1].Target.indexOf("#"),loc=locidx==-1?"":l2[1].Target.slice(locidx+1);return write_XLWideString(loc||"",o2),write_XLWideString(l2[1].Tooltip||"",o2),write_XLWideString("",o2),o2.slice(0,o2.l)}function parse_BrtPane(){}function parse_BrtArrFmla(data,length,opts){var end=data.l+length,rfx=parse_RfX(data),fAlwaysCalc=data.read_shift(1),o2=[rfx];if(o2[2]=fAlwaysCalc,opts.cellFormula){var formula=parse_XLSBArrayParsedFormula(data,end-data.l,opts);o2[1]=formula}else data.l=end;return o2}function parse_BrtShrFmla(data,length,opts){var end=data.l+length,rfx=parse_UncheckedRfX(data),o2=[rfx];if(opts.cellFormula){var formula=parse_XLSBSharedParsedFormula(data,end-data.l,opts);o2[1]=formula,data.l=end}else data.l=end;return o2}function write_BrtColInfo(C2,col,o2){o2==null&&(o2=new_buf(18));var p2=col_obj_w(C2,col);o2.write_shift(-4,C2),o2.write_shift(-4,C2),o2.write_shift(4,(p2.width||10)*256),o2.write_shift(4,0);var flags=0;return col.hidden&&(flags|=1),typeof p2.width=="number"&&(flags|=2),col.level&&(flags|=col.level<<8),o2.write_shift(2,flags),o2}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(data){var margins={};return BrtMarginKeys.forEach(function(k2){margins[k2]=parse_Xnum(data)}),margins}function write_BrtMargins(margins,o2){return o2==null&&(o2=new_buf(48)),default_margins(margins),BrtMarginKeys.forEach(function(k2){write_Xnum(margins[k2],o2)}),o2}function parse_BrtBeginWsView(data){var f2=data.read_shift(2);return data.l+=28,{RTL:f2&32}}function write_BrtBeginWsView(ws,Workbook,o2){o2==null&&(o2=new_buf(30));var f2=924;return(((Workbook||{}).Views||[])[0]||{}).RTL&&(f2|=32),o2.write_shift(2,f2),o2.write_shift(4,0),o2.write_shift(4,0),o2.write_shift(4,0),o2.write_shift(1,0),o2.write_shift(1,0),o2.write_shift(2,0),o2.write_shift(2,100),o2.write_shift(2,0),o2.write_shift(2,0),o2.write_shift(2,0),o2.write_shift(4,0),o2}function write_BrtCellIgnoreEC(ref){var o2=new_buf(24);return o2.write_shift(4,4),o2.write_shift(4,1),write_UncheckedRfX(ref,o2),o2}function write_BrtSheetProtection(sp,o2){return o2==null&&(o2=new_buf(66)),o2.write_shift(2,sp.password?crypto_CreatePasswordVerifier_Method1(sp.password):0),o2.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?o2.write_shift(4,sp[n[0]]!=null&&!sp[n[0]]?1:0):o2.write_shift(4,sp[n[0]]!=null&&sp[n[0]]?0:1)}),o2}function parse_BrtDVal(){}function parse_BrtDVal14(){}function write_ws_bin_cell(ba,cell,R2,C2,opts,ws,last_seen){if(cell.v===void 0)return!1;var vv="";switch(cell.t){case"b":vv=cell.v?"1":"0";break;case"d":cell=dup(cell),cell.z=cell.z||table_fmt[14],cell.v=datenum(parseDate(cell.v)),cell.t="n";break;case"n":case"e":vv=""+cell.v;break;default:vv=cell.v;break}var o2={r:R2,c:C2};switch(o2.s=get_cell_style(opts.cellXfs,cell,opts),cell.l&&ws["!links"].push([encode_cell(o2),cell.l]),cell.c&&ws["!comments"].push([encode_cell(o2),cell.c]),cell.t){case"s":case"str":return opts.bookSST?(vv=get_sst_id(opts.Strings,cell.v,opts.revStrings),o2.t="s",o2.v=vv,last_seen?write_record(ba,18,write_BrtShortIsst(cell,o2)):write_record(ba,7,write_BrtCellIsst(cell,o2))):(o2.t="str",last_seen?write_record(ba,17,write_BrtShortSt(cell,o2)):write_record(ba,6,write_BrtCellSt(cell,o2))),!0;case"n":return cell.v==(cell.v|0)&&cell.v>-1e3&&cell.v<1e3?last_seen?write_record(ba,13,write_BrtShortRk(cell,o2)):write_record(ba,2,write_BrtCellRk(cell,o2)):last_seen?write_record(ba,16,write_BrtShortReal(cell,o2)):write_record(ba,5,write_BrtCellReal(cell,o2)),!0;case"b":return o2.t="b",last_seen?write_record(ba,15,write_BrtShortBool(cell,o2)):write_record(ba,4,write_BrtCellBool(cell,o2)),!0;case"e":return o2.t="e",last_seen?write_record(ba,14,write_BrtShortError(cell,o2)):write_record(ba,3,write_BrtCellError(cell,o2)),!0}return last_seen?write_record(ba,12,write_BrtShortBlank(cell,o2)):write_record(ba,1,write_BrtCellBlank(cell,o2)),!0}function write_CELLTABLE(ba,ws,idx,opts){var range=safe_decode_range(ws["!ref"]||"A1"),ref,rr="",cols=[];write_record(ba,145);var dense=Array.isArray(ws),cap=range.e.r;ws["!rows"]&&(cap=Math.max(range.e.r,ws["!rows"].length-1));for(var R2=range.s.r;R2<=cap;++R2){rr=encode_row(R2),write_row_header(ba,ws,range,R2);var last_seen=!1;if(R2<=range.e.r)for(var C2=range.s.c;C2<=range.e.c;++C2){R2===range.s.r&&(cols[C2]=encode_col(C2)),ref=cols[C2]+rr;var cell=dense?(ws[R2]||[])[C2]:ws[ref];if(!cell){last_seen=!1;continue}last_seen=write_ws_bin_cell(ba,cell,R2,C2,opts,ws,last_seen)}}write_record(ba,146)}function write_MERGECELLS(ba,ws){!ws||!ws["!merges"]||(write_record(ba,177,write_BrtBeginMergeCells(ws["!merges"].length)),ws["!merges"].forEach(function(m2){write_record(ba,176,write_BrtMergeCell(m2))}),write_record(ba,178))}function write_COLINFOS(ba,ws){!ws||!ws["!cols"]||(write_record(ba,390),ws["!cols"].forEach(function(m2,i2){m2&&write_record(ba,60,write_BrtColInfo(i2,m2))}),write_record(ba,391))}function write_IGNOREECS(ba,ws){!ws||!ws["!ref"]||(write_record(ba,648),write_record(ba,649,write_BrtCellIgnoreEC(safe_decode_range(ws["!ref"]))),write_record(ba,650))}function write_HLINKS(ba,ws,rels){ws["!links"].forEach(function(l2){if(l2[1].Target){var rId=add_rels(rels,-1,l2[1].Target.replace(/#.*$/,""),RELS.HLINK);write_record(ba,494,write_BrtHLink(l2,rId))}}),delete ws["!links"]}function write_LEGACYDRAWING(ba,ws,idx,rels){if(ws["!comments"].length>0){var rId=add_rels(rels,-1,"../drawings/vmlDrawing"+(idx+1)+".vml",RELS.VML);write_record(ba,551,write_RelID("rId"+rId)),ws["!legacy"]=rId}}function write_AUTOFILTER(ba,ws,wb,idx){if(ws["!autofilter"]){var data=ws["!autofilter"],ref=typeof data.ref=="string"?data.ref:encode_range(data.ref);wb.Workbook||(wb.Workbook={Sheets:[]}),wb.Workbook.Names||(wb.Workbook.Names=[]);var names=wb.Workbook.Names,range=decode_range(ref);range.s.r==range.e.r&&(range.e.r=decode_range(ws["!ref"]).e.r,ref=encode_range(range));for(var i2=0;i2<names.length;++i2){var name=names[i2];if(name.Name=="_xlnm._FilterDatabase"&&name.Sheet==idx){name.Ref="'"+wb.SheetNames[idx]+"'!"+ref;break}}i2==names.length&&names.push({Name:"_xlnm._FilterDatabase",Sheet:idx,Ref:"'"+wb.SheetNames[idx]+"'!"+ref}),write_record(ba,161,write_UncheckedRfX(safe_decode_range(ref))),write_record(ba,162)}}function write_WSVIEWS2(ba,ws,Workbook){write_record(ba,133),write_record(ba,137,write_BrtBeginWsView(ws,Workbook)),write_record(ba,138),write_record(ba,134)}function write_SHEETPROTECT(ba,ws){ws["!protect"]&&write_record(ba,535,write_BrtSheetProtection(ws["!protect"]))}function write_ws_bin(idx,opts,wb,rels){var ba=buf_array(),s2=wb.SheetNames[idx],ws=wb.Sheets[s2]||{},c2=s2;try{wb&&wb.Workbook&&(c2=wb.Workbook.Sheets[idx].CodeName||c2)}catch{}var r=safe_decode_range(ws["!ref"]||"A1");if(r.e.c>16383||r.e.r>1048575){if(opts.WTF)throw new Error("Range "+(ws["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");r.e.c=Math.min(r.e.c,16383),r.e.r=Math.min(r.e.c,1048575)}return ws["!links"]=[],ws["!comments"]=[],write_record(ba,129),(wb.vbaraw||ws["!outline"])&&write_record(ba,147,write_BrtWsProp(c2,ws["!outline"])),write_record(ba,148,write_BrtWsDim(r)),write_WSVIEWS2(ba,ws,wb.Workbook),write_COLINFOS(ba,ws),write_CELLTABLE(ba,ws,idx,opts),write_SHEETPROTECT(ba,ws),write_AUTOFILTER(ba,ws,wb,idx),write_MERGECELLS(ba,ws),write_HLINKS(ba,ws,rels),ws["!margins"]&&write_record(ba,476,write_BrtMargins(ws["!margins"])),(!opts||opts.ignoreEC||opts.ignoreEC==null)&&write_IGNOREECS(ba,ws),write_LEGACYDRAWING(ba,ws,idx,rels),write_record(ba,130),ba.end()}function parse_BrtCsProp(data,length){data.l+=10;var name=parse_XLWideString(data);return{name}}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function safe1904(wb){return!wb.Workbook||!wb.Workbook.WBProps?"false":parsexmlbool(wb.Workbook.WBProps.date1904)?"true":"false"}var badchars="][*?/\\".split("");function check_ws_name(n,safe){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var _good=!0;return badchars.forEach(function(c2){if(n.indexOf(c2)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),_good}function check_wb_names(N2,S2,codes){N2.forEach(function(n,i2){check_ws_name(n);for(var j2=0;j2<i2;++j2)if(n==N2[j2])throw new Error("Duplicate Sheet Name: "+n);if(codes){var cn=S2&&S2[i2]&&S2[i2].CodeName||n;if(cn.charCodeAt(0)==95&&cn.length>22)throw new Error("Bad Code Name: Worksheet"+cn)}})}function check_wb(wb){if(!wb||!wb.SheetNames||!wb.Sheets)throw new Error("Invalid Workbook");if(!wb.SheetNames.length)throw new Error("Workbook is empty");var Sheets=wb.Workbook&&wb.Workbook.Sheets||[];check_wb_names(wb.SheetNames,Sheets,!!wb.vbaraw);for(var i2=0;i2<wb.SheetNames.length;++i2)check_ws(wb.Sheets[wb.SheetNames[i2]],wb.SheetNames[i2],i2)}function write_wb_xml(wb){var o2=[XML_HEADER];o2[o2.length]=writextag("workbook",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r});var write_names=wb.Workbook&&(wb.Workbook.Names||[]).length>0,workbookPr={codeName:"ThisWorkbook"};wb.Workbook&&wb.Workbook.WBProps&&(WBPropsDef.forEach(function(x2){wb.Workbook.WBProps[x2[0]]!=null&&wb.Workbook.WBProps[x2[0]]!=x2[1]&&(workbookPr[x2[0]]=wb.Workbook.WBProps[x2[0]])}),wb.Workbook.WBProps.CodeName&&(workbookPr.codeName=wb.Workbook.WBProps.CodeName,delete workbookPr.CodeName)),o2[o2.length]=writextag("workbookPr",null,workbookPr);var sheets=wb.Workbook&&wb.Workbook.Sheets||[],i2=0;if(sheets&&sheets[0]&&sheets[0].Hidden){for(o2[o2.length]="<bookViews>",i2=0;i2!=wb.SheetNames.length&&!(!sheets[i2]||!sheets[i2].Hidden);++i2);i2==wb.SheetNames.length&&(i2=0),o2[o2.length]='<workbookView firstSheet="'+i2+'" activeTab="'+i2+'"/>',o2[o2.length]="</bookViews>"}for(o2[o2.length]="<sheets>",i2=0;i2!=wb.SheetNames.length;++i2){var sht={name:escapexml(wb.SheetNames[i2].slice(0,31))};if(sht.sheetId=""+(i2+1),sht["r:id"]="rId"+(i2+1),sheets[i2])switch(sheets[i2].Hidden){case 1:sht.state="hidden";break;case 2:sht.state="veryHidden";break}o2[o2.length]=writextag("sheet",null,sht)}return o2[o2.length]="</sheets>",write_names&&(o2[o2.length]="<definedNames>",wb.Workbook&&wb.Workbook.Names&&wb.Workbook.Names.forEach(function(n){var d2={name:n.Name};n.Comment&&(d2.comment=n.Comment),n.Sheet!=null&&(d2.localSheetId=""+n.Sheet),n.Hidden&&(d2.hidden="1"),n.Ref&&(o2[o2.length]=writextag("definedName",escapexml(n.Ref),d2))}),o2[o2.length]="</definedNames>"),o2.length>2&&(o2[o2.length]="</workbook>",o2[1]=o2[1].replace("/>",">")),o2.join("")}function parse_BrtBundleSh(data,length){var z2={};return z2.Hidden=data.read_shift(4),z2.iTabID=data.read_shift(4),z2.strRelID=parse_RelID(data),z2.name=parse_XLWideString(data),z2}function write_BrtBundleSh(data,o2){return o2||(o2=new_buf(127)),o2.write_shift(4,data.Hidden),o2.write_shift(4,data.iTabID),write_RelID(data.strRelID,o2),write_XLWideString(data.name.slice(0,31),o2),o2.length>o2.l?o2.slice(0,o2.l):o2}function parse_BrtWbProp(data,length){var o2={},flags=data.read_shift(4);o2.defaultThemeVersion=data.read_shift(4);var strName=length>8?parse_XLWideString(data):"";return strName.length>0&&(o2.CodeName=strName),o2.autoCompressPictures=!!(flags&65536),o2.backupFile=!!(flags&64),o2.checkCompatibility=!!(flags&4096),o2.date1904=!!(flags&1),o2.filterPrivacy=!!(flags&8),o2.hidePivotFieldList=!!(flags&1024),o2.promptedSolutions=!!(flags&16),o2.publishItems=!!(flags&2048),o2.refreshAllConnections=!!(flags&262144),o2.saveExternalLinkValues=!!(flags&128),o2.showBorderUnselectedTables=!!(flags&4),o2.showInkAnnotation=!!(flags&32),o2.showObjects=["all","placeholders","none"][flags>>13&3],o2.showPivotChartFilter=!!(flags&32768),o2.updateLinks=["userSet","never","always"][flags>>8&3],o2}function write_BrtWbProp(data,o2){o2||(o2=new_buf(72));var flags=0;return data&&data.filterPrivacy&&(flags|=8),o2.write_shift(4,flags),o2.write_shift(4,0),write_XLSBCodeName(data&&data.CodeName||"ThisWorkbook",o2),o2.slice(0,o2.l)}function parse_BrtName(data,length,opts){var end=data.l+length;data.l+=4,data.l+=1;var itab=data.read_shift(4),name=parse_XLNameWideString(data),formula=parse_XLSBNameParsedFormula(data,0,opts),comment=parse_XLNullableWideString(data);data.l=end;var out={Name:name,Ptg:formula};return itab<268435455&&(out.Sheet=itab),comment&&(out.Comment=comment),out}function write_BUNDLESHS(ba,wb){write_record(ba,143);for(var idx=0;idx!=wb.SheetNames.length;++idx){var viz=wb.Workbook&&wb.Workbook.Sheets&&wb.Workbook.Sheets[idx]&&wb.Workbook.Sheets[idx].Hidden||0,d2={Hidden:viz,iTabID:idx+1,strRelID:"rId"+(idx+1),name:wb.SheetNames[idx]};write_record(ba,156,write_BrtBundleSh(d2))}write_record(ba,144)}function write_BrtFileVersion(data,o2){o2||(o2=new_buf(127));for(var i2=0;i2!=4;++i2)o2.write_shift(4,0);return write_XLWideString("SheetJS",o2),write_XLWideString(XLSX.version,o2),write_XLWideString(XLSX.version,o2),write_XLWideString("7262",o2),o2.length>o2.l?o2.slice(0,o2.l):o2}function write_BrtBookView(idx,o2){o2||(o2=new_buf(29)),o2.write_shift(-4,0),o2.write_shift(-4,460),o2.write_shift(4,28800),o2.write_shift(4,17600),o2.write_shift(4,500),o2.write_shift(4,idx),o2.write_shift(4,idx);var flags=120;return o2.write_shift(1,flags),o2.length>o2.l?o2.slice(0,o2.l):o2}function write_BOOKVIEWS(ba,wb){if(!(!wb.Workbook||!wb.Workbook.Sheets)){for(var sheets=wb.Workbook.Sheets,i2=0,vistab=-1,hidden=-1;i2<sheets.length;++i2)!sheets[i2]||!sheets[i2].Hidden&&vistab==-1?vistab=i2:sheets[i2].Hidden==1&&hidden==-1&&(hidden=i2);hidden>vistab||(write_record(ba,135),write_record(ba,158,write_BrtBookView(vistab)),write_record(ba,136))}}function write_wb_bin(wb,opts){var ba=buf_array();return write_record(ba,131),write_record(ba,128,write_BrtFileVersion()),write_record(ba,153,write_BrtWbProp(wb.Workbook&&wb.Workbook.WBProps||null)),write_BOOKVIEWS(ba,wb),write_BUNDLESHS(ba,wb),write_record(ba,132),ba.end()}function write_wb(wb,name,opts){return(name.slice(-4)===".bin"?write_wb_bin:write_wb_xml)(wb)}function write_ws(data,name,opts,wb,rels){return(name.slice(-4)===".bin"?write_ws_bin:write_ws_xml)(data,opts,wb,rels)}function write_sty(data,name,opts){return(name.slice(-4)===".bin"?write_sty_bin:write_sty_xml)(data,opts)}function write_sst(data,name,opts){return(name.slice(-4)===".bin"?write_sst_bin:write_sst_xml)(data,opts)}function write_cmnt(data,name,opts){return(name.slice(-4)===".bin"?write_comments_bin:write_comments_xml)(data)}function write_xlmeta(name){return(name.slice(-4)===".bin"?write_xlmeta_bin:write_xlmeta_xml)()}function write_props_xlml(wb,opts){var o2=[];return wb.Props&&o2.push(xlml_write_docprops(wb.Props,opts)),wb.Custprops&&o2.push(xlml_write_custprops(wb.Props,wb.Custprops)),o2.join("")}function write_wb_xlml(){return""}function write_sty_xlml(wb,opts){var styles=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return opts.cellXfs.forEach(function(xf,id){var payload=[];payload.push(writextag("NumberFormat",null,{"ss:Format":escapexml(table_fmt[xf.numFmtId])}));var o2={"ss:ID":"s"+(21+id)};styles.push(writextag("Style",payload.join(""),o2))}),writextag("Styles",styles.join(""))}function write_name_xlml(n){return writextag("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+a1_to_rc(n.Ref,{r:0,c:0})})}function write_names_xlml(wb){if(!((wb||{}).Workbook||{}).Names)return"";for(var names=wb.Workbook.Names,out=[],i2=0;i2<names.length;++i2){var n=names[i2];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||out.push(write_name_xlml(n)))}return writextag("Names",out.join(""))}function write_ws_xlml_names(ws,opts,idx,wb){if(!ws||!((wb||{}).Workbook||{}).Names)return"";for(var names=wb.Workbook.Names,out=[],i2=0;i2<names.length;++i2){var n=names[i2];n.Sheet==idx&&(n.Name.match(/^_xlfn\./)||out.push(write_name_xlml(n)))}return out.join("")}function write_ws_xlml_wsopts(ws,opts,idx,wb){if(!ws)return"";var o2=[];if(ws["!margins"]&&(o2.push("<PageSetup>"),ws["!margins"].header&&o2.push(writextag("Header",null,{"x:Margin":ws["!margins"].header})),ws["!margins"].footer&&o2.push(writextag("Footer",null,{"x:Margin":ws["!margins"].footer})),o2.push(writextag("PageMargins",null,{"x:Bottom":ws["!margins"].bottom||"0.75","x:Left":ws["!margins"].left||"0.7","x:Right":ws["!margins"].right||"0.7","x:Top":ws["!margins"].top||"0.75"})),o2.push("</PageSetup>")),wb&&wb.Workbook&&wb.Workbook.Sheets&&wb.Workbook.Sheets[idx])if(wb.Workbook.Sheets[idx].Hidden)o2.push(writextag("Visible",wb.Workbook.Sheets[idx].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i2=0;i2<idx&&!(wb.Workbook.Sheets[i2]&&!wb.Workbook.Sheets[i2].Hidden);++i2);i2==idx&&o2.push("<Selected/>")}return((((wb||{}).Workbook||{}).Views||[])[0]||{}).RTL&&o2.push("<DisplayRightToLeft/>"),ws["!protect"]&&(o2.push(writetag("ProtectContents","True")),ws["!protect"].objects&&o2.push(writetag("ProtectObjects","True")),ws["!protect"].scenarios&&o2.push(writetag("ProtectScenarios","True")),ws["!protect"].selectLockedCells!=null&&!ws["!protect"].selectLockedCells?o2.push(writetag("EnableSelection","NoSelection")):ws["!protect"].selectUnlockedCells!=null&&!ws["!protect"].selectUnlockedCells&&o2.push(writetag("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(x2){ws["!protect"][x2[0]]&&o2.push("<"+x2[1]+"/>")})),o2.length==0?"":writextag("WorksheetOptions",o2.join(""),{xmlns:XLMLNS.x})}function write_ws_xlml_comment(comments){return comments.map(function(c2){var t2=xlml_unfixstr(c2.t||""),d2=writextag("ss:Data",t2,{xmlns:"http://www.w3.org/TR/REC-html40"});return writextag("Comment",d2,{"ss:Author":c2.a})}).join("")}function write_ws_xlml_cell(cell,ref,ws,opts,idx,wb,addr){if(!cell||cell.v==null&&cell.f==null)return"";var attr={};if(cell.f&&(attr["ss:Formula"]="="+escapexml(a1_to_rc(cell.f,addr))),cell.F&&cell.F.slice(0,ref.length)==ref){var end=decode_cell(cell.F.slice(ref.length+1));attr["ss:ArrayRange"]="RC:R"+(end.r==addr.r?"":"["+(end.r-addr.r)+"]")+"C"+(end.c==addr.c?"":"["+(end.c-addr.c)+"]")}if(cell.l&&cell.l.Target&&(attr["ss:HRef"]=escapexml(cell.l.Target),cell.l.Tooltip&&(attr["x:HRefScreenTip"]=escapexml(cell.l.Tooltip))),ws["!merges"])for(var marr=ws["!merges"],mi=0;mi!=marr.length;++mi)marr[mi].s.c!=addr.c||marr[mi].s.r!=addr.r||(marr[mi].e.c>marr[mi].s.c&&(attr["ss:MergeAcross"]=marr[mi].e.c-marr[mi].s.c),marr[mi].e.r>marr[mi].s.r&&(attr["ss:MergeDown"]=marr[mi].e.r-marr[mi].s.r));var t2="",p2="";switch(cell.t){case"z":if(!opts.sheetStubs)return"";break;case"n":t2="Number",p2=String(cell.v);break;case"b":t2="Boolean",p2=cell.v?"1":"0";break;case"e":t2="Error",p2=BErr[cell.v];break;case"d":t2="DateTime",p2=new Date(cell.v).toISOString(),cell.z==null&&(cell.z=cell.z||table_fmt[14]);break;case"s":t2="String",p2=escapexlml(cell.v||"");break}var os=get_cell_style(opts.cellXfs,cell,opts);attr["ss:StyleID"]="s"+(21+os),attr["ss:Index"]=addr.c+1;var _v=cell.v!=null?p2:"",m2=cell.t=="z"?"":'<Data ss:Type="'+t2+'">'+_v+"</Data>";return(cell.c||[]).length>0&&(m2+=write_ws_xlml_comment(cell.c)),writextag("Cell",m2,attr)}function write_ws_xlml_row(R2,row){var o2='<Row ss:Index="'+(R2+1)+'"';return row&&(row.hpt&&!row.hpx&&(row.hpx=pt2px(row.hpt)),row.hpx&&(o2+=' ss:AutoFitHeight="0" ss:Height="'+row.hpx+'"'),row.hidden&&(o2+=' ss:Hidden="1"')),o2+">"}function write_ws_xlml_table(ws,opts,idx,wb){if(!ws["!ref"])return"";var range=safe_decode_range(ws["!ref"]),marr=ws["!merges"]||[],mi=0,o2=[];ws["!cols"]&&ws["!cols"].forEach(function(n,i2){process_col(n);var w2=!!n.width,p2=col_obj_w(i2,n),k2={"ss:Index":i2+1};w2&&(k2["ss:Width"]=width2px(p2.width)),n.hidden&&(k2["ss:Hidden"]="1"),o2.push(writextag("Column",null,k2))});for(var dense=Array.isArray(ws),R2=range.s.r;R2<=range.e.r;++R2){for(var row=[write_ws_xlml_row(R2,(ws["!rows"]||[])[R2])],C2=range.s.c;C2<=range.e.c;++C2){var skip=!1;for(mi=0;mi!=marr.length;++mi)if(!(marr[mi].s.c>C2)&&!(marr[mi].s.r>R2)&&!(marr[mi].e.c<C2)&&!(marr[mi].e.r<R2)){(marr[mi].s.c!=C2||marr[mi].s.r!=R2)&&(skip=!0);break}if(!skip){var addr={r:R2,c:C2},ref=encode_cell(addr),cell=dense?(ws[R2]||[])[C2]:ws[ref];row.push(write_ws_xlml_cell(cell,ref,ws,opts,idx,wb,addr))}}row.push("</Row>"),row.length>2&&o2.push(row.join(""))}return o2.join("")}function write_ws_xlml(idx,opts,wb){var o2=[],s2=wb.SheetNames[idx],ws=wb.Sheets[s2],t2=ws?write_ws_xlml_names(ws,opts,idx,wb):"";return t2.length>0&&o2.push("<Names>"+t2+"</Names>"),t2=ws?write_ws_xlml_table(ws,opts,idx,wb):"",t2.length>0&&o2.push("<Table>"+t2+"</Table>"),o2.push(write_ws_xlml_wsopts(ws,opts,idx,wb)),o2.join("")}function write_xlml(wb,opts){opts||(opts={}),wb.SSF||(wb.SSF=dup(table_fmt)),wb.SSF&&(make_ssf(),SSF_load_table(wb.SSF),opts.revssf=evert_num(wb.SSF),opts.revssf[wb.SSF[65535]]=0,opts.ssf=wb.SSF,opts.cellXfs=[],get_cell_style(opts.cellXfs,{},{revssf:{General:0}}));var d2=[];d2.push(write_props_xlml(wb,opts)),d2.push(write_wb_xlml()),d2.push(""),d2.push("");for(var i2=0;i2<wb.SheetNames.length;++i2)d2.push(writextag("Worksheet",write_ws_xlml(i2,opts,wb),{"ss:Name":escapexml(wb.SheetNames[i2])}));return d2[2]=write_sty_xlml(wb,opts),d2[3]=write_names_xlml(wb),XML_HEADER+writextag("Workbook",d2.join(""),{xmlns:XLMLNS.ss,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:ss":XLMLNS.ss,"xmlns:dt":XLMLNS.dt,"xmlns:html":XLMLNS.html})}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function write_xls_props(wb,cfb){var DSEntries=[],SEntries=[],CEntries=[],i2=0,Keys,DocSummaryRE=evert_key(DocSummaryPIDDSI,"n"),SummaryRE=evert_key(SummaryPIDSI,"n");if(wb.Props)for(Keys=keys(wb.Props),i2=0;i2<Keys.length;++i2)(Object.prototype.hasOwnProperty.call(DocSummaryRE,Keys[i2])?DSEntries:Object.prototype.hasOwnProperty.call(SummaryRE,Keys[i2])?SEntries:CEntries).push([Keys[i2],wb.Props[Keys[i2]]]);if(wb.Custprops)for(Keys=keys(wb.Custprops),i2=0;i2<Keys.length;++i2)Object.prototype.hasOwnProperty.call(wb.Props||{},Keys[i2])||(Object.prototype.hasOwnProperty.call(DocSummaryRE,Keys[i2])?DSEntries:Object.prototype.hasOwnProperty.call(SummaryRE,Keys[i2])?SEntries:CEntries).push([Keys[i2],wb.Custprops[Keys[i2]]]);var CEntries2=[];for(i2=0;i2<CEntries.length;++i2)XLSPSSkip.indexOf(CEntries[i2][0])>-1||PseudoPropsPairs.indexOf(CEntries[i2][0])>-1||CEntries[i2][1]!=null&&CEntries2.push(CEntries[i2]);SEntries.length&&CFB.utils.cfb_add(cfb,"/SummaryInformation",write_PropertySetStream(SEntries,PSCLSID.SI,SummaryRE,SummaryPIDSI)),(DSEntries.length||CEntries2.length)&&CFB.utils.cfb_add(cfb,"/DocumentSummaryInformation",write_PropertySetStream(DSEntries,PSCLSID.DSI,DocSummaryRE,DocSummaryPIDDSI,CEntries2.length?CEntries2:null,PSCLSID.UDI))}function write_xlscfb(wb,opts){var o2=opts||{},cfb=CFB.utils.cfb_new({root:"R"}),wbpath="/Workbook";switch(o2.bookType||"xls"){case"xls":o2.bookType="biff8";case"xla":o2.bookType||(o2.bookType="xla");case"biff8":wbpath="/Workbook",o2.biff=8;break;case"biff5":wbpath="/Book",o2.biff=5;break;default:throw new Error("invalid type "+o2.bookType+" for XLS CFB")}return CFB.utils.cfb_add(cfb,wbpath,write_biff_buf(wb,o2)),o2.biff==8&&(wb.Props||wb.Custprops)&&write_xls_props(wb,cfb),o2.biff==8&&wb.vbaraw&&fill_vba_xls(cfb,CFB.read(wb.vbaraw,{type:typeof wb.vbaraw=="string"?"binary":"buffer"})),cfb}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function write_biff_rec(ba,type,payload,length){var t2=type;if(!isNaN(t2)){var len=length||(payload||[]).length||0,o2=ba.next(4);o2.write_shift(2,t2),o2.write_shift(2,len),len>0&&is_buf(payload)&&ba.push(payload)}}function write_biff_continue(ba,type,payload,length){var len=(payload||[]).length||0;if(len<=8224)return write_biff_rec(ba,type,payload,len);var t2=type;if(!isNaN(t2)){for(var parts=payload.parts||[],sidx=0,i2=0,w2=0;w2+(parts[sidx]||8224)<=8224;)w2+=parts[sidx]||8224,sidx++;var o2=ba.next(4);for(o2.write_shift(2,t2),o2.write_shift(2,w2),ba.push(payload.slice(i2,i2+w2)),i2+=w2;i2<len;){for(o2=ba.next(4),o2.write_shift(2,60),w2=0;w2+(parts[sidx]||8224)<=8224;)w2+=parts[sidx]||8224,sidx++;o2.write_shift(2,w2),ba.push(payload.slice(i2,i2+w2)),i2+=w2}}}function write_BIFF2Cell(out,r,c2){return out||(out=new_buf(7)),out.write_shift(2,r),out.write_shift(2,c2),out.write_shift(2,0),out.write_shift(1,0),out}function write_BIFF2BERR(r,c2,val,t2){var out=new_buf(9);return write_BIFF2Cell(out,r,c2),write_Bes(val,t2||"b",out),out}function write_BIFF2LABEL(r,c2,val){var out=new_buf(8+2*val.length);return write_BIFF2Cell(out,r,c2),out.write_shift(1,val.length),out.write_shift(val.length,val,"sbcs"),out.l<out.length?out.slice(0,out.l):out}function write_ws_biff2_cell(ba,cell,R2,C2){if(cell.v!=null)switch(cell.t){case"d":case"n":var v2=cell.t=="d"?datenum(parseDate(cell.v)):cell.v;v2==(v2|0)&&v2>=0&&v2<65536?write_biff_rec(ba,2,write_BIFF2INT(R2,C2,v2)):write_biff_rec(ba,3,write_BIFF2NUM(R2,C2,v2));return;case"b":case"e":write_biff_rec(ba,5,write_BIFF2BERR(R2,C2,cell.v,cell.t));return;case"s":case"str":write_biff_rec(ba,4,write_BIFF2LABEL(R2,C2,(cell.v||"").slice(0,255)));return}write_biff_rec(ba,1,write_BIFF2Cell(null,R2,C2))}function write_ws_biff2(ba,ws,idx,opts){var dense=Array.isArray(ws),range=safe_decode_range(ws["!ref"]||"A1"),ref,rr="",cols=[];if(range.e.c>255||range.e.r>16383){if(opts.WTF)throw new Error("Range "+(ws["!ref"]||"A1")+" exceeds format limit A1:IV16384");range.e.c=Math.min(range.e.c,255),range.e.r=Math.min(range.e.c,16383),ref=encode_range(range)}for(var R2=range.s.r;R2<=range.e.r;++R2){rr=encode_row(R2);for(var C2=range.s.c;C2<=range.e.c;++C2){R2===range.s.r&&(cols[C2]=encode_col(C2)),ref=cols[C2]+rr;var cell=dense?(ws[R2]||[])[C2]:ws[ref];cell&&write_ws_biff2_cell(ba,cell,R2,C2)}}}function write_biff2_buf(wb,opts){for(var o2=opts||{},ba=buf_array(),idx=0,i2=0;i2<wb.SheetNames.length;++i2)wb.SheetNames[i2]==o2.sheet&&(idx=i2);if(idx==0&&o2.sheet&&wb.SheetNames[0]!=o2.sheet)throw new Error("Sheet not found: "+o2.sheet);return write_biff_rec(ba,o2.biff==4?1033:o2.biff==3?521:9,write_BOF(wb,16,o2)),write_ws_biff2(ba,wb.Sheets[wb.SheetNames[idx]],idx,o2),write_biff_rec(ba,10),ba.end()}function write_FONTS_biff8(ba,data,opts){write_biff_rec(ba,49,write_Font({sz:12,name:"Arial"},opts))}function write_FMTS_biff8(ba,NF,opts){NF&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i2=r[0];i2<=r[1];++i2)NF[i2]!=null&&write_biff_rec(ba,1054,write_Format(i2,NF[i2],opts))})}function write_FEAT(ba,ws){var o2=new_buf(19);o2.write_shift(4,2151),o2.write_shift(4,0),o2.write_shift(4,0),o2.write_shift(2,3),o2.write_shift(1,1),o2.write_shift(4,0),write_biff_rec(ba,2151,o2),o2=new_buf(39),o2.write_shift(4,2152),o2.write_shift(4,0),o2.write_shift(4,0),o2.write_shift(2,3),o2.write_shift(1,0),o2.write_shift(4,0),o2.write_shift(2,1),o2.write_shift(4,4),o2.write_shift(2,0),write_Ref8U(safe_decode_range(ws["!ref"]||"A1"),o2),o2.write_shift(4,4),write_biff_rec(ba,2152,o2)}function write_CELLXFS_biff8(ba,opts){for(var i2=0;i2<16;++i2)write_biff_rec(ba,224,write_XF({numFmtId:0,style:!0},0,opts));opts.cellXfs.forEach(function(c2){write_biff_rec(ba,224,write_XF(c2,0,opts))})}function write_ws_biff8_hlinks(ba,ws){for(var R2=0;R2<ws["!links"].length;++R2){var HL=ws["!links"][R2];write_biff_rec(ba,440,write_HLink(HL)),HL[1].Tooltip&&write_biff_rec(ba,2048,write_HLinkTooltip(HL))}delete ws["!links"]}function write_ws_cols_biff8(ba,cols){if(cols){var cnt=0;cols.forEach(function(col,idx){++cnt<=256&&col&&write_biff_rec(ba,125,write_ColInfo(col_obj_w(idx,col),idx))})}}function write_ws_biff8_cell(ba,cell,R2,C2,opts){var os=16+get_cell_style(opts.cellXfs,cell,opts);if(cell.v==null&&!cell.bf){write_biff_rec(ba,513,write_XLSCell(R2,C2,os));return}if(cell.bf)write_biff_rec(ba,6,write_Formula(cell,R2,C2,opts,os));else switch(cell.t){case"d":case"n":var v2=cell.t=="d"?datenum(parseDate(cell.v)):cell.v;write_biff_rec(ba,515,write_Number(R2,C2,v2,os));break;case"b":case"e":write_biff_rec(ba,517,write_BoolErr(R2,C2,cell.v,os,opts,cell.t));break;case"s":case"str":if(opts.bookSST){var isst=get_sst_id(opts.Strings,cell.v,opts.revStrings);write_biff_rec(ba,253,write_LabelSst(R2,C2,isst,os))}else write_biff_rec(ba,516,write_Label(R2,C2,(cell.v||"").slice(0,255),os,opts));break;default:write_biff_rec(ba,513,write_XLSCell(R2,C2,os))}}function write_ws_biff8(idx,opts,wb){var ba=buf_array(),s2=wb.SheetNames[idx],ws=wb.Sheets[s2]||{},_WB=(wb||{}).Workbook||{},_sheet=(_WB.Sheets||[])[idx]||{},dense=Array.isArray(ws),b8=opts.biff==8,ref,rr="",cols=[],range=safe_decode_range(ws["!ref"]||"A1"),MAX_ROWS=b8?65536:16384;if(range.e.c>255||range.e.r>=MAX_ROWS){if(opts.WTF)throw new Error("Range "+(ws["!ref"]||"A1")+" exceeds format limit A1:IV16384");range.e.c=Math.min(range.e.c,255),range.e.r=Math.min(range.e.c,MAX_ROWS-1)}write_biff_rec(ba,2057,write_BOF(wb,16,opts)),write_biff_rec(ba,13,writeuint16(1)),write_biff_rec(ba,12,writeuint16(100)),write_biff_rec(ba,15,writebool(!0)),write_biff_rec(ba,17,writebool(!1)),write_biff_rec(ba,16,write_Xnum(.001)),write_biff_rec(ba,95,writebool(!0)),write_biff_rec(ba,42,writebool(!1)),write_biff_rec(ba,43,writebool(!1)),write_biff_rec(ba,130,writeuint16(1)),write_biff_rec(ba,128,write_Guts()),write_biff_rec(ba,131,writebool(!1)),write_biff_rec(ba,132,writebool(!1)),b8&&write_ws_cols_biff8(ba,ws["!cols"]),write_biff_rec(ba,512,write_Dimensions(range,opts)),b8&&(ws["!links"]=[]);for(var R2=range.s.r;R2<=range.e.r;++R2){rr=encode_row(R2);for(var C2=range.s.c;C2<=range.e.c;++C2){R2===range.s.r&&(cols[C2]=encode_col(C2)),ref=cols[C2]+rr;var cell=dense?(ws[R2]||[])[C2]:ws[ref];cell&&(write_ws_biff8_cell(ba,cell,R2,C2,opts),b8&&cell.l&&ws["!links"].push([ref,cell.l]))}}var cname=_sheet.CodeName||_sheet.name||s2;return b8&&write_biff_rec(ba,574,write_Window2((_WB.Views||[])[0])),b8&&(ws["!merges"]||[]).length&&write_biff_rec(ba,229,write_MergeCells(ws["!merges"])),b8&&write_ws_biff8_hlinks(ba,ws),write_biff_rec(ba,442,write_XLUnicodeString(cname)),b8&&write_FEAT(ba,ws),write_biff_rec(ba,10),ba.end()}function write_biff8_global(wb,bufs,opts){var A2=buf_array(),_WB=(wb||{}).Workbook||{},_sheets=_WB.Sheets||[],_wb=_WB.WBProps||{},b8=opts.biff==8,b5=opts.biff==5;if(write_biff_rec(A2,2057,write_BOF(wb,5,opts)),opts.bookType=="xla"&&write_biff_rec(A2,135),write_biff_rec(A2,225,b8?writeuint16(1200):null),write_biff_rec(A2,193,writezeroes(2)),b5&&write_biff_rec(A2,191),b5&&write_biff_rec(A2,192),write_biff_rec(A2,226),write_biff_rec(A2,92,write_WriteAccess("SheetJS",opts)),write_biff_rec(A2,66,writeuint16(b8?1200:1252)),b8&&write_biff_rec(A2,353,writeuint16(0)),b8&&write_biff_rec(A2,448),write_biff_rec(A2,317,write_RRTabId(wb.SheetNames.length)),b8&&wb.vbaraw&&write_biff_rec(A2,211),b8&&wb.vbaraw){var cname=_wb.CodeName||"ThisWorkbook";write_biff_rec(A2,442,write_XLUnicodeString(cname))}write_biff_rec(A2,156,writeuint16(17)),write_biff_rec(A2,25,writebool(!1)),write_biff_rec(A2,18,writebool(!1)),write_biff_rec(A2,19,writeuint16(0)),b8&&write_biff_rec(A2,431,writebool(!1)),b8&&write_biff_rec(A2,444,writeuint16(0)),write_biff_rec(A2,61,write_Window1()),write_biff_rec(A2,64,writebool(!1)),write_biff_rec(A2,141,writeuint16(0)),write_biff_rec(A2,34,writebool(safe1904(wb)=="true")),write_biff_rec(A2,14,writebool(!0)),b8&&write_biff_rec(A2,439,writebool(!1)),write_biff_rec(A2,218,writeuint16(0)),write_FONTS_biff8(A2,wb,opts),write_FMTS_biff8(A2,wb.SSF,opts),write_CELLXFS_biff8(A2,opts),b8&&write_biff_rec(A2,352,writebool(!1));var a2=A2.end(),C2=buf_array();b8&&write_biff_rec(C2,140,write_Country()),b8&&opts.Strings&&write_biff_continue(C2,252,write_SST(opts.Strings)),write_biff_rec(C2,10);var c2=C2.end(),B2=buf_array(),blen=0,j2=0;for(j2=0;j2<wb.SheetNames.length;++j2)blen+=(b8?12:11)+(b8?2:1)*wb.SheetNames[j2].length;var start=a2.length+blen+c2.length;for(j2=0;j2<wb.SheetNames.length;++j2){var _sheet=_sheets[j2]||{};write_biff_rec(B2,133,write_BoundSheet8({pos:start,hs:_sheet.Hidden||0,dt:0,name:wb.SheetNames[j2]},opts)),start+=bufs[j2].length}var b2=B2.end();if(blen!=b2.length)throw new Error("BS8 "+blen+" != "+b2.length);var out=[];return a2.length&&out.push(a2),b2.length&&out.push(b2),c2.length&&out.push(c2),bconcat(out)}function write_biff8_buf(wb,opts){var o2=opts||{},bufs=[];wb&&!wb.SSF&&(wb.SSF=dup(table_fmt)),wb&&wb.SSF&&(make_ssf(),SSF_load_table(wb.SSF),o2.revssf=evert_num(wb.SSF),o2.revssf[wb.SSF[65535]]=0,o2.ssf=wb.SSF),o2.Strings=[],o2.Strings.Count=0,o2.Strings.Unique=0,fix_write_opts(o2),o2.cellXfs=[],get_cell_style(o2.cellXfs,{},{revssf:{General:0}}),wb.Props||(wb.Props={});for(var i2=0;i2<wb.SheetNames.length;++i2)bufs[bufs.length]=write_ws_biff8(i2,o2,wb);return bufs.unshift(write_biff8_global(wb,bufs,o2)),bconcat(bufs)}function write_biff_buf(wb,opts){for(var i2=0;i2<=wb.SheetNames.length;++i2){var ws=wb.Sheets[wb.SheetNames[i2]];if(!(!ws||!ws["!ref"])){var range=decode_range(ws["!ref"]);range.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+wb.SheetNames[i2]+"' extends beyond column IV (255).  Data may be lost.")}}var o2=opts||{};switch(o2.biff||2){case 8:case 5:return write_biff8_buf(wb,opts);case 4:case 3:case 2:return write_biff2_buf(wb,opts)}throw new Error("invalid type "+o2.bookType+" for BIFF")}function make_html_row(ws,r,R2,o2){for(var M2=ws["!merges"]||[],oo=[],C2=r.s.c;C2<=r.e.c;++C2){for(var RS=0,CS=0,j2=0;j2<M2.length;++j2)if(!(M2[j2].s.r>R2||M2[j2].s.c>C2)&&!(M2[j2].e.r<R2||M2[j2].e.c<C2)){if(M2[j2].s.r<R2||M2[j2].s.c<C2){RS=-1;break}RS=M2[j2].e.r-M2[j2].s.r+1,CS=M2[j2].e.c-M2[j2].s.c+1;break}if(!(RS<0)){var coord=encode_cell({r:R2,c:C2}),cell=o2.dense?(ws[R2]||[])[C2]:ws[coord],w2=cell&&cell.v!=null&&(cell.h||escapehtml(cell.w||(format_cell(cell),cell.w)||""))||"",sp={};RS>1&&(sp.rowspan=RS),CS>1&&(sp.colspan=CS),o2.editable?w2='<span contenteditable="true">'+w2+"</span>":cell&&(sp["data-t"]=cell&&cell.t||"z",cell.v!=null&&(sp["data-v"]=cell.v),cell.z!=null&&(sp["data-z"]=cell.z),cell.l&&(cell.l.Target||"#").charAt(0)!="#"&&(w2='<a href="'+cell.l.Target+'">'+w2+"</a>")),sp.id=(o2.id||"sjs")+"-"+coord,oo.push(writextag("td",w2,sp))}}var preamble="<tr>";return preamble+oo.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function make_html_preamble(ws,R2,o2){var out=[];return out.join("")+"<table"+(o2&&o2.id?' id="'+o2.id+'"':"")+">"}function sheet_to_html(ws,opts){var o2=opts||{},header=o2.header!=null?o2.header:HTML_BEGIN,footer=o2.footer!=null?o2.footer:HTML_END,out=[header],r=decode_range(ws["!ref"]);o2.dense=Array.isArray(ws),out.push(make_html_preamble(ws,r,o2));for(var R2=r.s.r;R2<=r.e.r;++R2)out.push(make_html_row(ws,r,R2,o2));return out.push("</table>"+footer),out.join("")}function sheet_add_dom(ws,table,_opts){var opts=_opts||{},or_R=0,or_C=0;if(opts.origin!=null)if(typeof opts.origin=="number")or_R=opts.origin;else{var _origin=typeof opts.origin=="string"?decode_cell(opts.origin):opts.origin;or_R=_origin.r,or_C=_origin.c}var rows=table.getElementsByTagName("tr"),sheetRows=Math.min(opts.sheetRows||1e7,rows.length),range={s:{r:0,c:0},e:{r:or_R,c:or_C}};if(ws["!ref"]){var _range=decode_range(ws["!ref"]);range.s.r=Math.min(range.s.r,_range.s.r),range.s.c=Math.min(range.s.c,_range.s.c),range.e.r=Math.max(range.e.r,_range.e.r),range.e.c=Math.max(range.e.c,_range.e.c),or_R==-1&&(range.e.r=or_R=_range.e.r+1)}var merges=[],midx=0,rowinfo=ws["!rows"]||(ws["!rows"]=[]),_R=0,R2=0,_C=0,C2=0,RS=0,CS=0;for(ws["!cols"]||(ws["!cols"]=[]);_R<rows.length&&R2<sheetRows;++_R){var row=rows[_R];if(is_dom_element_hidden(row)){if(opts.display)continue;rowinfo[R2]={hidden:!0}}var elts=row.children;for(_C=C2=0;_C<elts.length;++_C){var elt=elts[_C];if(!(opts.display&&is_dom_element_hidden(elt))){var v2=elt.hasAttribute("data-v")?elt.getAttribute("data-v"):elt.hasAttribute("v")?elt.getAttribute("v"):htmldecode(elt.innerHTML),z2=elt.getAttribute("data-z")||elt.getAttribute("z");for(midx=0;midx<merges.length;++midx){var m2=merges[midx];m2.s.c==C2+or_C&&m2.s.r<R2+or_R&&R2+or_R<=m2.e.r&&(C2=m2.e.c+1-or_C,midx=-1)}CS=+elt.getAttribute("colspan")||1,((RS=+elt.getAttribute("rowspan")||1)>1||CS>1)&&merges.push({s:{r:R2+or_R,c:C2+or_C},e:{r:R2+or_R+(RS||1)-1,c:C2+or_C+(CS||1)-1}});var o2={t:"s",v:v2},_t2=elt.getAttribute("data-t")||elt.getAttribute("t")||"";v2!=null&&(v2.length==0?o2.t=_t2||"z":opts.raw||v2.trim().length==0||_t2=="s"||(v2==="TRUE"?o2={t:"b",v:!0}:v2==="FALSE"?o2={t:"b",v:!1}:isNaN(fuzzynum(v2))?isNaN(fuzzydate(v2).getDate())||(o2={t:"d",v:parseDate(v2)},opts.cellDates||(o2={t:"n",v:datenum(o2.v)}),o2.z=opts.dateNF||table_fmt[14]):o2={t:"n",v:fuzzynum(v2)})),o2.z===void 0&&z2!=null&&(o2.z=z2);var l2="",Aelts=elt.getElementsByTagName("A");if(Aelts&&Aelts.length)for(var Aelti=0;Aelti<Aelts.length&&!(Aelts[Aelti].hasAttribute("href")&&(l2=Aelts[Aelti].getAttribute("href"),l2.charAt(0)!="#"));++Aelti);l2&&l2.charAt(0)!="#"&&(o2.l={Target:l2}),opts.dense?(ws[R2+or_R]||(ws[R2+or_R]=[]),ws[R2+or_R][C2+or_C]=o2):ws[encode_cell({c:C2+or_C,r:R2+or_R})]=o2,range.e.c<C2+or_C&&(range.e.c=C2+or_C),C2+=CS}}++R2}return merges.length&&(ws["!merges"]=(ws["!merges"]||[]).concat(merges)),range.e.r=Math.max(range.e.r,R2-1+or_R),ws["!ref"]=encode_range(range),R2>=sheetRows&&(ws["!fullref"]=encode_range((range.e.r=rows.length-_R+R2-1+or_R,range))),ws}function parse_dom_table(table,_opts){var opts=_opts||{},ws=opts.dense?[]:{};return sheet_add_dom(ws,table,_opts)}function table_to_book(table,opts){return sheet_to_workbook(parse_dom_table(table,opts),opts)}function is_dom_element_hidden(element){var display="",get_computed_style=get_get_computed_style_function(element);return get_computed_style&&(display=get_computed_style(element).getPropertyValue("display")),display||(display=element.style&&element.style.display),display==="none"}function get_get_computed_style_function(element){return element.ownerDocument.defaultView&&typeof element.ownerDocument.defaultView.getComputedStyle=="function"?element.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var write_styles_ods=(function(){var master_styles=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),payload="<office:document-styles "+wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+master_styles+"</office:document-styles>";return function(){return XML_HEADER+payload}})(),write_content_ods=(function(){var write_text_p=function(text){return escapexml(text).replace(/  +/g,function($$){return'<text:s text:c="'+$$.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},null_cell_xml=`          <table:table-cell />
`,covered_cell_xml=`          <table:covered-table-cell/>
`,write_ws2=function(ws,wb,i2){var o2=[];o2.push('      <table:table table:name="'+escapexml(wb.SheetNames[i2])+`" table:style-name="ta1">
`);var R2=0,C2=0,range=decode_range(ws["!ref"]||"A1"),marr=ws["!merges"]||[],mi=0,dense=Array.isArray(ws);if(ws["!cols"])for(C2=0;C2<=range.e.c;++C2)o2.push("        <table:table-column"+(ws["!cols"][C2]?' table:style-name="co'+ws["!cols"][C2].ods+'"':"")+`></table:table-column>
`);var H2="",ROWS=ws["!rows"]||[];for(R2=0;R2<range.s.r;++R2)H2=ROWS[R2]?' table:style-name="ro'+ROWS[R2].ods+'"':"",o2.push("        <table:table-row"+H2+`></table:table-row>
`);for(;R2<=range.e.r;++R2){for(H2=ROWS[R2]?' table:style-name="ro'+ROWS[R2].ods+'"':"",o2.push("        <table:table-row"+H2+`>
`),C2=0;C2<range.s.c;++C2)o2.push(null_cell_xml);for(;C2<=range.e.c;++C2){var skip=!1,ct2={},textp="";for(mi=0;mi!=marr.length;++mi)if(!(marr[mi].s.c>C2)&&!(marr[mi].s.r>R2)&&!(marr[mi].e.c<C2)&&!(marr[mi].e.r<R2)){(marr[mi].s.c!=C2||marr[mi].s.r!=R2)&&(skip=!0),ct2["table:number-columns-spanned"]=marr[mi].e.c-marr[mi].s.c+1,ct2["table:number-rows-spanned"]=marr[mi].e.r-marr[mi].s.r+1;break}if(skip){o2.push(covered_cell_xml);continue}var ref=encode_cell({r:R2,c:C2}),cell=dense?(ws[R2]||[])[C2]:ws[ref];if(cell&&cell.f&&(ct2["table:formula"]=escapexml(csf_to_ods_formula(cell.f)),cell.F&&cell.F.slice(0,ref.length)==ref)){var _Fref=decode_range(cell.F);ct2["table:number-matrix-columns-spanned"]=_Fref.e.c-_Fref.s.c+1,ct2["table:number-matrix-rows-spanned"]=_Fref.e.r-_Fref.s.r+1}if(!cell){o2.push(null_cell_xml);continue}switch(cell.t){case"b":textp=cell.v?"TRUE":"FALSE",ct2["office:value-type"]="boolean",ct2["office:boolean-value"]=cell.v?"true":"false";break;case"n":textp=cell.w||String(cell.v||0),ct2["office:value-type"]="float",ct2["office:value"]=cell.v||0;break;case"s":case"str":textp=cell.v==null?"":cell.v,ct2["office:value-type"]="string";break;case"d":textp=cell.w||parseDate(cell.v).toISOString(),ct2["office:value-type"]="date",ct2["office:date-value"]=parseDate(cell.v).toISOString(),ct2["table:style-name"]="ce1";break;default:o2.push(null_cell_xml);continue}var text_p=write_text_p(textp);if(cell.l&&cell.l.Target){var _tgt=cell.l.Target;_tgt=_tgt.charAt(0)=="#"?"#"+csf_to_ods_3D(_tgt.slice(1)):_tgt,_tgt.charAt(0)!="#"&&!_tgt.match(/^\w+:/)&&(_tgt="../"+_tgt),text_p=writextag("text:a",text_p,{"xlink:href":_tgt.replace(/&/g,"&amp;")})}o2.push("          "+writextag("table:table-cell",writextag("text:p",text_p,{}),ct2)+`
`)}o2.push(`        </table:table-row>
`)}return o2.push(`      </table:table>
`),o2.join("")},write_automatic_styles_ods=function(o2,wb){o2.push(` <office:automatic-styles>
`),o2.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o2.push(`   <number:month number:style="long"/>
`),o2.push(`   <number:text>/</number:text>
`),o2.push(`   <number:day number:style="long"/>
`),o2.push(`   <number:text>/</number:text>
`),o2.push(`   <number:year/>
`),o2.push(`  </number:date-style>
`);var cidx=0;wb.SheetNames.map(function(n){return wb.Sheets[n]}).forEach(function(ws){if(ws&&ws["!cols"]){for(var C2=0;C2<ws["!cols"].length;++C2)if(ws["!cols"][C2]){var colobj=ws["!cols"][C2];if(colobj.width==null&&colobj.wpx==null&&colobj.wch==null)continue;process_col(colobj),colobj.ods=cidx;var w2=ws["!cols"][C2].wpx+"px";o2.push('  <style:style style:name="co'+cidx+`" style:family="table-column">
`),o2.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+w2+`"/>
`),o2.push(`  </style:style>
`),++cidx}}});var ridx=0;wb.SheetNames.map(function(n){return wb.Sheets[n]}).forEach(function(ws){if(ws&&ws["!rows"]){for(var R2=0;R2<ws["!rows"].length;++R2)if(ws["!rows"][R2]){ws["!rows"][R2].ods=ridx;var h2=ws["!rows"][R2].hpx+"px";o2.push('  <style:style style:name="ro'+ridx+`" style:family="table-row">
`),o2.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h2+`"/>
`),o2.push(`  </style:style>
`),++ridx}}}),o2.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o2.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o2.push(`  </style:style>
`),o2.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o2.push(` </office:automatic-styles>
`)};return function(wb,opts){var o2=[XML_HEADER],attr=wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),fods=wxt_helper({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});opts.bookType=="fods"?(o2.push("<office:document"+attr+fods+`>
`),o2.push(write_meta_ods().replace(/office:document-meta/g,"office:meta"))):o2.push("<office:document-content"+attr+`>
`),write_automatic_styles_ods(o2,wb),o2.push(`  <office:body>
`),o2.push(`    <office:spreadsheet>
`);for(var i2=0;i2!=wb.SheetNames.length;++i2)o2.push(write_ws2(wb.Sheets[wb.SheetNames[i2]],wb,i2));return o2.push(`    </office:spreadsheet>
`),o2.push(`  </office:body>
`),opts.bookType=="fods"?o2.push("</office:document>"):o2.push("</office:document-content>"),o2.join("")}})();function write_ods(wb,opts){if(opts.bookType=="fods")return write_content_ods(wb,opts);var zip=zip_new(),f2="",manifest=[],rdf=[];return f2="mimetype",zip_add_file(zip,f2,"application/vnd.oasis.opendocument.spreadsheet"),f2="content.xml",zip_add_file(zip,f2,write_content_ods(wb,opts)),manifest.push([f2,"text/xml"]),rdf.push([f2,"ContentFile"]),f2="styles.xml",zip_add_file(zip,f2,write_styles_ods(wb,opts)),manifest.push([f2,"text/xml"]),rdf.push([f2,"StylesFile"]),f2="meta.xml",zip_add_file(zip,f2,XML_HEADER+write_meta_ods()),manifest.push([f2,"text/xml"]),rdf.push([f2,"MetadataFile"]),f2="manifest.rdf",zip_add_file(zip,f2,write_rdf(rdf)),manifest.push([f2,"application/rdf+xml"]),f2="META-INF/manifest.xml",zip_add_file(zip,f2,write_manifest(manifest)),zip}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function u8_to_dataview(array){return new DataView(array.buffer,array.byteOffset,array.byteLength)}function stru8(str){return typeof TextEncoder<"u"?new TextEncoder().encode(str):s2a(utf8write(str))}function u8contains(body,search){outer:for(var L2=0;L2<=body.length-search.length;++L2){for(var j2=0;j2<search.length;++j2)if(body[L2+j2]!=search[j2])continue outer;return!0}return!1}function u8concat(u8a){var len=u8a.reduce(function(acc,x2){return acc+x2.length},0),out=new Uint8Array(len),off=0;return u8a.forEach(function(u82){out.set(u82,off),off+=u82.length}),out}function writeDecimal128LE(buf,offset,value){var exp=Math.floor(value==0?0:Math.LOG10E*Math.log(Math.abs(value)))+6176-20,mantissa=value/Math.pow(10,exp-6176);buf[offset+15]|=exp>>7,buf[offset+14]|=(exp&127)<<1;for(var i2=0;mantissa>=1;++i2,mantissa/=256)buf[offset+i2]=mantissa&255;buf[offset+15]|=value>=0?0:128}function parse_varint49(buf,ptr){var l2=ptr?ptr[0]:0,usz=buf[l2]&127;varint:if(buf[l2++]>=128&&(usz|=(buf[l2]&127)<<7,buf[l2++]<128||(usz|=(buf[l2]&127)<<14,buf[l2++]<128)||(usz|=(buf[l2]&127)<<21,buf[l2++]<128)||(usz+=(buf[l2]&127)*Math.pow(2,28),++l2,buf[l2++]<128)||(usz+=(buf[l2]&127)*Math.pow(2,35),++l2,buf[l2++]<128)||(usz+=(buf[l2]&127)*Math.pow(2,42),++l2,buf[l2++]<128)))break varint;return ptr&&(ptr[0]=l2),usz}function write_varint49(v2){var usz=new Uint8Array(7);usz[0]=v2&127;var L2=1;sz:if(v2>127){if(usz[L2-1]|=128,usz[L2]=v2>>7&127,++L2,v2<=16383||(usz[L2-1]|=128,usz[L2]=v2>>14&127,++L2,v2<=2097151)||(usz[L2-1]|=128,usz[L2]=v2>>21&127,++L2,v2<=268435455)||(usz[L2-1]|=128,usz[L2]=v2/256>>>21&127,++L2,v2<=34359738367)||(usz[L2-1]|=128,usz[L2]=v2/65536>>>21&127,++L2,v2<=4398046511103))break sz;usz[L2-1]|=128,usz[L2]=v2/16777216>>>21&127,++L2}return usz.slice(0,L2)}function varint_to_i32(buf){var l2=0,i322=buf[l2]&127;varint:if(buf[l2++]>=128){if(i322|=(buf[l2]&127)<<7,buf[l2++]<128||(i322|=(buf[l2]&127)<<14,buf[l2++]<128)||(i322|=(buf[l2]&127)<<21,buf[l2++]<128))break varint;i322|=(buf[l2]&127)<<28}return i322}function parse_shallow(buf){for(var out=[],ptr=[0];ptr[0]<buf.length;){var off=ptr[0],num=parse_varint49(buf,ptr),type=num&7;num=Math.floor(num/8);var len=0,res;if(num==0)break;switch(type){case 0:{for(var l2=ptr[0];buf[ptr[0]++]>=128;);res=buf.slice(l2,ptr[0])}break;case 5:len=4,res=buf.slice(ptr[0],ptr[0]+len),ptr[0]+=len;break;case 1:len=8,res=buf.slice(ptr[0],ptr[0]+len),ptr[0]+=len;break;case 2:len=parse_varint49(buf,ptr),res=buf.slice(ptr[0],ptr[0]+len),ptr[0]+=len;break;case 3:case 4:default:throw new Error("PB Type ".concat(type," for Field ").concat(num," at offset ").concat(off))}var v2={data:res,type};out[num]==null?out[num]=[v2]:out[num].push(v2)}return out}function write_shallow(proto){var out=[];return proto.forEach(function(field,idx){field.forEach(function(item){item.data&&(out.push(write_varint49(idx*8+item.type)),item.type==2&&out.push(write_varint49(item.data.length)),out.push(item.data))})}),u8concat(out)}function parse_iwa_file(buf){for(var _a2,out=[],ptr=[0];ptr[0]<buf.length;){var len=parse_varint49(buf,ptr),ai=parse_shallow(buf.slice(ptr[0],ptr[0]+len));ptr[0]+=len;var res={id:varint_to_i32(ai[1][0].data),messages:[]};ai[2].forEach(function(b2){var mi=parse_shallow(b2.data),fl2=varint_to_i32(mi[3][0].data);res.messages.push({meta:mi,data:buf.slice(ptr[0],ptr[0]+fl2)}),ptr[0]+=fl2}),(_a2=ai[3])!=null&&_a2[0]&&(res.merge=varint_to_i32(ai[3][0].data)>>>0>0),out.push(res)}return out}function write_iwa_file(ias){var bufs=[];return ias.forEach(function(ia){var ai=[];ai[1]=[{data:write_varint49(ia.id),type:0}],ai[2]=[],ia.merge!=null&&(ai[3]=[{data:write_varint49(+!!ia.merge),type:0}]);var midata=[];ia.messages.forEach(function(mi){midata.push(mi.data),mi.meta[3]=[{type:0,data:write_varint49(mi.data.length)}],ai[2].push({data:write_shallow(mi.meta),type:2})});var aipayload=write_shallow(ai);bufs.push(write_varint49(aipayload.length)),bufs.push(aipayload),midata.forEach(function(mid){return bufs.push(mid)})}),u8concat(bufs)}function parse_snappy_chunk(type,buf){if(type!=0)throw new Error("Unexpected Snappy chunk type ".concat(type));for(var ptr=[0],usz=parse_varint49(buf,ptr),chunks=[];ptr[0]<buf.length;){var tag=buf[ptr[0]]&3;if(tag==0){var len=buf[ptr[0]++]>>2;if(len<60)++len;else{var c2=len-59;len=buf[ptr[0]],c2>1&&(len|=buf[ptr[0]+1]<<8),c2>2&&(len|=buf[ptr[0]+2]<<16),c2>3&&(len|=buf[ptr[0]+3]<<24),len>>>=0,len++,ptr[0]+=c2}chunks.push(buf.slice(ptr[0],ptr[0]+len)),ptr[0]+=len;continue}else{var offset=0,length=0;if(tag==1?(length=(buf[ptr[0]]>>2&7)+4,offset=(buf[ptr[0]++]&224)<<3,offset|=buf[ptr[0]++]):(length=(buf[ptr[0]++]>>2)+1,tag==2?(offset=buf[ptr[0]]|buf[ptr[0]+1]<<8,ptr[0]+=2):(offset=(buf[ptr[0]]|buf[ptr[0]+1]<<8|buf[ptr[0]+2]<<16|buf[ptr[0]+3]<<24)>>>0,ptr[0]+=4)),chunks=[u8concat(chunks)],offset==0)throw new Error("Invalid offset 0");if(offset>chunks[0].length)throw new Error("Invalid offset beyond length");if(length>=offset)for(chunks.push(chunks[0].slice(-offset)),length-=offset;length>=chunks[chunks.length-1].length;)chunks.push(chunks[chunks.length-1]),length-=chunks[chunks.length-1].length;chunks.push(chunks[0].slice(-offset,-offset+length))}}var o2=u8concat(chunks);if(o2.length!=usz)throw new Error("Unexpected length: ".concat(o2.length," != ").concat(usz));return o2}function decompress_iwa_file(buf){for(var out=[],l2=0;l2<buf.length;){var t2=buf[l2++],len=buf[l2]|buf[l2+1]<<8|buf[l2+2]<<16;l2+=3,out.push(parse_snappy_chunk(t2,buf.slice(l2,l2+len))),l2+=len}if(l2!==buf.length)throw new Error("data is not a valid framed stream!");return u8concat(out)}function compress_iwa_file(buf){for(var out=[],l2=0;l2<buf.length;){var c2=Math.min(buf.length-l2,268435455),frame=new Uint8Array(4);out.push(frame);var usz=write_varint49(c2),L2=usz.length;out.push(usz),c2<=60?(L2++,out.push(new Uint8Array([c2-1<<2]))):c2<=256?(L2+=2,out.push(new Uint8Array([240,c2-1&255]))):c2<=65536?(L2+=3,out.push(new Uint8Array([244,c2-1&255,c2-1>>8&255]))):c2<=16777216?(L2+=4,out.push(new Uint8Array([248,c2-1&255,c2-1>>8&255,c2-1>>16&255]))):c2<=4294967296&&(L2+=5,out.push(new Uint8Array([252,c2-1&255,c2-1>>8&255,c2-1>>16&255,c2-1>>>24&255]))),out.push(buf.slice(l2,l2+c2)),L2+=c2,frame[0]=0,frame[1]=L2&255,frame[2]=L2>>8&255,frame[3]=L2>>16&255,l2+=c2}return u8concat(out)}function write_new_storage(cell,sst){var out=new Uint8Array(32),dv=u8_to_dataview(out),l2=12,flags=0;switch(out[0]=5,cell.t){case"n":out[1]=2,writeDecimal128LE(out,l2,cell.v),flags|=1,l2+=16;break;case"b":out[1]=6,dv.setFloat64(l2,cell.v?1:0,!0),flags|=2,l2+=8;break;case"s":if(sst.indexOf(cell.v)==-1)throw new Error("Value ".concat(cell.v," missing from SST!"));out[1]=3,dv.setUint32(l2,sst.indexOf(cell.v),!0),flags|=8,l2+=4;break;default:throw"unsupported cell type "+cell.t}return dv.setUint32(8,flags,!0),out.slice(0,l2)}function write_old_storage(cell,sst){var out=new Uint8Array(32),dv=u8_to_dataview(out),l2=12,flags=0;switch(out[0]=3,cell.t){case"n":out[2]=2,dv.setFloat64(l2,cell.v,!0),flags|=32,l2+=8;break;case"b":out[2]=6,dv.setFloat64(l2,cell.v?1:0,!0),flags|=32,l2+=8;break;case"s":if(sst.indexOf(cell.v)==-1)throw new Error("Value ".concat(cell.v," missing from SST!"));out[2]=3,dv.setUint32(l2,sst.indexOf(cell.v),!0),flags|=16,l2+=4;break;default:throw"unsupported cell type "+cell.t}return dv.setUint32(4,flags,!0),out.slice(0,l2)}function parse_TSP_Reference(buf){var pb=parse_shallow(buf);return parse_varint49(pb[1][0].data)}function write_tile_row(tri,data,SST){var _a2,_b2,_c,_d;if(!((_a2=tri[6])!=null&&_a2[0])||!((_b2=tri[7])!=null&&_b2[0]))throw"Mutation only works on post-BNC storages!";var wide_offsets=((_d=(_c=tri[8])==null?void 0:_c[0])==null?void 0:_d.data)&&varint_to_i32(tri[8][0].data)>0||!1;if(wide_offsets)throw"Math only works with normal offsets";for(var cnt=0,dv=u8_to_dataview(tri[7][0].data),last_offset=0,cell_storage=[],_dv=u8_to_dataview(tri[4][0].data),_last_offset=0,_cell_storage=[],C2=0;C2<data.length;++C2){if(data[C2]==null){dv.setUint16(C2*2,65535,!0),_dv.setUint16(C2*2,65535);continue}dv.setUint16(C2*2,last_offset,!0),_dv.setUint16(C2*2,_last_offset,!0);var celload,_celload;switch(typeof data[C2]){case"string":celload=write_new_storage({t:"s",v:data[C2]},SST),_celload=write_old_storage({t:"s",v:data[C2]},SST);break;case"number":celload=write_new_storage({t:"n",v:data[C2]},SST),_celload=write_old_storage({t:"n",v:data[C2]},SST);break;case"boolean":celload=write_new_storage({t:"b",v:data[C2]},SST),_celload=write_old_storage({t:"b",v:data[C2]},SST);break;default:throw new Error("Unsupported value "+data[C2])}cell_storage.push(celload),last_offset+=celload.length,_cell_storage.push(_celload),_last_offset+=_celload.length,++cnt}for(tri[2][0].data=write_varint49(cnt);C2<tri[7][0].data.length/2;++C2)dv.setUint16(C2*2,65535,!0),_dv.setUint16(C2*2,65535,!0);return tri[6][0].data=u8concat(cell_storage),tri[3][0].data=u8concat(_cell_storage),cnt}function write_numbers_iwa(wb,opts){if(!opts||!opts.numbers)throw new Error("Must pass a `numbers` option -- check the README");var ws=wb.Sheets[wb.SheetNames[0]];wb.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var range=decode_range(ws["!ref"]);range.s.r=range.s.c=0;var trunc=!1;range.e.c>9&&(trunc=!0,range.e.c=9),range.e.r>49&&(trunc=!0,range.e.r=49),trunc&&console.error("The Numbers writer is currently limited to ".concat(encode_range(range)));var data=sheet_to_json(ws,{range,header:1}),SST=["~Sh33tJ5~"];data.forEach(function(row){return row.forEach(function(cell){typeof cell=="string"&&SST.push(cell)})});var dependents={},indices=[],cfb=CFB.read(opts.numbers,{type:"base64"});cfb.FileIndex.map(function(fi,idx){return[fi,cfb.FullPaths[idx]]}).forEach(function(row){var fi=row[0],fp=row[1];if(fi.type==2&&fi.name.match(/\.iwa/)){var old_content=fi.content,raw1=decompress_iwa_file(old_content),x22=parse_iwa_file(raw1);x22.forEach(function(packet2){indices.push(packet2.id),dependents[packet2.id]={deps:[],location:fp,type:varint_to_i32(packet2.messages[0].meta[1][0].data)}})}}),indices.sort(function(x22,y22){return x22-y22});var indices_varint=indices.filter(function(x22){return x22>1}).map(function(x22){return[x22,write_varint49(x22)]});cfb.FileIndex.map(function(fi,idx){return[fi,cfb.FullPaths[idx]]}).forEach(function(row){var fi=row[0];if(row[1],!!fi.name.match(/\.iwa/)){var x22=parse_iwa_file(decompress_iwa_file(fi.content));x22.forEach(function(ia){ia.messages.forEach(function(m2){indices_varint.forEach(function(ivi){ia.messages.some(function(mess){return varint_to_i32(mess.meta[1][0].data)!=11006&&u8contains(mess.data,ivi[1])})&&dependents[ivi[0]].deps.push(ia.id)})})})}});for(var entry=CFB.find(cfb,dependents[1].location),x2=parse_iwa_file(decompress_iwa_file(entry.content)),docroot,xi=0;xi<x2.length;++xi){var packet=x2[xi];packet.id==1&&(docroot=packet)}var sheetrootref=parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[1][0].data);for(entry=CFB.find(cfb,dependents[sheetrootref].location),x2=parse_iwa_file(decompress_iwa_file(entry.content)),xi=0;xi<x2.length;++xi)packet=x2[xi],packet.id==sheetrootref&&(docroot=packet);for(sheetrootref=parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[2][0].data),entry=CFB.find(cfb,dependents[sheetrootref].location),x2=parse_iwa_file(decompress_iwa_file(entry.content)),xi=0;xi<x2.length;++xi)packet=x2[xi],packet.id==sheetrootref&&(docroot=packet);for(sheetrootref=parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[2][0].data),entry=CFB.find(cfb,dependents[sheetrootref].location),x2=parse_iwa_file(decompress_iwa_file(entry.content)),xi=0;xi<x2.length;++xi)packet=x2[xi],packet.id==sheetrootref&&(docroot=packet);var pb=parse_shallow(docroot.messages[0].data);{pb[6][0].data=write_varint49(range.e.r+1),pb[7][0].data=write_varint49(range.e.c+1);var cruidsref=parse_TSP_Reference(pb[46][0].data),oldbucket=CFB.find(cfb,dependents[cruidsref].location),_x=parse_iwa_file(decompress_iwa_file(oldbucket.content));{for(var j2=0;j2<_x.length&&_x[j2].id!=cruidsref;++j2);if(_x[j2].id!=cruidsref)throw"Bad ColumnRowUIDMapArchive";var cruids=parse_shallow(_x[j2].messages[0].data);cruids[1]=[],cruids[2]=[],cruids[3]=[];for(var C2=0;C2<=range.e.c;++C2){var uuid=[];uuid[1]=uuid[2]=[{type:0,data:write_varint49(C2+420690)}],cruids[1].push({type:2,data:write_shallow(uuid)}),cruids[2].push({type:0,data:write_varint49(C2)}),cruids[3].push({type:0,data:write_varint49(C2)})}cruids[4]=[],cruids[5]=[],cruids[6]=[];for(var R2=0;R2<=range.e.r;++R2)uuid=[],uuid[1]=uuid[2]=[{type:0,data:write_varint49(R2+726270)}],cruids[4].push({type:2,data:write_shallow(uuid)}),cruids[5].push({type:0,data:write_varint49(R2)}),cruids[6].push({type:0,data:write_varint49(R2)});_x[j2].messages[0].data=write_shallow(cruids)}oldbucket.content=compress_iwa_file(write_iwa_file(_x)),oldbucket.size=oldbucket.content.length,delete pb[46];var store=parse_shallow(pb[4][0].data);{store[7][0].data=write_varint49(range.e.r+1);var row_headers=parse_shallow(store[1][0].data),row_header_ref=parse_TSP_Reference(row_headers[2][0].data);oldbucket=CFB.find(cfb,dependents[row_header_ref].location),_x=parse_iwa_file(decompress_iwa_file(oldbucket.content));{if(_x[0].id!=row_header_ref)throw"Bad HeaderStorageBucket";var base_bucket=parse_shallow(_x[0].messages[0].data);for(R2=0;R2<data.length;++R2){var _bucket=parse_shallow(base_bucket[2][0].data);_bucket[1][0].data=write_varint49(R2),_bucket[4][0].data=write_varint49(data[R2].length),base_bucket[2][R2]={type:base_bucket[2][0].type,data:write_shallow(_bucket)}}_x[0].messages[0].data=write_shallow(base_bucket)}oldbucket.content=compress_iwa_file(write_iwa_file(_x)),oldbucket.size=oldbucket.content.length;var col_header_ref=parse_TSP_Reference(store[2][0].data);oldbucket=CFB.find(cfb,dependents[col_header_ref].location),_x=parse_iwa_file(decompress_iwa_file(oldbucket.content));{if(_x[0].id!=col_header_ref)throw"Bad HeaderStorageBucket";for(base_bucket=parse_shallow(_x[0].messages[0].data),C2=0;C2<=range.e.c;++C2)_bucket=parse_shallow(base_bucket[2][0].data),_bucket[1][0].data=write_varint49(C2),_bucket[4][0].data=write_varint49(range.e.r+1),base_bucket[2][C2]={type:base_bucket[2][0].type,data:write_shallow(_bucket)};_x[0].messages[0].data=write_shallow(base_bucket)}oldbucket.content=compress_iwa_file(write_iwa_file(_x)),oldbucket.size=oldbucket.content.length;var sstref=parse_TSP_Reference(store[4][0].data);(function(){for(var sentry=CFB.find(cfb,dependents[sstref].location),sx=parse_iwa_file(decompress_iwa_file(sentry.content)),sstroot,sxi=0;sxi<sx.length;++sxi){var packet2=sx[sxi];packet2.id==sstref&&(sstroot=packet2)}var sstdata=parse_shallow(sstroot.messages[0].data);{sstdata[3]=[];var newsst=[];SST.forEach(function(str,i2){newsst[1]=[{type:0,data:write_varint49(i2)}],newsst[2]=[{type:0,data:write_varint49(1)}],newsst[3]=[{type:2,data:stru8(str)}],sstdata[3].push({type:2,data:write_shallow(newsst)})})}sstroot.messages[0].data=write_shallow(sstdata);var sy=write_iwa_file(sx),raw32=compress_iwa_file(sy);sentry.content=raw32,sentry.size=sentry.content.length})();var tile=parse_shallow(store[3][0].data);{var t2=tile[1][0];delete tile[2];var tl=parse_shallow(t2.data);{var tileref=parse_TSP_Reference(tl[2][0].data);(function(){for(var tentry=CFB.find(cfb,dependents[tileref].location),tx=parse_iwa_file(decompress_iwa_file(tentry.content)),tileroot,sxi=0;sxi<tx.length;++sxi){var packet2=tx[sxi];packet2.id==tileref&&(tileroot=packet2)}var tiledata=parse_shallow(tileroot.messages[0].data);{delete tiledata[6],delete tile[7];var rowload=new Uint8Array(tiledata[5][0].data);tiledata[5]=[];for(var cnt=0,R22=0;R22<=range.e.r;++R22){var tilerow=parse_shallow(rowload);cnt+=write_tile_row(tilerow,data[R22],SST),tilerow[1][0].data=write_varint49(R22),tiledata[5].push({data:write_shallow(tilerow),type:2})}tiledata[1]=[{type:0,data:write_varint49(range.e.c+1)}],tiledata[2]=[{type:0,data:write_varint49(range.e.r+1)}],tiledata[3]=[{type:0,data:write_varint49(cnt)}],tiledata[4]=[{type:0,data:write_varint49(range.e.r+1)}]}tileroot.messages[0].data=write_shallow(tiledata);var ty=write_iwa_file(tx),raw32=compress_iwa_file(ty);tentry.content=raw32,tentry.size=tentry.content.length})()}t2.data=write_shallow(tl)}store[3][0].data=write_shallow(tile)}pb[4][0].data=write_shallow(store)}docroot.messages[0].data=write_shallow(pb);var y2=write_iwa_file(x2),raw3=compress_iwa_file(y2);return entry.content=raw3,entry.size=entry.content.length,cfb}function fix_opts_func(defaults){return function(opts){for(var i2=0;i2!=defaults.length;++i2){var d2=defaults[i2];opts[d2[0]]===void 0&&(opts[d2[0]]=d2[1]),d2[2]==="n"&&(opts[d2[0]]=Number(opts[d2[0]]))}}}function fix_write_opts(opts){fix_opts_func([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(opts)}function write_zip(wb,opts){return opts.bookType=="ods"?write_ods(wb,opts):opts.bookType=="numbers"?write_numbers_iwa(wb,opts):opts.bookType=="xlsb"?write_zip_xlsxb(wb,opts):write_zip_xlsx(wb,opts)}function write_zip_xlsxb(wb,opts){_shapeid=1024,wb&&!wb.SSF&&(wb.SSF=dup(table_fmt)),wb&&wb.SSF&&(make_ssf(),SSF_load_table(wb.SSF),opts.revssf=evert_num(wb.SSF),opts.revssf[wb.SSF[65535]]=0,opts.ssf=wb.SSF),opts.rels={},opts.wbrels={},opts.Strings=[],opts.Strings.Count=0,opts.Strings.Unique=0,browser_has_Map?opts.revStrings=new Map:(opts.revStrings={},opts.revStrings.foo=[],delete opts.revStrings.foo);var wbext=opts.bookType=="xlsb"?"bin":"xml",vbafmt=VBAFMTS.indexOf(opts.bookType)>-1,ct2=new_ct();fix_write_opts(opts=opts||{});var zip=zip_new(),f2="",rId=0;if(opts.cellXfs=[],get_cell_style(opts.cellXfs,{},{revssf:{General:0}}),wb.Props||(wb.Props={}),f2="docProps/core.xml",zip_add_file(zip,f2,write_core_props(wb.Props,opts)),ct2.coreprops.push(f2),add_rels(opts.rels,2,f2,RELS.CORE_PROPS),f2="docProps/app.xml",!(wb.Props&&wb.Props.SheetNames))if(!wb.Workbook||!wb.Workbook.Sheets)wb.Props.SheetNames=wb.SheetNames;else{for(var _sn=[],_i=0;_i<wb.SheetNames.length;++_i)(wb.Workbook.Sheets[_i]||{}).Hidden!=2&&_sn.push(wb.SheetNames[_i]);wb.Props.SheetNames=_sn}for(wb.Props.Worksheets=wb.Props.SheetNames.length,zip_add_file(zip,f2,write_ext_props(wb.Props)),ct2.extprops.push(f2),add_rels(opts.rels,3,f2,RELS.EXT_PROPS),wb.Custprops!==wb.Props&&keys(wb.Custprops||{}).length>0&&(f2="docProps/custom.xml",zip_add_file(zip,f2,write_cust_props(wb.Custprops)),ct2.custprops.push(f2),add_rels(opts.rels,4,f2,RELS.CUST_PROPS)),rId=1;rId<=wb.SheetNames.length;++rId){var wsrels={"!id":{}},ws=wb.Sheets[wb.SheetNames[rId-1]],_type=(ws||{})["!type"]||"sheet";switch(_type){case"chart":default:f2="xl/worksheets/sheet"+rId+"."+wbext,zip_add_file(zip,f2,write_ws(rId-1,f2,opts,wb,wsrels)),ct2.sheets.push(f2),add_rels(opts.wbrels,-1,"worksheets/sheet"+rId+"."+wbext,RELS.WS[0])}if(ws){var comments=ws["!comments"],need_vml=!1,cf="";comments&&comments.length>0&&(cf="xl/comments"+rId+"."+wbext,zip_add_file(zip,cf,write_cmnt(comments,cf)),ct2.comments.push(cf),add_rels(wsrels,-1,"../comments"+rId+"."+wbext,RELS.CMNT),need_vml=!0),ws["!legacy"]&&need_vml&&zip_add_file(zip,"xl/drawings/vmlDrawing"+rId+".vml",write_comments_vml(rId,ws["!comments"])),delete ws["!comments"],delete ws["!legacy"]}wsrels["!id"].rId1&&zip_add_file(zip,get_rels_path(f2),write_rels(wsrels))}return opts.Strings!=null&&opts.Strings.length>0&&(f2="xl/sharedStrings."+wbext,zip_add_file(zip,f2,write_sst(opts.Strings,f2,opts)),ct2.strs.push(f2),add_rels(opts.wbrels,-1,"sharedStrings."+wbext,RELS.SST)),f2="xl/workbook."+wbext,zip_add_file(zip,f2,write_wb(wb,f2)),ct2.workbooks.push(f2),add_rels(opts.rels,1,f2,RELS.WB),f2="xl/theme/theme1.xml",zip_add_file(zip,f2,write_theme(wb.Themes,opts)),ct2.themes.push(f2),add_rels(opts.wbrels,-1,"theme/theme1.xml",RELS.THEME),f2="xl/styles."+wbext,zip_add_file(zip,f2,write_sty(wb,f2,opts)),ct2.styles.push(f2),add_rels(opts.wbrels,-1,"styles."+wbext,RELS.STY),wb.vbaraw&&vbafmt&&(f2="xl/vbaProject.bin",zip_add_file(zip,f2,wb.vbaraw),ct2.vba.push(f2),add_rels(opts.wbrels,-1,"vbaProject.bin",RELS.VBA)),f2="xl/metadata."+wbext,zip_add_file(zip,f2,write_xlmeta(f2)),ct2.metadata.push(f2),add_rels(opts.wbrels,-1,"metadata."+wbext,RELS.XLMETA),zip_add_file(zip,"[Content_Types].xml",write_ct(ct2,opts)),zip_add_file(zip,"_rels/.rels",write_rels(opts.rels)),zip_add_file(zip,"xl/_rels/workbook."+wbext+".rels",write_rels(opts.wbrels)),delete opts.revssf,delete opts.ssf,zip}function write_zip_xlsx(wb,opts){_shapeid=1024,wb&&!wb.SSF&&(wb.SSF=dup(table_fmt)),wb&&wb.SSF&&(make_ssf(),SSF_load_table(wb.SSF),opts.revssf=evert_num(wb.SSF),opts.revssf[wb.SSF[65535]]=0,opts.ssf=wb.SSF),opts.rels={},opts.wbrels={},opts.Strings=[],opts.Strings.Count=0,opts.Strings.Unique=0,browser_has_Map?opts.revStrings=new Map:(opts.revStrings={},opts.revStrings.foo=[],delete opts.revStrings.foo);var wbext="xml",vbafmt=VBAFMTS.indexOf(opts.bookType)>-1,ct2=new_ct();fix_write_opts(opts=opts||{});var zip=zip_new(),f2="",rId=0;if(opts.cellXfs=[],get_cell_style(opts.cellXfs,{},{revssf:{General:0}}),wb.Props||(wb.Props={}),f2="docProps/core.xml",zip_add_file(zip,f2,write_core_props(wb.Props,opts)),ct2.coreprops.push(f2),add_rels(opts.rels,2,f2,RELS.CORE_PROPS),f2="docProps/app.xml",!(wb.Props&&wb.Props.SheetNames))if(!wb.Workbook||!wb.Workbook.Sheets)wb.Props.SheetNames=wb.SheetNames;else{for(var _sn=[],_i=0;_i<wb.SheetNames.length;++_i)(wb.Workbook.Sheets[_i]||{}).Hidden!=2&&_sn.push(wb.SheetNames[_i]);wb.Props.SheetNames=_sn}wb.Props.Worksheets=wb.Props.SheetNames.length,zip_add_file(zip,f2,write_ext_props(wb.Props)),ct2.extprops.push(f2),add_rels(opts.rels,3,f2,RELS.EXT_PROPS),wb.Custprops!==wb.Props&&keys(wb.Custprops||{}).length>0&&(f2="docProps/custom.xml",zip_add_file(zip,f2,write_cust_props(wb.Custprops)),ct2.custprops.push(f2),add_rels(opts.rels,4,f2,RELS.CUST_PROPS));var people=["SheetJ5"];for(opts.tcid=0,rId=1;rId<=wb.SheetNames.length;++rId){var wsrels={"!id":{}},ws=wb.Sheets[wb.SheetNames[rId-1]],_type=(ws||{})["!type"]||"sheet";switch(_type){case"chart":default:f2="xl/worksheets/sheet"+rId+"."+wbext,zip_add_file(zip,f2,write_ws_xml(rId-1,opts,wb,wsrels)),ct2.sheets.push(f2),add_rels(opts.wbrels,-1,"worksheets/sheet"+rId+"."+wbext,RELS.WS[0])}if(ws){var comments=ws["!comments"],need_vml=!1,cf="";if(comments&&comments.length>0){var needtc=!1;comments.forEach(function(carr){carr[1].forEach(function(c2){c2.T==!0&&(needtc=!0)})}),needtc&&(cf="xl/threadedComments/threadedComment"+rId+"."+wbext,zip_add_file(zip,cf,write_tcmnt_xml(comments,people,opts)),ct2.threadedcomments.push(cf),add_rels(wsrels,-1,"../threadedComments/threadedComment"+rId+"."+wbext,RELS.TCMNT)),cf="xl/comments"+rId+"."+wbext,zip_add_file(zip,cf,write_comments_xml(comments)),ct2.comments.push(cf),add_rels(wsrels,-1,"../comments"+rId+"."+wbext,RELS.CMNT),need_vml=!0}ws["!legacy"]&&need_vml&&zip_add_file(zip,"xl/drawings/vmlDrawing"+rId+".vml",write_comments_vml(rId,ws["!comments"])),delete ws["!comments"],delete ws["!legacy"]}wsrels["!id"].rId1&&zip_add_file(zip,get_rels_path(f2),write_rels(wsrels))}return opts.Strings!=null&&opts.Strings.length>0&&(f2="xl/sharedStrings."+wbext,zip_add_file(zip,f2,write_sst_xml(opts.Strings,opts)),ct2.strs.push(f2),add_rels(opts.wbrels,-1,"sharedStrings."+wbext,RELS.SST)),f2="xl/workbook."+wbext,zip_add_file(zip,f2,write_wb_xml(wb)),ct2.workbooks.push(f2),add_rels(opts.rels,1,f2,RELS.WB),f2="xl/theme/theme1.xml",zip_add_file(zip,f2,write_theme(wb.Themes,opts)),ct2.themes.push(f2),add_rels(opts.wbrels,-1,"theme/theme1.xml",RELS.THEME),f2="xl/styles."+wbext,zip_add_file(zip,f2,write_sty_xml(wb,opts)),ct2.styles.push(f2),add_rels(opts.wbrels,-1,"styles."+wbext,RELS.STY),wb.vbaraw&&vbafmt&&(f2="xl/vbaProject.bin",zip_add_file(zip,f2,wb.vbaraw),ct2.vba.push(f2),add_rels(opts.wbrels,-1,"vbaProject.bin",RELS.VBA)),f2="xl/metadata."+wbext,zip_add_file(zip,f2,write_xlmeta_xml()),ct2.metadata.push(f2),add_rels(opts.wbrels,-1,"metadata."+wbext,RELS.XLMETA),people.length>1&&(f2="xl/persons/person.xml",zip_add_file(zip,f2,write_people_xml(people)),ct2.people.push(f2),add_rels(opts.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(zip,"[Content_Types].xml",write_ct(ct2,opts)),zip_add_file(zip,"_rels/.rels",write_rels(opts.rels)),zip_add_file(zip,"xl/_rels/workbook."+wbext+".rels",write_rels(opts.wbrels)),delete opts.revssf,delete opts.ssf,zip}function firstbyte(f2,o2){var x2="";switch((o2||{}).type||"base64"){case"buffer":return[f2[0],f2[1],f2[2],f2[3],f2[4],f2[5],f2[6],f2[7]];case"base64":x2=Base64_decode(f2.slice(0,12));break;case"binary":x2=f2;break;case"array":return[f2[0],f2[1],f2[2],f2[3],f2[4],f2[5],f2[6],f2[7]];default:throw new Error("Unrecognized type "+(o2&&o2.type||"undefined"))}return[x2.charCodeAt(0),x2.charCodeAt(1),x2.charCodeAt(2),x2.charCodeAt(3),x2.charCodeAt(4),x2.charCodeAt(5),x2.charCodeAt(6),x2.charCodeAt(7)]}function write_cfb_ctr(cfb,o2){switch(o2.type){case"base64":case"binary":break;case"buffer":case"array":o2.type="";break;case"file":return write_dl(o2.file,CFB.write(cfb,{type:has_buf?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+o2.bookType+"' files");default:throw new Error("Unrecognized type "+o2.type)}return CFB.write(cfb,o2)}function write_zip_type(wb,opts){var o2=dup(opts||{}),z2=write_zip(wb,o2);return write_zip_denouement(z2,o2)}function write_zip_denouement(z2,o2){var oopts={},ftype=has_buf?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(o2.compression&&(oopts.compression="DEFLATE"),o2.password)oopts.type=ftype;else switch(o2.type){case"base64":oopts.type="base64";break;case"binary":oopts.type="string";break;case"string":throw new Error("'string' output type invalid for '"+o2.bookType+"' files");case"buffer":case"file":oopts.type=ftype;break;default:throw new Error("Unrecognized type "+o2.type)}var out=z2.FullPaths?CFB.write(z2,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[oopts.type]||oopts.type,compression:!!o2.compression}):z2.generate(oopts);if(typeof Deno<"u"&&typeof out=="string"){if(o2.type=="binary"||o2.type=="base64")return out;out=new Uint8Array(s2ab(out))}return o2.password&&typeof encrypt_agile<"u"?write_cfb_ctr(encrypt_agile(out,o2.password),o2):o2.type==="file"?write_dl(o2.file,out):o2.type=="string"?utf8read(out):out}function write_cfb_type(wb,opts){var o2=opts||{},cfb=write_xlscfb(wb,o2);return write_cfb_ctr(cfb,o2)}function write_string_type(out,opts,bom){bom||(bom="");var o2=bom+out;switch(opts.type){case"base64":return Base64_encode(utf8write(o2));case"binary":return utf8write(o2);case"string":return out;case"file":return write_dl(opts.file,o2,"utf8");case"buffer":return has_buf?Buffer_from(o2,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(o2):write_string_type(o2,{type:"binary"}).split("").map(function(c2){return c2.charCodeAt(0)})}throw new Error("Unrecognized type "+opts.type)}function write_stxt_type(out,opts){switch(opts.type){case"base64":return Base64_encode(out);case"binary":return out;case"string":return out;case"file":return write_dl(opts.file,out,"binary");case"buffer":return has_buf?Buffer_from(out,"binary"):out.split("").map(function(c2){return c2.charCodeAt(0)})}throw new Error("Unrecognized type "+opts.type)}function write_binary_type(out,opts){switch(opts.type){case"string":case"base64":case"binary":for(var bstr="",i2=0;i2<out.length;++i2)bstr+=String.fromCharCode(out[i2]);return opts.type=="base64"?Base64_encode(bstr):opts.type=="string"?utf8read(bstr):bstr;case"file":return write_dl(opts.file,out);case"buffer":return out;default:throw new Error("Unrecognized type "+opts.type)}}function writeSync(wb,opts){reset_cp(),check_wb(wb);var o2=dup(opts||{});if(o2.cellStyles&&(o2.cellNF=!0,o2.sheetStubs=!0),o2.type=="array"){o2.type="binary";var out=writeSync(wb,o2);return o2.type="array",s2ab(out)}var idx=0;if(o2.sheet&&(typeof o2.sheet=="number"?idx=o2.sheet:idx=wb.SheetNames.indexOf(o2.sheet),!wb.SheetNames[idx]))throw new Error("Sheet not found: "+o2.sheet+" : "+typeof o2.sheet);switch(o2.bookType||"xlsb"){case"xml":case"xlml":return write_string_type(write_xlml(wb,o2),o2);case"slk":case"sylk":return write_string_type(SYLK.from_sheet(wb.Sheets[wb.SheetNames[idx]],o2),o2);case"htm":case"html":return write_string_type(sheet_to_html(wb.Sheets[wb.SheetNames[idx]],o2),o2);case"txt":return write_stxt_type(sheet_to_txt(wb.Sheets[wb.SheetNames[idx]],o2),o2);case"csv":return write_string_type(sheet_to_csv(wb.Sheets[wb.SheetNames[idx]],o2),o2,"\uFEFF");case"dif":return write_string_type(DIF.from_sheet(wb.Sheets[wb.SheetNames[idx]],o2),o2);case"dbf":return write_binary_type(DBF.from_sheet(wb.Sheets[wb.SheetNames[idx]],o2),o2);case"prn":return write_string_type(PRN.from_sheet(wb.Sheets[wb.SheetNames[idx]],o2),o2);case"rtf":return write_string_type(RTF.from_sheet(wb.Sheets[wb.SheetNames[idx]],o2),o2);case"eth":return write_string_type(ETH.from_sheet(wb.Sheets[wb.SheetNames[idx]],o2),o2);case"fods":return write_string_type(write_ods(wb,o2),o2);case"wk1":return write_binary_type(WK_.sheet_to_wk1(wb.Sheets[wb.SheetNames[idx]],o2),o2);case"wk3":return write_binary_type(WK_.book_to_wk3(wb,o2),o2);case"biff2":o2.biff||(o2.biff=2);case"biff3":o2.biff||(o2.biff=3);case"biff4":return o2.biff||(o2.biff=4),write_binary_type(write_biff_buf(wb,o2),o2);case"biff5":o2.biff||(o2.biff=5);case"biff8":case"xla":case"xls":return o2.biff||(o2.biff=8),write_cfb_type(wb,o2);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return write_zip_type(wb,o2);default:throw new Error("Unrecognized bookType |"+o2.bookType+"|")}}function make_json_row(sheet,r,R2,cols,header,hdr,dense,o2){var rr=encode_row(R2),defval=o2.defval,raw=o2.raw||!Object.prototype.hasOwnProperty.call(o2,"raw"),isempty=!0,row=header===1?[]:{};if(header!==1)if(Object.defineProperty)try{Object.defineProperty(row,"__rowNum__",{value:R2,enumerable:!1})}catch{row.__rowNum__=R2}else row.__rowNum__=R2;if(!dense||sheet[R2])for(var C2=r.s.c;C2<=r.e.c;++C2){var val=dense?sheet[R2][C2]:sheet[cols[C2]+rr];if(val===void 0||val.t===void 0){if(defval===void 0)continue;hdr[C2]!=null&&(row[hdr[C2]]=defval);continue}var v2=val.v;switch(val.t){case"z":if(v2==null)break;continue;case"e":v2=v2==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+val.t)}if(hdr[C2]!=null){if(v2==null)if(val.t=="e"&&v2===null)row[hdr[C2]]=null;else if(defval!==void 0)row[hdr[C2]]=defval;else if(raw&&v2===null)row[hdr[C2]]=null;else continue;else row[hdr[C2]]=raw&&(val.t!=="n"||val.t==="n"&&o2.rawNumbers!==!1)?v2:format_cell(val,v2,o2);v2!=null&&(isempty=!1)}}return{row,isempty}}function sheet_to_json(sheet,opts){if(sheet==null||sheet["!ref"]==null)return[];var val={t:"n",v:0},header=0,offset=1,hdr=[],v2=0,vv="",r={s:{r:0,c:0},e:{r:0,c:0}},o2=opts||{},range=o2.range!=null?o2.range:sheet["!ref"];switch(o2.header===1?header=1:o2.header==="A"?header=2:Array.isArray(o2.header)?header=3:o2.header==null&&(header=0),typeof range){case"string":r=safe_decode_range(range);break;case"number":r=safe_decode_range(sheet["!ref"]),r.s.r=range;break;default:r=range}header>0&&(offset=0);var rr=encode_row(r.s.r),cols=[],out=[],outi=0,counter=0,dense=Array.isArray(sheet),R2=r.s.r,C2=0,header_cnt={};dense&&!sheet[R2]&&(sheet[R2]=[]);var colinfo=o2.skipHidden&&sheet["!cols"]||[],rowinfo=o2.skipHidden&&sheet["!rows"]||[];for(C2=r.s.c;C2<=r.e.c;++C2)if(!(colinfo[C2]||{}).hidden)switch(cols[C2]=encode_col(C2),val=dense?sheet[R2][C2]:sheet[cols[C2]+rr],header){case 1:hdr[C2]=C2-r.s.c;break;case 2:hdr[C2]=cols[C2];break;case 3:hdr[C2]=o2.header[C2-r.s.c];break;default:if(val==null&&(val={w:"__EMPTY",t:"s"}),vv=v2=format_cell(val,null,o2),counter=header_cnt[v2]||0,!counter)header_cnt[v2]=1;else{do vv=v2+"_"+counter++;while(header_cnt[vv]);header_cnt[v2]=counter,header_cnt[vv]=1}hdr[C2]=vv}for(R2=r.s.r+offset;R2<=r.e.r;++R2)if(!(rowinfo[R2]||{}).hidden){var row=make_json_row(sheet,r,R2,cols,header,hdr,dense,o2);(row.isempty===!1||(header===1?o2.blankrows!==!1:o2.blankrows))&&(out[outi++]=row.row)}return out.length=outi,out}var qreg=/"/g;function make_csv_row(sheet,r,R2,cols,fs,rs,FS,o2){for(var isempty=!0,row=[],txt="",rr=encode_row(R2),C2=r.s.c;C2<=r.e.c;++C2)if(cols[C2]){var val=o2.dense?(sheet[R2]||[])[C2]:sheet[cols[C2]+rr];if(val==null)txt="";else if(val.v!=null){isempty=!1,txt=""+(o2.rawNumbers&&val.t=="n"?val.v:format_cell(val,null,o2));for(var i2=0,cc=0;i2!==txt.length;++i2)if((cc=txt.charCodeAt(i2))===fs||cc===rs||cc===34||o2.forceQuotes){txt='"'+txt.replace(qreg,'""')+'"';break}txt=="ID"&&(txt='"ID"')}else val.f!=null&&!val.F?(isempty=!1,txt="="+val.f,txt.indexOf(",")>=0&&(txt='"'+txt.replace(qreg,'""')+'"')):txt="";row.push(txt)}return o2.blankrows===!1&&isempty?null:row.join(FS)}function sheet_to_csv(sheet,opts){var out=[],o2=opts??{};if(sheet==null||sheet["!ref"]==null)return"";var r=safe_decode_range(sheet["!ref"]),FS=o2.FS!==void 0?o2.FS:",",fs=FS.charCodeAt(0),RS=o2.RS!==void 0?o2.RS:`
`,rs=RS.charCodeAt(0),endregex=new RegExp((FS=="|"?"\\|":FS)+"+$"),row="",cols=[];o2.dense=Array.isArray(sheet);for(var colinfo=o2.skipHidden&&sheet["!cols"]||[],rowinfo=o2.skipHidden&&sheet["!rows"]||[],C2=r.s.c;C2<=r.e.c;++C2)(colinfo[C2]||{}).hidden||(cols[C2]=encode_col(C2));for(var w2=0,R2=r.s.r;R2<=r.e.r;++R2)(rowinfo[R2]||{}).hidden||(row=make_csv_row(sheet,r,R2,cols,fs,rs,FS,o2),row!=null&&(o2.strip&&(row=row.replace(endregex,"")),(row||o2.blankrows!==!1)&&out.push((w2++?RS:"")+row)));return delete o2.dense,out.join("")}function sheet_to_txt(sheet,opts){opts||(opts={}),opts.FS="	",opts.RS=`
`;var s2=sheet_to_csv(sheet,opts);return s2}function sheet_to_formulae(sheet){var y2="",x2,val="";if(sheet==null||sheet["!ref"]==null)return[];var r=safe_decode_range(sheet["!ref"]),rr="",cols=[],C2,cmds=[],dense=Array.isArray(sheet);for(C2=r.s.c;C2<=r.e.c;++C2)cols[C2]=encode_col(C2);for(var R2=r.s.r;R2<=r.e.r;++R2)for(rr=encode_row(R2),C2=r.s.c;C2<=r.e.c;++C2)if(y2=cols[C2]+rr,x2=dense?(sheet[R2]||[])[C2]:sheet[y2],val="",x2!==void 0){if(x2.F!=null){if(y2=x2.F,!x2.f)continue;val=x2.f,y2.indexOf(":")==-1&&(y2=y2+":"+y2)}if(x2.f!=null)val=x2.f;else{if(x2.t=="z")continue;if(x2.t=="n"&&x2.v!=null)val=""+x2.v;else if(x2.t=="b")val=x2.v?"TRUE":"FALSE";else if(x2.w!==void 0)val="'"+x2.w;else{if(x2.v===void 0)continue;x2.t=="s"?val="'"+x2.v:val=""+x2.v}}cmds[cmds.length]=y2+"="+val}return cmds}function sheet_add_json(_ws,js,opts){var o2=opts||{},offset=+!o2.skipHeader,ws=_ws||{},_R=0,_C=0;if(ws&&o2.origin!=null)if(typeof o2.origin=="number")_R=o2.origin;else{var _origin=typeof o2.origin=="string"?decode_cell(o2.origin):o2.origin;_R=_origin.r,_C=_origin.c}var cell,range={s:{c:0,r:0},e:{c:_C,r:_R+js.length-1+offset}};if(ws["!ref"]){var _range=safe_decode_range(ws["!ref"]);range.e.c=Math.max(range.e.c,_range.e.c),range.e.r=Math.max(range.e.r,_range.e.r),_R==-1&&(_R=_range.e.r+1,range.e.r=_R+js.length-1+offset)}else _R==-1&&(_R=0,range.e.r=js.length-1+offset);var hdr=o2.header||[],C2=0;js.forEach(function(JS,R2){keys(JS).forEach(function(k2){(C2=hdr.indexOf(k2))==-1&&(hdr[C2=hdr.length]=k2);var v2=JS[k2],t2="z",z2="",ref=encode_cell({c:_C+C2,r:_R+R2+offset});cell=ws_get_cell_stub(ws,ref),v2&&typeof v2=="object"&&!(v2 instanceof Date)?ws[ref]=v2:(typeof v2=="number"?t2="n":typeof v2=="boolean"?t2="b":typeof v2=="string"?t2="s":v2 instanceof Date?(t2="d",o2.cellDates||(t2="n",v2=datenum(v2)),z2=o2.dateNF||table_fmt[14]):v2===null&&o2.nullError&&(t2="e",v2=0),cell?(cell.t=t2,cell.v=v2,delete cell.w,delete cell.R,z2&&(cell.z=z2)):ws[ref]=cell={t:t2,v:v2},z2&&(cell.z=z2))})}),range.e.c=Math.max(range.e.c,_C+hdr.length-1);var __R=encode_row(_R);if(offset)for(C2=0;C2<hdr.length;++C2)ws[encode_col(C2+_C)+__R]={t:"s",v:hdr[C2]};return ws["!ref"]=encode_range(range),ws}function json_to_sheet(js,opts){return sheet_add_json(null,js,opts)}function ws_get_cell_stub(ws,R2,C2){if(typeof R2=="string"){if(Array.isArray(ws)){var RC=decode_cell(R2);return ws[RC.r]||(ws[RC.r]=[]),ws[RC.r][RC.c]||(ws[RC.r][RC.c]={t:"z"})}return ws[R2]||(ws[R2]={t:"z"})}return typeof R2!="number"?ws_get_cell_stub(ws,encode_cell(R2)):ws_get_cell_stub(ws,encode_cell({r:R2,c:C2||0}))}function wb_sheet_idx(wb,sh){if(typeof sh=="number"){if(sh>=0&&wb.SheetNames.length>sh)return sh;throw new Error("Cannot find sheet # "+sh)}else if(typeof sh=="string"){var idx=wb.SheetNames.indexOf(sh);if(idx>-1)return idx;throw new Error("Cannot find sheet name |"+sh+"|")}else throw new Error("Cannot find sheet |"+sh+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(wb,ws,name,roll){var i2=1;if(!name)for(;i2<=65535&&wb.SheetNames.indexOf(name="Sheet"+i2)!=-1;++i2,name=void 0);if(!name||wb.SheetNames.length>=65535)throw new Error("Too many worksheets");if(roll&&wb.SheetNames.indexOf(name)>=0){var m2=name.match(/(^.*?)(\d+)$/);i2=m2&&+m2[2]||0;var root=m2&&m2[1]||name;for(++i2;i2<=65535&&wb.SheetNames.indexOf(name=root+i2)!=-1;++i2);}if(check_ws_name(name),wb.SheetNames.indexOf(name)>=0)throw new Error("Worksheet with name |"+name+"| already exists!");return wb.SheetNames.push(name),wb.Sheets[name]=ws,name}function book_set_sheet_visibility(wb,sh,vis){wb.Workbook||(wb.Workbook={}),wb.Workbook.Sheets||(wb.Workbook.Sheets=[]);var idx=wb_sheet_idx(wb,sh);switch(wb.Workbook.Sheets[idx]||(wb.Workbook.Sheets[idx]={}),vis){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+vis)}wb.Workbook.Sheets[idx].Hidden=vis}function cell_set_number_format(cell,fmt){return cell.z=fmt,cell}function cell_set_hyperlink(cell,target,tooltip){return target?(cell.l={Target:target},tooltip&&(cell.l.Tooltip=tooltip)):delete cell.l,cell}function cell_set_internal_link(cell,range,tooltip){return cell_set_hyperlink(cell,"#"+range,tooltip)}function cell_add_comment(cell,text,author){cell.c||(cell.c=[]),cell.c.push({t:text,a:author||"SheetJS"})}function sheet_set_array_formula(ws,range,formula,dynamic){for(var rng=typeof range!="string"?range:safe_decode_range(range),rngstr=typeof range=="string"?range:encode_range(range),R2=rng.s.r;R2<=rng.e.r;++R2)for(var C2=rng.s.c;C2<=rng.e.c;++C2){var cell=ws_get_cell_stub(ws,R2,C2);cell.t="n",cell.F=rngstr,delete cell.v,R2==rng.s.r&&C2==rng.s.c&&(cell.f=formula,dynamic&&(cell.D=!0))}return ws}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const downloadFile=(blob,filename)=>{console.log("[Download] Creating download for:",filename),console.log("[Download] Blob size:",blob.size,"bytes");const url=window.URL.createObjectURL(blob),a2=document.createElement("a");a2.style.display="none",a2.href=url,a2.download=filename,document.body.appendChild(a2),a2.click(),console.log("[Download] Click triggered for:",filename),setTimeout(()=>{document.body.removeChild(a2),window.URL.revokeObjectURL(url),console.log("[Download] Cleanup done")},100)},exportToPDF=(data,columns,summary,options)=>{const doc=new E;doc.setFontSize(18),doc.setFont("helvetica","bold"),doc.text(options.title,14,20),doc.setFontSize(10),doc.setFont("helvetica","normal"),doc.text(`Periode: ${options.period}`,14,28),doc.text(`Dicetak: ${new Date().toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}`,14,34);let yPos=45;doc.setFontSize(12),doc.setFont("helvetica","bold"),doc.text("Ringkasan",14,yPos),yPos+=8,doc.setFontSize(10),doc.setFont("helvetica","normal"),summary.forEach((item,index)=>{const xOffset=index%2===0?14:110;index%2===0&&index>0&&(yPos+=7),doc.text(`${item.label}: ${item.value}`,xOffset,yPos)}),yPos+=15;const tableData=data.map(row=>columns.map(col=>{const value=row[col.key];return value==null?"-":typeof value=="number"?value.toLocaleString("id-ID"):String(value)}));autoTable(doc,{startY:yPos,head:[columns.map(col=>col.header)],body:tableData,theme:"grid",headStyles:{fillColor:[34,139,34],textColor:255,fontStyle:"bold"},styles:{fontSize:9,cellPadding:3},alternateRowStyles:{fillColor:[245,245,245]}});const pageCount=doc.getNumberOfPages();for(let i2=1;i2<=pageCount;i2++)doc.setPage(i2),doc.setFontSize(8),doc.setTextColor(150),doc.text(`SIM4LON - Halaman ${i2} dari ${pageCount}`,doc.internal.pageSize.width/2,doc.internal.pageSize.height-10,{align:"center"});const pdfFilename=options.filename.endsWith(".pdf")?options.filename:`${options.filename}.pdf`,pdfBlob=doc.output("blob");downloadFile(pdfBlob,pdfFilename)},exportToExcel=(data,columns,summary,options)=>{const wb=utils.book_new(),summaryData=[[options.title],[`Periode: ${options.period}`],[`Dicetak: ${new Date().toLocaleDateString("id-ID")}`],[],["RINGKASAN"],...summary.map(item=>[item.label,String(item.value)])],summarySheet=utils.aoa_to_sheet(summaryData);utils.book_append_sheet(wb,summarySheet,"Ringkasan");const headers=columns.map(col=>col.header),rows=data.map(row=>columns.map(col=>row[col.key]??"-")),dataSheet=utils.aoa_to_sheet([headers,...rows]);dataSheet["!cols"]=columns.map(col=>({wch:col.width||15})),utils.book_append_sheet(wb,dataSheet,"Data");const xlsxFilename=options.filename.endsWith(".xlsx")?options.filename:`${options.filename}.xlsx`,wbout=writeSync(wb,{bookType:"xlsx",type:"array"}),blob=new Blob([wbout],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});downloadFile(blob,xlsxFilename)},formatCurrencyExport=value=>`Rp ${value.toLocaleString("id-ID")}`,formatDateExport=dateString=>new Date(dateString).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),formatCurrency=value=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(value),formatDate=dateString=>{const date=new Date(dateString),dateStr=date.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),timeStr=date.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"});return`${dateStr}, ${timeStr}`},getDateRange=preset=>{const now=new Date;let start,end=new Date(now.getFullYear(),now.getMonth(),now.getDate(),23,59,59);switch(preset){case"today":start=new Date(now.getFullYear(),now.getMonth(),now.getDate(),0,0,0);break;case"7days":start=new Date(now.getTime()-10080*60*1e3);break;case"30days":start=new Date(now.getTime()-720*60*60*1e3);break;case"month":start=new Date(now.getFullYear(),now.getMonth(),1),end=new Date(now.getFullYear(),now.getMonth()+1,0,23,59,59);break;case"year":start=new Date(now.getFullYear(),0,1),end=new Date(now.getFullYear(),11,31,23,59,59);break;default:start=new Date(now.getFullYear(),now.getMonth(),1)}return{start:start.toISOString(),end:end.toISOString()}};function ReportsPage(){const[activeTab,setActiveTab]=reactExports.useState("sales"),[datePreset,setDatePreset]=reactExports.useState("month"),[customStart,setCustomStart]=reactExports.useState(""),[customEnd,setCustomEnd]=reactExports.useState(""),[isLoading,setIsLoading]=reactExports.useState(!0),rowsPerPageOptions=[10,25,50],[salesRowsPerPage,setSalesRowsPerPage]=reactExports.useState(10),[salesCurrentPage,setSalesCurrentPage]=reactExports.useState(1),[paymentsRowsPerPage,setPaymentsRowsPerPage]=reactExports.useState(10),[paymentsCurrentPage,setPaymentsCurrentPage]=reactExports.useState(1),[stockRowsPerPage,setStockRowsPerPage]=reactExports.useState(10),[stockCurrentPage,setStockCurrentPage]=reactExports.useState(1),[salesData,setSalesData]=reactExports.useState(null),[paymentsData,setPaymentsData]=reactExports.useState(null),[stockData,setStockData]=reactExports.useState(null),[dailySalesTarget,setDailySalesTarget]=reactExports.useState(35e6),[isEditingTarget,setIsEditingTarget]=reactExports.useState(!1),[tempTarget,setTempTarget]=reactExports.useState("");reactExports.useEffect(()=>{const savedTarget=localStorage.getItem("dailySalesTarget");savedTarget&&setDailySalesTarget(Number(savedTarget))},[]);const handleSaveTarget=()=>{const newTarget=Number(tempTarget.replace(/\D/g,""));newTarget>0?(setDailySalesTarget(newTarget),localStorage.setItem("dailySalesTarget",String(newTarget)),setIsEditingTarget(!1),toast.success("Target penjualan berhasil disimpan!")):toast.error("Masukkan nilai target yang valid")},fetchReports=async()=>{setIsLoading(!0);try{const range=datePreset==="custom"&&customStart&&customEnd?{start:new Date(customStart).toISOString(),end:new Date(customEnd).toISOString()}:getDateRange(datePreset),[sales,payments,stock]=await Promise.all([reportsApi.getSalesReport(range.start,range.end),reportsApi.getPaymentsReport(range.start,range.end),reportsApi.getStockMovementReport(range.start,range.end)]);setSalesData(sales),setPaymentsData(payments),setStockData(stock)}catch(error){toast.error(error.message||"Gagal memuat laporan")}finally{setIsLoading(!1)}};reactExports.useEffect(()=>{fetchReports()},[datePreset]);const handlePresetChange=value=>{setDatePreset(value)},handleCustomDateApply=()=>{customStart&&customEnd&&fetchReports()},statusLabels={DRAFT:"DRAFT",MENUNGGU_PEMBAYARAN:"MENUNGGU PEMBAYARAN",DIPROSES:"DIPROSES",DIKIRIM:"DIKIRIM",SELESAI:"SELESAI",DIBATALKAN:"BATAL"},getStatusColor=status=>{switch(status){case"SELESAI":return"bg-green-100 text-green-800";case"DIKIRIM":return"bg-blue-100 text-blue-800";case"DIPROSES":return"bg-yellow-100 text-yellow-800";case"MENUNGGU_PEMBAYARAN":return"bg-orange-100 text-orange-800";case"DIBATALKAN":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},CHART_COLORS={primary:"#22c55e",secondary:"#f59e0b",accent:"#3b82f6"},PIE_COLORS=["#22c55e","#f59e0b","#3b82f6","#ef4444","#8b5cf6","#06b6d4"],salesChartData=reactExports.useMemo(()=>{if(!salesData?.data)return[];const groupedByDate={};return salesData.data.forEach(item=>{const dateKey=new Date(item.date).toLocaleDateString("id-ID",{day:"numeric",month:"short"});groupedByDate[dateKey]||(groupedByDate[dateKey]={date:dateKey,total:0,count:0,target:dailySalesTarget}),groupedByDate[dateKey].total+=item.total,groupedByDate[dateKey].count+=1}),Object.values(groupedByDate).reverse()},[salesData,dailySalesTarget]),growthPercentage=reactExports.useMemo(()=>{if(!salesData?.data||salesData.data.length===0)return 0;const totalRevenue=salesData.summary.total_revenue||0,daysInPeriod=salesChartData.length||1;return(totalRevenue/daysInPeriod-dailySalesTarget)/dailySalesTarget*100},[salesData,salesChartData,dailySalesTarget]),salesByStatusData=reactExports.useMemo(()=>salesData?.summary.status_breakdown?Object.entries(salesData.summary.status_breakdown).map(([status,count])=>({name:statusLabels[status]||status,value:count})):[],[salesData]),paymentMethodData=reactExports.useMemo(()=>paymentsData?.summary.method_breakdown?Object.entries(paymentsData.summary.method_breakdown).map(([method,data])=>({name:method,count:data.count,amount:data.amount/1e6})):[],[paymentsData]),paymentChartData=reactExports.useMemo(()=>{if(!paymentsData?.data)return[];const groupedByDate={};return paymentsData.data.forEach(item=>{const dateKey=new Date(item.date).toLocaleDateString("id-ID",{day:"numeric",month:"short"});groupedByDate[dateKey]||(groupedByDate[dateKey]={date:dateKey,amount:0,count:0}),groupedByDate[dateKey].amount+=item.amount,groupedByDate[dateKey].count+=1}),Object.values(groupedByDate).reverse()},[paymentsData]),stockChartData=reactExports.useMemo(()=>{if(!stockData?.data)return[];const groupedByDate={};return stockData.data.forEach(item=>{const dateKey=new Date(item.date).toLocaleDateString("id-ID",{day:"numeric",month:"short"});groupedByDate[dateKey]||(groupedByDate[dateKey]={date:dateKey,masuk:0,keluar:0}),item.type==="MASUK"?groupedByDate[dateKey].masuk+=item.qty:groupedByDate[dateKey].keluar+=item.qty}),Object.values(groupedByDate).reverse()},[stockData]),stockByProductData=reactExports.useMemo(()=>{if(!stockData?.data)return[];const groupedByProduct={};return stockData.data.forEach(item=>{const product=item.product;groupedByProduct[product]||(groupedByProduct[product]={product,masuk:0,keluar:0}),item.type==="MASUK"?groupedByProduct[product].masuk+=item.qty:groupedByProduct[product].keluar+=item.qty}),Object.values(groupedByProduct)},[stockData]),getPeriodLabel=()=>salesData?.period?`${formatDateExport(salesData.period.start)} - ${formatDateExport(salesData.period.end)}`:"Bulan Ini",handleExportPDF=()=>{try{const title=`Laporan ${{sales:"Penjualan",payments:"Pembayaran",stock:"Stok"}[activeTab]}`,period=getPeriodLabel(),filename=`laporan-${activeTab}-${new Date().toISOString().split("T")[0]}`;if(activeTab==="sales"&&salesData){const columns=[{header:"Tanggal",key:"date",width:15},{header:"Kode",key:"code",width:12},{header:"Pangkalan",key:"pangkalan",width:25},{header:"Total",key:"total",width:18},{header:"Status",key:"status",width:15}],data=salesData.data.map(item=>({...item,date:formatDateExport(item.date),total:formatCurrencyExport(item.total),status:statusLabels[item.status]||item.status})),summary=[{label:"Total Pesanan",value:salesData.summary.total_orders},{label:"Total Pendapatan",value:formatCurrencyExport(salesData.summary.total_revenue)},{label:"Rata-rata Pesanan",value:formatCurrencyExport(salesData.summary.average_order)},{label:"Pesanan Selesai",value:salesData.summary.status_breakdown?.SELESAI||0}];exportToPDF(data,columns,summary,{title,period,filename})}else if(activeTab==="payments"&&paymentsData){const columns=[{header:"Tanggal",key:"date",width:15},{header:"Invoice",key:"invoice_number",width:15},{header:"Pangkalan",key:"pangkalan",width:25},{header:"Jumlah",key:"amount",width:18},{header:"Metode",key:"method",width:12},{header:"Dicatat Oleh",key:"recorded_by",width:15}],data=paymentsData.data.map(item=>({...item,date:formatDateExport(item.date),amount:formatCurrencyExport(item.amount)})),summary=[{label:"Jumlah Pembayaran",value:paymentsData.summary.total_payments},{label:"Total Diterima",value:formatCurrencyExport(paymentsData.summary.total_amount)},{label:"Rata-rata Pembayaran",value:formatCurrencyExport(paymentsData.summary.average_payment)}];exportToPDF(data,columns,summary,{title,period,filename})}else if(activeTab==="stock"&&stockData){const columns=[{header:"Tanggal",key:"date",width:15},{header:"Produk",key:"product",width:20},{header:"Tipe",key:"type",width:10},{header:"Qty",key:"qty",width:10},{header:"Keterangan",key:"note",width:25},{header:"Dicatat Oleh",key:"recorded_by",width:15}],data=stockData.data.map(item=>({...item,date:formatDateExport(item.date),note:item.note||"-"})),summary=[{label:"Total Masuk",value:`+${stockData.summary.total_in}`},{label:"Total Keluar",value:`-${stockData.summary.total_out}`},{label:"Perubahan Bersih",value:stockData.summary.net_change},{label:"Saldo Akhir",value:stockData.summary.current_balance}];exportToPDF(data,columns,summary,{title,period,filename})}toast.success("PDF berhasil diexport!")}catch{toast.error("Gagal export PDF")}},handleExportExcel=()=>{try{const title=`Laporan ${{sales:"Penjualan",payments:"Pembayaran",stock:"Stok"}[activeTab]}`,period=getPeriodLabel(),filename=`laporan-${activeTab}-${new Date().toISOString().split("T")[0]}`;if(activeTab==="sales"&&salesData){const columns=[{header:"Tanggal",key:"date"},{header:"Kode",key:"code"},{header:"Pangkalan",key:"pangkalan"},{header:"Subtotal",key:"subtotal"},{header:"Pajak",key:"tax"},{header:"Total",key:"total"},{header:"Status",key:"status"}],data=salesData.data.map(item=>({...item,date:formatDateExport(item.date),status:statusLabels[item.status]||item.status})),summary=[{label:"Total Pesanan",value:salesData.summary.total_orders},{label:"Total Pendapatan",value:salesData.summary.total_revenue},{label:"Rata-rata Pesanan",value:salesData.summary.average_order}];exportToExcel(data,columns,summary,{title,period,filename})}else if(activeTab==="payments"&&paymentsData){const columns=[{header:"Tanggal",key:"date"},{header:"Invoice",key:"invoice_number"},{header:"Order",key:"order_code"},{header:"Pangkalan",key:"pangkalan"},{header:"Jumlah",key:"amount"},{header:"Metode",key:"method"},{header:"Catatan",key:"note"},{header:"Dicatat Oleh",key:"recorded_by"}],data=paymentsData.data.map(item=>({...item,date:formatDateExport(item.date)})),summary=[{label:"Jumlah Pembayaran",value:paymentsData.summary.total_payments},{label:"Total Diterima",value:paymentsData.summary.total_amount},{label:"Rata-rata Pembayaran",value:paymentsData.summary.average_payment}];exportToExcel(data,columns,summary,{title,period,filename})}else if(activeTab==="stock"&&stockData){const columns=[{header:"Tanggal",key:"date"},{header:"Produk",key:"product"},{header:"Tipe",key:"type"},{header:"Qty",key:"qty"},{header:"Keterangan",key:"note"},{header:"Dicatat Oleh",key:"recorded_by"}],data=stockData.data.map(item=>({...item,date:formatDateExport(item.date)})),summary=[{label:"Total Masuk",value:stockData.summary.total_in},{label:"Total Keluar",value:stockData.summary.total_out},{label:"Perubahan Bersih",value:stockData.summary.net_change},{label:"Saldo Akhir",value:stockData.summary.current_balance}];exportToExcel(data,columns,summary,{title,period,filename})}toast.success("Excel berhasil diexport!")}catch{toast.error("Gagal export Excel")}};return jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsx(Card,{className:"border-border/50 shadow-sm",children:jsxRuntimeExports.jsx(CardContent,{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-muted/50",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Calendar",className:"h-4 w-4 text-muted-foreground"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-foreground",children:"Periode"})]}),jsxRuntimeExports.jsxs(Select,{value:datePreset,onValueChange:handlePresetChange,children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-[180px] bg-background border-border/50 hover:border-primary/50 transition-colors",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Pilih periode"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[jsxRuntimeExports.jsx(SelectItem,{value:"today",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Clock",className:"h-3.5 w-3.5 text-muted-foreground"}),"Hari Ini"]})}),jsxRuntimeExports.jsx(SelectItem,{value:"7days",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Calendar",className:"h-3.5 w-3.5 text-muted-foreground"}),"7 Hari Terakhir"]})}),jsxRuntimeExports.jsx(SelectItem,{value:"30days",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Calendar",className:"h-3.5 w-3.5 text-muted-foreground"}),"30 Hari Terakhir"]})}),jsxRuntimeExports.jsx(SelectItem,{value:"month",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"CalendarDays",className:"h-3.5 w-3.5 text-muted-foreground"}),"Bulan Ini"]})}),jsxRuntimeExports.jsx(SelectItem,{value:"year",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"CalendarRange",className:"h-3.5 w-3.5 text-muted-foreground"}),"Tahun Ini"]})}),jsxRuntimeExports.jsx(SelectItem,{value:"custom",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Settings2",className:"h-3.5 w-3.5 text-muted-foreground"}),"Custom"]})})]})]}),datePreset==="custom"&&jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center bg-muted/30 p-2 rounded-lg border border-border/50",children:[jsxRuntimeExports.jsx(Input,{type:"date",value:customStart,onChange:e=>setCustomStart(e.target.value),className:"w-[140px] h-9 bg-background"}),jsxRuntimeExports.jsx(SafeIcon,{name:"ArrowRight",className:"h-4 w-4 text-muted-foreground"}),jsxRuntimeExports.jsx(Input,{type:"date",value:customEnd,onChange:e=>setCustomEnd(e.target.value),className:"w-[140px] h-9 bg-background"}),jsxRuntimeExports.jsxs(Button,{size:"sm",onClick:handleCustomDateApply,className:"h-9",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Check",className:"h-4 w-4 mr-1"}),"Terapkan"]})]}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"icon",onClick:fetchReports,disabled:isLoading,className:"h-9 w-9 hover:bg-primary/10 hover:text-primary",children:jsxRuntimeExports.jsx(SafeIcon,{name:"RefreshCw",className:`h-4 w-4 ${isLoading?"animate-spin":""}`})})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",disabled:isLoading,onClick:handleExportPDF,className:"border-red-200 text-red-600 hover:bg-red-50 hover:text-red-700 hover:border-red-300 transition-colors",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"FileText",className:"h-4 w-4 mr-2"}),"Export PDF"]}),jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",disabled:isLoading,onClick:handleExportExcel,className:"border-green-200 text-green-600 hover:bg-green-50 hover:text-green-700 hover:border-green-300 transition-colors",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"FileSpreadsheet",className:"h-4 w-4 mr-2"}),"Export Excel"]})]})]})})}),jsxRuntimeExports.jsxs(Tabs,{value:activeTab,onValueChange:setActiveTab,className:"space-y-4",children:[jsxRuntimeExports.jsxs(TabsList,{className:"inline-flex h-auto gap-1 rounded-xl bg-slate-200/80 p-1.5 border border-slate-300 shadow-sm",children:[jsxRuntimeExports.jsxs(TabsTrigger,{value:"sales",className:"relative flex items-center gap-2 rounded-lg px-4 py-2.5 text-sm font-medium transition-all duration-200 text-slate-600 data-[state=active]:bg-green-100 data-[state=active]:text-green-800 data-[state=active]:shadow-md data-[state=active]:border data-[state=active]:border-green-200 hover:bg-green-50 hover:text-green-700",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"ShoppingCart",className:"h-4 w-4"}),jsxRuntimeExports.jsx("span",{children:"Penjualan"}),salesData&&salesData.summary.total_orders>0&&jsxRuntimeExports.jsx(Badge,{variant:"secondary",className:"ml-1 h-5 min-w-5 rounded-full px-1.5 text-xs font-medium bg-green-200/20 text-green-800",children:salesData.summary.total_orders})]}),jsxRuntimeExports.jsxs(TabsTrigger,{value:"payments",className:"relative flex items-center gap-2 rounded-lg px-4 py-2.5 text-sm font-medium transition-all duration-200 text-slate-600 data-[state=active]:bg-blue-100 data-[state=active]:text-blue-800 data-[state=active]:shadow-md data-[state=active]:border data-[state=active]:border-blue-200 hover:bg-blue-50 hover:text-blue-700",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"CreditCard",className:"h-4 w-4"}),jsxRuntimeExports.jsx("span",{children:"Pembayaran"}),paymentsData&&paymentsData.summary.total_payments>0&&jsxRuntimeExports.jsx(Badge,{variant:"secondary",className:"ml-1 h-5 min-w-5 rounded-full px-1.5 text-xs font-medium bg-blue-200/20 text-blue-800",children:paymentsData.summary.total_payments})]}),jsxRuntimeExports.jsxs(TabsTrigger,{value:"stock",className:"relative flex items-center gap-2 rounded-lg px-4 py-2.5 text-sm font-medium transition-all duration-200 text-slate-600 data-[state=active]:bg-orange-100 data-[state=active]:text-orange-800 data-[state=active]:shadow-md data-[state=active]:border data-[state=active]:border-orange-200 hover:bg-orange-50 hover:text-orange-700",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Package",className:"h-4 w-4"}),jsxRuntimeExports.jsx("span",{children:"Stok"}),stockData&&stockData.summary.movement_count>0&&jsxRuntimeExports.jsx(Badge,{variant:"secondary",className:"ml-1 h-5 min-w-5 rounded-full px-1.5 text-xs font-medium bg-orange-200/20 text-orange-800",children:stockData.summary.movement_count})]})]}),jsxRuntimeExports.jsxs(TabsContent,{value:"sales",className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-semibold text-foreground/70",children:"Total Pesanan"}),jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-blue-50",children:jsxRuntimeExports.jsx(SafeIcon,{name:"ShoppingCart",className:"h-4 w-4 text-blue-600"})})]}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-primary",children:isLoading?"...":salesData?.summary.total_orders||0}),jsxRuntimeExports.jsx("p",{className:"text-xs text-foreground/60 mt-1",children:"Pesanan dalam periode"})]})]})}),jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.1s"},children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-semibold text-foreground/70",children:"Total Pendapatan"}),jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-green-50",children:jsxRuntimeExports.jsx(SafeIcon,{name:"TrendingUp",className:"h-4 w-4 text-green-600"})})]}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-primary",children:isLoading?"...":formatCurrency(salesData?.summary.total_revenue||0)}),jsxRuntimeExports.jsx("p",{className:"text-xs text-foreground/60 mt-1",children:"Revenue keseluruhan"})]})]})}),jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.2s"},children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-semibold text-foreground/70",children:"Rata-rata Pesanan"}),jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-purple-50",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Calculator",className:"h-4 w-4 text-purple-600"})})]}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-primary",children:isLoading?"...":formatCurrency(salesData?.summary.average_order||0)}),jsxRuntimeExports.jsx("p",{className:"text-xs text-foreground/60 mt-1",children:"Per transaksi"})]})]})}),jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.3s"},children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-semibold text-foreground/70",children:"Pertumbuhan"}),jsxRuntimeExports.jsx("div",{className:`p-2 rounded-lg ${growthPercentage>=0?"bg-green-50":"bg-red-50"}`,children:jsxRuntimeExports.jsx(SafeIcon,{name:growthPercentage>=0?"TrendingUp":"TrendingDown",className:`h-4 w-4 ${growthPercentage>=0?"text-green-600":"text-red-600"}`})})]}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("div",{className:`text-2xl font-bold ${growthPercentage>=0?"text-green-600":"text-red-600"}`,children:isLoading?"...":`${growthPercentage>=0?"+":""}${growthPercentage.toFixed(1)}%`}),jsxRuntimeExports.jsx("p",{className:"text-xs text-foreground/60 mt-1",children:"Vs target harian"})]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[jsxRuntimeExports.jsxs(Card,{className:"border-border/50",children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-2",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Tren Penjualan"}),jsxRuntimeExports.jsx(CardDescription,{children:"Total pendapatan per hari dalam periode ini"})]}),isEditingTarget?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Input,{type:"text",value:tempTarget,onChange:e=>setTempTarget(e.target.value.replace(/\D/g,"")),className:"w-32 h-8 text-sm",placeholder:"Rp",autoFocus:!0}),jsxRuntimeExports.jsx(Button,{size:"sm",className:"h-8 px-2",onClick:handleSaveTarget,children:jsxRuntimeExports.jsx(SafeIcon,{name:"Check",className:"h-4 w-4"})}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",className:"h-8 px-2",onClick:()=>setIsEditingTarget(!1),children:jsxRuntimeExports.jsx(SafeIcon,{name:"X",className:"h-4 w-4"})})]}):jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",className:"text-xs gap-1",onClick:()=>{setTempTarget(String(dailySalesTarget)),setIsEditingTarget(!0)},children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Settings2",className:"h-3 w-3"}),"Target: ",formatCurrency(dailySalesTarget)]})]})}),jsxRuntimeExports.jsx(CardContent,{children:isLoading?jsxRuntimeExports.jsx("div",{className:"h-[300px] flex items-center justify-center",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-8 w-8 animate-spin text-muted-foreground"})}):salesChartData.length===0?jsxRuntimeExports.jsxs("div",{className:"h-[300px] flex flex-col items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"LineChart",className:"h-12 w-12 text-muted-foreground/40"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Tidak ada data trend"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground/70",children:"Coba ubah filter periode"})]}):jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:300,children:jsxRuntimeExports.jsxs(LineChart,{data:salesChartData,children:[jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),jsxRuntimeExports.jsx(XAxis,{dataKey:"date",tick:{fontSize:12}}),jsxRuntimeExports.jsx(YAxis,{tickFormatter:value=>`${(value/1e6).toFixed(1)}Jt`,tick:{fontSize:12}}),jsxRuntimeExports.jsx(Tooltip,{formatter:(value,name)=>[formatCurrency(value),name],labelFormatter:label=>`Tanggal: ${label}`}),jsxRuntimeExports.jsx(Legend,{}),jsxRuntimeExports.jsx(Line,{type:"monotone",dataKey:"total",name:"Penjualan Aktual",stroke:CHART_COLORS.primary,strokeWidth:2,dot:{fill:CHART_COLORS.primary,strokeWidth:2}}),jsxRuntimeExports.jsx(Line,{type:"monotone",dataKey:"target",name:"Target Penjualan",stroke:CHART_COLORS.secondary,strokeWidth:2,strokeDasharray:"5 5",dot:{fill:CHART_COLORS.secondary,strokeWidth:2,r:3}})]})})})]}),jsxRuntimeExports.jsxs(Card,{className:"border-border/50",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Status Pesanan"}),jsxRuntimeExports.jsx(CardDescription,{children:"Distribusi pesanan berdasarkan status"})]}),jsxRuntimeExports.jsx(CardContent,{children:isLoading?jsxRuntimeExports.jsx("div",{className:"h-[300px] flex items-center justify-center",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-8 w-8 animate-spin text-muted-foreground"})}):salesByStatusData.length===0?jsxRuntimeExports.jsxs("div",{className:"h-[300px] flex flex-col items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"PieChart",className:"h-12 w-12 text-muted-foreground/40"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Tidak ada data status"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground/70",children:"Coba ubah filter periode"})]}):jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:300,children:jsxRuntimeExports.jsxs(PieChart,{children:[jsxRuntimeExports.jsx(Pie,{data:salesByStatusData,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:4,dataKey:"value",label:({name,percent})=>`${name} (${(percent*100).toFixed(0)}%)`,labelLine:{stroke:"#6b7280",strokeWidth:1},children:salesByStatusData.map((_2,index)=>jsxRuntimeExports.jsx(Cell$1,{fill:PIE_COLORS[index%PIE_COLORS.length]},`cell-${index}`))}),jsxRuntimeExports.jsx(Tooltip,{formatter:value=>[value,"Pesanan"]})]})})})]})]}),jsxRuntimeExports.jsxs(Card,{className:"border-border/50",children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-3",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"List",className:"h-5 w-5 text-muted-foreground"}),jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Detail Penjualan"})]}),salesData&&salesData.data.length>0&&jsxRuntimeExports.jsxs(Badge,{variant:"secondary",className:"bg-muted px-2 py-1",children:[salesData.data.length," transaksi"]})]})}),jsxRuntimeExports.jsxs(CardContent,{className:"p-0",children:[jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full",children:[jsxRuntimeExports.jsx("thead",{className:"bg-muted/50 border-t border-border",children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Tanggal"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Kode"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Pangkalan"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-muted-foreground",children:"Total"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-muted-foreground",children:"Status"})]})}),jsxRuntimeExports.jsx("tbody",{className:"divide-y divide-border",children:isLoading?jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{colSpan:5,className:"px-4 py-8 text-center",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-6 w-6 animate-spin mx-auto text-muted-foreground"})})}):salesData?.data.length===0?jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{colSpan:5,className:"px-4 py-12 text-center",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"ShoppingCart",className:"h-10 w-10 text-muted-foreground/50"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Tidak ada data penjualan"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground/70",children:"Coba ubah filter periode"})]})})}):salesData?.data.slice((salesCurrentPage-1)*salesRowsPerPage,salesCurrentPage*salesRowsPerPage).map(item=>jsxRuntimeExports.jsxs("tr",{className:"hover:bg-muted/30 transition-colors",children:[jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm",children:formatDate(item.date)}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm font-medium font-mono text-green-600",children:item.code}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm",children:item.pangkalan}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium",children:formatCurrency(item.total)}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-center",children:jsxRuntimeExports.jsx(Badge,{className:`${getStatusColor(item.status)} hover:bg-inherit`,children:statusLabels[item.status]||item.status})})]},item.id))})]})}),salesData&&salesData.data.length>0&&jsxRuntimeExports.jsxs("div",{className:"p-3 border-t border-border flex flex-col sm:flex-row items-center justify-between gap-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[jsxRuntimeExports.jsx("span",{children:"Tampilkan"}),jsxRuntimeExports.jsxs(Select,{value:String(salesRowsPerPage),onValueChange:v2=>{setSalesRowsPerPage(Number(v2)),setSalesCurrentPage(1)},children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-[70px] h-8",children:jsxRuntimeExports.jsx(SelectValue,{})}),jsxRuntimeExports.jsx(SelectContent,{children:rowsPerPageOptions.map(opt=>jsxRuntimeExports.jsx(SelectItem,{value:String(opt),children:opt},opt))})]}),jsxRuntimeExports.jsxs("span",{children:["dari ",salesData.data.length," data"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:()=>setSalesCurrentPage(p2=>Math.max(1,p2-1)),disabled:salesCurrentPage===1,className:"h-8 px-2",children:jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronLeft",className:"h-4 w-4"})}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-muted-foreground min-w-[80px] text-center",children:["Hal ",salesCurrentPage," / ",Math.ceil(salesData.data.length/salesRowsPerPage)]}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:()=>setSalesCurrentPage(p2=>Math.min(Math.ceil(salesData.data.length/salesRowsPerPage),p2+1)),disabled:salesCurrentPage>=Math.ceil(salesData.data.length/salesRowsPerPage),className:"h-8 px-2",children:jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronRight",className:"h-4 w-4"})})]})]})]})]})]}),jsxRuntimeExports.jsxs(TabsContent,{value:"payments",className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-semibold text-foreground/70",children:"Jumlah Pembayaran"}),jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-blue-50",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Receipt",className:"h-4 w-4 text-blue-600"})})]}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-primary",children:isLoading?"...":paymentsData?.summary.total_payments||0}),jsxRuntimeExports.jsx("p",{className:"text-xs text-foreground/60 mt-1",children:"Total transaksi"})]})]})}),jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.1s"},children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-semibold text-foreground/70",children:"Total Diterima"}),jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-green-50",children:jsxRuntimeExports.jsx(SafeIcon,{name:"DollarSign",className:"h-4 w-4 text-green-600"})})]}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-primary",children:isLoading?"...":formatCurrency(paymentsData?.summary.total_amount||0)}),jsxRuntimeExports.jsx("p",{className:"text-xs text-foreground/60 mt-1",children:"Pembayaran diterima"})]})]})}),jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.2s"},children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-semibold text-foreground/70",children:"Rata-rata Pembayaran"}),jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-purple-50",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Calculator",className:"h-4 w-4 text-purple-600"})})]}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-primary",children:isLoading?"...":formatCurrency(paymentsData?.summary.average_payment||0)}),jsxRuntimeExports.jsx("p",{className:"text-xs text-foreground/60 mt-1",children:"Per transaksi"})]})]})}),jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.3s"},children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-semibold text-foreground/70",children:"Metode Terbanyak"}),jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-orange-50",children:jsxRuntimeExports.jsx(SafeIcon,{name:"CreditCard",className:"h-4 w-4 text-orange-600"})})]}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-primary",children:isLoading?"...":Object.entries(paymentsData?.summary.method_breakdown||{}).sort(([,a2],[,b2])=>b2.count-a2.count)[0]?.[0]||"-"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-foreground/60 mt-1",children:"Metode populer"})]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[jsxRuntimeExports.jsxs(Card,{className:"border-border/50",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Tren Pembayaran"}),jsxRuntimeExports.jsx(CardDescription,{children:"Total pembayaran per hari dalam periode ini"})]}),jsxRuntimeExports.jsx(CardContent,{children:isLoading?jsxRuntimeExports.jsx("div",{className:"h-[300px] flex items-center justify-center",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-8 w-8 animate-spin text-muted-foreground"})}):paymentChartData.length===0?jsxRuntimeExports.jsxs("div",{className:"h-[300px] flex flex-col items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"LineChart",className:"h-12 w-12 text-muted-foreground/40"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Tidak ada data trend"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground/70",children:"Coba ubah filter periode"})]}):jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:300,children:jsxRuntimeExports.jsxs(LineChart,{data:paymentChartData,children:[jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),jsxRuntimeExports.jsx(XAxis,{dataKey:"date",tick:{fontSize:12}}),jsxRuntimeExports.jsx(YAxis,{tickFormatter:value=>`${(value/1e6).toFixed(1)}Jt`,tick:{fontSize:12}}),jsxRuntimeExports.jsx(Tooltip,{formatter:value=>[formatCurrency(value),"Jumlah"],labelFormatter:label=>`Tanggal: ${label}`}),jsxRuntimeExports.jsx(Legend,{}),jsxRuntimeExports.jsx(Line,{type:"monotone",dataKey:"amount",name:"Pembayaran",stroke:CHART_COLORS.accent,strokeWidth:2,dot:{fill:CHART_COLORS.accent,strokeWidth:2}})]})})})]}),jsxRuntimeExports.jsxs(Card,{className:"border-border/50",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Metode Pembayaran"}),jsxRuntimeExports.jsx(CardDescription,{children:"Distribusi jumlah & total per metode"})]}),jsxRuntimeExports.jsx(CardContent,{children:isLoading?jsxRuntimeExports.jsx("div",{className:"h-[300px] flex items-center justify-center",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-8 w-8 animate-spin text-muted-foreground"})}):paymentMethodData.length===0?jsxRuntimeExports.jsxs("div",{className:"h-[300px] flex flex-col items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"BarChart3",className:"h-12 w-12 text-muted-foreground/40"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Tidak ada data metode"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground/70",children:"Coba ubah filter periode"})]}):jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:300,children:jsxRuntimeExports.jsxs(BarChart,{data:paymentMethodData,children:[jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),jsxRuntimeExports.jsx(XAxis,{dataKey:"name",tick:{fontSize:11}}),jsxRuntimeExports.jsx(YAxis,{yAxisId:"left",tick:{fontSize:12}}),jsxRuntimeExports.jsx(YAxis,{yAxisId:"right",orientation:"right",tickFormatter:v2=>`${v2}Jt`,tick:{fontSize:12}}),jsxRuntimeExports.jsx(Tooltip,{formatter:(value,name)=>name==="Total (Juta)"?[`Rp ${value.toFixed(1)}M`,name]:[value,name]}),jsxRuntimeExports.jsx(Legend,{}),jsxRuntimeExports.jsx(Bar,{yAxisId:"left",dataKey:"count",name:"Jumlah",fill:CHART_COLORS.primary}),jsxRuntimeExports.jsx(Bar,{yAxisId:"right",dataKey:"amount",name:"Total (Juta)",fill:CHART_COLORS.secondary})]})})})]})]}),jsxRuntimeExports.jsxs(Card,{className:"border-border/50",children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-3",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Receipt",className:"h-5 w-5 text-muted-foreground"}),jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Detail Pembayaran"})]}),paymentsData&&paymentsData.data.length>0&&jsxRuntimeExports.jsxs(Badge,{variant:"secondary",className:"bg-muted px-2 py-1",children:[paymentsData.data.length," pembayaran"]})]})}),jsxRuntimeExports.jsxs(CardContent,{className:"p-0",children:[jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full",children:[jsxRuntimeExports.jsx("thead",{className:"bg-muted/50 border-t border-border",children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Tanggal"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Invoice"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Pangkalan"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-muted-foreground",children:"Jumlah"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-muted-foreground",children:"Metode"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Dicatat Oleh"})]})}),jsxRuntimeExports.jsx("tbody",{className:"divide-y divide-border",children:isLoading?jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{colSpan:6,className:"px-4 py-8 text-center",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-6 w-6 animate-spin mx-auto text-muted-foreground"})})}):paymentsData?.data.length===0?jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{colSpan:6,className:"px-4 py-12 text-center",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"CreditCard",className:"h-10 w-10 text-muted-foreground/50"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Tidak ada data pembayaran"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground/70",children:"Coba ubah filter periode"})]})})}):paymentsData?.data.slice((paymentsCurrentPage-1)*paymentsRowsPerPage,paymentsCurrentPage*paymentsRowsPerPage).map(item=>jsxRuntimeExports.jsxs("tr",{className:"hover:bg-muted/30 transition-colors",children:[jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm",children:formatDate(item.date)}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm font-medium font-mono text-blue-600",children:item.invoice_number}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm",children:item.pangkalan}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium text-blue-600",children:formatCurrency(item.amount)}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-center",children:jsxRuntimeExports.jsx(Badge,{variant:"outline",children:item.method})}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm text-muted-foreground",children:item.recorded_by})]},item.id))})]})}),paymentsData&&paymentsData.data.length>0&&jsxRuntimeExports.jsxs("div",{className:"p-3 border-t border-border flex flex-col sm:flex-row items-center justify-between gap-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[jsxRuntimeExports.jsx("span",{children:"Tampilkan"}),jsxRuntimeExports.jsxs(Select,{value:String(paymentsRowsPerPage),onValueChange:v2=>{setPaymentsRowsPerPage(Number(v2)),setPaymentsCurrentPage(1)},children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-[70px] h-8",children:jsxRuntimeExports.jsx(SelectValue,{})}),jsxRuntimeExports.jsx(SelectContent,{children:rowsPerPageOptions.map(opt=>jsxRuntimeExports.jsx(SelectItem,{value:String(opt),children:opt},opt))})]}),jsxRuntimeExports.jsxs("span",{children:["dari ",paymentsData.data.length," data"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:()=>setPaymentsCurrentPage(p2=>Math.max(1,p2-1)),disabled:paymentsCurrentPage===1,className:"h-8 px-2",children:jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronLeft",className:"h-4 w-4"})}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-muted-foreground min-w-[80px] text-center",children:["Hal ",paymentsCurrentPage," / ",Math.ceil(paymentsData.data.length/paymentsRowsPerPage)]}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:()=>setPaymentsCurrentPage(p2=>Math.min(Math.ceil(paymentsData.data.length/paymentsRowsPerPage),p2+1)),disabled:paymentsCurrentPage>=Math.ceil(paymentsData.data.length/paymentsRowsPerPage),className:"h-8 px-2",children:jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronRight",className:"h-4 w-4"})})]})]})]})]})]}),jsxRuntimeExports.jsxs(TabsContent,{value:"stock",className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid gap-4 md:grid-cols-3 lg:grid-cols-5",children:[jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-semibold text-foreground/70",children:"Total Masuk"}),jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-green-50",children:jsxRuntimeExports.jsx(SafeIcon,{name:"ArrowDownCircle",className:"h-4 w-4 text-green-600"})})]}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["+",isLoading?"...":stockData?.summary.total_in||0]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-foreground/60 mt-1",children:"Stok masuk"})]})]})}),jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.1s"},children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-semibold text-foreground/70",children:"Total Keluar"}),jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-red-50",children:jsxRuntimeExports.jsx(SafeIcon,{name:"ArrowUpCircle",className:"h-4 w-4 text-red-600"})})]}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["-",isLoading?"...":stockData?.summary.total_out||0]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-foreground/60 mt-1",children:"Stok keluar"})]})]})}),jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.2s"},children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-semibold text-foreground/70",children:"Perubahan Bersih"}),jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-blue-50",children:jsxRuntimeExports.jsx(SafeIcon,{name:"TrendingUp",className:"h-4 w-4 text-blue-600"})})]}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsxs("div",{className:`text-2xl font-bold ${(stockData?.summary.net_change||0)>=0?"text-green-600":"text-red-600"}`,children:[isLoading?"...":(stockData?.summary.net_change||0)>=0?"+":"",stockData?.summary.net_change||0]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-foreground/60 mt-1",children:"Selisih masuk/keluar"})]})]})}),jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.3s"},children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-semibold text-foreground/70",children:"Saldo Akhir"}),jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-purple-50",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Package",className:"h-4 w-4 text-purple-600"})})]}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-primary",children:isLoading?"...":stockData?.summary.current_balance||0}),jsxRuntimeExports.jsx("p",{className:"text-xs text-foreground/60 mt-1",children:"Stok saat ini"})]})]})}),jsxRuntimeExports.jsx(Tilt3DCard,{className:"animate-fadeInUp",style:{animationDelay:"0.4s"},children:jsxRuntimeExports.jsxs(Card,{children:[jsxRuntimeExports.jsxs(CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-sm font-semibold text-foreground/70",children:"Jumlah Transaksi"}),jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg bg-orange-50",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Activity",className:"h-4 w-4 text-orange-600"})})]}),jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-primary",children:isLoading?"...":stockData?.summary.movement_count||0}),jsxRuntimeExports.jsx("p",{className:"text-xs text-foreground/60 mt-1",children:"Pergerakan stok"})]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[jsxRuntimeExports.jsxs(Card,{className:"border-border/50",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Grafik Pergerakan Stok"}),jsxRuntimeExports.jsx(CardDescription,{children:"Stok masuk dan keluar per hari dalam periode ini"})]}),jsxRuntimeExports.jsx(CardContent,{children:isLoading?jsxRuntimeExports.jsx("div",{className:"h-[300px] flex items-center justify-center",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-8 w-8 animate-spin text-muted-foreground"})}):stockChartData.length===0?jsxRuntimeExports.jsxs("div",{className:"h-[300px] flex flex-col items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"LineChart",className:"h-12 w-12 text-muted-foreground/40"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Tidak ada data pergerakan"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground/70",children:"Coba ubah filter periode"})]}):jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:300,children:jsxRuntimeExports.jsxs(LineChart,{data:stockChartData,children:[jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),jsxRuntimeExports.jsx(XAxis,{dataKey:"date",tick:{fontSize:12}}),jsxRuntimeExports.jsx(YAxis,{tick:{fontSize:12}}),jsxRuntimeExports.jsx(Tooltip,{}),jsxRuntimeExports.jsx(Legend,{}),jsxRuntimeExports.jsx(Line,{type:"monotone",dataKey:"masuk",name:"Masuk",stroke:CHART_COLORS.primary,strokeWidth:2,dot:{fill:CHART_COLORS.primary,strokeWidth:2}}),jsxRuntimeExports.jsx(Line,{type:"monotone",dataKey:"keluar",name:"Keluar",stroke:CHART_COLORS.secondary,strokeWidth:2,dot:{fill:CHART_COLORS.secondary,strokeWidth:2}})]})})})]}),jsxRuntimeExports.jsxs(Card,{className:"border-border/50",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"pb-2",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Pemakaian Berdasarkan Jenis"}),jsxRuntimeExports.jsx(CardDescription,{children:"Distribusi stok masuk/keluar per produk"})]}),jsxRuntimeExports.jsx(CardContent,{children:isLoading?jsxRuntimeExports.jsx("div",{className:"h-[300px] flex items-center justify-center",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-8 w-8 animate-spin text-muted-foreground"})}):stockByProductData.length===0?jsxRuntimeExports.jsxs("div",{className:"h-[300px] flex flex-col items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"BarChart",className:"h-12 w-12 text-muted-foreground/40"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Tidak ada data produk"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground/70",children:"Coba ubah filter periode"})]}):jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:300,children:jsxRuntimeExports.jsxs(BarChart,{data:stockByProductData,layout:"vertical",children:[jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),jsxRuntimeExports.jsx(XAxis,{type:"number",tick:{fontSize:12}}),jsxRuntimeExports.jsx(YAxis,{dataKey:"product",type:"category",tick:{fontSize:11},width:100}),jsxRuntimeExports.jsx(Tooltip,{}),jsxRuntimeExports.jsx(Legend,{}),jsxRuntimeExports.jsx(Bar,{dataKey:"masuk",name:"Masuk",fill:CHART_COLORS.primary}),jsxRuntimeExports.jsx(Bar,{dataKey:"keluar",name:"Keluar",fill:CHART_COLORS.secondary})]})})})]})]}),jsxRuntimeExports.jsxs(Card,{className:"border-border/50",children:[jsxRuntimeExports.jsx(CardHeader,{className:"pb-3",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"PackageOpen",className:"h-5 w-5 text-muted-foreground"}),jsxRuntimeExports.jsx(CardTitle,{className:"text-lg",children:"Riwayat Pergerakan Stok"})]}),stockData&&stockData.data.length>0&&jsxRuntimeExports.jsxs(Badge,{variant:"secondary",className:"bg-muted px-2 py-1",children:[stockData.data.length," pergerakan"]})]})}),jsxRuntimeExports.jsxs(CardContent,{className:"p-0",children:[jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"w-full",children:[jsxRuntimeExports.jsx("thead",{className:"bg-muted/50 border-t border-border",children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Tanggal"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Produk"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-muted-foreground",children:"Tipe"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-muted-foreground",children:"Qty"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Keterangan"}),jsxRuntimeExports.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted-foreground",children:"Dicatat Oleh"})]})}),jsxRuntimeExports.jsx("tbody",{className:"divide-y divide-border",children:isLoading?jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{colSpan:6,className:"px-4 py-8 text-center",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-6 w-6 animate-spin mx-auto text-muted-foreground"})})}):stockData?.data.length===0?jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{colSpan:6,className:"px-4 py-12 text-center",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-2",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Package",className:"h-10 w-10 text-muted-foreground/50"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Tidak ada data pergerakan stok"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground/70",children:"Coba ubah filter periode"})]})})}):stockData?.data.slice((stockCurrentPage-1)*stockRowsPerPage,stockCurrentPage*stockRowsPerPage).map(item=>jsxRuntimeExports.jsxs("tr",{className:"hover:bg-muted/30 transition-colors",children:[jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm",children:formatDate(item.date)}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm font-medium text-orange-600",children:item.product}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-center",children:jsxRuntimeExports.jsx(Badge,{className:`${item.type==="MASUK"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"} hover:bg-inherit`,children:item.type})}),jsxRuntimeExports.jsxs("td",{className:`px-4 py-3 text-sm text-right font-medium font-mono ${item.type==="MASUK"?"text-green-600":"text-red-600"}`,children:[item.type==="MASUK"?"+":"-",item.qty]}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm text-muted-foreground",children:item.note||"-"}),jsxRuntimeExports.jsx("td",{className:"px-4 py-3 text-sm text-muted-foreground",children:item.recorded_by})]},item.id))})]})}),stockData&&stockData.data.length>0&&jsxRuntimeExports.jsxs("div",{className:"p-3 border-t border-border flex flex-col sm:flex-row items-center justify-between gap-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[jsxRuntimeExports.jsx("span",{children:"Tampilkan"}),jsxRuntimeExports.jsxs(Select,{value:String(stockRowsPerPage),onValueChange:v2=>{setStockRowsPerPage(Number(v2)),setStockCurrentPage(1)},children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-[70px] h-8",children:jsxRuntimeExports.jsx(SelectValue,{})}),jsxRuntimeExports.jsx(SelectContent,{children:rowsPerPageOptions.map(opt=>jsxRuntimeExports.jsx(SelectItem,{value:String(opt),children:opt},opt))})]}),jsxRuntimeExports.jsxs("span",{children:["dari ",stockData.data.length," data"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:()=>setStockCurrentPage(p2=>Math.max(1,p2-1)),disabled:stockCurrentPage===1,className:"h-8 px-2",children:jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronLeft",className:"h-4 w-4"})}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-muted-foreground min-w-[80px] text-center",children:["Hal ",stockCurrentPage," / ",Math.ceil(stockData.data.length/stockRowsPerPage)]}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"sm",onClick:()=>setStockCurrentPage(p2=>Math.min(Math.ceil(stockData.data.length/stockRowsPerPage),p2+1)),disabled:stockCurrentPage>=Math.ceil(stockData.data.length/stockRowsPerPage),className:"h-8 px-2",children:jsxRuntimeExports.jsx(SafeIcon,{name:"ChevronRight",className:"h-4 w-4"})})]})]})]})]})]})]})]})}export{ReportsPage as R,_typeof as _};
