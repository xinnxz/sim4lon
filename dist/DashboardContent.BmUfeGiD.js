import{j as jsxRuntimeExports}from"./jsx-runtime.mvtouYz0.js";import{a as CardHeader,b as CardTitle,d as CardContent,C as Card,c as CardDescription}from"./card.SxAweRZB.js";import{S as SafeIcon,B as Button}from"./SafeIcon.C08LGL0m.js";import{r as reactExports}from"./index.DcciWILN.js";import{B as Badge}from"./badge.BFgaaq5n.js";import{u as use3DTilt}from"./use3DTilt.Dcq4iilr.js";import{dashboardApi,pangkalanApi,activityApi}from"./api.B5PpFILw.js";import{R as ResponsiveContainer,T as Tooltip,L as Legend,B as Bar,C as Cell}from"./generateCategoricalChart.Crqe-OLF.js";import{L as LineChart,C as CartesianGrid,X as XAxis,Y as YAxis,a as Line}from"./LineChart.DBAKq2J_.js";import{B as BarChart}from"./BarChart.ffT2CUX_.js";import{D as Dialog,e as DialogTrigger,a as DialogContent,b as DialogHeader,c as DialogTitle,d as DialogDescription}from"./dialog.Deg6T-G2.js";import{P as PieChart,a as Pie}from"./PieChart.DJGyav3p.js";import{S as Separator}from"./separator.D_t_gK4i.js";import{S as Skeleton}from"./skeleton.CiucfBuv.js";import"./index.DYERl0li.js";import"./index.CmV6gt94.js";import"./index.PIAPtHoh.js";import"./index.ubNQCTBn.js";import"./index.CLV08RI1.js";import"./index.BB0xO63c.js";import"./Combination.wteLWZ5f.js";import"./index.Ci_bviUJ.js";import"./x.3YBaUzhJ.js";function CreateOrderButton(){return jsxRuntimeExports.jsx("div",{id:"ik3r7o",className:"w-full",children:jsxRuntimeExports.jsxs("a",{href:"./buat-pesanan.html",className:"inline-flex items-center gap-3 px-6 sm:px-7 py-3.5 bg-gradient-to-r from-white to-background/5 border border-border rounded-xl shadow-enterprise hover:scale-105 active:scale-95 transition-all duration-300 ease-out font-semibold text-sm sm:text-base text-foreground",id:"icez9",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Plus",className:"h-5 w-5 stroke-[1.5] flex-shrink-0 transition-transform duration-300 group-hover:rotate-90"}),"Buat Pesanan"]})})}const KPICardItem=({kpi,index})=>{const{cardRef,isHovering,handleMouseMove,handleMouseEnter,handleMouseLeave,getTransform}=use3DTilt();return jsxRuntimeExports.jsx("div",{ref:cardRef,className:`animate-scaleIn kpi-card-${index+1}`,style:{perspective:"1000px",transformStyle:"preserve-3d"},onMouseMove:handleMouseMove,onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave,children:jsxRuntimeExports.jsx("div",{style:{transform:getTransform(),transformStyle:"preserve-3d",transition:isHovering?"none":"transform 0.5s cubic-bezier(0.23, 1, 0.320, 1)"},children:jsxRuntimeExports.jsxs("div",{className:"overflow-hidden shadow-sm transition-shadow duration-300 ease-out cursor-default group relative bg-gradient-to-br from-card via-card to-card/70 h-full rounded-xl border-0 bg-card text-card-foreground",style:{boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",transition:"box-shadow 0.3s cubic-bezier(0.23, 1, 0.320, 1)",border:"1px solid hsl(var(--border))",pointerEvents:"auto"},children:[jsxRuntimeExports.jsxs(CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-sm sm:text-base font-semibold leading-tight",children:kpi.title}),jsxRuntimeExports.jsx("div",{className:`${kpi.color} p-2.5 rounded-lg flex-shrink-0 transition-all duration-300 group-hover:scale-125 group-hover:shadow-lg`,children:jsxRuntimeExports.jsx(SafeIcon,{name:kpi.icon,className:`h-5 w-5 ${kpi.iconColor}`})})]}),jsxRuntimeExports.jsxs(CardContent,{className:"space-y-3",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl sm:text-3xl font-bold transition-colors duration-300",children:kpi.value}),jsxRuntimeExports.jsx(Badge,{variant:kpi.changeType==="positive"?"default":"destructive",className:"text-xs font-semibold transition-all duration-300",children:kpi.change})]})]})})})},KPICardSkeleton=({index})=>jsxRuntimeExports.jsx("div",{className:`animate-pulse kpi-card-${index+1}`,children:jsxRuntimeExports.jsx("div",{className:"h-32 bg-muted rounded-xl"})});function formatNumber(num){return new Intl.NumberFormat("id-ID").format(num)}function DashboardKPICards(){const[stats,setStats]=reactExports.useState(null),[isLoading,setIsLoading]=reactExports.useState(!0),[error,setError]=reactExports.useState(null);if(reactExports.useEffect(()=>{(async()=>{try{setIsLoading(!0);const data=await dashboardApi.getStats();setStats(data),setError(null)}catch(err){console.error("Failed to fetch dashboard stats:",err),setError("Gagal memuat data")}finally{setIsLoading(!1)}})()},[]),isLoading)return jsxRuntimeExports.jsx("div",{id:"il6kka",className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 mt-2",children:[0,1,2,3].map(index=>jsxRuntimeExports.jsx(KPICardSkeleton,{index},index))});const totalStock=stats?.dynamicProducts?.reduce((sum,p)=>sum+p.stock.current,0)||0,hasProducts=stats?.dynamicProducts&&stats.dynamicProducts.length>0,getStockBreakdown=()=>hasProducts?`${stats.dynamicProducts.length} jenis produk`:"Belum ada produk LPG",kpiData=[{title:"Total Pesanan",value:formatNumber(stats?.todayOrders||0),change:"Hari ini",changeType:"positive",icon:"ShoppingCart",color:"bg-blue-50",iconColor:"text-blue-600"},{title:"Menunggu Pembayaran",value:formatNumber(stats?.pendingOrders||0),change:"Perlu ditagih",changeType:stats&&stats.pendingOrders>5?"negative":"positive",icon:"Clock",color:"bg-amber-50",iconColor:"text-amber-600"},{title:"Pesanan Selesai",value:formatNumber(stats?.completedOrders||0),change:"Hari ini",changeType:"positive",icon:"Truck",color:"bg-green-50",iconColor:"text-green-600"},{title:"Total Stok LPG",value:formatNumber(totalStock),change:getStockBreakdown(),changeType:totalStock<100?"negative":"positive",icon:"Package",color:"bg-purple-50",iconColor:"text-purple-600"}];return jsxRuntimeExports.jsx("div",{id:"il6kka",className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 mt-2",children:kpiData.map((kpi,index)=>jsxRuntimeExports.jsx(KPICardItem,{kpi,index},kpi.title))})}const CustomTooltip$3=({active,payload})=>active&&payload&&payload.length?jsxRuntimeExports.jsxs("div",{className:"bg-background border border-border rounded-lg shadow-lg p-3 backdrop-blur-sm",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-semibold text-foreground",children:payload[0].payload.day}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-primary font-bold",children:["Rp ",(payload[0].value/1e6).toFixed(1),"Jt"]})]}):null;function SalesChart({isVisible=!0}){const[data,setData]=reactExports.useState([]),[isLoading,setIsLoading]=reactExports.useState(!0),[error,setError]=reactExports.useState(null);return reactExports.useEffect(()=>{(async()=>{try{setIsLoading(!0);const response=await dashboardApi.getSalesChart();setData(response.data),setError(null)}catch(err){console.error("Failed to fetch sales chart:",err),setError("Gagal memuat data"),setData([])}finally{setIsLoading(!1)}})()},[]),isLoading?jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"animate-pulse text-muted-foreground",children:"Memuat data..."})}):error?jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"text-destructive",children:error})}):data.length===0?jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"text-muted-foreground",children:"Belum ada data penjualan"})}):jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:"100%",children:jsxRuntimeExports.jsxs(LineChart,{data,margin:{top:5,right:30,left:0,bottom:5},className:"drop-shadow-sm",children:[jsxRuntimeExports.jsx("defs",{children:jsxRuntimeExports.jsxs("linearGradient",{id:"colorSales",x1:"0",y1:"0",x2:"0",y2:"1",children:[jsxRuntimeExports.jsx("stop",{offset:"5%",stopColor:"hsl(var(--primary))",stopOpacity:.8}),jsxRuntimeExports.jsx("stop",{offset:"95%",stopColor:"hsl(var(--primary))",stopOpacity:0})]})}),jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.5,vertical:!1}),jsxRuntimeExports.jsx(XAxis,{dataKey:"day",stroke:"hsl(var(--muted-foreground))",style:{fontSize:"12px"}}),jsxRuntimeExports.jsx(YAxis,{stroke:"hsl(var(--muted-foreground))",style:{fontSize:"12px"},tickFormatter:value=>`Rp${(value/1e6).toFixed(0)}Jt`}),jsxRuntimeExports.jsx(Tooltip,{content:jsxRuntimeExports.jsx(CustomTooltip$3,{}),cursor:{stroke:"hsl(var(--primary))",strokeWidth:2,opacity:.3}}),jsxRuntimeExports.jsx(Line,{type:"monotone",dataKey:"sales",stroke:"hsl(var(--primary))",strokeWidth:3,dot:{fill:"hsl(var(--primary))",r:5,strokeWidth:2,stroke:"hsl(var(--background))"},activeDot:{r:7,strokeWidth:2},isAnimationActive:isVisible,animationBegin:0,animationDuration:800,animationEasing:"ease-in-out",fillOpacity:1})]})})}const CustomTooltip$2=({active,payload,label})=>active&&payload&&payload.length?jsxRuntimeExports.jsxs("div",{className:"bg-background border border-border rounded-lg shadow-lg p-3 backdrop-blur-sm",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-semibold text-foreground mb-2",children:label}),payload.map((entry,index)=>jsxRuntimeExports.jsxs("p",{className:"text-sm",style:{color:entry.color},children:[entry.name,": ",jsxRuntimeExports.jsxs("span",{className:"font-bold",children:[entry.value," Unit"]})]},index))]}):null;function StockChart({isVisible=!0}){const[chartData,setChartData]=reactExports.useState(null),[isLoading,setIsLoading]=reactExports.useState(!0),[error,setError]=reactExports.useState(null);return reactExports.useEffect(()=>{(async()=>{try{setIsLoading(!0);const response=await dashboardApi.getStockChart();setChartData(response),setError(null)}catch(err){console.error("Failed to fetch stock chart:",err),setError("Gagal memuat data"),setChartData(null)}finally{setIsLoading(!1)}})()},[]),isLoading?jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"animate-pulse text-muted-foreground",children:"Memuat data..."})}):error?jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"text-destructive",children:error})}):!chartData||chartData.data.length===0||chartData.products.length===0?jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"text-muted-foreground",children:"Belum ada data stok"})}):jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:"100%",children:jsxRuntimeExports.jsxs(LineChart,{data:chartData.data,margin:{top:5,right:30,left:0,bottom:5},className:"drop-shadow-sm",children:[jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.5,vertical:!1}),jsxRuntimeExports.jsx(XAxis,{dataKey:"day",stroke:"hsl(var(--muted-foreground))",style:{fontSize:"12px"}}),jsxRuntimeExports.jsx(YAxis,{stroke:"hsl(var(--muted-foreground))",style:{fontSize:"12px"},tickFormatter:value=>`${value}`}),jsxRuntimeExports.jsx(Tooltip,{content:jsxRuntimeExports.jsx(CustomTooltip$2,{}),cursor:{stroke:"hsl(var(--accent))",strokeWidth:2,opacity:.3}}),jsxRuntimeExports.jsx(Legend,{wrapperStyle:{fontSize:"11px",paddingTop:"10px"}}),chartData.products.map((product,index)=>jsxRuntimeExports.jsx(Line,{type:"monotone",dataKey:product.id,name:product.name,stroke:product.color,strokeWidth:2,dot:{fill:product.color,r:3,strokeWidth:2,stroke:"hsl(var(--background))"},activeDot:{r:5,strokeWidth:2},isAnimationActive:isVisible,animationBegin:index*100,animationDuration:800,animationEasing:"ease-in-out"},product.id))]})})}const CustomTooltip$1=({active,payload})=>active&&payload&&payload.length?jsxRuntimeExports.jsxs("div",{className:"bg-background border border-border rounded-lg shadow-lg p-3 backdrop-blur-sm",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-semibold text-foreground",children:payload[0].payload.day}),jsxRuntimeExports.jsxs("p",{className:"text-sm font-bold text-green-600",children:["Rp ",(payload[0].value/1e3).toFixed(0),"K"]})]}):null,GRADIENT_COLORS=["hsl(152 100% 35%)","hsl(152 95% 38%)","hsl(152 90% 40%)","hsl(152 85% 38%)","hsl(152 90% 35%)","hsl(152 95% 33%)","hsl(152 100% 30%)"];function ProfitChart({isVisible=!0}){const[data,setData]=reactExports.useState([]),[isLoading,setIsLoading]=reactExports.useState(!0),[error,setError]=reactExports.useState(null);return reactExports.useEffect(()=>{(async()=>{try{setIsLoading(!0);const response=await dashboardApi.getProfitChart();setData(response.data),setError(null)}catch(err){console.error("Failed to fetch profit chart:",err),setError("Gagal memuat data"),setData([])}finally{setIsLoading(!1)}})()},[]),isLoading?jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"animate-pulse text-muted-foreground",children:"Memuat data..."})}):error?jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"text-destructive",children:error})}):data.length===0?jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"text-muted-foreground",children:"Belum ada data keuntungan"})}):jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:300,children:jsxRuntimeExports.jsxs(BarChart,{data,margin:{top:10,right:30,left:0,bottom:5},className:"drop-shadow-sm",children:[jsxRuntimeExports.jsx("defs",{children:jsxRuntimeExports.jsxs("linearGradient",{id:"colorProfitGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[jsxRuntimeExports.jsx("stop",{offset:"0%",stopColor:"hsl(152 100% 35%)",stopOpacity:1}),jsxRuntimeExports.jsx("stop",{offset:"100%",stopColor:"hsl(152 100% 45%)",stopOpacity:.8})]})}),jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.5,vertical:!1}),jsxRuntimeExports.jsx(XAxis,{dataKey:"day",stroke:"hsl(var(--muted-foreground))",style:{fontSize:"12px"}}),jsxRuntimeExports.jsx(YAxis,{stroke:"hsl(var(--muted-foreground))",style:{fontSize:"12px"},tickFormatter:value=>`Rp${(value/1e3).toFixed(0)}K`}),jsxRuntimeExports.jsx(Tooltip,{content:jsxRuntimeExports.jsx(CustomTooltip$1,{}),cursor:{fill:"hsl(var(--primary) / 0.1)",radius:8}}),jsxRuntimeExports.jsx(Bar,{dataKey:"profit",fill:"url(#colorProfitGradient)",radius:[8,8,0,0],isAnimationActive:isVisible,animationBegin:0,animationDuration:800,animationEasing:"ease-in-out",children:data.map((entry,index)=>jsxRuntimeExports.jsx(Cell,{fill:GRADIENT_COLORS[index%GRADIENT_COLORS.length]},`cell-${index}`))})]})})}const COLORS=["#22c55e","#3b82f6","#f59e0b"],CustomTooltip=({active,payload})=>{if(active&&payload&&payload.length){const data=payload[0].payload;return jsxRuntimeExports.jsxs("div",{className:"bg-background border border-border rounded-lg shadow-lg p-3 backdrop-blur-sm",children:[jsxRuntimeExports.jsx("p",{className:"text-xs font-semibold text-foreground max-w-[160px] truncate",children:data.name}),jsxRuntimeExports.jsxs("p",{className:"text-sm font-bold text-primary",children:[data.value," pesanan"]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-muted-foreground",children:[data.percentage,"%"]})]})}return null};function PangkalanOrderChart({isVisible=!0}){const[data,setData]=reactExports.useState([]),[allRankings,setAllRankings]=reactExports.useState([]),[isLoading,setIsLoading]=reactExports.useState(!0),[isLoadingMore,setIsLoadingMore]=reactExports.useState(!1),[error,setError]=reactExports.useState(null),[showModal,setShowModal]=reactExports.useState(!1);reactExports.useEffect(()=>{(async()=>{try{setIsLoading(!0);const response=await dashboardApi.getTopPangkalan(),totalValue=response.data.reduce((sum,item)=>sum+item.value,0),processedData=response.data.map(item=>({...item,percentage:totalValue>0?(item.value/totalValue*100).toFixed(1):"0"}));setData(processedData),setError(null)}catch(err){console.error("Failed to fetch pangkalan chart:",err),setError("Gagal memuat data"),setData([])}finally{setIsLoading(!1)}})()},[]);const handleOpenModal=async()=>{if(setShowModal(!0),allRankings.length===0){setIsLoadingMore(!0);try{const sorted=(await pangkalanApi.getAll(1,100)).data.filter(p=>p._count?.orders>0).map(p=>({name:p.name,value:p._count?.orders||0})).sort((a,b)=>b.value-a.value),total=sorted.reduce((sum,item)=>sum+item.value,0),withPercentage=sorted.map(item=>({...item,percentage:total>0?(item.value/total*100).toFixed(1):"0"}));setAllRankings(withPercentage)}catch(err){console.error("Failed to fetch all rankings:",err)}finally{setIsLoadingMore(!1)}}};return isLoading?jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"animate-pulse text-muted-foreground text-sm",children:"Memuat data..."})}):error?jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"text-destructive text-sm",children:error})}):data.length===0?jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"text-muted-foreground text-sm",children:"Belum ada data pangkalan"})}):jsxRuntimeExports.jsxs("div",{className:"w-full h-full flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 min-h-0",children:jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:"100%",children:jsxRuntimeExports.jsxs(PieChart,{children:[jsxRuntimeExports.jsx(Pie,{data,cx:"50%",cy:"50%",innerRadius:"40%",outerRadius:"70%",paddingAngle:4,dataKey:"value",labelLine:!1,isAnimationActive:isVisible,animationBegin:0,animationDuration:800,animationEasing:"ease-in-out",children:data.map((entry,index)=>jsxRuntimeExports.jsx(Cell,{fill:COLORS[index%COLORS.length],style:{filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.1))"}},`cell-${index}`))}),jsxRuntimeExports.jsx(Tooltip,{content:jsxRuntimeExports.jsx(CustomTooltip,{})})]})})}),jsxRuntimeExports.jsx("div",{className:"flex flex-col gap-1.5 pt-2 pb-2",children:data.map((item,index)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[jsxRuntimeExports.jsx("div",{className:"w-2.5 h-2.5 rounded-sm shrink-0",style:{backgroundColor:COLORS[index%COLORS.length]}}),jsxRuntimeExports.jsx("span",{className:"flex-1 truncate text-muted-foreground",title:item.name,children:item.name}),jsxRuntimeExports.jsxs("span",{className:"font-semibold text-foreground shrink-0",children:[item.percentage,"%"]})]},item.name))}),jsxRuntimeExports.jsxs(Dialog,{open:showModal,onOpenChange:setShowModal,children:[jsxRuntimeExports.jsx(DialogTrigger,{asChild:!0,children:jsxRuntimeExports.jsxs(Button,{variant:"outline",size:"sm",className:"w-full text-xs",onClick:handleOpenModal,children:[jsxRuntimeExports.jsx(SafeIcon,{name:"BarChart3",className:"h-3.5 w-3.5 mr-1.5"}),"Lihat Semua Ranking"]})}),jsxRuntimeExports.jsxs(DialogContent,{className:"max-w-md max-h-[80vh]",children:[jsxRuntimeExports.jsxs(DialogHeader,{children:[jsxRuntimeExports.jsx(DialogTitle,{children:"Ranking Semua Pangkalan"}),jsxRuntimeExports.jsx(DialogDescription,{children:"Berdasarkan jumlah pesanan"})]}),jsxRuntimeExports.jsx("div",{className:"overflow-y-auto max-h-[50vh] pr-2",children:isLoadingMore?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center py-8",children:jsxRuntimeExports.jsx(SafeIcon,{name:"Loader2",className:"h-6 w-6 animate-spin text-muted-foreground"})}):allRankings.length>0?jsxRuntimeExports.jsx("div",{className:"space-y-2",children:allRankings.map((item,index)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/50 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${index===0?"bg-yellow-500 text-white":index===1?"bg-gray-400 text-white":index===2?"bg-amber-600 text-white":"bg-muted text-muted-foreground"}`,children:index+1}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium truncate",children:item.name}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-muted-foreground",children:[item.value," pesanan"]})]}),jsxRuntimeExports.jsxs("span",{className:"text-sm font-semibold text-primary shrink-0",children:[item.percentage,"%"]})]},item.name))}):jsxRuntimeExports.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"Tidak ada data pangkalan"})})]})]})]})}const formatRelativeTime=timestamp=>{const now=new Date,date=new Date(timestamp),diffMs=now.getTime()-date.getTime(),diffMins=Math.floor(diffMs/6e4),diffHours=Math.floor(diffMs/36e5),diffDays=Math.floor(diffMs/864e5);return diffMins<1?"Baru saja":diffMins<60?`${diffMins} menit yang lalu`:diffHours<24?`${diffHours} jam yang lalu`:diffDays<7?`${diffDays} hari yang lalu`:date.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})},getActivityIcon=(type,iconName)=>{if(iconName)return iconName;switch(type){case"ORDER_NEW":return"ShoppingCart";case"ORDER_UPDATED":return"Edit";case"ORDER_COMPLETED":return"CheckCircle";case"ORDER_CANCELLED":return"XCircle";case"PAYMENT_RECEIVED":return"CreditCard";case"STOCK_IN":return"ArrowDownCircle";case"STOCK_OUT":return"ArrowUpCircle";case"USER_LOGIN":return"LogIn";default:return"Activity"}},getActivityStyle=type=>{switch(type){case"ORDER_NEW":return{bg:"bg-blue-50",text:"text-blue-600",badge:"bg-blue-100 text-blue-700",badgeText:"Baru"};case"ORDER_COMPLETED":return{bg:"bg-green-50",text:"text-green-600",badge:"bg-green-100 text-green-700",badgeText:"Selesai"};case"ORDER_CANCELLED":return{bg:"bg-red-50",text:"text-red-600",badge:"bg-red-100 text-red-700",badgeText:"Batal"};case"PAYMENT_RECEIVED":return{bg:"bg-emerald-50",text:"text-emerald-600",badge:"bg-emerald-100 text-emerald-700",badgeText:"Pembayaran"};case"STOCK_IN":return{bg:"bg-indigo-50",text:"text-indigo-600",badge:"bg-indigo-100 text-indigo-700",badgeText:"Stok Masuk"};case"STOCK_OUT":return{bg:"bg-orange-50",text:"text-orange-600",badge:"bg-orange-100 text-orange-700",badgeText:"Stok Keluar"};default:return{bg:"bg-gray-50",text:"text-gray-600",badge:"bg-gray-100 text-gray-700",badgeText:"Lainnya"}}};function RecentActivitySection(){const[activities,setActivities]=reactExports.useState([]),[isLoading,setIsLoading]=reactExports.useState(!0),[error,setError]=reactExports.useState(null);return reactExports.useEffect(()=>{(async()=>{try{setIsLoading(!0);const data=await activityApi.getRecent(5);setActivities(data)}catch(err){console.error("Failed to fetch recent activities:",err),setError("Gagal memuat aktivitas")}finally{setIsLoading(!1)}})()},[]),jsxRuntimeExports.jsxs(Card,{className:"h-full flex flex-col shadow-enterprise",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"pb-4",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-lg font-semibold",children:"Aktivitas Terbaru"}),jsxRuntimeExports.jsx(CardDescription,{className:"text-xs sm:text-sm",children:"Pantau aktivitas sistem secara real-time"})]}),jsxRuntimeExports.jsxs(CardContent,{className:"space-y-4 flex-1 flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto flex-1",children:isLoading?Array.from({length:4}).map((_,i)=>jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3 p-3",children:[jsxRuntimeExports.jsx(Skeleton,{className:"h-10 w-10 rounded-full"}),jsxRuntimeExports.jsxs("div",{className:"flex-1 space-y-2",children:[jsxRuntimeExports.jsx(Skeleton,{className:"h-4 w-3/4"}),jsxRuntimeExports.jsx(Skeleton,{className:"h-3 w-1/2"}),jsxRuntimeExports.jsx(Skeleton,{className:"h-3 w-1/4"})]})]},i)):error?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"AlertCircle",className:"h-10 w-10 mb-2 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:error})]}):activities.length===0?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[jsxRuntimeExports.jsx(SafeIcon,{name:"Inbox",className:"h-10 w-10 mb-2 opacity-50"}),jsxRuntimeExports.jsx("p",{className:"text-sm",children:"Belum ada aktivitas"})]}):activities.map((activity,index)=>{const style=getActivityStyle(activity.type),icon=getActivityIcon(activity.type,activity.icon_name);return jsxRuntimeExports.jsxs("div",{className:"transition-all duration-300 ease-out hover:bg-muted/50 p-3 rounded-lg cursor-pointer animate-fadeInUp",style:{animationDelay:`${index*.1}s`},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[jsxRuntimeExports.jsx("div",{className:`flex h-10 w-10 shrink-0 items-center justify-center rounded-full ${style.bg} transition-all duration-300`,children:jsxRuntimeExports.jsx(SafeIcon,{name:icon,className:`h-5 w-5 ${style.text}`})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 space-y-1.5 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2",children:[jsxRuntimeExports.jsx("p",{className:"text-xs sm:text-sm font-medium",children:activity.title}),jsxRuntimeExports.jsx(Badge,{variant:"outline",className:`text-xs flex-shrink-0 ${style.badge} hover:bg-inherit`,children:style.badgeText})]}),jsxRuntimeExports.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground line-clamp-2",children:activity.description||activity.pangkalan_name||"Tidak ada detail"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between text-xs",children:[jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:formatRelativeTime(activity.timestamp)}),activity.detail_numeric&&jsxRuntimeExports.jsxs("p",{className:"font-semibold text-primary",children:[activity.detail_numeric.toLocaleString("id-ID")," tabung"]})]})]})]}),index<activities.length-1&&jsxRuntimeExports.jsx(Separator,{className:"mt-3"})]},activity.id)})}),jsxRuntimeExports.jsx(Button,{variant:"outline",className:"w-full mt-2 text-xs sm:text-sm hover:scale-[1.02] active:scale-[0.98] transition-all duration-300 ease-out group",asChild:!0,children:jsxRuntimeExports.jsxs("a",{href:"/riwayat-aktivitas",children:["Lihat Semua Aktivitas",jsxRuntimeExports.jsx(SafeIcon,{name:"ArrowRight",className:"ml-2 h-4 w-4 transition-transform duration-300 group-hover:translate-x-1"})]})})]})]})}function useIntersectionObserver(options={}){const ref=reactExports.useRef(null),[isVisible,setIsVisible]=reactExports.useState(!1),[hasBeenVisible,setHasBeenVisible]=reactExports.useState(!1);return reactExports.useEffect(()=>{if(typeof window>"u")return;const observer=new IntersectionObserver(([entry])=>{entry.isIntersecting?(setIsVisible(!0),setHasBeenVisible(!0)):setIsVisible(!1)},{threshold:options.threshold??.1,rootMargin:options.rootMargin??"0px"});return ref.current&&observer.observe(ref.current),()=>{ref.current&&observer.unobserve(ref.current)}},[options]),{ref,isVisible,hasBeenVisible}}function ChartContainer({children,animationDelay}){const{ref,isVisible}=useIntersectionObserver({threshold:.1});return jsxRuntimeExports.jsx("div",{ref,style:animationDelay?{animationDelay}:{},children:children(isVisible)})}function DashboardContent(){return jsxRuntimeExports.jsxs("div",{id:"is6jwg",className:"flex-1 space-y-8 p-4 sm:p-6 lg:p-8 bg-background",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4 animate-fadeInDown",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h1",{className:"text-3xl sm:text-4xl lg:text-5xl font-bold tracking-tight bg-gradient-to-r from-foreground to-foreground/70 bg-clip-text text-transparent",children:"Dashboard"})}),jsxRuntimeExports.jsx("p",{className:"text-base sm:text-lg text-muted-foreground/80 max-w-2xl",children:"Selamat datang kembali! Berikut adalah ringkasan operasional Anda hari ini."})]}),jsxRuntimeExports.jsx("div",{className:"animate-fadeInUp",style:{animationDelay:"0.05s"},children:jsxRuntimeExports.jsx(CreateOrderButton,{})}),jsxRuntimeExports.jsx(DashboardKPICards,{}),jsxRuntimeExports.jsx(ChartContainer,{animationDelay:"0.5s",children:isVisible=>jsxRuntimeExports.jsx("div",{className:"w-full animate-fadeInUp chart-sales",children:jsxRuntimeExports.jsxs(Card,{className:"shadow-enterprise",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"pb-4",children:[jsxRuntimeExports.jsx(CardTitle,{id:"i1oio5",className:"text-lg sm:text-xl font-semibold",children:"Pesanan Mingguan"}),jsxRuntimeExports.jsx(CardDescription,{id:"iwkknt",className:"text-xs sm:text-sm",children:"Ringkasan pemesanan gas 7 hari terakhir"})]}),jsxRuntimeExports.jsx(CardContent,{className:"p-4 sm:p-6 pt-0",children:jsxRuntimeExports.jsx("div",{className:"w-full h-64 sm:h-72 lg:h-80",children:jsxRuntimeExports.jsx(SalesChart,{isVisible})})})]})})}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[jsxRuntimeExports.jsx(ChartContainer,{animationDelay:"0.6s",children:isVisible=>jsxRuntimeExports.jsx("div",{className:"animate-fadeInUp chart-stock",children:jsxRuntimeExports.jsxs(Card,{className:"shadow-enterprise",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"pb-4",children:[jsxRuntimeExports.jsx(CardTitle,{id:"ixkzi5",className:"text-lg font-semibold",children:"Stok LPG"}),jsxRuntimeExports.jsx(CardDescription,{id:"ico6v7",className:"text-xs sm:text-sm",children:"Tren stok lpg mingguan"})]}),jsxRuntimeExports.jsx(CardContent,{className:"p-4 sm:p-6 pt-0",children:jsxRuntimeExports.jsx("div",{className:"w-full h-64 sm:h-72",children:jsxRuntimeExports.jsx(StockChart,{isVisible})})})]})})}),jsxRuntimeExports.jsx(ChartContainer,{animationDelay:"0.65s",children:isVisible=>jsxRuntimeExports.jsx("div",{className:"animate-fadeInUp chart-profit",children:jsxRuntimeExports.jsxs(Card,{className:"shadow-enterprise",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"pb-4",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-lg font-semibold",children:"Keuntungan"}),jsxRuntimeExports.jsx(CardDescription,{className:"text-xs sm:text-sm",children:"Profit harian"})]}),jsxRuntimeExports.jsx(CardContent,{className:"p-4 sm:p-6 pt-0",children:jsxRuntimeExports.jsx("div",{className:"w-full h-64 sm:h-72",children:jsxRuntimeExports.jsx(ProfitChart,{isVisible})})})]})})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[jsxRuntimeExports.jsx(ChartContainer,{animationDelay:"0.7s",children:isVisible=>jsxRuntimeExports.jsx("div",{className:"animate-fadeInUp h-full",children:jsxRuntimeExports.jsxs(Card,{className:"h-full shadow-enterprise flex flex-col",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"pb-3",children:[jsxRuntimeExports.jsx(CardTitle,{className:"text-lg font-semibold",children:"Top Pangkalan"}),jsxRuntimeExports.jsx(CardDescription,{className:"text-xs sm:text-sm",children:"3 pangkalan dengan order terbanyak"})]}),jsxRuntimeExports.jsx(CardContent,{className:"flex-1 p-4 pt-0 flex flex-col",children:jsxRuntimeExports.jsx("div",{className:"w-full flex-1 min-h-[240px]",children:jsxRuntimeExports.jsx(PangkalanOrderChart,{isVisible})})})]})})}),jsxRuntimeExports.jsx(ChartContainer,{animationDelay:"0.75s",children:isVisible=>jsxRuntimeExports.jsx("div",{className:"animate-fadeInUp h-full",children:jsxRuntimeExports.jsx(RecentActivitySection,{})})})]})]})}export{DashboardContent as default};
